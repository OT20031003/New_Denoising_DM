Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([10, 3, 256, 256])
10 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([10, 8, 32, 32])
autoencoder.py , moments = torch.Size([10, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5908, 0.4737, 0.7370, 0.6033, 0.5286, 0.8769, 0.5822, 0.6585, 0.6126,
        0.5291], device='cuda:0')
Variance (Real, all elements): 0.5303367376327515
Variance (Imag, all elements): 0.47340333461761475
--------SNR = -5,  rho_ul = 0.07905694150420949-----------
G_variance = tensor([1.0437, 0.8602, 0.9750, 0.8653, 0.9432, 0.7141, 0.9722, 0.7389, 0.9549,
        0.9552], device='cuda:0')
G_hat_variance = tensor([0.5659, 0.4900, 0.4642, 0.4901, 0.5641, 0.3775, 0.6061, 0.5046, 0.5984,
        0.6190], device='cuda:0')
G_tilde_var = tensor([0.3144, 0.3376, 0.4372, 0.3518, 0.2964, 0.3314, 0.4467, 0.3605, 0.3553,
        0.3794], device='cuda:0')
gamma = tensor([[[0.6126, 0.6126, 0.6126, 0.6126]]], device='cuda:0')
Z_mean = tensor([ 0.2301+0.0578j,  0.1408-0.0343j, -0.0278+0.1681j, -0.0347+0.3100j,
         0.0558+0.1619j,  0.0343-0.0155j,  0.2819+0.0056j,  0.0057-0.0434j,
        -0.1073+0.1083j,  0.1108+0.1667j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9238, 0.7999, 0.7577, 0.8000, 0.9209, 0.6163, 0.9895, 0.8237, 0.9768,
        1.0104], device='cuda:0')
Real_SNR = tensor([-4.1610, -4.4447, -4.7656, -5.4583, -5.6383, -5.7652, -4.4644, -5.2582,
        -4.9271, -4.6336], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.7823, 4.5703, 4.3180, 3.5391, 3.5008, 3.3140, 4.3636, 3.6770, 4.0960,
        4.3965], device='cuda:0')
signal_var = tensor([0.3781, 0.3613, 0.3414, 0.2798, 0.2768, 0.2620, 0.3450, 0.2907, 0.3238,
        0.3476], device='cuda:0')
w_var = tensor([0.9856, 1.0054, 1.0228, 0.9832, 1.0138, 0.9881, 0.9643, 0.9756, 1.0070,
        1.0102], device='cuda:0')
y_var = tensor([1.3769, 1.3849, 1.3568, 1.2541, 1.2852, 1.2508, 1.3052, 1.2575, 1.3229,
        1.3535], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[18.5898,  8.2623,  3.5987,  7.8279],
        [13.0240,  5.5582,  4.1931,  9.2603],
        [ 7.2948, 10.3077,  6.4019,  6.7093],
        [ 7.1182,  9.2718,  5.7066, 12.9974],
        [ 8.6194, 10.4350,  5.3748, 12.6585],
        [ 3.5978,  7.3360,  7.2820,  5.8757],
        [ 8.2351, 12.9368, 13.3866,  7.2118],
        [10.3212, 10.0286,  6.6146,  5.2384],
        [12.4593, 11.4022,  5.6929,  9.4705],
        [ 8.1419, 18.9593, 10.0617,  3.8461]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[20.8673,  9.2745,  4.0396,  8.7869],
        [14.6196,  6.2392,  4.7068, 10.3948],
        [ 8.1885, 11.5706,  7.1862,  7.5313],
        [ 7.9903, 10.4077,  6.4057, 14.5897],
        [ 9.6755, 11.7135,  6.0333, 14.2093],
        [ 4.0386,  8.2348,  8.1742,  6.5955],
        [ 9.2440, 14.5217, 15.0266,  8.0953],
        [11.5857, 11.2573,  7.4250,  5.8802],
        [13.9858, 12.7991,  6.3904, 10.6308],
        [ 9.1395, 21.2821, 11.2944,  4.3172]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([48.8134, 40.8523, 39.1665, 44.7522, 47.2948, 30.7217, 53.2659, 41.0654,
        49.7651, 52.2953], device='cuda:0')
SINR = tensor([-16.8854, -16.1122, -15.9291, -16.5081, -16.7481, -14.8745, -17.2645,
        -16.1348, -16.9692, -17.1846], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0201, 0.0239, 0.0249, 0.0219, 0.0207, 0.0315, 0.0184, 0.0238, 0.0197,
        0.0188], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -4,  rho_ul = 0.0995267926383743-----------
G_variance = tensor([0.9104, 0.8124, 0.7493, 0.8797, 1.0172, 0.9706, 1.1270, 1.1642, 0.8855,
        0.9145], device='cuda:0')
G_hat_variance = tensor([0.7295, 0.6372, 0.4827, 0.5628, 0.7003, 0.6181, 0.8147, 0.8784, 0.6072,
        0.6564], device='cuda:0')
G_tilde_var = tensor([0.2851, 0.2129, 0.3419, 0.4197, 0.3288, 0.3401, 0.3174, 0.2844, 0.2756,
        0.2316], device='cuda:0')
gamma = tensor([[[0.6656, 0.6656, 0.6656, 0.6656]]], device='cuda:0')
Z_mean = tensor([ 0.1473-0.0011j,  0.2187-0.0288j,  0.0023-0.1105j,  0.0588+0.0173j,
        -0.0836-0.1055j,  0.0172+0.0255j, -0.0455+0.0264j, -0.0530-0.0298j,
        -0.1040+0.0450j,  0.1274-0.1748j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0960, 0.9573, 0.7252, 0.8456, 1.0521, 0.9286, 1.2240, 1.3197, 0.9122,
        0.9862], device='cuda:0')
Real_SNR = tensor([-3.9229, -3.8938, -4.5811, -4.2916, -3.6722, -5.1699, -2.7934, -2.7012,
        -5.0587, -4.2394], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.0840, 4.1165, 3.4178, 3.7901, 4.2512, 3.1058, 5.2645, 5.3327, 3.1171,
        3.8765], device='cuda:0')
signal_var = tensor([0.4065, 0.4097, 0.3402, 0.3772, 0.4231, 0.3091, 0.5240, 0.5308, 0.3102,
        0.3858], device='cuda:0')
w_var = tensor([1.0030, 1.0043, 0.9768, 1.0133, 0.9855, 1.0165, 0.9969, 0.9886, 0.9944,
        1.0240], device='cuda:0')
y_var = tensor([1.3909, 1.3998, 1.3098, 1.3976, 1.4043, 1.3320, 1.5311, 1.5051, 1.3178,
        1.4065], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 8.2908, 21.9349,  8.4616,  4.9261],
        [ 7.8750, 12.1235, 13.6055,  5.6769],
        [10.6375,  4.1804,  8.4870,  5.4669],
        [ 6.5254, 13.2591,  8.2494,  5.0946],
        [ 6.9208, 15.9424, 11.8191,  7.0740],
        [10.6313,  8.3933,  8.0917,  9.1380],
        [16.0447,  8.2944, 13.1148, 10.3915],
        [13.2997,  8.3710, 11.8092, 18.1378],
        [ 8.4712, 10.2440, 10.4106,  6.9649],
        [ 9.9307, 12.6422, 11.3950,  6.3643]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 9.3944, 24.8549,  9.5880,  5.5819],
        [ 8.9234, 13.7374, 15.4167,  6.4326],
        [12.0536,  4.7369,  9.6168,  6.1946],
        [ 7.3940, 15.0242,  9.3475,  5.7729],
        [ 7.8421, 18.0647, 13.3925,  8.0157],
        [12.0466,  9.5106,  9.1689, 10.3545],
        [18.1806,  9.3986, 14.8607, 11.7748],
        [15.0702,  9.4854, 13.3813, 20.5523],
        [ 9.5989, 11.6077, 11.7965,  7.8921],
        [11.2527, 14.3252, 12.9119,  7.2115]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([48.0016, 43.2332, 31.6666, 36.4618, 45.9578, 39.9021, 52.6595, 56.8114,
        39.7221, 44.3903], device='cuda:0')
SINR = tensor([-16.8126, -16.3582, -15.0060, -15.6184, -16.6236, -16.0100, -17.2148,
        -17.5444, -15.9903, -16.4729], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0204, 0.0226, 0.0306, 0.0267, 0.0213, 0.0244, 0.0186, 0.0173, 0.0246,
        0.0220], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -3,  rho_ul = 0.12529680840681806-----------
G_variance = tensor([1.1502, 0.8829, 0.8964, 1.0996, 1.0832, 1.0015, 1.2229, 0.9368, 0.9960,
        0.9622], device='cuda:0')
G_hat_variance = tensor([0.7149, 0.5875, 0.6369, 0.7435, 0.7292, 0.6960, 0.8569, 0.7593, 0.7492,
        0.6210], device='cuda:0')
G_tilde_var = tensor([0.3395, 0.3133, 0.2354, 0.2906, 0.3039, 0.2517, 0.2626, 0.2909, 0.3366,
        0.3532], device='cuda:0')
gamma = tensor([[[0.7148, 0.7148, 0.7148, 0.7148]]], device='cuda:0')
Z_mean = tensor([ 0.0210+0.0984j,  0.0672-0.0765j, -0.0878+0.1400j, -0.1254+0.0926j,
         0.0658-0.0778j, -0.0293-0.1006j, -0.1086+0.0675j,  0.1540-0.0774j,
        -0.0169-0.0459j, -0.1268+0.1886j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0002, 0.8219, 0.8911, 1.0402, 1.0202, 0.9737, 1.1989, 1.0623, 1.0482,
        0.8688], device='cuda:0')
Real_SNR = tensor([-3.0233, -2.6418, -3.4077, -1.7933, -2.5976, -2.5112, -2.1158, -3.0085,
        -3.3651, -2.9782], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.8723, 4.3585, 3.6267, 5.2380, 4.3914, 4.5955, 4.9344, 4.0951, 3.6957,
        4.0634], device='cuda:0')
signal_var = tensor([0.4852, 0.5461, 0.4544, 0.6563, 0.5502, 0.5758, 0.6183, 0.5131, 0.4631,
        0.5091], device='cuda:0')
w_var = tensor([0.9733, 1.0034, 0.9959, 0.9918, 1.0007, 1.0266, 1.0064, 1.0258, 1.0049,
        1.0108], device='cuda:0')
y_var = tensor([1.4367, 1.5524, 1.4466, 1.6626, 1.5432, 1.6025, 1.6197, 1.5450, 1.4736,
        1.5364], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 5.4438, 15.1492,  6.8202, 11.9998],
        [ 8.3130, 10.2896,  5.7670,  8.0996],
        [11.1696,  7.3223, 10.1831,  7.1704],
        [15.1570,  8.8581,  9.6424,  7.8809],
        [ 5.8981, 11.2659,  8.6958, 14.3429],
        [ 9.9883,  7.8206,  7.7132, 12.8908],
        [13.3783, 14.7012, 12.9962,  6.3341],
        [14.7992,  8.4495,  9.9252,  9.4432],
        [12.0993, 11.4504,  8.0023,  9.4238],
        [ 8.5267,  9.0572,  6.7335, 11.6327]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 6.2220, 17.3148,  7.7952, 13.7152],
        [ 9.5014, 11.7605,  6.5914,  9.2575],
        [12.7663,  8.3691, 11.6388,  8.1955],
        [17.3237, 10.1244, 11.0209,  9.0075],
        [ 6.7412, 12.8765,  9.9389, 16.3933],
        [11.4162,  8.9385,  8.8159, 14.7336],
        [15.2908, 16.8028, 14.8541,  7.2396],
        [16.9148,  9.6574, 11.3440, 10.7932],
        [13.8289, 13.0873,  9.1463, 10.7710],
        [ 9.7456, 10.3520,  7.6960, 13.2956]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([37.6318, 31.0018, 34.2255, 39.6612, 38.3858, 36.6770, 45.2673, 40.6911,
        39.1240, 34.3254], device='cuda:0')
SINR = tensor([-15.7556, -14.9139, -15.3435, -15.9837, -15.8417, -15.6439, -16.5578,
        -16.0950, -15.9244, -15.3562], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0259, 0.0312, 0.0284, 0.0246, 0.0254, 0.0265, 0.0216, 0.0240, 0.0249,
        0.0283], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -2,  rho_ul = 0.1577393361200483-----------
G_variance = tensor([0.8597, 1.0693, 1.2964, 0.9584, 0.9970, 1.0609, 0.7336, 1.0254, 0.9446,
        0.9975], device='cuda:0')
G_hat_variance = tensor([0.5599, 0.8054, 0.8570, 0.7240, 0.7422, 0.6866, 0.6029, 0.7534, 0.6005,
        0.6526], device='cuda:0')
G_tilde_var = tensor([0.2281, 0.2361, 0.2321, 0.1940, 0.3037, 0.3150, 0.2650, 0.1896, 0.3082,
        0.2549], device='cuda:0')
gamma = tensor([[[0.7593, 0.7593, 0.7593, 0.7593]]], device='cuda:0')
Z_mean = tensor([-0.1512-0.0093j,  0.0559-0.1183j,  0.0834-0.1849j, -0.0513-0.0237j,
         0.0899+0.2061j, -0.0572+0.1375j, -0.1216-0.0602j,  0.0159+0.1146j,
        -0.1134-0.0174j, -0.0193+0.1395j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.7374, 1.0607, 1.1286, 0.9535, 0.9774, 0.9042, 0.7940, 0.9922, 0.7908,
        0.8595], device='cuda:0')
Real_SNR = tensor([-2.9260, -0.2869, -0.5717, -1.8589, -1.9683, -0.9348, -2.6255, -1.0612,
        -1.8438, -1.3075], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.1614, 5.9764, 5.5115, 4.1162, 4.0760, 5.0714, 3.3417, 4.9054, 4.2192,
        4.6405], device='cuda:0')
signal_var = tensor([0.4987, 0.9427, 0.8694, 0.6493, 0.6429, 0.8000, 0.5271, 0.7738, 0.6655,
        0.7320], device='cuda:0')
w_var = tensor([0.9782, 1.0071, 0.9917, 0.9962, 1.0116, 0.9921, 0.9648, 0.9879, 1.0176,
        0.9891], device='cuda:0')
y_var = tensor([1.4559, 1.9607, 1.8659, 1.6609, 1.6373, 1.7771, 1.5061, 1.7633, 1.6853,
        1.7485], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 7.0439,  5.2206,  9.0646,  8.3487],
        [12.9900,  6.2963, 17.8041,  4.9617],
        [11.5042, 17.3643,  9.3637,  7.4292],
        [ 9.6393,  8.1986,  8.8851, 10.5899],
        [ 9.3547, 10.8825, 11.4279,  8.4763],
        [ 7.7370, 13.0325,  6.5248,  8.8568],
        [ 8.0803,  7.8720,  5.5711, 10.1800],
        [ 9.7109, 10.8280, 10.8089,  7.8848],
        [10.9483,  6.9553,  4.9233,  8.5402],
        [10.9241,  9.7573,  8.2028,  5.4293]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 8.1136,  6.0134, 10.4411,  9.6166],
        [14.9627,  7.2524, 20.5079,  5.7152],
        [13.2512, 20.0013, 10.7857,  8.5574],
        [11.1031,  9.4437, 10.2344, 12.1981],
        [10.7753, 12.5351, 13.1634,  9.7635],
        [ 8.9120, 15.0116,  7.5157, 10.2018],
        [ 9.3073,  9.0675,  6.4171, 11.7260],
        [11.1856, 12.4724, 12.4503,  9.0822],
        [12.6109,  8.0115,  5.6709,  9.8372],
        [12.5831, 11.2391,  9.4485,  6.2538]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([24.6940, 34.9903, 37.9935, 31.0470, 33.4004, 30.0803, 26.3794, 32.6442,
        26.0996, 28.5513], device='cuda:0')
SINR = tensor([-13.9259, -15.4395, -15.7971, -14.9202, -15.2375, -14.7828, -14.2127,
        -15.1381, -14.1663, -14.5563], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0389, 0.0278, 0.0256, 0.0312, 0.0291, 0.0322, 0.0365, 0.0297, 0.0369,
        0.0338], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -1,  rho_ul = 0.19858205868107037-----------
G_variance = tensor([1.1793, 0.8490, 1.0576, 0.8373, 0.8670, 1.0609, 1.2337, 0.8130, 0.8733,
        0.7770], device='cuda:0')
G_hat_variance = tensor([0.8391, 0.8961, 0.8535, 0.5869, 0.6945, 0.8891, 0.8917, 0.6249, 0.7499,
        0.6574], device='cuda:0')
G_tilde_var = tensor([0.2610, 0.1669, 0.2108, 0.2110, 0.1504, 0.2154, 0.2097, 0.2139, 0.1597,
        0.1994], device='cuda:0')
gamma = tensor([[[0.7989, 0.7989, 0.7989, 0.7989]]], device='cuda:0')
Z_mean = tensor([ 0.0208+0.0026j, -0.0586-0.1185j, -0.1280-0.1492j, -0.2727+0.1210j,
         0.0435-0.1290j,  0.0708+0.1212j, -0.0484+0.0544j, -0.2419+0.0236j,
        -0.0289-0.2059j, -0.1208+0.0086j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0504, 1.1218, 1.0684, 0.7347, 0.8693, 1.1130, 1.1162, 0.7823, 0.9387,
        0.8229], device='cuda:0')
Real_SNR = tensor([-0.7016, -0.5185,  0.0541, -0.8293, -1.8413, -2.9608, -0.2608, -0.6446,
        -1.0662, -2.4672], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.3309, 4.6634, 5.1880, 4.0980, 3.3460, 2.5586, 4.8604, 4.3277, 3.9281,
        2.8458], device='cuda:0')
signal_var = tensor([0.8600, 0.9261, 1.0302, 0.8138, 0.6645, 0.5081, 0.9652, 0.8594, 0.7800,
        0.5651], device='cuda:0')
w_var = tensor([1.0108, 1.0435, 1.0175, 0.9850, 1.0153, 1.0047, 1.0249, 0.9969, 0.9971,
        0.9974], device='cuda:0')
y_var = tensor([1.8585, 1.9694, 2.0482, 1.7934, 1.6976, 1.5336, 2.0021, 1.8364, 1.7638,
        1.5729], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.3790, 10.9548,  7.6872, 11.9628],
        [10.8948, 12.5880,  7.7811, 13.1844],
        [14.0549,  7.0179, 15.6886,  6.4526],
        [ 9.5444,  8.9080,  6.2937,  7.4651],
        [ 6.9069, 10.0913,  9.1582,  8.4887],
        [ 9.5408, 12.9789,  8.1146, 13.5612],
        [14.1000,  9.9295,  9.1856, 10.5292],
        [ 9.6166, 12.0974,  6.8088,  4.3487],
        [ 9.3350,  9.9510,  4.1927, 14.8607],
        [ 5.3594,  9.3991, 11.0271,  6.8950]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[12.0372, 12.7051,  8.9154, 13.8741],
        [12.6355, 14.5992,  9.0243, 15.2909],
        [16.3005,  8.1392, 18.1952,  7.4835],
        [11.0693, 10.3312,  7.2992,  8.6578],
        [ 8.0104, 11.7037, 10.6215,  9.8449],
        [11.0652, 15.0525,  9.4111, 15.7279],
        [16.3528, 11.5159, 10.6531, 12.2115],
        [11.1530, 14.0303,  7.8967,  5.0435],
        [10.8265, 11.5409,  4.8626, 17.2350],
        [ 6.2157, 10.9008, 12.7890,  7.9966]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([29.8345, 32.3565, 31.4581, 23.4484, 25.2203, 32.1726, 31.8440, 23.9291,
        27.9095, 23.7902], device='cuda:0')
SINR = tensor([-14.7472, -15.0996, -14.9773, -13.7011, -14.0175, -15.0749, -15.0303,
        -13.7893, -14.4575, -13.7640], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0324, 0.0300, 0.0308, 0.0409, 0.0381, 0.0301, 0.0304, 0.0401, 0.0346,
        0.0403], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 0,  rho_ul = 0.25-----------
G_variance = tensor([0.9429, 0.9945, 0.9005, 1.3800, 1.2039, 1.3523, 1.2694, 0.8160, 1.0155,
        1.3766], device='cuda:0')
G_hat_variance = tensor([0.8106, 0.7990, 0.7391, 1.1527, 1.0971, 0.9935, 0.9787, 0.5935, 0.8370,
        1.0795], device='cuda:0')
G_tilde_var = tensor([0.1847, 0.1881, 0.2005, 0.1520, 0.2301, 0.1847, 0.1623, 0.2128, 0.1654,
        0.1462], device='cuda:0')
gamma = tensor([[[0.8333, 0.8333, 0.8333, 0.8333]]], device='cuda:0')
Z_mean = tensor([ 0.1224-0.0806j,  0.0108+0.0051j,  0.1297-0.1374j, -0.1754-0.0079j,
         0.3518-0.0835j,  0.0254-0.1238j, -0.0871-0.0204j, -0.1198-0.0863j,
         0.0229-0.0057j,  0.1032-0.1219j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9727, 0.9588, 0.8869, 1.3833, 1.3166, 1.1922, 1.1744, 0.7122, 1.0044,
        1.2954], device='cuda:0')
Real_SNR = tensor([-0.1227,  0.9017, -0.7213,  2.8673,  0.9298,  0.4873,  0.8401, -0.0916,
         0.7535,  1.1842], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.8125, 4.8168, 3.3809, 7.7508, 4.9432, 4.4628, 4.9475, 3.9435, 4.7605,
        5.3444], device='cuda:0')
signal_var = tensor([0.9531, 1.2042, 0.8452, 1.9377, 1.2358, 1.1157, 1.2369, 0.9859, 1.1901,
        1.3361], device='cuda:0')
w_var = tensor([0.9804, 0.9784, 0.9979, 1.0013, 0.9976, 0.9973, 1.0194, 1.0069, 1.0006,
        1.0172], device='cuda:0')
y_var = tensor([1.9259, 2.1828, 1.8362, 2.8979, 2.2271, 2.0913, 2.2570, 2.0236, 2.1846,
        2.3673], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.8713,  8.5440,  7.0282, 12.3508],
        [ 8.0490, 16.6411,  7.8899,  4.8194],
        [11.2690,  7.4258,  7.3458,  9.9770],
        [18.4717, 20.9927,  9.2699,  6.4455],
        [15.6608,  6.7425, 17.1315, 17.0406],
        [12.6960, 12.7296, 11.9313,  9.7787],
        [12.3147, 13.0310,  7.4784, 13.2981],
        [ 5.7559,  8.9467,  7.5887,  6.3549],
        [ 7.7811, 12.1612,  9.5064,  9.7447],
        [ 7.8201, 14.5979, 13.7067, 15.4153]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[12.6832,  9.9679,  8.1995, 14.4093],
        [ 9.3905, 19.4147,  9.2049,  5.6226],
        [13.1472,  8.6634,  8.5701, 11.6398],
        [21.5503, 24.4915, 10.8149,  7.5197],
        [18.2709,  7.8663, 19.9868, 19.8806],
        [14.8120, 14.8512, 13.9198, 11.4085],
        [14.3672, 15.2028,  8.7248, 15.5145],
        [ 6.7152, 10.4379,  8.8535,  7.4141],
        [ 9.0780, 14.1881, 11.0908, 11.3689],
        [ 9.1234, 17.0309, 15.9912, 17.9845]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([24.7899, 23.8986, 23.0156, 35.2604, 36.1522, 30.1201, 29.4726, 18.3053,
        25.0450, 32.9346], device='cuda:0')
SINR = tensor([-13.9428, -13.7837, -13.6202, -15.4729, -15.5814, -14.7886, -14.6942,
        -12.6258, -13.9872, -15.1765], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0388, 0.0402, 0.0416, 0.0276, 0.0269, 0.0321, 0.0328, 0.0518, 0.0384,
        0.0295], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 1,  rho_ul = 0.3147313529485418-----------
G_variance = tensor([0.8883, 1.3929, 0.8824, 0.8052, 0.9548, 0.8776, 0.8446, 0.9345, 0.8843,
        0.8140], device='cuda:0')
G_hat_variance = tensor([0.8179, 1.1258, 0.7367, 0.7940, 0.8463, 0.7465, 0.7603, 0.9006, 0.7574,
        0.7530], device='cuda:0')
G_tilde_var = tensor([0.1214, 0.1187, 0.1336, 0.1538, 0.1367, 0.1068, 0.1456, 0.1439, 0.1398,
        0.1120], device='cuda:0')
gamma = tensor([[[0.8629, 0.8629, 0.8629, 0.8629]]], device='cuda:0')
Z_mean = tensor([-0.0512-0.1182j,  0.0456-0.0445j,  0.1624+0.1458j, -0.0434+0.0291j,
         0.1322+0.1919j, -0.1462+0.1247j,  0.1055-0.0102j,  0.1616+0.0423j,
         0.2229-0.1347j, -0.2041-0.0675j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9478, 1.3047, 0.8537, 0.9202, 0.9807, 0.8651, 0.8811, 1.0436, 0.8777,
        0.8726], device='cuda:0')
Real_SNR = tensor([0.6055, 2.6054, 0.8965, 0.0959, 0.8138, 0.6758, 0.0989, 1.2790, 0.8649,
        0.1610], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.6629, 5.8024, 3.8905, 3.2853, 3.8501, 3.7631, 3.2090, 4.1882, 3.9587,
        3.3002], device='cuda:0')
signal_var = tensor([1.1528, 1.8262, 1.2245, 1.0340, 1.2117, 1.1844, 1.0100, 1.3182, 1.2459,
        1.0387], device='cuda:0')
w_var = tensor([1.0028, 1.0023, 0.9961, 1.0114, 1.0047, 1.0137, 0.9872, 0.9819, 1.0209,
        1.0009], device='cuda:0')
y_var = tensor([2.1478, 2.8001, 2.2177, 2.0376, 2.2398, 2.1642, 2.0131, 2.2643, 2.2656,
        2.0349], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[12.3108,  7.1332, 10.2384,  7.9467],
        [11.1084, 16.8490, 15.4917,  7.5963],
        [10.3761,  5.0949,  5.3225, 14.4066],
        [ 8.9417,  4.6185,  7.2272, 15.2083],
        [11.0252,  8.7441,  6.9848, 13.6660],
        [ 8.7090, 10.4215, 10.3345,  5.7485],
        [ 9.0233,  6.3460,  9.8738,  9.5686],
        [ 9.9211, 15.7341,  9.8365,  6.3263],
        [ 9.5129,  9.9902,  8.0524,  9.3872],
        [ 5.6245,  7.3079, 17.1761,  5.7713]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[14.4355,  8.3643, 12.0054,  9.3181],
        [13.0255, 19.7568, 18.1653,  8.9072],
        [12.1668,  5.9741,  6.2411, 16.8929],
        [10.4849,  5.4156,  8.4744, 17.8330],
        [12.9280, 10.2532,  8.1902, 16.0245],
        [10.2121, 12.2201, 12.1181,  6.7406],
        [10.5806,  7.4412, 11.5778, 11.2200],
        [11.6333, 18.4495, 11.5341,  7.4181],
        [11.1547, 11.7144,  9.4421, 11.0073],
        [ 6.5951,  8.5691, 20.1405,  6.7673]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([21.1667, 28.7135, 19.8004, 20.2479, 22.7367, 19.8080, 19.5819, 23.5230,
        20.7806, 20.1827], device='cuda:0')
SINR = tensor([-13.2565, -14.5809, -12.9667, -13.0638, -13.5673, -12.9684, -12.9186,
        -13.7149, -13.1766, -13.0498], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0451, 0.0337, 0.0481, 0.0471, 0.0421, 0.0481, 0.0486, 0.0408, 0.0459,
        0.0472], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 2,  rho_ul = 0.3962232981152784-----------
G_variance = tensor([1.0990, 0.9698, 1.1527, 0.8800, 0.9517, 1.0174, 0.9318, 0.9687, 0.9410,
        0.9291], device='cuda:0')
G_hat_variance = tensor([0.8523, 0.7962, 0.9143, 0.7465, 0.8836, 0.9176, 0.8028, 0.7657, 0.8238,
        0.8806], device='cuda:0')
G_tilde_var = tensor([0.1202, 0.1127, 0.1135, 0.0964, 0.0995, 0.1232, 0.1035, 0.0850, 0.0878,
        0.1061], device='cuda:0')
gamma = tensor([[[0.8879, 0.8879, 0.8879, 0.8879]]], device='cuda:0')
Z_mean = tensor([ 2.0375e-01-0.1249j,  1.2928e-01+0.0533j, -1.5349e-02+0.0641j,
         8.9216e-05-0.0580j, -3.1406e-02+0.2300j, -3.8546e-02+0.0834j,
        -3.6141e-02+0.0517j,  1.0758e-01-0.0022j, -7.1656e-02-0.0166j,
         3.7067e-02+0.0217j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9599, 0.8967, 1.0296, 0.8407, 0.9952, 1.0334, 0.9042, 0.8624, 0.9278,
        0.9917], device='cuda:0')
Real_SNR = tensor([2.8530, 2.5897, 3.7958, 2.1081, 1.6238, 3.1347, 1.5757, 1.8812, 0.3570,
        1.4921], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.8300, 4.6005, 5.9936, 4.0617, 3.7441, 5.2470, 3.6868, 3.9127, 2.7043,
        3.5184], device='cuda:0')
signal_var = tensor([1.9138, 1.8228, 2.3748, 1.6093, 1.4835, 2.0790, 1.4608, 1.5503, 1.0715,
        1.3941], device='cuda:0')
w_var = tensor([0.9922, 1.0041, 0.9910, 0.9905, 1.0207, 1.0101, 1.0163, 1.0053, 0.9869,
        0.9887], device='cuda:0')
y_var = tensor([2.9808, 2.8589, 3.3544, 2.6245, 2.4648, 3.0562, 2.4869, 2.5495, 2.0823,
        2.3958], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 8.8861,  9.6080, 11.7499,  9.4773],
        [ 6.6067,  8.0934,  9.9794, 11.0746],
        [14.7950,  6.8665,  6.5410, 12.1271],
        [ 8.6898,  9.9708,  9.3093,  4.9534],
        [ 8.0914, 11.3504, 11.0460, 10.4794],
        [ 5.4653, 10.3418, 10.2039, 14.6296],
        [ 7.0325,  5.9010, 10.6018, 11.8860],
        [10.8581,  8.3964,  9.1353,  5.7055],
        [ 6.0799,  6.6045,  9.5579, 14.1564],
        [ 6.8295,  7.4896, 11.0169, 13.4129]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[10.4642, 11.3142, 13.8365, 11.1604],
        [ 7.7800,  9.5307, 11.7516, 13.0414],
        [17.4224,  8.0859,  7.7026, 14.2808],
        [10.2330, 11.7415, 10.9626,  5.8331],
        [ 9.5283, 13.3662, 13.0076, 12.3404],
        [ 6.4359, 12.1784, 12.0160, 17.2277],
        [ 8.2814,  6.9490, 12.4846, 13.9968],
        [12.7863,  9.8875, 10.7576,  6.7188],
        [ 7.1597,  7.7774, 11.2553, 16.6704],
        [ 8.0423,  8.8197, 12.9734, 15.7949]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([19.7148, 17.7459, 20.0168, 16.3408, 20.3332, 20.1711, 17.5807, 16.9225,
        18.0658, 19.2322], device='cuda:0')
SINR = tensor([-12.9479, -12.4910, -13.0139, -12.1327, -13.0821, -13.0473, -12.4504,
        -12.2846, -12.5686, -12.8403], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0483, 0.0533, 0.0476, 0.0577, 0.0469, 0.0472, 0.0538, 0.0558, 0.0524,
        0.0494], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 3,  rho_ul = 0.4988155787422199-----------
G_variance = tensor([1.0528, 0.9841, 1.1168, 0.8484, 0.9723, 1.2632, 0.9419, 0.9496, 1.1132,
        1.0879], device='cuda:0')
G_hat_variance = tensor([0.8481, 0.8639, 1.1589, 0.7680, 0.8476, 1.1653, 0.9668, 0.8560, 1.0248,
        0.9520], device='cuda:0')
G_tilde_var = tensor([0.0764, 0.0762, 0.1158, 0.0920, 0.0875, 0.0905, 0.0865, 0.1005, 0.1121,
        0.0748], device='cuda:0')
gamma = tensor([[[0.9089, 0.9089, 0.9089, 0.9089]]], device='cuda:0')
Z_mean = tensor([-0.0903-0.0350j, -0.1306-0.0013j,  0.1616-0.0417j,  0.2944+0.0053j,
         0.1341-0.1325j,  0.0332+0.0767j,  0.1077+0.0136j,  0.0523-0.1608j,
         0.1038+0.0714j, -0.1557-0.0280j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9332, 0.9505, 1.2751, 0.8450, 0.9326, 1.2821, 1.0638, 0.9418, 1.1275,
        1.0475], device='cuda:0')
Real_SNR = tensor([2.3295, 3.7397, 4.0110, 3.9110, 2.5633, 3.7997, 2.3729, 3.3217, 2.6918,
        4.0962], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.4059, 4.7152, 4.9694, 4.8311, 3.5182, 4.7283, 3.4152, 4.2693, 3.7231,
        5.2656], device='cuda:0')
signal_var = tensor([1.6989, 2.3520, 2.4788, 2.4098, 1.7549, 2.3585, 1.7036, 2.1296, 1.8571,
        2.6266], device='cuda:0')
w_var = tensor([0.9936, 0.9942, 0.9843, 0.9792, 0.9726, 0.9833, 0.9864, 0.9911, 0.9992,
        1.0227], device='cuda:0')
y_var = tensor([2.6895, 3.3778, 3.4339, 3.3923, 2.7665, 3.2460, 2.6487, 3.1161, 2.8651,
        3.6403], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 9.3289, 12.0606,  8.0023,  7.3767],
        [11.2665,  7.4682, 10.4461,  8.5708],
        [11.4478,  7.9224, 17.2570, 14.2143],
        [10.9216,  6.3806,  9.2214,  9.8988],
        [10.7041, 15.3368,  9.0279,  2.7226],
        [14.5883, 12.7617, 15.8279,  7.1018],
        [10.1539, 10.6668,  8.5559, 12.5813],
        [ 7.7552, 10.8065,  9.4740,  9.8383],
        [ 9.7425, 11.8453,  4.7324, 18.2874],
        [14.6231,  9.1241,  8.7599,  9.3448]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[11.0247, 14.2529,  9.4569,  8.7177],
        [13.3145,  8.8257, 12.3450, 10.1288],
        [13.5288,  9.3625, 20.3940, 16.7981],
        [12.9069,  7.5405, 10.8976, 11.6982],
        [12.6499, 18.1247, 10.6690,  3.2176],
        [17.2401, 15.0815, 18.7051,  8.3927],
        [11.9996, 12.6058, 10.1111, 14.8683],
        [ 9.1649, 12.7709, 11.1962, 11.6267],
        [11.5135, 13.9985,  5.5926, 21.6116],
        [17.2813, 10.7827, 10.3522, 11.0435]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([16.1334, 16.5648, 22.3084, 15.9815, 16.5822, 22.0618, 18.4104, 16.6185,
        19.5730, 18.3639], device='cuda:0')
SINR = tensor([-12.0772, -12.1919, -13.4847, -12.0362, -12.1964, -13.4364, -12.6506,
        -12.2059, -12.9166, -12.6397], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0584, 0.0569, 0.0429, 0.0589, 0.0569, 0.0434, 0.0515, 0.0568, 0.0486,
        0.0516], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 4,  rho_ul = 0.627971607877395-----------
G_variance = tensor([0.6412, 1.0805, 0.8828, 0.9060, 0.9769, 1.1764, 1.1637, 0.9602, 0.8671,
        0.7549], device='cuda:0')
G_hat_variance = tensor([0.5944, 0.8963, 0.8408, 0.8318, 0.8533, 1.0837, 1.1763, 0.9177, 0.9017,
        0.7181], device='cuda:0')
G_tilde_var = tensor([0.0920, 0.0808, 0.0780, 0.0732, 0.0708, 0.0830, 0.0643, 0.0587, 0.0621,
        0.0969], device='cuda:0')
gamma = tensor([[[0.9263, 0.9263, 0.9263, 0.9263]]], device='cuda:0')
Z_mean = tensor([-0.0339-0.0729j, -0.0211-0.0663j, -0.1571+0.0101j,  0.1468-0.0390j,
         0.0015+0.0899j, -0.0525+0.1649j, -0.0527+0.2353j,  0.1169+0.0399j,
         0.1097+0.1320j, -0.1945+0.0698j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.6417, 0.9677, 0.9077, 0.8981, 0.9213, 1.1700, 1.2699, 0.9907, 0.9735,
        0.7753], device='cuda:0')
Real_SNR = tensor([2.3525, 5.7840, 2.3060, 3.6006, 4.8888, 5.9280, 5.0216, 3.8525, 3.6875,
        3.4210], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([2.7356, 6.1113, 2.6577, 3.5897, 4.9595, 6.2336, 5.0283, 3.8788, 3.7740,
        3.4142], device='cuda:0')
signal_var = tensor([1.7179, 3.8377, 1.6690, 2.2542, 3.1144, 3.9145, 3.1576, 2.4358, 2.3700,
        2.1440], device='cuda:0')
w_var = tensor([0.9994, 1.0131, 0.9814, 0.9839, 1.0104, 0.9997, 0.9936, 1.0032, 1.0139,
        0.9753], device='cuda:0')
y_var = tensor([2.7150, 4.8370, 2.6618, 3.2680, 4.1520, 4.9172, 4.2080, 3.4359, 3.3911,
        3.1635], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 7.9568,  5.0444,  4.9640,  7.3206],
        [ 8.7197, 12.3982,  9.4156,  7.3989],
        [ 8.8848,  9.9028,  7.7977,  9.8080],
        [ 8.4375,  6.4350, 11.1059,  9.9687],
        [11.9701,  5.5311,  9.9580,  8.7935],
        [16.0240, 10.0321,  8.4541, 12.3152],
        [15.6045, 11.8198, 11.8757, 12.5528],
        [11.2112,  9.0848,  6.4354, 12.5174],
        [11.4753,  8.5688,  7.1395, 11.9601],
        [ 6.6142,  8.1817,  9.4687,  7.6789]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 9.4308,  5.9788,  5.8836,  8.6767],
        [10.3350, 14.6950, 11.1598,  8.7696],
        [10.5307, 11.7372,  9.2422, 11.6249],
        [10.0006,  7.6270, 13.1632, 11.8154],
        [14.1876,  6.5557, 11.8027, 10.4225],
        [18.9925, 11.8906, 10.0203, 14.5966],
        [18.4952, 14.0094, 14.0757, 14.8782],
        [13.2881, 10.7678,  7.6275, 14.8362],
        [13.6011, 10.1561,  8.4621, 14.1757],
        [ 7.8394,  9.6973, 11.2228,  9.1014]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([ 9.8241, 14.7376, 14.1396, 13.9662, 14.0850, 18.1927, 20.1460, 15.2490,
        15.2082, 12.4107], device='cuda:0')
SINR = tensor([ -9.9229, -11.6843, -11.5044, -11.4508, -11.4876, -12.5990, -13.0419,
        -11.8324, -11.8208, -10.9380], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0924, 0.0635, 0.0661, 0.0668, 0.0663, 0.0521, 0.0473, 0.0615, 0.0617,
        0.0746], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 5,  rho_ul = 0.7905694150420949-----------
G_variance = tensor([0.8844, 1.1035, 1.0274, 1.1420, 1.2195, 1.2793, 0.8930, 0.8340, 1.1947,
        1.4357], device='cuda:0')
G_hat_variance = tensor([0.8757, 1.0129, 0.9881, 0.9569, 1.1836, 1.1422, 0.8077, 0.7747, 1.0888,
        1.4458], device='cuda:0')
G_tilde_var = tensor([0.0646, 0.0553, 0.0628, 0.0669, 0.0539, 0.0678, 0.0779, 0.0726, 0.0539,
        0.0528], device='cuda:0')
gamma = tensor([[[0.9405, 0.9405, 0.9405, 0.9405]]], device='cuda:0')
Z_mean = tensor([-0.0632+0.0405j,  0.0015-0.1377j,  0.0767+0.1051j,  0.0691-0.0791j,
        -0.0352-0.0166j, -0.0489-0.0436j, -0.0409+0.0595j,  0.0498+0.0567j,
        -0.0694+0.0653j,  0.1016+0.0895j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9311, 1.0770, 1.0506, 1.0175, 1.2584, 1.2145, 0.8588, 0.8236, 1.1577,
        1.5373], device='cuda:0')
Real_SNR = tensor([4.0846, 6.8592, 6.6066, 5.8271, 5.9495, 5.8354, 5.0036, 5.2385, 5.4039,
        6.6581], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.2483, 6.0673, 5.7849, 4.6843, 5.1059, 4.8187, 4.0791, 4.2693, 4.4119,
        5.8919], device='cuda:0')
signal_var = tensor([2.5680, 4.7966, 4.5733, 3.7032, 4.0365, 3.8095, 3.2248, 3.3752, 3.4879,
        4.6579], device='cuda:0')
w_var = tensor([1.0026, 0.9886, 0.9990, 0.9680, 1.0258, 0.9939, 1.0189, 1.0103, 1.0050,
        1.0055], device='cuda:0')
y_var = tensor([3.5741, 5.8044, 5.5788, 4.7016, 5.1397, 4.7791, 4.2161, 4.4174, 4.5175,
        5.7117], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 9.0617,  7.7465,  9.2311, 10.4983],
        [13.6740, 11.2388,  7.4904, 10.3577],
        [16.8750,  8.9055, 10.0023,  5.8684],
        [ 7.1838, 17.6665,  8.5385,  6.7332],
        [10.0973, 16.1718, 11.6059, 11.2641],
        [11.0772,  8.8460, 11.9080, 15.7046],
        [ 9.6042,  7.0606,  4.5514, 12.4866],
        [10.8824,  6.1316, 10.3225,  5.0133],
        [11.2100,  8.2079, 11.8409, 14.2542],
        [12.4289, 13.1017, 21.4280, 13.7277]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[10.7662,  9.2037, 10.9675, 12.4731],
        [16.2461, 13.3528,  8.8994, 12.3060],
        [20.0492, 10.5806, 11.8837,  6.9723],
        [ 8.5351, 20.9896, 10.1446,  7.9998],
        [11.9966, 19.2138, 13.7890, 13.3829],
        [13.1608, 10.5099, 14.1480, 18.6587],
        [11.4107,  8.3887,  5.4076, 14.8354],
        [12.9294,  7.2850, 12.2642,  5.9563],
        [13.3186,  9.7518, 14.0682, 16.9355],
        [14.7668, 15.5662, 25.4587, 16.3099]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([12.5858, 14.7295, 14.3472, 13.8205, 16.9266, 16.3742, 11.6093, 11.1433,
        15.6775, 20.9041], device='cuda:0')
SINR = tensor([-10.9988, -11.6819, -11.5677, -11.4052, -12.2857, -12.1416, -10.6481,
        -10.4701, -11.9528, -13.2023], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0736, 0.0636, 0.0652, 0.0675, 0.0558, 0.0576, 0.0793, 0.0824, 0.0600,
        0.0457], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 6,  rho_ul = 0.9952679263837431-----------
G_variance = tensor([1.0466, 0.9496, 1.0808, 1.0129, 0.9332, 1.2370, 1.0389, 1.1271, 1.0373,
        0.8903], device='cuda:0')
G_hat_variance = tensor([0.9896, 0.8849, 1.0518, 0.9658, 0.8036, 1.1489, 0.9482, 1.0675, 0.9712,
        0.8345], device='cuda:0')
G_tilde_var = tensor([0.0421, 0.0423, 0.0482, 0.0587, 0.0495, 0.0511, 0.0479, 0.0451, 0.0505,
        0.0400], device='cuda:0')
gamma = tensor([[[0.9522, 0.9522, 0.9522, 0.9522]]], device='cuda:0')
Z_mean = tensor([ 0.0843-0.0663j,  0.1518+0.0565j,  0.0449+0.1678j, -0.0363-0.1013j,
        -0.0302+0.0533j, -0.1647-0.1841j,  0.0034+0.0039j, -0.0158+0.0593j,
        -0.0100+0.0498j,  0.0431-0.1903j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0394, 0.9294, 1.1047, 1.0143, 0.8440, 1.2066, 0.9958, 1.1211, 1.0200,
        0.8764], device='cuda:0')
Real_SNR = tensor([6.1222, 6.7923, 6.7868, 7.0966, 5.2233, 6.9378, 7.0364, 7.5190, 7.1774,
        5.6374], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.0976, 4.7613, 4.7230, 5.2366, 3.3089, 4.9048, 4.9801, 5.7390, 5.2084,
        3.6814], device='cuda:0')
signal_var = tensor([4.0783, 4.7388, 4.7006, 5.2118, 3.2932, 4.8816, 4.9565, 5.7119, 5.1837,
        3.6640], device='cuda:0')
w_var = tensor([0.9960, 0.9918, 0.9851, 1.0170, 0.9892, 0.9880, 0.9807, 1.0113, 0.9929,
        1.0005], device='cuda:0')
y_var = tensor([5.0032, 5.6752, 5.6983, 6.1615, 4.2353, 5.7841, 5.9379, 6.7759, 6.1532,
        4.6873], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[14.2407,  8.1890,  8.3982, 10.1670],
        [ 6.3344, 13.6511,  6.4868, 10.8228],
        [16.2697,  6.3755, 12.9201,  8.7249],
        [11.5215, 10.8187,  9.4173,  8.2657],
        [ 6.9866,  9.8499,  7.1638,  9.0659],
        [ 9.6885, 11.3568, 10.0913, 18.3624],
        [13.4473,  8.3135,  9.0100,  8.0682],
        [14.6030,  9.4383,  7.8972, 11.9366],
        [16.1564,  7.1213,  7.1158,  9.4894],
        [10.9957,  9.1854,  9.3239,  6.1970]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[16.9526,  9.7485,  9.9975, 12.1031],
        [ 7.5406, 16.2507,  7.7221, 12.8838],
        [19.3680,  7.5896, 15.3806, 10.3864],
        [13.7155, 12.8789, 11.2107,  9.8398],
        [ 8.3171, 11.7257,  8.5280, 10.7923],
        [11.5335, 13.5195, 12.0131, 21.8592],
        [16.0082,  9.8967, 10.7258,  9.6046],
        [17.3838, 11.2357,  9.4011, 14.2097],
        [19.2331,  8.4774,  8.4709, 11.2965],
        [13.0896, 10.9346, 11.0995,  7.3771]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([12.5328, 11.4017, 13.5403, 12.2357, 10.1089, 15.1326, 11.8737, 13.4133,
        12.1929, 10.9147], device='cuda:0')
SINR = tensor([-10.9805, -10.5697, -11.3163, -10.8763, -10.0470, -11.7991, -10.7459,
        -11.2754, -10.8611, -10.3801], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0739, 0.0806, 0.0688, 0.0756, 0.0900, 0.0620, 0.0777, 0.0694, 0.0758,
        0.0839], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 7,  rho_ul = 1.2529680840681805-----------
G_variance = tensor([1.3371, 1.0368, 1.1945, 1.2635, 0.9839, 0.8883, 1.0689, 1.1770, 1.3298,
        0.8236], device='cuda:0')
G_hat_variance = tensor([1.1572, 0.9890, 1.1465, 1.1842, 0.9476, 0.9111, 1.1050, 1.1073, 1.3988,
        0.8545], device='cuda:0')
G_tilde_var = tensor([0.0568, 0.0296, 0.0310, 0.0487, 0.0358, 0.0368, 0.0371, 0.0365, 0.0379,
        0.0332], device='cuda:0')
gamma = tensor([[[0.9616, 0.9616, 0.9616, 0.9616]]], device='cuda:0')
Z_mean = tensor([-0.0465+0.0082j, -0.0922-0.2096j, -0.0574+0.2134j,  0.0050-0.0710j,
        -0.0520-0.1343j, -0.2082-0.0581j, -0.0412+0.1114j,  0.1069+0.0394j,
         0.0564-0.0289j, -0.0102+0.0093j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.2034, 1.0285, 1.1923, 1.2315, 0.9854, 0.9475, 1.1491, 1.1514, 1.4546,
        0.8885], device='cuda:0')
Real_SNR = tensor([8.0582, 8.2982, 7.0706, 7.5983, 7.9247, 6.2534, 6.7757, 7.2325, 9.0186,
        6.6039], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([5.2139, 5.4911, 4.0351, 4.6306, 4.9891, 3.3529, 3.7761, 4.2153, 6.3603,
        3.7009], device='cuda:0')
signal_var = tensor([6.5328, 6.8801, 5.0558, 5.8020, 6.2512, 4.2011, 4.7313, 5.2816, 7.9693,
        4.6372], device='cuda:0')
w_var = tensor([1.0216, 1.0181, 0.9925, 1.0087, 1.0081, 0.9954, 0.9941, 0.9989, 0.9990,
        1.0136], device='cuda:0')
y_var = tensor([7.5496, 7.9192, 6.0353, 6.7720, 7.2784, 5.2518, 5.7685, 6.2904, 8.9757,
        5.6447], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[12.1901, 16.6284,  9.2371,  8.9660],
        [ 7.8474, 11.3403, 11.8780, 11.1421],
        [13.8763, 13.2562, 14.6167,  6.7034],
        [ 8.0217, 12.4314, 14.8518, 12.9257],
        [10.5862,  7.9972, 13.0027,  7.6735],
        [ 8.2313, 10.9539, 11.6370,  7.9977],
        [15.7167,  7.4900, 10.5250, 11.6468],
        [11.1171, 10.5372,  7.6096, 16.1613],
        [16.2058, 11.6363, 18.2051, 10.8438],
        [10.1949,  5.7325, 10.8877,  7.8460]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[14.5346, 19.8264, 11.0136, 10.6904],
        [ 9.3567, 13.5213, 14.1625, 13.2850],
        [16.5451, 15.8057, 17.4279,  7.9926],
        [ 9.5645, 14.8223, 17.7082, 15.4116],
        [12.6222,  9.5353, 15.5035,  9.1493],
        [ 9.8143, 13.0606, 13.8750,  9.5358],
        [18.7394,  8.9305, 12.5493, 13.8867],
        [13.2552, 12.5638,  9.0731, 19.2695],
        [19.3226, 13.8742, 21.7064, 12.9294],
        [12.1557,  6.8350, 12.9816,  9.3550]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([12.7691, 11.4619, 13.1577, 13.0974, 10.6612, 10.5418, 12.3229, 12.3355,
        15.4492,  9.4125], device='cuda:0')
SINR = tensor([-11.0616, -10.5925, -11.1918, -11.1718, -10.2781, -10.2291, -10.9071,
        -10.9116, -11.8891,  -9.7370], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0726, 0.0802, 0.0706, 0.0709, 0.0858, 0.0866, 0.0751, 0.0750, 0.0608,
        0.0960], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 8,  rho_ul = 1.5773933612004833-----------
G_variance = tensor([0.9670, 1.0741, 0.9046, 1.0392, 0.8640, 0.9842, 0.7397, 0.7575, 1.3084,
        0.8947], device='cuda:0')
G_hat_variance = tensor([0.9723, 1.0155, 0.8739, 1.0057, 0.8255, 1.0028, 0.6895, 0.7276, 1.2456,
        0.8786], device='cuda:0')
G_tilde_var = tensor([0.0267, 0.0350, 0.0262, 0.0298, 0.0342, 0.0276, 0.0313, 0.0299, 0.0277,
        0.0337], device='cuda:0')
gamma = tensor([[[0.9693, 0.9693, 0.9693, 0.9693]]], device='cuda:0')
Z_mean = tensor([ 0.0795+0.0617j, -0.0140+0.0578j, -0.1617-0.0079j,  0.1833-0.0075j,
         0.1210+0.0520j, -0.1699+0.0673j,  0.0444+0.1424j,  0.0248-0.0534j,
        -0.0474-0.0662j, -0.0990+0.2202j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0031, 1.0477, 0.9016, 1.0376, 0.8517, 1.0346, 0.7113, 0.7507, 1.2850,
        0.9065], device='cuda:0')
Real_SNR = tensor([9.4380, 8.9167, 8.0080, 8.4109, 8.4017, 7.9952, 6.6020, 7.7798, 8.9282,
        8.6147], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([5.5263, 4.9784, 4.0022, 4.5126, 4.4582, 4.0498, 2.8297, 3.7858, 5.1322,
        4.5709], device='cuda:0')
signal_var = tensor([8.7172, 7.8528, 6.3131, 7.1181, 7.0324, 6.3881, 4.4636, 5.9717, 8.0956,
        7.2100], device='cuda:0')
w_var = tensor([0.9921, 1.0078, 0.9987, 1.0263, 1.0161, 1.0136, 0.9761, 0.9957, 1.0362,
        0.9919], device='cuda:0')
y_var = tensor([9.6702, 8.8696, 7.3529, 8.1587, 7.9864, 7.3902, 5.4406, 7.0008, 9.0663,
        8.2681], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[19.5879,  5.4240,  5.5149,  9.0005],
        [10.4400,  7.4768, 13.4855,  9.6002],
        [ 7.3633,  9.6593, 10.2766,  8.9130],
        [12.1712,  9.7038, 12.1309,  7.8054],
        [11.0900,  9.2893,  7.4657,  6.0647],
        [ 9.6325,  8.3984, 14.4365,  9.2156],
        [ 8.1216,  4.9044,  7.9383,  7.6676],
        [10.1332,  7.6717,  5.9765,  5.6337],
        [13.1225,  9.0094, 11.6684, 16.5815],
        [15.3376,  6.5924,  5.5238, 10.2294]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[23.3851,  6.4755,  6.5839, 10.7453],
        [12.4639,  8.9263, 16.0997, 11.4612],
        [ 8.7907, 11.5317, 12.2688, 10.6409],
        [14.5307, 11.5850, 14.4825,  9.3185],
        [13.2399, 11.0900,  8.9129,  7.2403],
        [11.4998, 10.0265, 17.2352, 11.0020],
        [ 9.6960,  5.8552,  9.4772,  9.1540],
        [12.0975,  9.1589,  7.1351,  6.7258],
        [15.6664, 10.7559, 13.9303, 19.7959],
        [18.3109,  7.8704,  6.5946, 12.2124]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([ 9.5410,  9.8971,  8.7408, 10.0924,  8.1850, 10.0614,  6.9111,  7.1002,
        12.1611,  9.0959], device='cuda:0')
SINR = tensor([ -9.7959,  -9.9551,  -9.4155, -10.0399,  -9.1302, -10.0266,  -8.3955,
         -8.5127, -10.8497,  -9.5885], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0949, 0.0918, 0.1027, 0.0902, 0.1089, 0.0904, 0.1264, 0.1235, 0.0760,
        0.0991], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 9,  rho_ul = 1.985820586810704-----------
G_variance = tensor([1.0720, 1.0281, 0.9774, 0.7544, 0.9707, 0.8811, 1.0571, 1.0728, 1.2217,
        1.1285], device='cuda:0')
G_hat_variance = tensor([1.0315, 0.9764, 0.9726, 0.7161, 0.9905, 0.9226, 1.0112, 0.9638, 1.2016,
        1.0750], device='cuda:0')
G_tilde_var = tensor([0.0265, 0.0234, 0.0152, 0.0229, 0.0183, 0.0221, 0.0242, 0.0291, 0.0200,
        0.0340], device='cuda:0')
gamma = tensor([[[0.9754, 0.9754, 0.9754, 0.9754]]], device='cuda:0')
Z_mean = tensor([-0.1207-0.2077j,  0.1093-0.0724j,  0.0846+0.0936j,  0.0840+0.0453j,
        -0.0369-0.2407j, -0.0798+0.1101j,  0.0812+0.0884j,  0.1211-0.1587j,
         0.0190+0.0428j, -0.0171-0.0509j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0574, 1.0010, 0.9971, 0.7341, 1.0155, 0.9459, 1.0367, 0.9881, 1.2319,
        1.1021], device='cuda:0')
Real_SNR = tensor([ 9.3513,  9.8254, 10.2481,  8.7323,  8.8074,  8.5853,  8.5478, 11.1708,
         8.9184,  9.5394], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.3422, 4.8335, 5.3242, 3.7809, 3.7767, 3.5618, 3.5090, 6.4948, 4.0318,
        4.5834], device='cuda:0')
signal_var = tensor([ 8.6228,  9.5985, 10.5729,  7.5082,  7.4998,  7.0732,  6.9683, 12.8975,
         8.0064,  9.1018], device='cuda:0')
w_var = tensor([1.0012, 0.9992, 0.9986, 1.0053, 0.9870, 0.9797, 0.9735, 0.9850, 1.0270,
        1.0120], device='cuda:0')
y_var = tensor([ 9.5427, 10.5578, 11.4669,  8.3844,  8.5082,  8.1670,  7.9529, 13.8577,
         8.9755, 10.1710], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[11.1206, 13.7227,  9.9365,  8.7677],
        [10.8072,  8.7084, 12.7583,  7.4517],
        [ 8.7192,  9.1648,  7.6045, 14.0361],
        [11.8059,  4.2232,  4.1746,  8.7922],
        [10.4545, 10.2509, 10.9804, 10.2886],
        [13.7131,  6.7737, 12.3686,  4.7727],
        [10.5941,  9.1219,  5.6381, 15.6534],
        [10.8275, 17.3331,  7.0766,  4.8943],
        [11.4393,  8.1524, 10.2609, 18.2795],
        [12.2723,  9.6226, 12.4985,  8.7041]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[13.2900, 16.3998, 11.8750, 10.4782],
        [12.9156, 10.4073, 15.2473,  8.9054],
        [10.4202, 10.9528,  9.0880, 16.7744],
        [14.1091,  5.0471,  4.9890, 10.5074],
        [12.4940, 12.2508, 13.1225, 12.2958],
        [16.3884,  8.0952, 14.7816,  5.7038],
        [12.6608, 10.9014,  6.7380, 18.7072],
        [12.9399, 20.7145,  8.4572,  5.8492],
        [13.6709,  9.7428, 12.2627, 21.8456],
        [14.6665, 11.4998, 14.9368, 10.4021]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([ 9.3483,  8.5279,  8.4847,  6.2245,  9.0106,  8.0776,  8.8030,  8.6150,
        10.3325,  9.2517], device='cuda:0')
SINR = tensor([ -9.7073,  -9.3084,  -9.2864,  -7.9411,  -9.5475,  -9.0728,  -9.4463,
         -9.3526, -10.1420,  -9.6622], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0966, 0.1050, 0.1054, 0.1384, 0.0999, 0.1102, 0.1020, 0.1040, 0.0882,
        0.0975], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 300, 300, 300, 300, 300, 300, 300, 300, 300], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=300/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
