Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([10, 3, 256, 256])
10 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([10, 8, 32, 32])
autoencoder.py , moments = torch.Size([10, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5908, 0.4737, 0.7370, 0.6033, 0.5286, 0.8769, 0.5822, 0.6585, 0.6126,
        0.5291], device='cuda:0')
Variance (Real, all elements): 0.5303348302841187
Variance (Imag, all elements): 0.47340482473373413
--------SNR = -5,  rho_ul = 0.07905694150420949-----------
G_variance = tensor([0.8915, 0.7514, 0.8728, 0.7333, 0.8466, 0.9245, 1.1621, 1.0926, 0.9836,
        1.1575], device='cuda:0')
G_hat_variance = tensor([0.4367, 0.7650, 0.5728, 0.5526, 0.5623, 0.5917, 0.6499, 0.7227, 0.5887,
        0.5864], device='cuda:0')
gamma = tensor([[[0.6126, 0.6126, 0.6126, 0.6126]]], device='cuda:0')
Z_mean = tensor([-0.1476+0.1427j, -0.1714+0.0323j,  0.0382+0.0463j, -0.0518-0.1594j,
        -0.2755+0.1254j,  0.0824-0.0685j, -0.0185-0.0986j, -0.1804+0.1616j,
        -0.0586+0.1721j,  0.0675+0.0214j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.7129, 1.2488, 0.9350, 0.9021, 0.9180, 0.9660, 1.0609, 1.1799, 0.9610,
        0.9573], device='cuda:0')
Real_SNR = tensor([-5.1435, -4.7815, -6.2415, -6.5054, -6.1813, -5.0946, -4.5533, -4.5938,
        -4.2419, -4.3761], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.8062, 4.3192, 3.0268, 2.8844, 3.0574, 3.9664, 4.3854, 4.3732, 4.7458,
        4.4634], device='cuda:0')
signal_var = tensor([0.3009, 0.3415, 0.2393, 0.2280, 0.2417, 0.3136, 0.3467, 0.3457, 0.3752,
        0.3529], device='cuda:0')
w_var = tensor([0.9835, 1.0268, 1.0071, 1.0199, 1.0033, 1.0134, 0.9892, 0.9957, 0.9964,
        0.9665], device='cuda:0')
y_var = tensor([1.2550, 1.3607, 1.2437, 1.2335, 1.2651, 1.3498, 1.3251, 1.3504, 1.3751,
        1.2966], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[12.5298,  3.8459,  6.0405,  7.0708],
        [13.0076, 13.2871, 11.4610, 12.1649],
        [10.8816,  7.5404,  9.8676,  8.3192],
        [ 7.6702, 14.3604,  4.7274,  9.5464],
        [ 7.1074, 10.4691, 12.5010,  9.3894],
        [12.4345,  9.5737,  6.3362,  9.7892],
        [ 8.7545, 14.4484, 10.9381,  7.6355],
        [ 9.7212, 13.5353,  6.7375, 18.3675],
        [12.6766,  7.0196, 13.8151,  5.2902],
        [14.9948,  6.4972,  8.2610,  7.7822]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[14.0649,  4.3171,  6.7806,  7.9370],
        [14.6012, 14.9149, 12.8651, 13.6553],
        [12.2148,  8.4643, 11.0765,  9.3384],
        [ 8.6099, 16.1197,  5.3066, 10.7160],
        [ 7.9781, 11.7517, 14.0325, 10.5397],
        [13.9579, 10.7466,  7.1125, 10.9885],
        [ 9.8271, 16.2185, 12.2782,  8.5710],
        [10.9122, 15.1935,  7.5630, 20.6178],
        [14.2297,  7.8796, 15.5076,  5.9383],
        [16.8319,  7.2932,  9.2730,  8.7357]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([37.6022, 63.6594, 46.6841, 46.2959, 50.3286, 48.6285, 53.2739, 61.6713,
        49.4802, 47.8655], device='cuda:0')
SINR = tensor([-15.7521, -18.0386, -16.6917, -16.6554, -17.0181, -16.8689, -17.2652,
        -17.9008, -16.9443, -16.8002], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0259, 0.0155, 0.0210, 0.0211, 0.0195, 0.0201, 0.0184, 0.0160, 0.0198,
        0.0205], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -4,  rho_ul = 0.0995267926383743-----------
G_variance = tensor([0.9264, 0.9099, 1.0344, 0.8595, 0.8837, 0.7936, 1.0947, 1.1345, 0.8379,
        0.9028], device='cuda:0')
G_hat_variance = tensor([0.7693, 0.7352, 0.5949, 0.5453, 0.6217, 0.7393, 0.6839, 0.7081, 0.4902,
        0.5454], device='cuda:0')
gamma = tensor([[[0.6656, 0.6656, 0.6656, 0.6656]]], device='cuda:0')
Z_mean = tensor([ 0.0500+0.0059j, -0.1231+0.0989j,  0.2573+0.0247j,  0.1885+0.0245j,
         0.1158-0.0456j,  0.2012+0.1064j, -0.0852-0.0951j, -0.0113+0.0197j,
        -0.0919-0.0231j, -0.0533+0.0295j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1558, 1.1046, 0.8937, 0.8193, 0.9340, 1.1107, 1.0274, 1.0639, 0.7365,
        0.8193], device='cuda:0')
Real_SNR = tensor([-4.3013, -2.7239, -4.3915, -3.1333, -4.6345, -5.5777, -3.7038, -2.8716,
        -4.0399, -4.3490], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.6913, 5.3696, 3.7745, 4.8518, 3.4701, 2.7523, 4.2728, 5.1491, 3.9786,
        3.7358], device='cuda:0')
signal_var = tensor([0.3674, 0.5344, 0.3757, 0.4829, 0.3454, 0.2739, 0.4253, 0.5125, 0.3960,
        0.3718], device='cuda:0')
w_var = tensor([0.9891, 1.0006, 1.0326, 0.9935, 1.0040, 0.9895, 0.9978, 0.9927, 1.0038,
        1.0121], device='cuda:0')
y_var = tensor([1.3702, 1.5189, 1.4077, 1.4654, 1.3401, 1.2722, 1.4106, 1.5009, 1.3966,
        1.3838], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.3696,  7.3792, 10.2226, 17.2056],
        [ 8.5093, 16.9989, 14.1679,  4.4016],
        [11.4775, 10.4490,  8.8942,  6.7070],
        [ 8.7437,  7.1012,  6.8035, 10.7483],
        [ 7.4460, 11.5429,  9.2558,  8.7997],
        [10.7970, 15.1533,  8.8320, 10.6079],
        [ 4.9866, 15.0751, 11.6523,  9.0080],
        [ 6.7037, 15.2048, 11.5205,  8.0830],
        [ 6.2214,  6.1907,  7.3458,  9.3257],
        [ 7.6993, 10.5480,  7.1706,  6.6842]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[11.7501,  8.3616, 11.5834, 19.4960],
        [ 9.6420, 19.2618, 16.0540,  4.9875],
        [13.0054, 11.8400, 10.0782,  7.5999],
        [ 9.9077,  8.0466,  7.7092, 12.1791],
        [ 8.4372, 13.0795, 10.4880,  9.9712],
        [12.2344, 17.1706, 10.0077, 12.0201],
        [ 5.6504, 17.0819, 13.2035, 10.2071],
        [ 7.5961, 17.2288, 13.0541,  9.1591],
        [ 7.0496,  7.0148,  8.3237, 10.5671],
        [ 8.7243, 11.9522,  8.1251,  7.5740]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([49.7225, 48.5126, 41.3036, 36.7569, 40.7717, 49.9573, 44.8193, 45.6888,
        32.0098, 35.3321], device='cuda:0')
SINR = tensor([-16.9655, -16.8586, -16.1599, -15.6534, -16.1036, -16.9860, -16.5147,
        -16.5981, -15.0528, -15.4817], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0197, 0.0202, 0.0236, 0.0265, 0.0239, 0.0196, 0.0218, 0.0214, 0.0303,
        0.0275], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -3,  rho_ul = 0.12529680840681806-----------
G_variance = tensor([0.7918, 0.8490, 0.8101, 1.2680, 1.0854, 1.0375, 1.0381, 1.0645, 0.9178,
        0.8446], device='cuda:0')
G_hat_variance = tensor([0.7696, 0.5744, 0.7385, 0.8462, 0.8250, 0.7262, 0.5919, 0.7199, 0.7256,
        0.6420], device='cuda:0')
gamma = tensor([[[0.7148, 0.7148, 0.7148, 0.7148]]], device='cuda:0')
Z_mean = tensor([ 0.1866+0.0341j,  0.1399-0.0134j, -0.0515-0.0350j, -0.0959+0.0061j,
        -0.0215+0.1035j, -0.1350-0.0098j,  0.0419+0.1558j,  0.0166+0.0265j,
        -0.0264+0.0312j,  0.0431-0.0562j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0767, 0.8036, 1.0332, 1.1839, 1.1543, 1.0160, 0.8280, 1.0071, 1.0152,
        0.8981], device='cuda:0')
Real_SNR = tensor([-4.2036, -3.1146, -3.6114, -1.9775, -2.3535, -2.2002, -2.7659, -2.4004,
        -4.3504, -3.3465], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.1457, 3.9071, 3.4482, 5.1197, 4.5898, 4.7471, 4.1325, 4.6240, 2.9314,
        3.7325], device='cuda:0')
signal_var = tensor([0.3942, 0.4895, 0.4320, 0.6415, 0.5751, 0.5948, 0.5178, 0.5794, 0.3673,
        0.4677], device='cuda:0')
w_var = tensor([1.0376, 1.0029, 0.9924, 1.0114, 0.9887, 0.9872, 0.9789, 1.0069, 1.0001,
        1.0106], device='cuda:0')
y_var = tensor([1.4376, 1.5083, 1.4482, 1.6432, 1.5719, 1.5832, 1.4744, 1.5996, 1.3787,
        1.4666], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.4944,  9.7571, 17.2983,  5.8820],
        [13.5160,  7.2260,  5.2096,  6.1798],
        [11.5483, 12.0256,  8.8593,  8.0154],
        [ 8.3082, 13.6063, 13.2060, 11.4204],
        [ 7.0492, 13.9821, 16.0946,  8.3375],
        [10.7611,  7.4954,  7.0871, 15.0140],
        [10.9619,  5.8886,  7.6238,  8.8602],
        [ 8.6212, 10.7286,  9.6830, 10.2849],
        [ 9.1362,  7.4119, 10.0437, 13.0681],
        [10.5361, 10.6357,  5.6003,  8.4555]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[11.9946, 11.1520, 19.7712,  6.7229],
        [15.4482,  8.2590,  5.9544,  7.0632],
        [13.1991, 13.7447, 10.1258,  9.1612],
        [ 9.4958, 15.5514, 15.0938, 13.0530],
        [ 8.0569, 15.9809, 18.3954,  9.5294],
        [12.2995,  8.5669,  8.1002, 17.1603],
        [12.5290,  6.7304,  8.7136, 10.1268],
        [ 9.8536, 12.2622, 11.0672, 11.7552],
        [10.4423,  8.4714, 11.4795, 14.9363],
        [12.0423, 12.1562,  6.4008,  9.6643]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([41.4691, 30.6793, 38.6206, 44.4376, 43.4088, 38.5337, 31.8281, 37.5408,
        37.8676, 33.6356], device='cuda:0')
SINR = tensor([-16.1772, -14.8685, -15.8682, -16.4775, -16.3758, -15.8584, -15.0281,
        -15.7450, -15.7827, -15.2680], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0235, 0.0316, 0.0252, 0.0220, 0.0225, 0.0253, 0.0305, 0.0259, 0.0257,
        0.0289], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -2,  rho_ul = 0.1577393361200483-----------
G_variance = tensor([1.0804, 1.1947, 0.8415, 0.8884, 1.2143, 1.2236, 1.1885, 0.9848, 1.4608,
        0.8579], device='cuda:0')
G_hat_variance = tensor([0.7190, 0.9193, 0.6390, 0.7098, 0.8154, 0.9546, 0.8151, 0.7461, 1.3312,
        0.5953], device='cuda:0')
gamma = tensor([[[0.7593, 0.7593, 0.7593, 0.7593]]], device='cuda:0')
Z_mean = tensor([-0.0557-0.0079j,  0.0307-0.0318j, -0.0279+0.1541j,  0.0930-0.0068j,
        -0.0291+0.0197j, -0.0362-0.1189j,  0.1424-0.0828j,  0.0497-0.0310j,
        -0.0890+0.0983j, -0.0999+0.1083j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9468, 1.2107, 0.8416, 0.9347, 1.0738, 1.2572, 1.0734, 0.9827, 1.7532,
        0.7841], device='cuda:0')
Real_SNR = tensor([-0.5399, -1.2036, -2.4496, -2.3832, -2.1106, -0.5909, -0.9048, -2.6896,
        -0.2969, -2.2829], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([5.6183, 4.7307, 3.5843, 3.6371, 3.8171, 5.5309, 5.2216, 3.4196, 6.0365,
        3.7319], device='cuda:0')
signal_var = tensor([0.8862, 0.7462, 0.5654, 0.5737, 0.6021, 0.8724, 0.8236, 0.5394, 0.9522,
        0.5887], device='cuda:0')
w_var = tensor([1.0035, 0.9845, 0.9938, 0.9931, 0.9789, 0.9996, 1.0144, 1.0020, 1.0196,
        0.9958], device='cuda:0')
y_var = tensor([1.8769, 1.7364, 1.5437, 1.5884, 1.5453, 1.8713, 1.8480, 1.5550, 1.9738,
        1.5755], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[12.4048, 11.2819,  7.2987,  6.0684],
        [16.4187,  8.9971,  9.9369, 11.9424],
        [ 7.4535,  9.5041,  8.7687,  8.0751],
        [ 7.0218,  6.6430, 14.6368,  8.5014],
        [ 7.4216, 10.6668, 10.5967, 13.2434],
        [ 6.2429, 11.0424, 14.7742, 17.5891],
        [10.7961,  7.2101,  7.1262, 17.8168],
        [11.4830, 13.1718,  5.7932,  8.0130],
        [11.7147, 13.3086, 24.7616, 19.2922],
        [ 8.8496,  8.0892, 10.1309,  4.3762]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[14.2886, 12.9952,  8.4071,  6.9899],
        [18.9121, 10.3635, 11.4460, 13.7561],
        [ 8.5854, 10.9474, 10.1003,  9.3014],
        [ 8.0882,  7.6518, 16.8595,  9.7925],
        [ 8.5486, 12.2867, 12.2059, 15.2546],
        [ 7.1910, 12.7193, 17.0179, 20.2603],
        [12.4356,  8.3050,  8.2084, 20.5225],
        [13.2268, 15.1721,  6.6730,  9.2299],
        [13.4937, 15.3297, 28.5219, 22.2220],
        [10.1935,  9.3177, 11.6694,  5.0408]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([30.8312, 39.3529, 28.1250, 30.6227, 34.8874, 41.3112, 35.7367, 32.0022,
        57.4770, 26.1652], device='cuda:0')
SINR = tensor([-14.8899, -15.9498, -14.4909, -14.8604, -15.4267, -16.1607, -15.5311,
        -15.0518, -17.5949, -14.1772], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0314, 0.0248, 0.0343, 0.0316, 0.0279, 0.0236, 0.0272, 0.0303, 0.0171,
        0.0368], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -1,  rho_ul = 0.19858205868107037-----------
G_variance = tensor([0.8669, 1.0827, 0.7926, 0.9439, 1.2127, 1.0933, 0.8810, 0.8548, 1.1428,
        1.0288], device='cuda:0')
G_hat_variance = tensor([0.7461, 0.8019, 0.5516, 0.8056, 0.9033, 1.0249, 0.7112, 0.5929, 0.8513,
        0.7604], device='cuda:0')
gamma = tensor([[[0.7989, 0.7989, 0.7989, 0.7989]]], device='cuda:0')
Z_mean = tensor([-0.2243+0.1517j,  0.1003+0.0721j,  0.1091-0.0211j,  0.1791-0.0243j,
         0.1026-0.0505j,  0.1528+0.1377j,  0.0373-0.0178j,  0.0578+0.0236j,
         0.0098+0.0194j,  0.0601+0.0363j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9339, 1.0038, 0.6905, 1.0084, 1.1308, 1.2830, 0.8902, 0.7422, 1.0656,
        0.9518], device='cuda:0')
Real_SNR = tensor([-0.7358, -0.2781, -0.8284, -0.4386, -0.2642, -0.7273, -2.1147, -1.3928,
        -0.9139,  0.4694], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.2480, 4.7166, 4.0804, 4.4632, 4.6806, 4.2019, 3.1192, 3.6691, 4.1008,
        5.6414], device='cuda:0')
signal_var = tensor([0.8436, 0.9366, 0.8103, 0.8863, 0.9295, 0.8344, 0.6194, 0.7286, 0.8144,
        1.1203], device='cuda:0')
w_var = tensor([0.9993, 0.9986, 0.9806, 0.9805, 0.9878, 0.9865, 1.0080, 1.0041, 1.0051,
        1.0055], device='cuda:0')
y_var = tensor([1.8927, 1.9220, 1.8115, 1.8833, 1.9206, 1.8577, 1.6010, 1.7380, 1.8285,
        2.1139], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 8.5927, 10.0561, 11.4389,  9.2669],
        [13.7814,  7.4987,  9.9038,  8.5745],
        [ 6.9329, 10.0042,  4.7620,  5.7241],
        [10.7681,  6.8313, 10.6058, 12.4275],
        [10.0372,  8.6600, 10.5848, 15.3411],
        [14.5400, 14.9506,  7.8809, 14.3584],
        [ 8.9889,  8.7059,  8.9009,  8.1911],
        [ 9.1071,  8.3874,  5.6870,  5.9205],
        [10.7766, 12.0570, 10.2934,  8.4504],
        [15.2165,  5.4286,  7.2274,  9.4455]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 9.9656, 11.6628, 13.2665, 10.7475],
        [15.9833,  8.6968, 11.4862,  9.9445],
        [ 8.0406, 11.6026,  5.5229,  6.6386],
        [12.4885,  7.9228, 12.3003, 14.4131],
        [11.6408, 10.0436, 12.2760, 17.7922],
        [16.8631, 17.3393,  9.1400, 16.6525],
        [10.4250, 10.0968, 10.3230,  9.4998],
        [10.5622,  9.7274,  6.5956,  6.8664],
        [12.4984, 13.9834, 11.9380,  9.8005],
        [17.6477,  6.2959,  8.3821, 10.9546]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([28.6486, 28.9426, 19.9630, 29.5790, 32.4839, 37.6573, 25.3233, 21.1850,
        30.2667, 27.1660], device='cuda:0')
SINR = tensor([-14.5710, -14.6154, -13.0023, -14.7098, -15.1167, -15.7585, -14.0352,
        -13.2603, -14.8097, -14.3403], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0337, 0.0334, 0.0477, 0.0327, 0.0299, 0.0259, 0.0380, 0.0451, 0.0320,
        0.0355], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 0,  rho_ul = 0.25-----------
G_variance = tensor([1.1243, 0.9535, 0.9496, 1.0330, 0.9932, 0.9829, 1.2205, 0.9740, 0.9557,
        1.4101], device='cuda:0')
G_hat_variance = tensor([0.9479, 0.6747, 0.7501, 0.7211, 0.7606, 0.7806, 1.0837, 0.7732, 0.7995,
        0.9706], device='cuda:0')
gamma = tensor([[[0.8333, 0.8333, 0.8333, 0.8333]]], device='cuda:0')
Z_mean = tensor([-0.0838-0.0916j, -0.1789-0.0924j,  0.2399+0.0075j,  0.0785-0.1713j,
         0.1163-0.0146j,  0.1628-0.0576j,  0.1704-0.0914j,  0.1050-0.2000j,
        -0.1005-0.1163j,  0.0017-0.1239j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1375, 0.8097, 0.9002, 0.8653, 0.9127, 0.9367, 1.3004, 0.9278, 0.9594,
        1.1648], device='cuda:0')
Real_SNR = tensor([ 1.5690,  1.2685,  0.0715,  0.2138, -0.7093,  0.7464,  1.1777,  0.3525,
        -1.0597,  1.4225], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([5.6745, 5.3953, 3.9954, 4.3034, 3.4319, 4.5955, 5.1745, 4.3868, 3.1677,
        5.6334], device='cuda:0')
signal_var = tensor([1.4186, 1.3488, 0.9989, 1.0759, 0.8580, 1.1489, 1.2936, 1.0967, 0.7919,
        1.4083], device='cuda:0')
w_var = tensor([0.9885, 1.0072, 0.9826, 1.0242, 1.0102, 0.9675, 0.9864, 1.0112, 1.0108,
        1.0150], device='cuda:0')
y_var = tensor([2.4188, 2.3982, 1.9697, 2.0741, 1.8714, 2.0842, 2.3225, 2.1193, 1.8197,
        2.4198], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 7.5517, 15.8498, 10.5425, 11.0341],
        [ 7.9978, 11.3574,  7.3121,  6.5320],
        [ 9.5231, 10.3376,  6.5490, 11.0017],
        [ 4.4729, 10.9151,  7.4784, 12.3019],
        [ 6.7809,  9.1464, 10.9471,  9.2709],
        [10.0501, 11.1085,  7.9340,  8.6332],
        [14.0666, 20.0281,  8.3288,  9.7877],
        [14.1340,  6.5483,  7.9973,  9.5456],
        [ 5.0430, 11.3624,  9.2314, 12.7249],
        [14.3671, 10.6326,  6.6559, 14.3846]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 8.8104, 18.4914, 12.2995, 12.8731],
        [ 9.3308, 13.2503,  8.5308,  7.6206],
        [11.1103, 12.0605,  7.6405, 12.8353],
        [ 5.2184, 12.7343,  8.7248, 14.3522],
        [ 7.9110, 10.6707, 12.7716, 10.8160],
        [11.7252, 12.9600,  9.2563, 10.0721],
        [16.4110, 23.3661,  9.7169, 11.4190],
        [16.4896,  7.6397,  9.3302, 11.1365],
        [ 5.8835, 13.2562, 10.7699, 14.8457],
        [16.7616, 12.4047,  7.7652, 16.7820]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([28.7414, 21.2146, 23.9063, 22.4729, 23.0972, 24.1072, 33.3635, 24.4262,
        24.5135, 29.4201], device='cuda:0')
SINR = tensor([-14.5851, -13.2663, -13.7851, -13.5166, -13.6356, -13.8215, -15.2327,
        -13.8786, -13.8940, -14.6864], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0336, 0.0450, 0.0402, 0.0426, 0.0415, 0.0398, 0.0291, 0.0393, 0.0392,
        0.0329], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 1,  rho_ul = 0.3147313529485418-----------
G_variance = tensor([1.1002, 1.0257, 0.9365, 1.0518, 0.7022, 0.7705, 0.8075, 0.8198, 0.8946,
        1.1175], device='cuda:0')
G_hat_variance = tensor([0.9036, 0.8720, 0.9019, 0.8925, 0.7668, 0.6198, 0.7929, 0.8591, 0.8573,
        0.9162], device='cuda:0')
gamma = tensor([[[0.8629, 0.8629, 0.8629, 0.8629]]], device='cuda:0')
Z_mean = tensor([-0.2233+0.1987j, -0.1121+0.0272j, -0.0361+0.3062j,  0.0726-0.1502j,
         0.0331-0.0910j,  0.0903-0.1743j,  0.0026+0.0171j, -0.0830-0.0252j,
        -0.1463-0.0265j,  0.0305-0.0089j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0471, 1.0105, 1.0452, 1.0342, 0.8887, 0.7183, 0.9189, 0.9956, 0.9935,
        1.0617], device='cuda:0')
Real_SNR = tensor([ 1.8677e+00,  2.3400e+00,  9.4855e-01,  2.4173e+00, -1.1214e+00,
        -1.3087e+00,  6.0501e-01,  1.3258e-01,  1.4799e-03,  2.3220e+00],
       device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.9811, 5.4848, 3.9668, 5.5742, 2.4325, 2.4016, 3.6168, 3.3191, 3.2268,
        5.3444], device='cuda:0')
signal_var = tensor([1.5677, 1.7262, 1.2485, 1.7544, 0.7656, 0.7559, 1.1383, 1.0446, 1.0156,
        1.6820], device='cuda:0')
w_var = tensor([1.0197, 1.0072, 1.0035, 1.0055, 0.9911, 1.0217, 0.9903, 1.0132, 1.0152,
        0.9855], device='cuda:0')
y_var = tensor([2.5960, 2.7312, 2.2852, 2.7790, 1.7591, 1.7598, 2.1159, 2.0445, 2.0189,
        2.6531], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 6.8624,  8.8605, 16.5631, 12.1256],
        [ 7.9028, 14.5127,  9.5741,  7.9523],
        [ 7.5527, 10.1713, 12.5516, 14.2900],
        [13.8871,  6.0305, 13.6672,  7.8641],
        [ 6.2928, 11.6145,  9.7875,  7.3379],
        [ 8.3216,  7.6285,  8.8471,  4.7584],
        [ 9.7918, 11.6684,  6.7539,  7.6354],
        [12.3600,  9.6159,  8.4043,  8.7491],
        [13.2862,  6.7673, 12.0695,  7.5075],
        [12.4456, 12.2096,  8.6854,  8.1071]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 8.0467, 10.3897, 19.4216, 14.2183],
        [ 9.2667, 17.0174, 11.2264,  9.3247],
        [ 8.8562, 11.9267, 14.7178, 16.7562],
        [16.2838,  7.0713, 16.0260,  9.2213],
        [ 7.3788, 13.6189, 11.4766,  8.6043],
        [ 9.7577,  8.9450, 10.3739,  5.5796],
        [11.4817, 13.6822,  7.9195,  8.9532],
        [14.4931, 11.2755,  9.8547, 10.2590],
        [15.5792,  7.9353, 14.1525,  8.8032],
        [14.5935, 14.3167, 10.1843,  9.5062]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([24.9820, 22.4677, 25.0686, 23.3155, 19.7062, 16.6253, 20.1658, 22.0106,
        22.2926, 23.3147], device='cuda:0')
SINR = tensor([-13.9763, -13.5156, -13.9913, -13.6764, -12.9460, -12.2077, -13.0461,
        -13.4263, -13.4816, -13.6763], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0385, 0.0426, 0.0384, 0.0411, 0.0483, 0.0567, 0.0472, 0.0435, 0.0429,
        0.0411], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 2,  rho_ul = 0.3962232981152784-----------
G_variance = tensor([0.6754, 0.8900, 1.2570, 0.7239, 1.1501, 0.9395, 1.0097, 0.8727, 1.0534,
        1.2608], device='cuda:0')
G_hat_variance = tensor([0.7878, 0.7744, 1.2140, 0.6531, 1.1760, 0.8324, 0.9337, 0.8430, 0.8728,
        1.1428], device='cuda:0')
gamma = tensor([[[0.8879, 0.8879, 0.8879, 0.8879]]], device='cuda:0')
Z_mean = tensor([-0.0060-0.0934j, -0.0145-0.0595j,  0.0040+0.1820j, -0.0057+0.2938j,
         0.1618-0.0807j,  0.0585+0.0394j, -0.0895+0.0754j,  0.0547-0.1417j,
         0.1181-0.1519j,  0.1083+0.0470j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8872, 0.8721, 1.3672, 0.7355, 1.3244, 0.9375, 1.0515, 0.9494, 0.9830,
        1.2870], device='cuda:0')
Real_SNR = tensor([0.4729, 2.4022, 3.7336, 0.9690, 3.9542, 1.3828, 2.2601, 2.0817, 3.1558,
        3.0092], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([2.8411, 4.4231, 6.0757, 3.1893, 6.1153, 3.3857, 4.3149, 4.1673, 5.1033,
        5.0688], device='cuda:0')
signal_var = tensor([1.1257, 1.7526, 2.4073, 1.2637, 2.4230, 1.3415, 1.7097, 1.6512, 2.0221,
        2.0084], device='cuda:0')
w_var = tensor([1.0096, 1.0080, 1.0190, 1.0109, 0.9749, 0.9757, 1.0160, 1.0224, 0.9777,
        1.0045], device='cuda:0')
y_var = tensor([2.1179, 2.7665, 3.3890, 2.2704, 3.4498, 2.3040, 2.7268, 2.6844, 2.9630,
        3.0248], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.0135,  5.7419, 10.4362,  8.7600],
        [ 8.1103,  7.8374,  9.4054,  8.8103],
        [13.7897,  9.6753, 16.5384, 14.6451],
        [ 6.1153,  5.2177,  9.5548, 11.2512],
        [17.1676,  8.1822, 12.3059, 15.3033],
        [ 5.1875, 12.4299,  7.6940, 11.4492],
        [11.8743,  9.9659, 14.8483,  4.8692],
        [ 7.9893, 10.4777,  6.2754, 13.2053],
        [11.6449,  8.6677,  7.7037, 11.8004],
        [13.8845, 10.6755, 15.7854, 10.4044]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[11.7918,  6.7616, 12.2896, 10.3157],
        [ 9.5506,  9.2293, 11.0757, 10.3749],
        [16.2386, 11.3935, 19.4754, 17.2459],
        [ 7.2014,  6.1444, 11.2517, 13.2493],
        [20.2164,  9.6353, 14.4913, 18.0210],
        [ 6.1087, 14.6374,  9.0603, 13.4824],
        [13.9831, 11.7358, 17.4852,  5.7339],
        [ 9.4081, 12.3385,  7.3898, 15.5504],
        [13.7129, 10.2070,  9.0718, 13.8960],
        [16.3502, 12.5713, 18.5888, 12.2521]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([17.3475, 16.9563, 27.1236, 15.9516, 26.2851, 18.2454, 20.6263, 18.8345,
        19.7622, 25.1886], device='cuda:0')
SINR = tensor([-12.3924, -12.2933, -14.3335, -12.0280, -14.1971, -12.6115, -13.1442,
        -12.7496, -12.9584, -14.0120], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0545, 0.0557, 0.0356, 0.0590, 0.0367, 0.0520, 0.0462, 0.0504, 0.0482,
        0.0382], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 3,  rho_ul = 0.4988155787422199-----------
G_variance = tensor([1.1023, 1.1596, 0.9286, 1.2149, 0.9305, 1.2224, 0.8880, 1.1302, 0.9816,
        1.1080], device='cuda:0')
G_hat_variance = tensor([0.9648, 0.9743, 0.9427, 1.1095, 0.8566, 0.9899, 0.7429, 1.0468, 0.8969,
        0.9290], device='cuda:0')
gamma = tensor([[[0.9089, 0.9089, 0.9089, 0.9089]]], device='cuda:0')
Z_mean = tensor([-0.0374+0.1863j,  0.0705-0.0459j,  0.0499-0.0386j,  0.0338+0.0008j,
         0.0883-0.1616j,  0.0746-0.1794j, -0.0532-0.0045j,  0.1213-0.0157j,
        -0.0294+0.1887j, -0.0494-0.0993j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0615, 1.0719, 1.0372, 1.2207, 0.9425, 1.0892, 0.8174, 1.1517, 0.9869,
        1.0221], device='cuda:0')
Real_SNR = tensor([2.9361, 2.8889, 2.0354, 3.9557, 3.4596, 4.1318, 2.5011, 4.5763, 2.5751,
        4.3582], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.9461, 3.8802, 3.2291, 4.9331, 4.5436, 5.2539, 3.5618, 5.6711, 3.6210,
        5.4902], device='cuda:0')
signal_var = tensor([1.9684, 1.9355, 1.6107, 2.4607, 2.2664, 2.6207, 1.7767, 2.8288, 1.8062,
        2.7386], device='cuda:0')
w_var = tensor([1.0011, 0.9952, 1.0080, 0.9897, 1.0218, 1.0122, 0.9989, 0.9862, 0.9983,
        1.0039], device='cuda:0')
y_var = tensor([2.9996, 2.9589, 2.6145, 3.4850, 3.2685, 3.6271, 2.7672, 3.7732, 2.7789,
        3.7543], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[11.1491, 11.4635, 11.2485,  8.9808],
        [ 9.7987,  4.7643, 13.1191, 14.4054],
        [10.8949,  7.2933, 11.3958, 11.0246],
        [ 6.8115, 16.7122, 13.4150, 10.7154],
        [15.5721,  9.8892,  8.5395,  4.1135],
        [ 8.3192, 13.5847, 14.6998,  7.3842],
        [ 6.1036,  9.2619,  6.4559, 10.1716],
        [13.5990, 10.8220, 11.2810,  9.8133],
        [12.3470,  7.8093,  8.8682, 10.9222],
        [10.9870, 10.0508,  9.3581,  9.9595]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[13.1757, 13.5473, 13.2933, 10.6133],
        [11.5799,  5.6304, 15.5039, 17.0241],
        [12.8754,  8.6191, 13.4673, 13.0287],
        [ 8.0497, 19.7501, 15.8535, 12.6632],
        [18.4028, 11.6868, 10.0918,  4.8613],
        [ 9.8314, 16.0542, 17.3719,  8.7265],
        [ 7.2131, 10.9455,  7.6295, 12.0206],
        [16.0710, 12.7892, 13.3317, 11.5971],
        [14.5914,  9.2289, 10.4802, 12.9076],
        [12.9842, 11.8779, 11.0593, 11.7699]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([18.7983, 18.4673, 17.8184, 20.9097, 16.7239, 19.3011, 14.0380, 19.9713,
        17.5279, 17.7073], device='cuda:0')
SINR = tensor([-12.7412, -12.6640, -12.5087, -13.2035, -12.2334, -12.8558, -11.4730,
        -13.0041, -12.4373, -12.4815], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0505, 0.0514, 0.0531, 0.0456, 0.0564, 0.0493, 0.0665, 0.0477, 0.0540,
        0.0535], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 4,  rho_ul = 0.627971607877395-----------
G_variance = tensor([1.1625, 0.9399, 1.3334, 0.9922, 0.9578, 1.0377, 1.2254, 0.8561, 0.9998,
        1.1435], device='cuda:0')
G_hat_variance = tensor([1.1697, 0.9994, 1.2100, 0.9242, 0.9019, 0.9358, 1.1230, 0.7672, 0.9159,
        1.0773], device='cuda:0')
gamma = tensor([[[0.9263, 0.9263, 0.9263, 0.9263]]], device='cuda:0')
Z_mean = tensor([ 0.0019+0.0089j,  0.1050-0.0013j,  0.0852-0.1181j, -0.2411+0.0437j,
        -0.0464-0.1044j, -0.0022-0.1115j, -0.0590+0.0545j, -0.1185+0.0135j,
        -0.1270+0.0355j,  0.1307-0.1019j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.2629, 1.0790, 1.3064, 0.9978, 0.9737, 1.0103, 1.2124, 0.8283, 0.9889,
        1.1631], device='cuda:0')
Real_SNR = tensor([4.7269, 3.6770, 5.3079, 4.3507, 4.4240, 5.0947, 5.3957, 3.1808, 4.2869,
        5.0054], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.7512, 3.6731, 5.6034, 4.2225, 4.5207, 5.1898, 5.5172, 3.3225, 4.1877,
        5.0290], device='cuda:0')
signal_var = tensor([2.9836, 2.3066, 3.5188, 2.6516, 2.8389, 3.2591, 3.4647, 2.0865, 2.6298,
        3.1581], device='cuda:0')
w_var = tensor([1.0048, 0.9892, 1.0366, 0.9737, 1.0250, 1.0084, 1.0002, 1.0031, 0.9800,
        0.9974], device='cuda:0')
y_var = tensor([4.0479, 3.3240, 4.6108, 3.6483, 3.8811, 4.2612, 4.4635, 3.1076, 3.5890,
        4.0981], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.3136, 13.0452, 15.1655, 10.7306],
        [ 6.9261, 10.5983, 16.2492,  8.7483],
        [ 8.9655, 15.3703, 18.0243,  9.4369],
        [11.1051,  8.0586,  9.2349, 12.9180],
        [14.1271, 10.3577,  8.7344,  5.2779],
        [ 9.8196, 14.5078,  8.4145,  7.1579],
        [11.2557, 11.7668,  9.7860, 14.7323],
        [ 8.9030,  5.7048,  7.4182, 10.8478],
        [10.2814, 13.4292,  6.0769,  9.4727],
        [11.2690, 15.6812, 13.4816,  6.0287]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[12.2242, 15.4618, 17.9749, 12.7184],
        [ 8.2092, 12.5616, 19.2593, 10.3689],
        [10.6264, 18.2177, 21.3633, 11.1850],
        [13.1623,  9.5515, 10.9456, 15.3111],
        [16.7441, 12.2765, 10.3525,  6.2557],
        [11.6387, 17.1954,  9.9733,  8.4839],
        [13.3408, 13.9466, 11.5988, 17.4615],
        [10.5523,  6.7617,  8.7924, 12.8574],
        [12.1860, 15.9170,  7.2026, 11.2275],
        [13.3566, 18.5861, 15.9791,  7.1455]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([19.1366, 16.5207, 20.1243, 16.0524, 14.9570, 15.5020, 18.4706, 12.7722,
        15.2535, 18.0509], device='cuda:0')
SINR = tensor([-12.8186, -12.1803, -13.0372, -12.0554, -11.7484, -11.9039, -12.6648,
        -11.0627, -11.8337, -12.5650], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0497, 0.0571, 0.0473, 0.0586, 0.0627, 0.0606, 0.0514, 0.0726, 0.0615,
        0.0525], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 5,  rho_ul = 0.7905694150420949-----------
G_variance = tensor([1.0920, 1.2501, 1.0339, 1.0655, 1.2060, 1.0261, 1.0219, 1.1137, 0.8118,
        0.9650], device='cuda:0')
G_hat_variance = tensor([0.9891, 1.1692, 0.9992, 0.9575, 1.1362, 0.9587, 0.8457, 1.0075, 0.7385,
        0.9184], device='cuda:0')
gamma = tensor([[[0.9405, 0.9405, 0.9405, 0.9405]]], device='cuda:0')
Z_mean = tensor([-7.4421e-02+0.1438j,  1.0474e-01-0.1286j,  5.2295e-02-0.0309j,
        -1.0843e-01+0.1049j, -9.3803e-02+0.1047j, -6.6822e-02+0.0621j,
        -1.3140e-02+0.1435j, -5.3016e-02+0.0110j,  6.7487e-06-0.0540j,
        -7.7302e-03-0.2079j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0517, 1.2432, 1.0624, 1.0180, 1.2081, 1.0193, 0.8992, 1.0712, 0.7852,
        0.9765], device='cuda:0')
Real_SNR = tensor([4.9288, 6.4579, 5.2915, 5.3920, 6.1529, 5.9247, 4.4706, 6.5552, 4.1772,
        5.8853], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.9240, 5.5847, 4.2861, 4.3383, 5.1648, 4.8149, 3.5092, 5.8063, 3.3667,
        4.8404], device='cuda:0')
signal_var = tensor([3.1022, 4.4151, 3.3884, 3.4297, 4.0831, 3.8065, 2.7743, 4.5903, 2.6616,
        3.8267], device='cuda:0')
w_var = tensor([0.9972, 0.9980, 1.0019, 0.9910, 0.9901, 0.9729, 0.9910, 1.0147, 1.0172,
        0.9869], device='cuda:0')
y_var = tensor([4.1420, 5.3828, 4.3585, 4.4061, 5.0713, 4.7449, 3.7912, 5.5754, 3.6979,
        4.8098], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 8.6076, 13.5346, 12.5706,  7.3526],
        [10.7083,  9.3000,  9.6115, 19.9651],
        [11.7398, 10.7676, 10.2367,  8.8355],
        [ 6.8081, 11.2163, 14.8915,  7.6971],
        [13.0903,  7.4991, 15.3129, 12.0029],
        [ 9.9585, 11.6101,  9.4696,  9.0492],
        [ 8.8491,  8.7424,  9.0688,  9.2393],
        [11.7999,  6.3678,  7.0319, 16.6964],
        [ 9.8274,  9.4850,  6.0870,  5.3402],
        [14.1522,  4.0566, 11.6440,  9.9629]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[10.2267, 16.0805, 14.9352,  8.7356],
        [12.7226, 11.0494, 11.4194, 23.7206],
        [13.9482, 12.7930, 12.1622, 10.4975],
        [ 8.0888, 13.3261, 17.6926,  9.1450],
        [15.5526,  8.9097, 18.1933, 14.2606],
        [11.8318, 13.7940, 11.2509, 10.7514],
        [10.5136, 10.3868, 10.7747, 10.9772],
        [14.0194,  7.5656,  8.3546, 19.8370],
        [11.6759, 11.2691,  7.2320,  6.3448],
        [16.8143,  4.8197, 13.8343, 11.8369]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([14.4899, 17.0801, 14.3226, 13.9896, 16.5015, 13.8086, 12.3660, 14.4315,
        10.5886, 13.7150], device='cuda:0')
SINR = tensor([-11.6107, -12.3249, -11.5602, -11.4581, -12.1752, -11.4015, -10.9223,
        -11.5931, -10.2484, -11.3720], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0646, 0.0553, 0.0653, 0.0667, 0.0571, 0.0675, 0.0748, 0.0648, 0.0863,
        0.0680], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 6,  rho_ul = 0.9952679263837431-----------
G_variance = tensor([1.1413, 0.8835, 0.9059, 1.1453, 0.8971, 1.1276, 1.0646, 0.9814, 0.8312,
        0.8268], device='cuda:0')
G_hat_variance = tensor([1.0697, 0.8233, 0.8791, 1.1475, 0.8768, 1.0369, 1.0753, 0.9620, 0.7859,
        0.8282], device='cuda:0')
gamma = tensor([[[0.9522, 0.9522, 0.9522, 0.9522]]], device='cuda:0')
Z_mean = tensor([ 0.1157+0.0846j,  0.0343+0.2020j,  0.2110-0.1013j, -0.0443+0.0063j,
         0.0245-0.2067j, -0.0159+0.2255j, -0.1459+0.0876j,  0.0654-0.2409j,
         0.1657+0.1200j, -0.0397-0.0723j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1235, 0.8646, 0.9233, 1.2051, 0.9208, 1.0890, 1.1293, 1.0103, 0.8253,
        0.8698], device='cuda:0')
Real_SNR = tensor([6.9917, 6.2564, 5.7590, 7.3570, 5.6514, 5.7090, 5.4349, 7.4531, 6.0419,
        4.8921], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([5.0247, 4.3168, 3.8052, 5.5078, 3.6802, 3.7403, 3.5178, 5.5567, 4.0643,
        3.0585], device='cuda:0')
signal_var = tensor([5.0009, 4.2964, 3.7872, 5.4817, 3.6628, 3.7226, 3.5012, 5.5304, 4.0451,
        3.0440], device='cuda:0')
w_var = tensor([0.9997, 1.0173, 1.0056, 1.0074, 0.9969, 0.9999, 1.0017, 0.9941, 1.0063,
        0.9868], device='cuda:0')
y_var = tensor([5.9653, 5.3417, 4.8275, 6.5232, 4.6631, 4.7078, 4.5232, 6.4649, 5.0341,
        4.0239], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 9.4499, 14.5414, 11.3654,  9.2801],
        [ 6.8795,  8.0538,  8.1077, 12.3581],
        [ 8.9302,  8.3091, 10.6268, 10.3336],
        [13.4327, 16.8870,  7.9897,  8.7713],
        [ 8.1539,  5.0969, 12.1263, 12.2678],
        [ 9.1601, 12.3542, 11.4205, 11.5812],
        [ 6.4124, 15.8065,  8.1557, 14.8253],
        [14.3773,  9.9593,  8.8400,  8.7178],
        [ 9.2747,  5.8581,  4.9310, 13.7984],
        [ 6.8374, 11.5476,  7.5171,  8.2909]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[11.2495, 17.3105, 13.5298, 11.0474],
        [ 8.1896,  9.5876,  9.6516, 14.7115],
        [10.6308,  9.8914, 12.6505, 12.3014],
        [15.9907, 20.1028,  9.5112, 10.4417],
        [ 9.7067,  6.0675, 14.4356, 14.6040],
        [10.9045, 14.7068, 13.5953, 13.7866],
        [ 7.6336, 18.8166,  9.7088, 17.6485],
        [17.1152, 11.8559, 10.5235, 10.3780],
        [11.0409,  6.9737,  5.8700, 16.4261],
        [ 8.1395, 13.7467,  8.9486,  9.8698]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([13.6462, 10.8221, 11.6783, 14.3933, 11.5087, 13.6093, 13.8184, 12.8078,
        10.3522, 10.4534], device='cuda:0')
SINR = tensor([-11.3501, -10.3431, -10.6738, -11.5816, -10.6103, -11.3383, -11.4046,
        -11.0748, -10.1503, -10.1926], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0683, 0.0846, 0.0789, 0.0650, 0.0799, 0.0684, 0.0675, 0.0724, 0.0881,
        0.0873], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 7,  rho_ul = 1.2529680840681805-----------
G_variance = tensor([0.9765, 0.9577, 0.9615, 1.2371, 0.9613, 0.8911, 1.2128, 0.9329, 1.0250,
        0.8870], device='cuda:0')
G_hat_variance = tensor([0.9037, 0.9448, 0.9713, 1.1977, 0.8967, 0.8334, 1.0816, 0.8904, 1.0097,
        0.8398], device='cuda:0')
gamma = tensor([[[0.9616, 0.9616, 0.9616, 0.9616]]], device='cuda:0')
Z_mean = tensor([ 0.1404+0.0749j,  0.0126+0.2146j, -0.1623-0.1167j,  0.1926+0.0007j,
        -0.1554+0.1607j,  0.0529-0.1682j, -0.1191-0.1174j, -0.1068+0.2231j,
        -0.0654-0.0137j,  0.1653+0.0145j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9398, 0.9825, 1.0101, 1.2455, 0.9325, 0.8667, 1.1248, 0.9260, 1.0500,
        0.8733], device='cuda:0')
Real_SNR = tensor([6.5819, 7.9354, 8.1981, 9.0627, 6.7158, 7.2235, 8.0330, 6.9388, 7.0509,
        7.6260], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.6400, 4.9825, 5.2556, 6.5526, 3.6854, 4.2981, 5.0175, 3.9739, 4.0477,
        4.6871], device='cuda:0')
signal_var = tensor([4.5607, 6.2429, 6.5851, 8.2102, 4.6177, 5.3854, 6.2867, 4.9792, 5.0716,
        5.8728], device='cuda:0')
w_var = tensor([1.0019, 1.0043, 0.9971, 1.0188, 0.9837, 1.0206, 0.9888, 1.0076, 1.0001,
        1.0145], device='cuda:0')
y_var = tensor([5.5411, 7.2933, 7.6755, 9.3345, 5.5654, 6.4625, 7.3201, 5.9964, 6.1664,
        6.9077], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[11.4167,  9.8613,  9.6088,  6.7785],
        [ 8.0586,  9.9768, 10.8100, 11.3230],
        [12.8262,  9.4374,  7.8031, 10.9237],
        [17.2154, 11.8628, 15.1134,  5.8687],
        [ 9.3214,  7.0818,  6.6967, 15.2685],
        [ 5.7325, 17.0002,  5.7407,  6.5699],
        [13.2303, 12.1164,  9.5121, 10.1257],
        [ 6.8192, 11.3769,  8.9518, 11.4125],
        [12.0612,  9.2654,  8.4162, 11.3869],
        [10.8875, 12.6028,  6.7490,  4.9199]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[13.6124, 11.7578, 11.4568,  8.0822],
        [ 9.6085, 11.8956, 12.8890, 13.5007],
        [15.2930, 11.2525,  9.3039, 13.0246],
        [20.5264, 14.1444, 18.0200,  6.9974],
        [11.1142,  8.4438,  7.9847, 18.2050],
        [ 6.8351, 20.2698,  6.8447,  7.8335],
        [15.7749, 14.4467, 11.3415, 12.0731],
        [ 8.1307, 13.5649, 10.6734, 13.6074],
        [14.3809, 11.0474, 10.0348, 13.5768],
        [12.9814, 15.0267,  8.0471,  5.8661]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([10.2283, 10.9080, 11.1313, 13.5942, 10.4192,  9.5163, 12.2159, 10.4713,
        11.1691,  9.5478], device='cuda:0')
SINR = tensor([-10.0980, -10.3775, -10.4654, -11.3336, -10.1784,  -9.7847, -10.8692,
        -10.2000, -10.4802,  -9.7990], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0891, 0.0840, 0.0824, 0.0685, 0.0876, 0.0951, 0.0757, 0.0872, 0.0822,
        0.0948], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 8,  rho_ul = 1.5773933612004833-----------
G_variance = tensor([1.2808, 0.7957, 0.9604, 1.1808, 0.8381, 0.9567, 1.1657, 0.9558, 0.9729,
        1.0503], device='cuda:0')
G_hat_variance = tensor([1.2357, 0.7824, 1.0134, 1.1675, 0.8267, 0.9089, 1.1580, 0.9523, 0.9407,
        0.9827], device='cuda:0')
gamma = tensor([[[0.9693, 0.9693, 0.9693, 0.9693]]], device='cuda:0')
Z_mean = tensor([ 0.0076-0.0846j,  0.0044+0.0500j,  0.1004+0.1256j,  0.1008+0.0691j,
        -0.1360-0.0758j, -0.1071+0.0032j,  0.1256+0.1218j, -0.0608+0.1547j,
        -0.2371-0.0266j,  0.0487-0.1440j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.2749, 0.8072, 1.0456, 1.2045, 0.8529, 0.9377, 1.1947, 0.9825, 0.9705,
        1.0138], device='cuda:0')
Real_SNR = tensor([8.7119, 8.6478, 8.5833, 9.5359, 6.8750, 7.3522, 8.6232, 7.5319, 7.8486,
        8.6592], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.7492, 4.6187, 4.5174, 5.6401, 3.0504, 3.4047, 4.6120, 3.5306, 3.9840,
        4.6658], device='cuda:0')
signal_var = tensor([7.4914, 7.2855, 7.1258, 8.8967, 4.8116, 5.3706, 7.2750, 5.5692, 6.2844,
        7.3599], device='cuda:0')
w_var = tensor([1.0078, 0.9947, 0.9874, 0.9900, 0.9881, 0.9881, 0.9989, 0.9831, 1.0313,
        1.0022], device='cuda:0')
y_var = tensor([8.6012, 8.2390, 8.1175, 9.9250, 5.7201, 6.4129, 8.2268, 6.5422, 7.3458,
        8.3699], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[16.8352,  6.6572, 14.5736, 11.9419],
        [ 6.1022,  9.9659,  9.0002,  6.5136],
        [12.7838,  5.2301, 15.0472,  8.7505],
        [16.1987,  7.9366, 11.3061, 12.1326],
        [ 7.8600,  7.7499,  5.8223, 12.8018],
        [12.9177,  6.1184,  6.6748, 11.3190],
        [12.9938, 12.4911, 14.9087,  7.4252],
        [ 6.3849, 10.3373,  6.3953, 16.3046],
        [12.0280,  8.0177, 10.0306, 10.0501],
        [ 8.7085, 13.0936,  7.9552, 10.7054]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[20.0989,  7.9477, 17.3988, 14.2569],
        [ 7.2852, 11.8978, 10.7450,  7.7763],
        [15.2620,  6.2439, 17.9641, 10.4469],
        [19.3389,  9.4752, 13.4978, 14.4845],
        [ 9.3837,  9.2522,  6.9510, 15.2835],
        [15.4219,  7.3045,  7.9688, 13.5133],
        [15.5128, 14.9126, 17.7988,  8.8646],
        [ 7.6226, 12.3412,  7.6351, 19.4653],
        [14.3597,  9.5719, 11.9751, 11.9984],
        [10.3966, 15.6318,  9.4973, 12.7807]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([12.0708,  7.6232, 10.0924, 11.4833,  8.2633,  8.9382, 11.5424,  9.5156,
         9.6856,  9.7668], device='cuda:0')
SINR = tensor([-10.8174,  -8.8214, -10.0399, -10.6007,  -9.1715,  -9.5125, -10.6230,
         -9.7844,  -9.8613,  -9.8975], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0765, 0.1160, 0.0902, 0.0801, 0.1080, 0.1006, 0.0797, 0.0951, 0.0936,
        0.0929], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 9,  rho_ul = 1.985820586810704-----------
G_variance = tensor([1.0097, 0.9550, 0.9975, 1.1304, 1.0091, 0.9035, 0.9175, 0.9915, 1.1875,
        1.0083], device='cuda:0')
G_hat_variance = tensor([1.0253, 0.9783, 0.9576, 1.1199, 0.9867, 0.8441, 0.8327, 0.9663, 1.1883,
        1.0471], device='cuda:0')
gamma = tensor([[[0.9754, 0.9754, 0.9754, 0.9754]]], device='cuda:0')
Z_mean = tensor([-0.1518-0.0139j,  0.1356-0.1535j,  0.1998-0.0081j, -0.0603+0.1585j,
         0.1349+0.0680j,  0.0768+0.0224j,  0.0545-0.0403j,  0.0277-0.1396j,
        -0.0096-0.0462j,  0.0274+0.1151j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0511, 1.0030, 0.9817, 1.1481, 1.0116, 0.8654, 0.8536, 0.9906, 1.2182,
        1.0735], device='cuda:0')
Real_SNR = tensor([ 8.6481,  8.2802,  9.0989,  9.6898,  9.8086,  8.5781,  8.6866,  9.3871,
        10.6034,  9.1779], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.7005, 3.4123, 4.0659, 4.6842, 4.9024, 3.6278, 3.7544, 4.4542, 5.7850,
        4.1823], device='cuda:0')
signal_var = tensor([ 7.3485,  6.7762,  8.0741,  9.3019,  9.7354,  7.2041,  7.4555,  8.8452,
        11.4880,  8.3053], device='cuda:0')
w_var = tensor([1.0032, 1.0069, 0.9936, 0.9991, 1.0174, 0.9995, 1.0088, 1.0186, 0.9998,
        1.0036], device='cuda:0')
y_var = tensor([ 8.4524,  7.7785,  8.9978, 10.3248, 10.7155,  8.1745,  8.4462,  9.8236,
        12.5457,  9.3174], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 9.4766, 18.1593,  7.2921,  6.9937],
        [ 6.2116,  9.1083, 16.6992,  8.7746],
        [10.4762, 11.4083,  8.8110,  9.1909],
        [10.8174,  8.3555,  9.5909, 17.1616],
        [ 9.1226, 10.2242,  8.4589, 12.5581],
        [11.3396,  4.5004, 13.6341,  4.5316],
        [10.0571, 11.0837,  6.8714,  5.4633],
        [11.1597,  6.9778, 11.5961,  9.7111],
        [15.4955,  8.9175,  5.7107, 17.4746],
        [ 9.4474, 11.9419,  8.2474, 12.7893]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[11.3254, 21.7020,  8.7147,  8.3581],
        [ 7.4235, 10.8853, 19.9570, 10.4865],
        [12.5200, 13.6339, 10.5299, 10.9839],
        [12.9278,  9.9856, 11.4620, 20.5096],
        [10.9023, 12.2189, 10.1091, 15.0080],
        [13.5518,  5.3784, 16.2939,  5.4156],
        [12.0191, 13.2460,  8.2119,  6.5291],
        [13.3368,  8.3391, 13.8584, 11.6056],
        [18.5185, 10.6572,  6.8247, 20.8837],
        [11.2905, 14.2717,  9.8563, 15.2843]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([ 8.9993,  8.7572,  8.5624,  9.8588,  8.6649,  7.3000,  7.1861,  8.4676,
        10.2179,  9.1076], device='cuda:0')
SINR = tensor([ -9.5421,  -9.4236,  -9.3259,  -9.9382,  -9.3776,  -8.6332,  -8.5650,
         -9.2776, -10.0936,  -9.5940], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1000, 0.1025, 0.1046, 0.0921, 0.1035, 0.1205, 0.1222, 0.1056, 0.0891,
        0.0989], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([100, 100, 100, 100, 100, 100, 100, 100, 100, 100], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=100/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
