Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
合計 100 枚の画像をロードしました。20 枚ずつのチャンクで処理します。

--- 処理中: 画像 1 から 20 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 0)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.7532, 0.6074, 0.6583, 0.7701, 0.8240, 0.5942, 0.6361, 0.7517, 0.5557,
        0.6154, 0.4440, 0.5926, 0.5110, 0.4479, 0.4735, 0.6824, 0.6127, 1.1112,
        0.5368, 0.5905], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-9.0573, -7.4142, -7.0073, -6.6359, -9.9513, -6.7670, -6.1690, -3.9910,
        -3.0796, -6.9679, -4.7497, -4.3593, -6.6171, -7.8192, -0.7322, -8.6114,
        -9.1488, -4.9667, -2.3126, -6.3841], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 175.2633+2.8539e-05j,  455.9324-8.6220e-06j,   37.2468-2.1707e-06j,
          19.6693+3.4142e-07j,   64.7950+4.2735e-07j,  258.0131+1.9474e-05j,
         266.8025-5.3739e-07j, 1650.3646+2.9010e-06j,  710.1899-2.7641e-06j,
         789.2976-5.4052e-07j, 1178.5239+1.2308e-05j,  431.6879+2.1262e-05j,
         552.4758+1.5498e-06j,   25.7138+6.6757e-06j,  341.3099+1.5259e-05j,
          86.0422+2.3842e-06j,   73.0074-1.3544e-06j, 1526.3466+3.0518e-05j,
          10.1617+4.5300e-05j,   47.4716+6.5642e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(435.0157775878906+8.580268513469491e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.5977-0.0000e+00j,  0.2221+1.3411e-07j,  0.1721+3.0856e-09j,
         2.2352-3.6410e-08j,  0.3784-1.1577e-09j,  0.2272+2.2045e-08j,
         0.0552-2.1420e-08j,  3.0344-4.8001e-08j, 10.6133-4.1825e-08j,
         2.0099+3.8685e-08j,  1.5635+1.7881e-07j,  3.4305+2.3842e-07j,
         0.2714+1.3039e-08j,  0.9766-1.0431e-07j, 16.8610+3.0452e-07j,
         0.0796-1.4552e-08j,  0.5859+1.5929e-08j,  3.1500+2.3842e-07j,
        16.7791+2.1695e-07j,  0.3220-1.9435e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.178246021270752+5.584565698768529e-08j)
SINR torch.Size([20]) = tensor([-11.0177, -16.1462, -16.4478,  -7.7001, -14.7576, -15.6754, -23.7949,
         -7.8808,  -3.5485,  -8.1275,  -9.1783,  -8.1424, -17.0805, -11.5161,
         -3.2066, -19.5514, -10.8907,  -7.4718,  -2.7325, -14.6497],
       device='cuda:0')
SINR mean = -11.47581958770752
E[H^H] = 1e-07
E_MSE (Error Power) = 30.293073654174805
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0733, 0.0237, 0.0222, 0.1452, 0.0324, 0.0264, 0.0042, 0.1401, 0.3064,
        0.1334, 0.1078, 0.1330, 0.0192, 0.0659, 0.3234, 0.0110, 0.0753, 0.1518,
        0.3477, 0.0331], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 716,  849,  856,  617,  815,  837, 1000,  623,  479,  631,  663,  631,
         870,  730,  467,  925,  713,  610,  450,  812], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -4-----------
Real SNR = tensor([-7.1920, -3.3514, -7.8544, -6.2819, -4.9230, -5.4950, -5.2655, -4.2827,
        -3.5093, -3.5660, -3.6805, -3.1741, -2.0238, -0.7926, -4.3224, -6.9903,
        -5.1786, -4.9268, -6.7929, -7.9587], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([358.4117+5.6179e-07j, 165.3472-1.6980e-06j, 218.1010-1.0630e-05j,
        100.3411+8.4688e-06j, 437.2526+2.8343e-06j, 209.0872-1.0658e-05j,
        109.8177+1.5259e-05j, 126.1647-2.3213e-07j,  54.4205+1.9104e-06j,
         26.6573+1.1368e-06j, 114.8629+3.8147e-06j, 414.8895-4.2465e-06j,
        158.8632-2.1404e-07j, 392.4596-5.2412e-07j,  52.2159+2.2584e-07j,
        192.5081-4.8765e-07j, 131.2111+3.8147e-06j,  45.0761-7.2669e-06j,
        548.4430+3.0518e-05j, 214.4993-5.7220e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(203.53147888183594+1.3432421610559686e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.5368+4.4703e-08j,  2.6040-6.3318e-09j,  0.7028-3.6221e-10j,
         0.6590-2.4046e-08j,  1.0631-1.7550e-07j,  0.6069+1.6496e-08j,
         3.0180+3.4900e-09j,  1.5217-5.3296e-08j,  0.4843+1.0517e-07j,
         1.2233-1.4901e-07j,  1.3489-9.4045e-09j,  3.4768+6.8951e-08j,
        11.7577-2.7350e-07j, 16.5472-3.0750e-08j,  2.0317-9.5665e-09j,
         0.9994-1.2375e-08j,  1.7411+1.5348e-07j,  1.2386+1.7909e-08j,
         0.9108-5.9605e-08j,  0.8310+7.7148e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.665165901184082-1.9291659825171337e-08j)
SINR torch.Size([20]) = tensor([-11.0781,  -6.6238,  -9.7427, -11.3799, -12.3368, -11.2326,  -4.8215,
         -7.6254, -13.9054, -12.1070,  -8.7832,  -5.5203,  -2.2780,  -1.2575,
         -7.9804,  -7.8685,  -8.0568,  -7.7273,  -9.2299,  -8.2098],
       device='cuda:0')
SINR mean = -8.388252258300781
E[H^H] = 1e-07
E_MSE (Error Power) = 8.03386402130127
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0724, 0.1787, 0.0959, 0.0678, 0.0552, 0.0700, 0.2478, 0.1473, 0.0391,
        0.0580, 0.1169, 0.2191, 0.3718, 0.4281, 0.1373, 0.1404, 0.1353, 0.1444,
        0.1067, 0.1312], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([718, 583, 680, 727, 753, 722, 522, 615, 794, 747, 651, 546, 434, 398,
        626, 622, 628, 618, 664, 633], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -3-----------
Real SNR = tensor([-5.8106, -6.5262, -9.6366, -8.2907, -3.4856, -3.3388, -9.2358, -2.3796,
         1.2133, -6.6880, -8.7122, -2.6374, -8.1610, -6.4689, -7.3565, -7.0208,
        -4.2621, -7.3127, -0.8001, -4.3904], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.0398e+00+7.4506e-07j, 1.4168e+01-1.9073e-06j, 4.5095e+01+1.9073e-06j,
        1.0508e+02-1.3258e-07j, 1.0402e+01-4.2915e-06j, 5.7827e+01+1.3629e-06j,
        3.7559e+00-4.2915e-06j, 8.0421e+00-4.7684e-07j, 5.0421e+01+8.4113e-07j,
        3.1708e+02-1.1444e-05j, 6.4141e+01+3.0243e-07j, 1.0592e+02+1.1041e-06j,
        7.5713e+01-1.4960e-07j, 1.0106e+02-9.8450e-07j, 1.0675e+00+1.3113e-06j,
        1.1900e+01-8.1062e-06j, 2.0895e+02+7.6294e-06j, 1.1210e+02-2.5143e-06j,
        2.2594e+01-2.0857e-06j, 1.2431e+03+1.2968e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(127.9737319946289-9.94189463199291e-07j)
torch.linalg.det(H.mH@H) = tensor([0.2787+2.1435e-08j, 0.7392+4.0633e-08j, 0.2516+6.0940e-10j,
        0.1498+1.6030e-08j, 4.4937+1.1176e-08j, 2.1577+1.9021e-08j,
        0.3740-2.5836e-09j, 1.0520-4.1536e-08j, 8.1511+3.3963e-08j,
        0.1693+3.7253e-08j, 0.2590+5.3637e-10j, 1.1184+6.5193e-08j,
        0.2699-2.0942e-08j, 0.7057-2.0547e-10j, 0.2340-1.0176e-09j,
        0.6531-1.4901e-08j, 2.1294-1.1033e-07j, 1.6746+1.7659e-08j,
        4.4798+6.2715e-08j, 0.5486-3.3874e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4944835901260376+5.04153963021281e-09j)
SINR torch.Size([20]) = tensor([-13.7719,  -8.9328,  -9.7509, -14.0403,  -5.6568,  -6.4606,  -8.6638,
         -9.5010,  -3.5878, -14.7425, -10.1693,  -8.8202, -11.6801,  -8.7105,
        -13.9309, -10.6312,  -6.6886,  -7.0041,  -4.0866, -11.1411],
       device='cuda:0')
SINR mean = -9.398538589477539
E[H^H] = 1e-07
E_MSE (Error Power) = 10.40125846862793
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0403, 0.1134, 0.0958, 0.0379, 0.2137, 0.1843, 0.1197, 0.1009, 0.3045,
        0.0325, 0.0877, 0.1160, 0.0636, 0.1186, 0.0389, 0.0796, 0.1765, 0.1662,
        0.2807, 0.0714], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([790, 655, 680, 797, 551, 577, 647, 672, 480, 815, 692, 652, 735, 649,
        794, 705, 585, 595, 497, 720], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -2-----------
Real SNR = tensor([-1.7034, -0.0101, -4.9555, -2.4644, -0.1823, -7.0643, -2.6887, -4.9027,
        -3.1378, -4.5743,  0.5290, -1.2470, -0.1856, -6.3023, -5.8185, -4.0093,
        -5.4099, -2.4730,  0.4372, -3.5822], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 37.4851+5.2917e-07j,  18.6427-2.8473e-08j,   2.6007-2.4736e-06j,
        204.7288-4.2859e-06j,   3.4716+3.3975e-08j,  50.1249+4.8283e-07j,
         56.8538-3.4501e-06j,  56.4924-5.8357e-07j,  27.1735+3.3379e-06j,
        207.1554-1.6458e-06j, 117.4223-3.6175e-06j,   0.9978+2.1458e-06j,
         84.5613-7.6294e-06j,  94.3349+1.9407e-06j,  20.3725-2.0551e-07j,
         65.0399-1.5259e-05j,   8.5065+4.7684e-07j,  33.7035+1.3174e-05j,
         97.3792+6.6747e-06j,  71.1060+3.7337e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(62.90766143798828-5.004750391890411e-07j)
torch.linalg.det(H.mH@H) = tensor([0.8057-8.6020e-08j, 2.5990+9.2586e-08j, 1.3927+6.5543e-09j,
        3.4184-7.5951e-09j, 6.4390-1.1632e-08j, 0.0787+7.4506e-09j,
        1.5554-5.4597e-09j, 1.4833+3.0522e-08j, 0.9961-6.1337e-08j,
        0.5027-5.2154e-08j, 5.6663-1.4338e-07j, 1.2594+3.3083e-08j,
        2.0058+5.9605e-08j, 0.0832+2.9794e-10j, 0.5838-8.8891e-09j,
        0.7403+5.1675e-08j, 0.4011-3.6462e-09j, 2.0185+4.1697e-10j,
        2.4526-1.1176e-08j, 0.2488+8.1956e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7365318536758423-1.357287282566233e-09j)
SINR torch.Size([20]) = tensor([ -8.7061,  -6.5226,  -4.7742,  -2.7850,  -3.5431, -15.6696,  -5.3402,
         -4.7213,  -7.3795, -11.2216,  -2.5131,  -7.6110,  -6.6918, -15.5399,
         -8.3004,  -9.3586, -10.1919,  -4.7250,  -7.7597, -13.2974],
       device='cuda:0')
SINR mean = -7.832589149475098
E[H^H] = 1e-07
E_MSE (Error Power) = 8.507765769958496
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1187, 0.1821, 0.2499, 0.3450, 0.3066, 0.0264, 0.2262, 0.2522, 0.1546,
        0.0702, 0.3592, 0.1477, 0.1764, 0.0272, 0.1288, 0.1039, 0.0873, 0.2520,
        0.1435, 0.0447], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([648, 579, 521, 452, 478, 837, 540, 519, 607, 722, 442, 614, 585, 834,
        636, 668, 693, 519, 619, 778], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -1-----------
Real SNR = tensor([-4.3203,  1.4843, -5.2307, -3.7789, -2.1351, -2.2452, -1.0292, -1.9955,
        -4.3852, -8.1054, -3.5018, -7.3891, -3.5469, -0.6043, -0.1169, -7.5298,
        -2.8633, -5.1254, -2.1869, -1.6718], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([244.4746-1.3957e-06j,   6.8183+2.0421e-07j,  50.8315-2.8610e-06j,
         12.9932+3.1988e-06j, 202.0377+1.1384e-06j, 540.1754+9.3514e-06j,
        127.7284+1.0348e-06j, 167.9376+2.7834e-06j,  29.5991+1.7399e-08j,
         25.3635+3.8968e-08j, 151.1012+3.8147e-05j,  43.0413-2.4815e-07j,
         17.4178-7.9999e-08j,  30.7446+5.9034e-07j,  33.0346+1.6093e-06j,
        111.3624-8.1205e-07j, 123.7808-3.3809e-06j,  26.9387+1.5513e-08j,
         36.8459-1.5497e-06j,  33.4654-7.6294e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(100.78459930419922+2.0086274616915034e-06j)
torch.linalg.det(H.mH@H) = tensor([7.0632e-01+5.9605e-08j, 1.1898e+01-1.6996e-08j, 3.3320e-01+8.6504e-09j,
        8.4514e-02-4.4447e-09j, 2.3196e+00-6.4027e-10j, 1.2352e+00-9.4392e-08j,
        2.9107e+00+4.3987e-08j, 2.6333e-01+4.8335e-09j, 7.6933e-02+1.5011e-09j,
        7.1590e-03-2.0677e-10j, 1.7232e+00+3.3180e-08j, 1.6631e-01-1.9709e-09j,
        4.3893e-01-2.9802e-08j, 3.4323e-01+6.1321e-08j, 1.2979e+00-1.5801e-08j,
        2.1761e-01+2.2920e-09j, 2.0611e+00-2.0731e-08j, 1.8728e-01-7.4506e-09j,
        1.4153e+00-9.9940e-08j, 1.0204e+00-6.9646e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4352821111679077-4.198487779660809e-09j)
SINR torch.Size([20]) = tensor([ -6.8398,   1.0168,  -8.1308, -15.6059,  -3.5686,  -6.2694,  -3.2279,
        -11.4053, -14.1805, -21.2098,  -4.8384,  -9.9344,  -8.0141, -14.2087,
         -6.2870,  -7.8448,  -3.1821, -11.7583,  -6.3699,  -5.9912],
       device='cuda:0')
SINR mean = -8.392507553100586
E[H^H] = 1e-07
E_MSE (Error Power) = 14.664214134216309
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1715, 0.5583, 0.1333, 0.0268, 0.3054, 0.1910, 0.3223, 0.0675, 0.0368,
        0.0075, 0.2471, 0.0922, 0.1364, 0.0366, 0.1904, 0.1411, 0.3246, 0.0625,
        0.1874, 0.2011], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([590, 320, 631, 836, 479, 571, 467, 727, 801, 959, 523, 685, 627, 801,
        572, 622, 466, 737, 574, 562], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 0-----------
Real SNR = tensor([-1.7937, -0.2747, -0.6653,  1.4344, -2.1908, -0.8200, -0.9295,  1.3207,
        -4.5525, -0.8117, -3.3791,  2.0454, -0.9531,  3.1019,  0.1411,  1.3522,
         4.1357, -4.7526,  1.1107, -3.8414], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 42.2474+2.6447e-07j,  50.6474+2.4030e-07j,   6.4263-1.1921e-07j,
         31.5526+1.2477e-07j,  67.2618+2.1756e-07j,  55.8819-1.8953e-07j,
        100.1466-3.7830e-06j,  18.2034-1.1043e-06j,  69.0314+5.8546e-07j,
          1.4641-2.8312e-07j,  86.6134+3.0069e-06j,  67.8526+3.2097e-06j,
         32.2230-3.2445e-07j,  21.7737+3.1419e-07j,  60.1081-2.1156e-07j,
         32.7728-0.0000e+00j, 104.1641-1.4901e-06j,  83.4550+1.1351e-06j,
        138.3603-1.2800e-06j,  42.9708-4.2915e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(55.6578369140625-1.989101292565465e-07j)
torch.linalg.det(H.mH@H) = tensor([5.2393e-03+5.4777e-08j, 1.4176e+00+3.5798e-08j, 2.9070e+00-2.3842e-07j,
        1.0726e+00+1.9175e-07j, 3.5865e+00+1.0357e-08j, 1.9843e+00+5.5976e-09j,
        5.0565e+00+4.0619e-08j, 4.3892e-01-3.6356e-08j, 2.5289e-01+7.2748e-09j,
        2.1298e+00-3.2710e-08j, 3.7298e-01-9.8930e-09j, 5.4933e+00+8.2199e-09j,
        3.1731e-01+1.8070e-10j, 1.7640e+00+1.4360e-07j, 1.6753e+00-9.3348e-09j,
        7.1954e-01+8.7503e-08j, 3.4373e+00+7.3473e-08j, 9.8870e-01+1.2608e-08j,
        4.6401e+00+1.1431e-07j, 1.0094e-01+4.2426e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9180399179458618+2.3180284358659264e-08j)
SINR torch.Size([20]) = tensor([-28.3363,  -4.0984,  -3.6194,  -6.2778,  -1.4311,  -3.4644,  -0.4064,
        -10.6223,  -7.5837,  -3.1813,  -8.0239,   0.2245, -10.1541,  -5.7851,
         -4.2251,  -7.2355,  -3.8315,  -4.0209,  -0.7006, -13.9688],
       device='cuda:0')
SINR mean = -6.337106227874756
E[H^H] = 1e-07
E_MSE (Error Power) = 35.520111083984375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0015, 0.2802, 0.3029, 0.1907, 0.4184, 0.3105, 0.4766, 0.0797, 0.1485,
        0.3246, 0.1362, 0.5129, 0.0880, 0.2088, 0.2743, 0.1590, 0.2927, 0.2838,
        0.4598, 0.0386], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  498,  481,  571,  404,  476,  368,  705,  613,  466,  627,  347,
         692,  555,  502,  602,  488,  495,  379,  795], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 1-----------
Real SNR = tensor([ 0.3458,  3.3820, -3.4530,  1.8065, -3.1221,  3.3158, -0.0163, -4.9178,
        -4.4138, -1.5541,  1.0411, -2.9907,  3.8250,  0.0365,  1.4001, -3.4828,
        -1.2961, -3.3847,  0.6572,  2.7794], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 11.0863+1.8802e-07j,  13.6415-5.9524e-07j, 100.0093-1.4307e-06j,
         21.2793-3.8089e-07j,  32.6212-1.9073e-06j,   4.1695+8.0466e-07j,
          9.9143-1.2354e-06j,   0.2696+1.5360e-06j,   8.7060+3.6513e-07j,
          3.9921-1.8541e-07j,   6.6812+1.5359e-06j,   1.1544-1.8626e-09j,
         41.4515+9.5367e-07j,  27.9707-4.2781e-07j,   3.3975-1.2666e-06j,
         27.2320+4.5252e-07j,  75.7971-2.2234e-08j,   0.9049+1.0107e-08j,
          9.3256+5.4621e-07j,  32.1729-8.1006e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(21.588855743408203-9.356408980920605e-08j)
torch.linalg.det(H.mH@H) = tensor([0.2666+3.8919e-08j, 2.3059+7.2643e-08j, 0.1638+7.4506e-09j,
        1.6321+6.9568e-09j, 0.1124-4.2758e-08j, 3.7209+1.6112e-07j,
        2.0082-8.5917e-08j, 0.2412-1.6260e-09j, 0.2056-1.0380e-09j,
        0.5636+2.9802e-08j, 0.5215-2.1228e-07j, 0.2366-0.0000e+00j,
        9.1149-7.9760e-08j, 1.2337+2.4406e-08j, 0.8006+2.9802e-08j,
        0.8642+2.9012e-08j, 0.5671-9.8980e-09j, 0.4012+3.7253e-08j,
        0.1398+1.8323e-08j, 3.6622-1.9775e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.43809974193573+1.3170478596613577e-10j)
SINR torch.Size([20]) = tensor([-11.1145,  -4.3586, -10.1442,  -2.5592, -14.5065,  -1.2513,  -4.0892,
         -6.9967,  -8.0846,  -6.9974,  -9.6518,  -8.2751,   2.1849,  -4.3025,
         -7.9406,  -3.1590,  -6.4295,  -9.8161, -12.4760,  -1.5725],
       device='cuda:0')
SINR mean = -6.577017307281494
E[H^H] = 1e-07
E_MSE (Error Power) = 6.20187520980835
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0718, 0.2682, 0.0882, 0.3568, 0.0342, 0.4285, 0.2806, 0.1664, 0.1345,
        0.1664, 0.0978, 0.1295, 0.6232, 0.2708, 0.1384, 0.3258, 0.1854, 0.0945,
        0.0535, 0.4105], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([719, 507, 691, 444, 809, 398, 497, 595, 629, 595, 677, 635, 281, 505,
        625, 465, 576, 682, 756, 409], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 2-----------
Real SNR = tensor([ 1.2508,  3.2851,  1.5798,  1.4151,  1.4525,  3.3097,  0.0235, -0.7623,
         1.1070,  2.2445,  1.2407,  0.8098,  3.2651,  0.5803, -2.2428,  3.7789,
         3.5266,  0.4154, -2.3830, -1.9987], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([109.8212+3.2431e-07j,  26.0762-9.8187e-08j,  14.7125+4.7684e-06j,
          5.9429+5.9279e-07j,  27.1542+7.7050e-07j,   1.4833+7.7486e-07j,
          0.7895-7.0148e-09j, 125.0253+1.2752e-06j,   0.3114+2.4616e-07j,
         56.6958-1.1114e-06j,  17.4184-5.2674e-08j,  15.1459+3.0123e-06j,
         77.8143+1.0136e-06j,  30.9602-8.3880e-07j,   8.5678-2.7381e-07j,
          4.1903-9.7580e-08j,   9.6506-4.7684e-07j,   9.2926-8.5682e-07j,
          3.3513-2.4297e-08j,   2.9905-3.5975e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(27.369705200195312+4.4685467059935036e-07j)
torch.linalg.det(H.mH@H) = tensor([2.2997-9.3270e-09j, 2.0257-7.0922e-08j, 3.0608+3.2232e-09j,
        0.5129-5.8411e-07j, 0.3246-1.2206e-09j, 6.2534-1.4182e-07j,
        2.1552+1.7150e-08j, 0.7882+1.0431e-07j, 0.7131-3.7720e-08j,
        0.6810+4.6194e-07j, 0.2268-2.0117e-07j, 4.2433+2.0343e-08j,
        2.1082+9.3132e-09j, 0.0269+5.2620e-08j, 0.7310-3.7924e-09j,
        7.7097+1.9732e-07j, 1.0093-1.2899e-07j, 0.3807-2.0795e-09j,
        0.5180-1.6082e-08j, 0.0182+1.1180e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7893394231796265-1.649473269083046e-08j)
SINR torch.Size([20]) = tensor([ -0.4901,  -2.7038,   1.0081,  -9.1819,  -7.3154,   1.1951,  -0.9940,
         -6.9094,  -6.2912,  -7.0215, -11.2039,   1.6226,  -3.8360, -19.5694,
         -3.7979,   2.3785,  -6.5964,  -6.2746,  -3.5111, -17.3483],
       device='cuda:0')
SINR mean = -5.342024803161621
E[H^H] = 1e-07
E_MSE (Error Power) = 9.570902824401855
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4718, 0.3492, 0.5578, 0.1077, 0.1565, 0.5684, 0.4430, 0.1693, 0.1902,
        0.1657, 0.0705, 0.5923, 0.2925, 0.0109, 0.2943, 0.6336, 0.1796, 0.1908,
        0.3082, 0.0181], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([371, 449, 320, 663, 605, 314, 389, 592, 572, 596, 722, 299, 489, 925,
        487, 275, 582, 571, 477, 876], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 3-----------
Real SNR = tensor([-1.7074, -1.9082,  5.1085, -0.3308, -3.9222, -1.0818, -0.7152,  2.6456,
         4.2187, -0.3332,  2.7608, -0.4181,  3.9021,  3.5448, -0.8355,  0.4008,
         0.3633, -4.5775,  3.7616,  3.6054], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  7.9759+3.3336e-07j,   5.1963-1.5404e-07j,   3.9517-2.3842e-07j,
         10.7131+7.1526e-07j,  60.2719-1.4235e-06j,  62.7448+9.5671e-07j,
          1.2358+2.3842e-07j,  25.1850+4.3947e-07j,   7.4163+1.3103e-07j,
          9.3912-2.4760e-08j,  25.1887-0.0000e+00j,   2.2653+1.6846e-09j,
         22.7003+1.8232e-07j,   0.1577-9.2387e-07j,   1.8097+1.6090e-08j,
          0.6684+5.8682e-09j,  40.5679-3.8968e-07j,   8.5918+1.0133e-06j,
        113.9652+1.8467e-06j,  43.2705+1.3537e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(22.663373947143555+1.4306037598998955e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1003+1.1176e-08j, 0.7360-2.9742e-09j, 2.4282+9.7225e-09j,
        0.5981+6.3169e-09j, 0.5750-0.0000e+00j, 1.0150-1.0320e-09j,
        0.7773-0.0000e+00j, 3.0506+1.4998e-08j, 0.9479-9.6346e-08j,
        0.6694+2.5919e-08j, 2.5834+3.5763e-07j, 0.1541+4.5339e-08j,
        5.4517+1.2333e-07j, 1.7646+4.6397e-08j, 0.2358+2.2352e-08j,
        1.3663+1.6395e-08j, 0.6007+6.0536e-09j, 0.1675-7.6105e-10j,
        4.4307-6.4480e-08j, 1.0309+4.8534e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4341802597045898+2.8428235765431964e-08j)
SINR torch.Size([20]) = tensor([-8.6224, -1.7108, -0.0354, -2.2941, -4.3637, -0.5703, -2.6448,  0.9385,
        -4.2039, -2.1425,  0.2158, -9.8557,  2.7072, -0.7333, -9.4064, -1.0366,
        -6.2630, -5.1955,  0.6903, -4.3544], device='cuda:0')
SINR mean = -2.9440462589263916
E[H^H] = 1e-07
E_MSE (Error Power) = 2.5189480781555176
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1207, 0.4028, 0.4980, 0.3709, 0.2680, 0.4672, 0.3523, 0.5538, 0.2753,
        0.3791, 0.5124, 0.0937, 0.6510, 0.4579, 0.1029, 0.4406, 0.1912, 0.2321,
        0.5397, 0.2684], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([646, 414, 356, 435, 507, 374, 447, 322, 501, 429, 347, 683, 264, 380,
        670, 390, 571, 535, 331, 506], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 4-----------
Real SNR = tensor([ 5.9694, -1.8705,  4.9669,  4.2729,  4.1384, -0.6544,  4.6264,  2.1815,
         2.3427,  1.4134, -1.1574,  5.5803,  5.3389,  4.9816,  3.8127,  0.8708,
         4.2562,  0.2055,  5.9102,  2.4527], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([68.6298-2.5379e-07j,  0.6693+4.6440e-08j,  1.3463-8.3325e-09j,
        11.7172-2.7575e-08j,  0.6997+2.2245e-07j,  2.9330-7.3630e-08j,
        11.4190-5.6861e-07j,  5.9316-1.8421e-07j,  3.2864+2.3313e-09j,
        16.9106+3.8621e-08j,  8.3905-9.1921e-08j, 22.9911+2.9602e-07j,
        18.4103-0.0000e+00j,  6.2263-3.3010e-07j, 30.8743+9.6853e-07j,
         4.3709+8.0372e-08j, 23.8294-4.2777e-07j,  4.6521+1.9045e-07j,
        31.8590-2.3841e-07j, 13.3204+3.3476e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(14.423352241516113-1.2186206488351559e-09j)
torch.linalg.det(H.mH@H) = tensor([1.9855+1.4263e-08j, 0.0257-1.1176e-08j, 2.1178+5.4835e-08j,
        0.4369+2.9802e-08j, 2.2323+6.9815e-08j, 0.2133-0.0000e+00j,
        3.8409+1.8374e-08j, 0.1973+1.0388e-08j, 1.7580+1.5048e-09j,
        0.3245-5.1417e-08j, 0.4498-4.1155e-09j, 1.6978+2.3842e-07j,
        0.8653-4.7800e-08j, 6.1707+9.1137e-08j, 0.5579-1.9514e-09j,
        1.5979-6.4889e-08j, 5.1402+9.1984e-08j, 0.1331-1.7229e-08j,
        5.6677-2.9016e-07j, 1.3743-4.1215e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8393446207046509+4.528379893287138e-09j)
SINR torch.Size([20]) = tensor([ -0.6910, -13.0104,  -1.2983,  -6.1229,   1.5884,  -6.2174,   1.7463,
         -6.9376,   1.5749,  -4.6722,  -1.4060,  -2.1396,  -4.5486,   4.3804,
         -4.4840,   0.6210,   3.5656,  -7.5661,   2.6620,  -0.1173],
       device='cuda:0')
SINR mean = -2.15364146232605
E[H^H] = 1e-07
E_MSE (Error Power) = 2.695497512817383
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4603, 0.0476, 0.4258, 0.1963, 0.5904, 0.1928, 0.5992, 0.1683, 0.5897,
        0.2543, 0.4198, 0.3793, 0.2597, 0.7328, 0.2626, 0.5357, 0.6945, 0.1490,
        0.6486, 0.4932], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([378, 771, 400, 566, 301, 569, 295, 593, 301, 517, 403, 429, 513, 214,
        511, 333, 238, 613, 266, 358], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 5-----------
Real SNR = tensor([ 2.7272,  0.6524,  2.0961,  3.2819,  3.0833,  3.3981,  2.3947,  2.1023,
         3.3390,  4.7634,  4.6014,  4.0371,  5.5960,  4.4443,  0.7249,  1.9642,
         6.8334,  7.8213,  4.8249, -1.4287], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.8493e+00-5.0135e-07j, 1.3396e+00+3.1487e-08j, 1.6869e+00-1.4901e-08j,
        7.7794e+00+5.0918e-08j, 1.2747e+01-1.1765e-07j, 7.5043e+00-1.1116e-07j,
        2.7202e-01-1.4901e-08j, 6.1873e+00-0.0000e+00j, 1.6005e+01+1.0042e-08j,
        6.0875e-01+2.0713e-06j, 8.1135e+00-1.1741e-08j, 7.1275e-01+4.1095e-08j,
        5.4011e+00-9.0343e-08j, 1.3315e+00+8.0466e-07j, 3.5974e+00-9.7574e-09j,
        2.1851e+01+1.4702e-07j, 1.4246e+01+3.4689e-09j, 6.9065e+01-1.2391e-07j,
        1.8556e+01+2.4359e-07j, 3.3182e-02-5.5879e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(10.144365310668945+1.1759823337342823e-07j)
torch.linalg.det(H.mH@H) = tensor([0.4428-6.3895e-10j, 0.6035+9.7621e-10j, 0.4191-4.0643e-08j,
        3.5897+2.1759e-08j, 0.0863+8.5682e-08j, 0.5380+1.1217e-08j,
        0.1103+9.3132e-08j, 0.1758+1.4901e-08j, 0.4225+7.4506e-09j,
        1.8385+1.0015e-07j, 2.9182-6.1811e-08j, 1.4960+2.4913e-08j,
        6.1012-3.2446e-08j, 0.3333-4.4636e-08j, 0.7035-5.3062e-09j,
        2.1507+2.8435e-08j, 4.5496+2.4953e-07j, 9.1842+1.2497e-08j,
        2.6430-4.7793e-10j, 0.2782-5.8559e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.929219126701355+2.2941202715287545e-08j)
SINR torch.Size([20]) = tensor([ -2.5735,  -0.1585,  -3.4820,   4.5123,  -9.9755,  -1.8893, -13.0016,
         -9.4692,  -4.0601,   1.4092,   3.1811,   1.5478,   5.5457,  -4.7528,
         -1.1109,   2.6952,   3.2949,   5.7103,   3.2942,  -2.3573],
       device='cuda:0')
SINR mean = -1.081999659538269
E[H^H] = 1e-07
E_MSE (Error Power) = 2.6162469387054443
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3560, 0.4909, 0.3097, 0.7387, 0.0914, 0.3929, 0.0477, 0.1015, 0.2819,
        0.5804, 0.6753, 0.5882, 0.7819, 0.2508, 0.4364, 0.6504, 0.6811, 0.7883,
        0.6810, 0.3675], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([444, 360, 476, 210, 686, 420, 770, 671, 496, 306, 250, 302, 182, 520,
        393, 265, 246, 178, 246, 437], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 6-----------
Real SNR = tensor([ 6.0727,  4.6072,  2.9111,  3.5577,  6.7146,  3.7903,  6.5211, -0.7320,
         1.8930,  8.2433,  5.2745,  7.8610,  3.1904,  4.6156,  5.2290,  2.5195,
         1.4673,  2.9636,  3.7075,  3.0080], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1545+7.4506e-08j,  9.9060+4.7684e-07j,  0.5710+2.4030e-10j,
         2.9610+1.4581e-08j,  6.6577-1.2314e-07j,  3.9007+1.1921e-06j,
        19.3374+2.0986e-07j,  1.8857-8.6543e-08j,  2.3453+2.3842e-07j,
         9.7619-6.4253e-08j,  1.7259+4.7955e-07j, 21.7874-3.0920e-07j,
         3.5858-1.1921e-07j,  4.0048+5.9653e-07j,  9.4748+2.5107e-07j,
         0.1347+1.5832e-08j, 14.2054+1.8690e-07j,  0.5977-6.6952e-09j,
         6.0594+5.4080e-08j,  0.2324+2.8304e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.964475154876709+1.5548801002296386e-07j)
torch.linalg.det(H.mH@H) = tensor([4.0855+1.6458e-07j, 1.2781+5.9605e-08j, 0.4299+4.4703e-08j,
        0.4065+4.4394e-09j, 3.6118-4.7684e-07j, 0.7859-1.0334e-08j,
        3.6220-1.0047e-07j, 0.1512-2.7940e-09j, 0.0592+1.3970e-08j,
        4.3119-1.9358e-07j, 3.7032-5.6353e-08j, 0.0399+8.8326e-08j,
        0.3218-0.0000e+00j, 0.6259+5.9605e-08j, 1.4259+2.4033e-08j,
        0.3451+1.3411e-07j, 0.2818-2.2135e-09j, 0.6421+1.4865e-09j,
        0.2776-1.4901e-08j, 1.2071+4.1023e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.380614161491394-1.1079850814610381e-08j)
SINR torch.Size([20]) = tensor([  4.5499,   1.5193,  -1.7813,  -3.4976,   2.3140,   0.4099,   5.0977,
         -4.0600,  -9.3393,   4.0403,   5.1049, -16.8122,  -3.2941,  -0.9190,
          1.3637,  -3.4303,  -2.3092,   0.9172,  -4.1768,   1.2705],
       device='cuda:0')
SINR mean = -1.1516226530075073
E[H^H] = 1e-07
E_MSE (Error Power) = 3.704011917114258
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7403, 0.5866, 0.3989, 0.3089, 0.6301, 0.5236, 0.7638, 0.2819, 0.1043,
        0.7171, 0.7641, 0.0204, 0.3190, 0.4473, 0.5779, 0.3122, 0.3701, 0.5526,
        0.2765, 0.5726], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([209, 303, 417, 477, 277, 340, 194, 496, 668, 224, 194, 864, 470, 386,
        308, 474, 435, 323, 500, 311], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 7-----------
Real SNR = tensor([ 4.9601,  4.6453,  6.3379,  6.8567,  5.9345, 11.1369, -1.3935,  2.4273,
         2.1107,  5.1850,  5.9091,  4.1805,  8.4231,  9.4937,  8.9235,  7.3101,
         6.6656,  2.2889,  6.2987,  9.1492], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.9699-0.0000e+00j,  8.2526-1.7038e-07j,  6.7226+1.1805e-07j,
        18.5509-1.1660e-07j,  1.2663-2.9831e-08j, 37.0817-4.5215e-07j,
         3.9100+5.4919e-08j,  7.3672+2.5227e-08j,  1.8635-5.9605e-08j,
         2.1569+5.9605e-08j,  0.2646+8.5697e-09j,  2.8917+1.4025e-08j,
         4.1283+5.7285e-08j, 48.3820+1.7274e-07j,  3.4752-9.3433e-08j,
         6.8276-1.3381e-07j, 14.4787-4.6564e-08j,  2.7947+3.6173e-08j,
         2.0787-4.2622e-09j, 34.7404-1.5450e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(10.710176467895508-3.572640494553525e-08j)
torch.linalg.det(H.mH@H) = tensor([3.2082e+00+1.1941e-07j, 2.7484e-01+4.4703e-08j, 5.9724e-01+1.6520e-07j,
        1.0924e+00+1.8507e-08j, 1.3795e+00-7.1995e-09j, 2.5003e+01-6.6213e-08j,
        9.4690e-02-3.6810e-09j, 1.0844e+00-1.4277e-08j, 9.9788e-02-1.8626e-09j,
        1.6704e+00+9.2799e-09j, 6.0170e-01-3.3707e-08j, 1.0532e+00-5.4187e-09j,
        1.1875e+00-3.2305e-07j, 1.1036e+01-9.4443e-08j, 1.5055e+01-2.5019e-07j,
        3.1011e+00+1.4296e-08j, 4.2238e-03+9.9282e-09j, 2.3396e-01-1.4274e-09j,
        8.0054e-01-2.9802e-08j, 8.6667e+00+2.0963e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.8121979236602783-1.2016397654690536e-08j)
SINR torch.Size([20]) = tensor([  5.0692,  -4.9898,  -1.1682,  -0.0829,   2.7001,  10.2327,  -2.2270,
          2.1244,  -5.3267,   4.4933,  -1.7404,   2.2300,   0.1176,   8.6272,
          8.5158,   5.7979, -22.6051,  -2.4057,  -0.5901,   7.3253],
       device='cuda:0')
SINR mean = 0.8048784136772156
E[H^H] = 1e-07
E_MSE (Error Power) = 9.13425350189209
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7626, 0.2407, 0.4332, 0.4952, 0.6506, 0.9134, 0.3745, 0.6199, 0.2268,
        0.7378, 0.4011, 0.6256, 0.5068, 0.8794, 0.8766, 0.7917, 0.0055, 0.3650,
        0.4661, 0.8438], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([195, 528, 395, 357, 265,  85, 432, 283, 540, 211, 415, 280, 350, 112,
        114, 175, 986, 439, 375, 139], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 8-----------
Real SNR = tensor([ 9.0663,  9.3965,  4.8677,  9.0618,  5.1898,  9.7049,  7.8275, 10.3592,
         7.2835,  6.1688,  9.1760,  9.5229,  1.1995,  7.8016,  6.5128,  4.9541,
         9.5116,  2.2259,  7.0527,  5.3067], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2357+1.0617e-07j, 15.0319+3.1825e-08j,  0.3254+6.9419e-09j,
        14.2534-3.4589e-08j,  0.0903-1.1176e-08j,  5.8853+4.9520e-07j,
         0.1423-2.6077e-08j,  4.5265+2.3842e-07j,  2.9109+1.1921e-07j,
         0.3867+1.6391e-07j, 18.9472-1.2458e-06j,  7.3101+7.0486e-07j,
         1.0291+4.4939e-08j,  0.3121+9.7253e-09j,  0.8351-5.2154e-08j,
         6.1831-4.8614e-09j, 12.2377+1.7227e-07j,  1.7821-6.4546e-08j,
         2.3660+3.5763e-07j,  7.7259-5.6083e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.125834941864014+4.7791179014211593e-08j)
torch.linalg.det(H.mH@H) = tensor([1.4267-3.4819e-08j, 5.1025-8.6329e-08j, 0.2241-2.7863e-10j,
        4.7563-0.0000e+00j, 3.5231-2.5315e-08j, 2.7681-3.3844e-07j,
        1.1115-3.7253e-09j, 6.5010-4.8975e-08j, 2.7701+1.1086e-07j,
        0.3528-1.1921e-07j, 2.0589-1.7882e-07j, 0.5227-8.0939e-08j,
        0.1265+2.4431e-09j, 0.2911+1.7909e-08j, 1.3856+1.4833e-08j,
        0.5217+4.3137e-09j, 1.4438+2.3842e-07j, 0.5976-1.3670e-09j,
        2.0647-9.4156e-09j, 1.1545+7.2447e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.935177206993103-2.6580556422572954e-08j)
SINR torch.Size([20]) = tensor([ 2.7669,  6.9249, -0.7799,  5.8593,  6.8412,  2.6063,  2.9255,  8.4191,
         6.1102, -2.6317,  3.8819, -0.7968, -2.2138, -2.0024,  4.0839,  1.8790,
        -0.1597,  2.9130,  5.2312,  2.9078], device='cuda:0')
SINR mean = 2.7382965087890625
E[H^H] = 1e-07
E_MSE (Error Power) = 0.6537694334983826
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6541, 0.8312, 0.4552, 0.7940, 0.8285, 0.6457, 0.6623, 0.8742, 0.8033,
        0.3530, 0.7097, 0.4543, 0.3753, 0.3867, 0.7192, 0.6065, 0.4908, 0.6617,
        0.7693, 0.6614], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([262, 148, 382, 174, 150, 268, 257, 116, 168, 447, 228, 382, 432, 424,
        222, 291, 360, 258, 190, 258], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 9-----------
Real SNR = tensor([ 7.9318,  4.3540,  8.0361,  6.9212,  9.8115, 11.2525,  5.2681,  6.7379,
        10.3946,  5.5283,  8.9570, 10.1523,  5.3162,  8.6650,  9.9608,  8.2789,
         7.0069, -2.4950,  9.4734,  6.4286], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.3117e-03+1.1302e-08j, 4.0625e-01+6.6004e-09j, 3.6895e+00-7.5340e-08j,
        1.2359e+01-2.0589e-09j, 8.9782e-02-8.1201e-07j, 3.8544e+01+8.5713e-07j,
        1.8638e-01+2.3881e-08j, 1.1691e+01+2.9030e-07j, 1.8148e-01-1.8141e-07j,
        4.1445e+00-1.1921e-07j, 1.6873e+00-0.0000e+00j, 4.6741e+00+7.2863e-08j,
        1.2377e+00-5.9605e-08j, 1.6852e+00-0.0000e+00j, 4.7610e-01+1.0244e-08j,
        2.9587e+00+2.7040e-07j, 3.2970e+00+1.3134e-08j, 4.6878e+00+3.4701e-08j,
        2.9793e+00+4.4138e-08j, 1.2769e+00-4.7183e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.8128204345703125+1.9017315722180683e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.4575+1.4901e-08j,  0.2320-1.4901e-08j,  1.3469+1.9040e-08j,
         1.3698+6.3440e-08j,  2.4610-1.2290e-08j, 16.9836-9.2296e-08j,
         0.0984+2.6077e-08j,  1.2662-1.0801e-08j,  5.4659-1.8056e-07j,
         0.2643-8.9407e-08j,  2.4039+8.4824e-08j,  0.9936+5.9605e-08j,
         0.6831+1.0749e-08j,  3.2191+9.1708e-08j,  0.8570+5.0573e-08j,
         0.6426+9.7360e-09j,  1.2135-2.2549e-09j,  0.1152-1.6589e-09j,
         2.3943-6.1890e-08j,  0.8385+2.8891e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1653239727020264-1.6256951340665182e-09j)
SINR torch.Size([20]) = tensor([-0.3431, -1.1705,  5.1341,  4.3872,  5.4405, 11.3010, -4.9472,  4.7803,
         8.4461, -1.2753,  6.0090,  2.5939,  3.7633,  7.6862,  0.9412,  0.9524,
         3.9405,  0.4752,  6.1379,  3.2794], device='cuda:0')
SINR mean = 3.376599073410034
E[H^H] = 1e-07
E_MSE (Error Power) = 0.619398832321167
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4803, 0.4330, 0.7653, 0.7331, 0.7778, 0.9310, 0.2425, 0.7504, 0.8749,
        0.4271, 0.7996, 0.6450, 0.7040, 0.8544, 0.5540, 0.5546, 0.7125, 0.5273,
        0.8043, 0.6803], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([366, 395, 193, 214, 185,  69, 527, 203, 116, 399, 170, 268, 232, 131,
        322, 322, 227, 338, 167, 247], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 10-----------
Real SNR = tensor([ 5.1678,  9.9237,  6.2676,  5.8153,  4.6924,  7.6128,  4.8674, 11.6894,
         6.2576,  6.2930, 11.8370,  5.6590, 10.2156, 12.3847,  6.3436, 10.4622,
        10.7520,  6.7667, 11.5193,  7.2664], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.4205-3.1621e-08j,  5.2809-3.5295e-08j,  0.3717-6.1618e-08j,
         0.5315+3.5409e-09j,  9.0922+4.3522e-07j,  3.8841-4.8097e-08j,
         1.5494-4.9072e-08j,  8.8614+3.6792e-08j,  0.2618-7.6834e-09j,
         2.5970-3.5146e-08j,  5.1272+4.6120e-07j,  9.9232-1.0830e-07j,
         0.8927+1.4901e-08j,  7.4076-8.1448e-08j,  5.5746+2.2615e-09j,
         1.7310-2.9802e-08j, 14.1794-8.3446e-07j,  6.0069+2.1600e-07j,
         6.0701-9.4403e-08j,  2.2019-1.7881e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.648250579833984-2.1292255070193278e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.4601-1.3101e-09j,  3.6905-3.9564e-08j,  0.8836+2.7437e-08j,
         0.3030-0.0000e+00j,  0.4163-4.3694e-09j,  0.3073-9.3268e-09j,
         0.6143-6.5226e-09j,  2.9694-1.1921e-07j,  0.6584+3.8902e-09j,
         1.5375-3.2533e-08j,  7.5587-7.2678e-08j,  1.4666+6.5664e-09j,
         5.5211+2.2845e-08j, 13.3730+1.1069e-07j,  0.7402+6.5274e-09j,
         7.1536+5.8235e-08j,  0.4407-2.3842e-07j,  3.3344-8.8237e-08j,
         7.0483-6.1143e-08j,  0.5360-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9506466388702393-2.1855809606563525e-08j)
SINR torch.Size([20]) = tensor([ 4.5931,  9.0803,  5.2939,  1.3912,  3.9276,  1.3496,  4.8348,  4.7677,
         4.9925,  7.4560, 10.8009,  6.8264,  9.7689, 12.0156,  3.6197, 10.9114,
        -2.3908,  6.7690, 10.4013,  2.2972], device='cuda:0')
SINR mean = 5.935327529907227
E[H^H] = 1e-07
E_MSE (Error Power) = 0.33617445826530457
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7422, 0.8900, 0.7719, 0.5794, 0.7118, 0.5771, 0.7527, 0.7498, 0.7594,
        0.8477, 0.9232, 0.8280, 0.9046, 0.9408, 0.6971, 0.9250, 0.3657, 0.8262,
        0.9164, 0.6292], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([208, 104, 189, 307, 227, 308, 201, 203, 197, 136,  76, 150,  92,  61,
        236,  75, 438, 152,  82, 277], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 11-----------
Real SNR = tensor([ 9.7108,  8.8018, 10.7604,  9.9581,  4.7873,  9.2826,  9.2995, 10.8150,
        13.0234, 11.0391, 11.4454,  8.4207, 11.2782, 10.5532,  4.3810,  5.9073,
        12.1831, 12.2495, 10.1521, 10.4599], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.6708+1.2056e-07j,  0.0894-2.7940e-08j,  3.8574-1.7547e-07j,
         8.3668-8.4120e-08j,  1.9947+4.4703e-08j,  2.2897-1.2969e-08j,
         0.2198-2.0489e-08j,  1.5655+1.3765e-08j,  4.9611-2.4308e-08j,
         3.6666-3.4345e-08j, 11.6767+1.0904e-07j,  0.9112-7.8670e-09j,
         1.1210-5.6233e-08j,  9.3284+2.9334e-08j,  0.0146+9.3132e-10j,
         2.0429+5.7786e-08j,  6.7348-1.2177e-07j,  0.6654-4.6643e-09j,
         1.9202+4.3499e-08j,  0.6049+4.6194e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.235093832015991+1.556909801081474e-08j)
torch.linalg.det(H.mH@H) = tensor([1.9473e+00-8.5987e-09j, 7.3066e-02+5.7742e-08j, 9.4237e-01+1.7909e-09j,
        4.4733e+00-2.2386e-08j, 6.4660e-02-1.8626e-08j, 1.8082e+00-2.4442e-09j,
        1.0305e+00-5.2154e-08j, 2.8106e+00-3.4397e-08j, 1.1963e+01+1.3728e-07j,
        4.1071e+00-3.9188e-09j, 1.9341e+00-5.4492e-08j, 4.7934e-01+2.2500e-08j,
        6.2866e-01-3.7754e-08j, 9.1137e-01-5.5190e-08j, 5.8644e-02-3.6767e-09j,
        1.9831e+00+5.5216e-09j, 5.8808e-01+3.3007e-08j, 4.6190e-01+2.2774e-08j,
        1.4436e+00+7.5955e-08j, 9.6859e-03+1.4278e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.885928988456726+1.0285292617595587e-08j)
SINR torch.Size([20]) = tensor([  8.1541,  -6.2453,   5.6523,  10.7438,  -5.7336,   7.5504,   5.6272,
          8.6293,  12.7825,  11.0155,   7.5796,   2.8829,   3.3971,   4.3780,
         -1.9258,   8.8706,   0.5565,   1.5602,   6.5017, -16.2692],
       device='cuda:0')
SINR mean = 3.7853944301605225
E[H^H] = 1e-07
E_MSE (Error Power) = 2.5024516582489014
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8673, 0.1919, 0.7861, 0.9223, 0.2108, 0.8505, 0.7851, 0.8794, 0.9499,
        0.9267, 0.8514, 0.6601, 0.6862, 0.7326, 0.3909, 0.8852, 0.5320, 0.5889,
        0.8171, 0.0231], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([122, 570, 179,  77, 553, 134, 180, 112,  52,  73, 133, 259, 243, 214,
        422, 108, 335, 301, 158, 852], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 12-----------
Real SNR = tensor([12.0730,  9.6026,  7.3835, 10.2177,  8.9603, 13.8865, 10.4859,  9.4266,
         8.4345, 14.3680, 12.1084, 11.5939,  6.9309, 13.4801, 12.5087, 10.5638,
         7.3717, 11.5833, 13.4587, 11.9612], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.5846-7.5871e-08j,  0.1231-6.0387e-09j,  0.0632+2.7940e-09j,
         1.0117-4.8976e-08j,  1.2707-1.7662e-07j,  8.8294+3.7784e-08j,
         4.4139+1.0190e-07j,  0.4047+3.0973e-09j,  0.9992+3.4907e-08j,
         5.9370+2.2391e-08j,  4.8397-3.7149e-08j,  5.8823+1.5166e-08j,
         0.1507-2.6708e-09j,  0.1194-3.0500e-08j,  3.4486-8.6786e-08j,
         6.8584-1.1127e-07j,  0.6485-7.4506e-09j, 22.5182-1.4092e-07j,
         5.9530-3.4767e-08j, 11.9762-2.8778e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.301621913909912-4.1437868247840015e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.0175+1.1642e-08j,  0.8638+1.5874e-08j,  0.1306+1.1176e-08j,
         0.8319-2.8264e-08j,  3.8020-3.9983e-08j, 10.5829-9.3042e-08j,
         1.3360-4.8035e-08j,  0.7400-6.5309e-09j,  0.5389-3.1072e-09j,
         2.7450-2.7496e-08j,  3.6175+6.7262e-09j,  4.2764+1.1588e-09j,
         0.1116-1.4170e-09j,  0.7584-4.4826e-07j,  3.5892+1.0995e-08j,
         1.0760+5.3219e-08j,  0.1595+2.2352e-08j,  5.9246+1.9987e-08j,
         6.5171-9.9321e-09j,  6.7136-6.2411e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7166314125061035-3.076740995311411e-08j)
SINR torch.Size([20]) = tensor([-11.8107,   6.8318,  -0.2150,   6.3016,   9.9167,  13.3676,   6.9365,
          6.5512,   6.0501,   8.8063,  10.9896,  10.6663,   1.6841,   1.5757,
          9.1554,   7.6241,  -0.4684,  12.0001,  12.0155,  12.5322],
       device='cuda:0')
SINR mean = 6.525525093078613
E[H^H] = 1e-07
E_MSE (Error Power) = 0.9551488757133484
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0618, 0.8282, 0.4876, 0.8102, 0.9075, 0.9560, 0.8316, 0.8188, 0.8011,
        0.8837, 0.9262, 0.9210, 0.5957, 0.5897, 0.8917, 0.8526, 0.4731, 0.9407,
        0.9408, 0.9471], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([738, 150, 362, 163,  90,  46, 148, 157, 169, 109,  74,  78, 297, 301,
        103, 133, 371,  61,  61,  55], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 13-----------
Real SNR = tensor([ 9.2220,  9.5617, 10.7849, 11.8791, 12.4617, 14.9506, 11.8353, 11.2926,
        14.5281,  8.0946, 10.8647, 10.5799, 15.7897, 11.0760,  7.2097,  7.2001,
         9.1939, 11.0922,  7.0751, 12.5972], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4232+5.9605e-08j,  3.6196+1.1921e-07j,  0.1461-4.6194e-07j,
         1.4734-4.0224e-09j,  0.3768-1.3596e-08j,  5.7888-1.2772e-07j,
         2.9538-6.5303e-09j,  1.7615-7.0750e-08j,  0.0534-2.8555e-08j,
         1.1297-4.4021e-08j,  2.4799+1.7241e-08j,  0.4064+5.9950e-09j,
        11.6170+1.3950e-08j,  7.0933+3.9723e-08j,  0.1146-2.9802e-08j,
         0.6126-2.9802e-08j,  1.6367-2.3933e-08j,  2.1673-2.8197e-08j,
         0.3828+8.0150e-08j,  1.7684-1.4079e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.3002631664276123-2.6720028856175304e-08j)
torch.linalg.det(H.mH@H) = tensor([0.3035-7.4506e-09j, 0.6588+2.9802e-08j, 0.1050+2.3097e-07j,
        3.7708+1.5690e-08j, 0.6742-7.7372e-09j, 1.6010-6.4240e-08j,
        1.1100-3.1292e-08j, 2.4932-1.6784e-08j, 0.6844+1.2579e-09j,
        0.7410-1.1061e-08j, 1.0086+5.0524e-08j, 0.4125+1.0410e-09j,
        7.3750+4.3017e-08j, 1.3960-2.3737e-08j, 0.0607+2.2352e-08j,
        0.5175-1.4901e-08j, 1.0056-5.9790e-10j, 1.6813+7.1480e-08j,
        0.0238+6.5193e-09j, 1.6933+1.0003e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3658055067062378+1.5242658690794997e-08j)
SINR torch.Size([20]) = tensor([ 3.3866,  6.9736, -4.1238, 11.8477,  3.7517,  7.5976,  8.7292, 11.1021,
         4.1557,  7.9922,  7.8044,  5.4648, 13.6088, 10.0284, -3.3012,  6.5211,
         8.8825,  7.9454, -4.4060,  8.4959], device='cuda:0')
SINR mean = 6.122845649719238
E[H^H] = 1e-07
E_MSE (Error Power) = 0.49214956164360046
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6856, 0.8328, 0.2790, 0.9387, 0.7035, 0.8519, 0.8818, 0.9280, 0.7225,
        0.8630, 0.8578, 0.7787, 0.9583, 0.9096, 0.3186, 0.8178, 0.8855, 0.8617,
        0.2661, 0.8761], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([243, 147, 499,  63, 232, 133, 110,  72, 220, 125, 129, 184,  44,  88,
        470, 158, 107, 126, 508, 115], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 14-----------
Real SNR = tensor([10.5713, 14.7426, 12.5504,  9.9069, 10.5090, 10.4787,  8.5701, 11.7210,
         8.9915, 16.4377, 16.3458, 16.3266, 13.5515, 16.2372, 10.9275, 14.6009,
        10.3722,  9.0603, 13.2802, 14.2828], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3433-1.0536e-08j, 8.8076-4.5821e-08j, 2.2186+7.6498e-08j,
        0.5822-0.0000e+00j, 0.8588-1.1495e-08j, 0.4954+2.9802e-08j,
        0.1047+1.1176e-08j, 2.8257-1.4461e-08j, 0.1996+6.3859e-10j,
        6.6031+1.6689e-06j, 2.0824-5.9330e-08j, 3.4100-9.6376e-08j,
        6.3388-8.3762e-08j, 8.7564-2.5818e-08j, 1.3273-7.5165e-09j,
        1.9149+5.3644e-07j, 0.2913+8.9799e-09j, 1.7059+5.9231e-09j,
        9.5921+2.6044e-07j, 3.4679-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.0963008403778076+1.1218550355351908e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.2232+3.9815e-09j,  9.3033+4.9870e-08j,  3.7921-8.5470e-08j,
         0.0687+7.4506e-08j,  0.3917-1.1770e-08j,  0.0626+6.5193e-08j,
         0.0549+7.4506e-09j,  1.0656+1.4915e-08j,  0.0543+6.9849e-10j,
         4.0387-3.5763e-07j,  0.7426-3.5138e-08j,  1.4598+1.7922e-08j,
         3.6884-4.0370e-08j, 11.7451+2.6012e-07j,  0.2376+3.9581e-09j,
         1.3516+4.7684e-07j,  0.0266-3.1836e-09j,  0.6051-3.5953e-08j,
         2.3850+1.0295e-07j,  0.9567+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.112675905227661+2.6189198365500488e-08j)
SINR torch.Size([20]) = tensor([ 4.4996, 14.6286, 13.0026, -1.1983,  7.3026, -2.8948, -2.3093,  9.1425,
        -0.1755,  9.7230,  4.5184,  8.6411, 13.4985, 15.5482,  4.5659,  8.2630,
        -4.2746,  8.4624, 11.4602,  5.1020], device='cuda:0')
SINR mean = 6.375306129455566
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5129319429397583
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7381, 0.9667, 0.9523, 0.4315, 0.8431, 0.3393, 0.3701, 0.8914, 0.4899,
        0.9037, 0.7389, 0.8797, 0.9572, 0.9729, 0.7410, 0.8702, 0.2720, 0.8753,
        0.9333, 0.7640], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([211,  36,  50, 396, 140, 456, 435, 103, 360,  93, 210, 112,  45,  29,
        209, 119, 504, 115,  67, 194], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 15-----------
Real SNR = tensor([17.5928, 14.3741, 10.6623,  7.3586, 12.1738, 15.0888, 10.8226, 15.3152,
        12.9789, 10.2730, 10.6049, 11.8366, 15.5462, 12.5300, 17.1724, 16.7135,
        11.9446, 13.3276, 12.4008, 14.2647], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([18.6434-2.8849e-07j,  0.1200-1.7976e-08j,  0.5857+6.8087e-09j,
         0.3190+4.0492e-09j,  0.8073+5.3836e-10j,  4.0827-2.0862e-07j,
         1.5490+1.2150e-08j,  4.8265+1.3464e-07j,  1.4360+1.1921e-07j,
         0.2886-2.6992e-09j,  0.9004+1.5507e-08j,  3.6901+1.0249e-08j,
         0.5803+2.4337e-08j,  1.0170+1.5349e-08j,  5.4006-1.2227e-07j,
         3.2313-5.1688e-08j,  1.4292+1.4528e-08j,  3.5214-1.1911e-09j,
         0.1783+1.4156e-07j,  0.2863+2.5631e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.6446495056152344+3.1152873614104237e-09j)
torch.linalg.det(H.mH@H) = tensor([11.1269+2.6951e-07j,  0.0539-1.0281e-07j,  0.3057+2.3380e-08j,
         0.2722+1.0089e-09j,  0.8733+7.0147e-09j,  2.1323-0.0000e+00j,
         0.7644+3.1857e-08j,  3.8577-2.6112e-08j,  1.3407-8.9407e-08j,
         0.2652+4.0320e-09j,  0.4261+3.4527e-09j,  1.2883-7.9464e-09j,
         0.5892-1.0607e-08j,  1.3088-1.7437e-08j,  9.0630+3.2543e-08j,
         2.5424-1.0518e-07j,  0.8620-5.9605e-08j,  1.0471-6.6461e-08j,
         0.0914+3.7253e-08j,  0.7417-5.6896e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9476158618927002-6.620604064977442e-09j)
SINR torch.Size([20]) = tensor([16.0168, -4.7742,  6.0127,  8.8172,  9.7233, 10.9197,  8.9491, 13.8684,
        10.4464,  6.8323,  9.1210, 11.4785,  5.7341, 10.9142, 14.2066, 11.0780,
         9.0107,  7.8740, -0.1467,  7.1538], device='cuda:0')
SINR mean = 8.6618070602417
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2915460169315338
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9756, 0.2499, 0.7997, 0.8839, 0.9037, 0.9251, 0.8870, 0.9606, 0.9172,
        0.8282, 0.8909, 0.9336, 0.7892, 0.9251, 0.9634, 0.9276, 0.8884, 0.8597,
        0.4916, 0.8385], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 27, 521, 170, 109,  93,  75, 106,  42,  81, 150, 103,  67, 177,  75,
         39,  72, 105, 127, 359, 143], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 16-----------
Real SNR = tensor([15.2896, 14.3029, 15.5596, 11.8616, 14.1960, 10.3437, 17.1174, 17.4407,
        15.7148, 16.5812, 10.6099, 12.1071, 13.4664, 13.2190, 11.7140, 16.5781,
        17.4457, 16.4448, 19.5694, 17.6024], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.9979+1.4901e-07j,  2.3230-1.7421e-08j,  2.8666-6.7242e-08j,
         0.3929-4.3630e-08j,  0.8722-2.8388e-08j,  0.5729-0.0000e+00j,
        12.9917-7.4760e-08j,  1.1084-6.7974e-08j,  1.5608+1.7881e-07j,
         8.9951+3.4757e-07j,  0.0247+6.4028e-10j,  0.2307-5.2154e-08j,
         0.5629+1.1514e-08j,  1.1482-0.0000e+00j,  0.8736-7.4506e-08j,
         2.3265+5.0816e-08j,  9.3455+1.7970e-07j, 10.4137-1.4335e-07j,
        17.1844+1.8041e-07j,  0.6182-3.4626e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.7704968452453613+2.4720973712533123e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.4696-2.0862e-07j,  1.1315+1.1379e-08j,  1.7018+5.4339e-08j,
         0.1026-1.3262e-09j,  2.8848-2.7996e-08j,  0.1008-4.4703e-08j,
        10.5742-1.5078e-07j,  1.4349+5.1260e-08j,  2.2830+4.1063e-08j,
         6.7989-2.4520e-07j,  0.0165+5.8208e-09j,  0.6748+1.8081e-08j,
         1.8609+2.9613e-08j,  1.0271+1.7930e-08j,  0.2097-1.4901e-08j,
         0.9590+2.3267e-08j,  4.1071-8.4613e-09j,  9.1974-1.1644e-07j,
         8.5275-2.4943e-08j,  0.3012-1.2106e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7181689739227295-3.558382744017763e-08j)
SINR torch.Size([20]) = tensor([ 6.2077, 11.7244, 12.5423,  3.1973, 14.3236,  2.1839, 17.6074, 11.4945,
        13.2016, 14.8528, -3.7331, 11.1017, 13.0194, 11.4060,  5.0105, 11.3424,
        14.9502, 16.9872, 16.6988,  1.7874], device='cuda:0')
SINR mean = 10.295292854309082
E[H^H] = 1e-07
E_MSE (Error Power) = 0.25171294808387756
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8068, 0.9370, 0.9472, 0.6762, 0.9644, 0.6231, 0.9829, 0.9338, 0.9543,
        0.9683, 0.2974, 0.9280, 0.9525, 0.9325, 0.7602, 0.9316, 0.9690, 0.9804,
        0.9791, 0.6015], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([165,  64,  55, 249,  38, 281,  19,  67,  48,  34, 485,  72,  50,  68,
        196,  69,  33,  21,  23, 294], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 17-----------
Real SNR = tensor([18.5773, 16.3413, 14.4384, 14.5867, 14.5643, 18.8948, 17.6684,  8.7966,
        17.4980, 14.7164, 13.6832, 20.3030, 19.0636, 14.1736, 13.6620, 10.9612,
        16.2412, 17.8363, 17.6968, 18.0912], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.3129-1.9058e-07j, 2.3792+1.8971e-08j, 0.9575-1.9081e-08j,
        0.7261-8.7947e-08j, 7.2847-8.2531e-08j, 0.9681+1.6834e-07j,
        3.3463+2.3842e-07j, 0.2868-2.1561e-08j, 4.7166-6.4614e-08j,
        0.0591-2.5961e-08j, 0.0690-3.2941e-08j, 9.6494-6.6894e-08j,
        2.8921+2.6704e-07j, 0.6204-2.8855e-09j, 0.4598-4.1079e-08j,
        0.0601-1.4901e-08j, 2.5642-2.9802e-07j, 4.5564-8.4031e-08j,
        3.7676+5.7578e-08j, 3.9877-7.2203e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.533203125-1.774459512660087e-08j)
torch.linalg.det(H.mH@H) = tensor([1.4662+6.8842e-08j, 2.0541+1.6405e-07j, 0.8242+2.6408e-08j,
        0.7181+3.1886e-08j, 6.3263+7.9938e-09j, 1.1764+8.3043e-08j,
        3.8135-2.6822e-07j, 0.0324+3.0886e-10j, 4.3382-4.1932e-08j,
        0.0309-6.4714e-09j, 0.2884+4.4703e-08j, 6.0711+1.6195e-08j,
        2.0822+4.3089e-07j, 0.5445-2.5819e-09j, 0.6427-3.5401e-08j,
        0.0242-1.8626e-09j, 1.5457+1.7881e-07j, 2.9474+3.9540e-08j,
        4.9643+4.6241e-08j, 5.8955+4.0600e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2893216609954834+3.932541758899788e-08j)
SINR torch.Size([20]) = tensor([10.6475, 14.0956, 12.4753,  9.9866, 16.9033, 10.3826, 14.1683,  3.4250,
        15.9418, -2.6554,  7.9011, 15.5662, 11.6500, 11.4188, 10.1330, -2.0428,
        11.6078, 14.5204, 15.8259, 16.8953], device='cuda:0')
SINR mean = 10.942326545715332
E[H^H] = 1e-07
E_MSE (Error Power) = 0.23459430038928986
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9207, 0.9625, 0.9465, 0.9088, 0.9800, 0.9161, 0.9631, 0.6875, 0.9752,
        0.3517, 0.8605, 0.9730, 0.9360, 0.9327, 0.9116, 0.3845, 0.9354, 0.9659,
        0.9745, 0.9800], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 78,  40,  55,  89,  22,  82,  39, 242,  27, 447, 127,  29,  65,  68,
         86, 426,  65,  37,  28,  22], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 18-----------
Real SNR = tensor([13.4553, 20.3997, 14.8528, 20.1803, 11.6697, 16.7615, 14.5332, 16.9053,
        17.4986, 15.1981, 17.7949, 17.3795, 13.8747, 16.8050, 16.0657, 19.5906,
        21.6742, 21.7704, 19.9613, 17.2460], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1482-7.4506e-09j,  3.1746+1.6764e-07j,  0.8330+1.1921e-07j,
         1.0002+1.7941e-08j,  0.4900-1.3909e-08j,  0.3185+2.5676e-08j,
         0.1959+8.5587e-08j,  1.7670-2.6534e-09j,  1.1459-1.7479e-07j,
         1.9308-0.0000e+00j,  0.6892+2.8446e-08j,  1.8691+1.0853e-08j,
         0.4648+5.0654e-09j,  1.1480+7.5290e-09j,  0.7213+1.4901e-08j,
         0.0277+2.2797e-08j, 17.0383-1.6505e-07j, 15.2912-1.7758e-07j,
         0.2201+2.7159e-08j,  1.0024+4.0808e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.473816394805908+1.6087277066034744e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.0351+3.2596e-08j,  5.8465+7.4506e-08j,  1.1415+2.9802e-08j,
         0.2043+8.7860e-08j,  0.5639+3.7882e-08j,  0.1638+5.1858e-08j,
         0.5018+2.2757e-08j,  1.4171-5.4026e-09j,  0.3783-9.3835e-09j,
         2.0399+4.0996e-08j,  0.3596-1.9459e-09j,  2.1497-7.4099e-08j,
         0.4500+2.7365e-08j,  1.6931-2.9193e-08j,  0.7182-6.7221e-09j,
         0.3573+4.0496e-08j, 12.9019-1.2871e-07j, 19.2354+1.9845e-07j,
         0.0509+2.5843e-08j,  1.6426+8.7427e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.5925452709198+2.11845527786636e-08j)
SINR torch.Size([20]) = tensor([-0.8867, 15.1894, 13.3328,  3.5182, 11.1787,  4.9914, 10.8215, 13.5452,
         7.3899, 15.3002,  8.5726, 15.5080, 10.1513, 15.5279, 10.7696,  7.9929,
        19.7618, 20.3539, -1.7975, 15.1274], device='cuda:0')
SINR mean = 10.817428588867188
E[H^H] = 1e-07
E_MSE (Error Power) = 0.21446137130260468
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4491, 0.9706, 0.9556, 0.6921, 0.9292, 0.7594, 0.9236, 0.9577, 0.8457,
        0.9713, 0.8780, 0.9726, 0.9119, 0.9728, 0.9227, 0.8630, 0.9895, 0.9909,
        0.3980, 0.9702], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([385,  32,  47, 239,  71, 197,  76,  45, 138,  31, 113,  30,  86,  30,
         77, 125,  11,  10, 417,  32], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 19-----------
Real SNR = tensor([18.9838, 18.9624, 19.6172, 17.3047, 16.1895, 16.0061, 16.9155, 14.6552,
        15.4611, 16.5601, 16.8769, 15.7723, 20.8910, 18.9056, 18.8887, 17.0321,
        18.2532, 16.5503, 19.4492, 17.5059], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.5856-2.9802e-08j, 1.3638-7.8595e-08j, 3.8405-5.9883e-08j,
        1.3693-5.9605e-08j, 2.1500+4.1830e-08j, 2.0170+1.1004e-08j,
        2.0714+8.2197e-08j, 0.1723+2.2352e-08j, 0.5755-0.0000e+00j,
        1.2150+9.5163e-08j, 0.7651-5.2337e-09j, 0.2356+2.9933e-08j,
        6.5180-6.8942e-08j, 3.3164-5.4496e-09j, 0.5622+1.7058e-08j,
        1.6762-2.7677e-08j, 7.4388-1.2259e-07j, 3.3990-1.5383e-08j,
        1.7180+2.2084e-08j, 0.1922-7.4506e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1590964794158936-1.1302282665326402e-08j)
torch.linalg.det(H.mH@H) = tensor([3.1881-1.1921e-07j, 0.6410+1.2236e-08j, 4.7727-2.3135e-08j,
        1.9324-3.8734e-08j, 1.4920-9.3498e-09j, 0.3685-1.4901e-08j,
        1.3688-8.4319e-08j, 0.1342-0.0000e+00j, 0.1579-3.7253e-09j,
        2.6084+1.7954e-07j, 0.8669+2.7190e-08j, 0.1657-3.7253e-08j,
        7.7025+2.1876e-08j, 3.3037-1.7352e-08j, 0.0874-1.1516e-08j,
        2.6043+4.5412e-08j, 6.2254-1.8519e-08j, 2.4190-1.5426e-08j,
        3.2447-1.8570e-08j, 0.1318+4.0978e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1707611083984375-4.238741357909248e-09j)
SINR torch.Size([20]) = tensor([16.4619,  9.6290, 18.6048, 16.6621, 14.8168,  9.0487, 14.3196,  5.1955,
         7.8165, 16.2003, 12.9104,  7.0076, 20.3279, 17.7857,  2.7283, 16.7078,
        19.0673, 17.4349, 17.1440,  4.5475], device='cuda:0')
SINR mean = 13.220840454101562
E[H^H] = 1e-07
E_MSE (Error Power) = 0.09179458767175674
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9779, 0.9018, 0.9864, 0.9789, 0.9681, 0.8893, 0.9643, 0.7679, 0.8581,
        0.9766, 0.9513, 0.8339, 0.9908, 0.9836, 0.6521, 0.9791, 0.9878, 0.9823,
        0.9811, 0.7402], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 24,  94,  15,  23,  34, 104,  38, 191, 128,  26,  51, 146,  10,  18,
        264,  23,  13,  19,  21, 209], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 20-----------
Real SNR = tensor([20.4765, 19.0551, 20.1281, 20.6333, 16.1117, 19.5328, 21.9445, 18.3281,
        15.7275, 16.6150, 19.1721, 20.8062, 21.2497, 24.1121, 21.2332, 22.2291,
        21.0349, 13.0031, 20.1243, 16.7385], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.6903+3.8936e-08j, 2.3147-1.7745e-08j, 1.6746+9.1836e-10j,
        4.7698-2.6168e-08j, 2.0154-3.3669e-08j, 4.1531+1.3733e-07j,
        1.4084+1.0127e-07j, 1.1221-5.9605e-08j, 1.2965-1.2845e-08j,
        0.8435+4.9400e-08j, 1.9787+2.0454e-08j, 3.4326+9.8701e-09j,
        0.9140-1.2518e-07j, 5.9307+3.3414e-07j, 2.1783-2.9529e-09j,
        4.2067+1.1275e-07j, 5.4028+1.4242e-07j, 1.0765-2.2352e-08j,
        6.0882+9.8418e-08j, 1.6937-2.6483e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8095431327819824+3.59458489640474e-08j)
torch.linalg.det(H.mH@H) = tensor([4.4512-1.0240e-08j, 3.0418+3.0428e-08j, 1.5198-3.9116e-08j,
        4.8224-3.2483e-08j, 3.9248+6.4298e-08j, 2.2640+3.0700e-08j,
        1.2558-9.0042e-08j, 1.4529+3.5294e-10j, 0.7273-2.3843e-09j,
        0.3515-1.0547e-09j, 2.4915+3.0828e-08j, 3.8362+4.8829e-08j,
        1.4336-2.5366e-08j, 8.2978+4.9421e-08j, 1.9606+5.7011e-08j,
        4.1563-1.0882e-07j, 3.7945+6.6367e-08j, 0.5011+5.9605e-08j,
        4.7156+1.1487e-07j, 0.5113-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.775510787963867+1.216030209860719e-08j)
SINR torch.Size([20]) = tensor([18.4481, 18.8781, 15.4878, 18.8344, 18.9583, 17.1818, 13.7901, 15.1424,
        15.3443, 12.6241, 17.7792, 19.1826, 13.6983, 19.5326, 16.2769, 18.4304,
        17.0849, 12.2144, 19.4720, 12.1709], device='cuda:0')
SINR mean = 16.52658462524414
E[H^H] = 1e-07
E_MSE (Error Power) = 0.024415550753474236
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9859, 0.9872, 0.9725, 0.9871, 0.9874, 0.9812, 0.9599, 0.9703, 0.9716,
        0.9482, 0.9836, 0.9881, 0.9591, 0.9890, 0.9770, 0.9858, 0.9808, 0.9433,
        0.9888, 0.9428], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([16, 14, 30, 14, 14, 21, 42, 32, 31, 54, 18, 13, 43, 12, 25, 16, 21, 58,
        12, 59], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 21-----------
Real SNR = tensor([18.4034, 20.7490, 20.3207, 11.8625, 18.9924, 23.5007, 19.2789, 15.6893,
        17.7451, 20.8038, 15.6653, 20.8446, 20.3218, 22.3344, 22.6391, 16.0926,
        20.9905, 19.3179, 17.0690, 18.4084], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.0300+3.9620e-08j, 3.1343+8.4099e-08j, 0.2053-1.6517e-08j,
        0.0459-4.4263e-11j, 1.5140-1.1921e-07j, 5.4038+6.2069e-08j,
        4.7506-2.3842e-07j, 0.1608-4.8805e-09j, 0.0565+6.9849e-10j,
        1.8448+2.8451e-08j, 0.1048-4.9440e-12j, 0.8162-4.2594e-08j,
        0.0581+7.4257e-09j, 1.1733-2.8263e-07j, 3.9911+5.7173e-08j,
        0.6599+2.7940e-08j, 1.1242+3.1340e-08j, 2.3941-5.9605e-08j,
        0.2556-2.9802e-08j, 1.1558+2.1520e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4439518451690674-2.1668443039857266e-08j)
torch.linalg.det(H.mH@H) = tensor([6.8379e-02-2.3785e-08j, 2.1209e+00+8.1135e-09j, 3.7543e-01+5.3080e-09j,
        3.2425e-02+4.9974e-09j, 9.2491e-01-5.9605e-08j, 5.1483e+00+2.9485e-08j,
        4.3456e+00-4.7684e-07j, 2.1684e-01+2.7334e-09j, 5.2747e-02-2.9802e-08j,
        1.1265e+00+2.7505e-09j, 1.3559e-01+4.7536e-11j, 1.1275e+00+1.2370e-07j,
        2.2612e-03+2.3229e-09j, 2.6563e+00-3.8956e-08j, 5.9251e+00-8.9148e-08j,
        1.9285e-01-3.7253e-09j, 1.7240e+00+5.4500e-08j, 1.4849e+00-5.9605e-08j,
        3.3012e-01-5.9605e-08j, 4.0685e-01+3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4198784828186035-3.016938876498898e-08j)
SINR torch.Size([20]) = tensor([  5.5937,  17.4603,  12.6850,   7.9073,  14.1183,  19.3939,  18.9031,
         12.3330,   4.1029,  15.0835,  11.4553,  15.0790, -10.5882,  17.4516,
         20.4907,   9.4876,  16.3898,  15.8658,  12.9636,  12.0334],
       device='cuda:0')
SINR mean = 12.410479545593262
E[H^H] = 1e-07
E_MSE (Error Power) = 0.635970413684845
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7838, 0.9824, 0.9489, 0.8607, 0.9627, 0.9886, 0.9873, 0.9448, 0.7201,
        0.9699, 0.9332, 0.9699, 0.0803, 0.9823, 0.9911, 0.8989, 0.9776, 0.9747,
        0.9519, 0.9411], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([181,  19,  53, 127,  40,  13,  14,  57, 222,  32,  67,  32, 704,  19,
         10,  97,  25,  27,  50,  60], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 22-----------
Real SNR = tensor([16.8471, 18.3562, 22.0900, 18.1962, 19.5705, 23.2160, 19.4778, 20.2578,
        17.7860, 19.3099, 19.4959, 19.1057, 20.4538, 14.4468, 23.3996, 16.9013,
        21.4566, 19.1399, 21.4951, 20.2919], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.0440-8.8518e-10j, 0.4411+7.4506e-09j, 1.2103+7.2494e-08j,
        0.4378-0.0000e+00j, 1.2552-0.0000e+00j, 4.7644+4.9421e-08j,
        3.2247+7.5477e-08j, 2.6076+7.4695e-08j, 0.8617-3.3788e-09j,
        1.2683-3.2349e-08j, 0.0286+1.6764e-08j, 1.6258+3.1914e-08j,
        2.2763-3.8238e-08j, 0.0212+9.3132e-10j, 1.7883-5.3644e-07j,
        0.1454+2.9802e-08j, 7.0825+4.6978e-09j, 0.4883-6.0726e-10j,
        2.1156-9.8679e-09j, 4.4000+4.4049e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8043498992919922-1.070364419319958e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0115+1.2294e-09j, 0.0875-9.3132e-10j, 0.9754+1.9960e-07j,
        0.8289-0.0000e+00j, 0.8024+1.4901e-08j, 4.4153+9.6210e-08j,
        2.1028+1.4674e-08j, 2.4710-1.5227e-08j, 0.6037-1.4035e-08j,
        1.4773-2.8474e-08j, 0.1409-2.6077e-08j, 1.3699-1.4643e-08j,
        1.8869+1.4387e-08j, 0.0442+5.5879e-09j, 3.0777-3.5763e-07j,
        0.2133+9.5284e-09j, 5.9162-8.8513e-08j, 0.3737-0.0000e+00j,
        1.6001+8.2702e-09j, 4.0232-5.7160e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6210933923721313-1.1914875308605133e-08j)
SINR torch.Size([20]) = tensor([ 2.0602,  6.2315, 15.2252, 16.0032, 16.0415, 21.1645, 19.6215, 18.7167,
        17.3432, 18.9675,  8.4105, 19.2566, 20.1029,  6.4274, 18.2121, 13.2492,
        22.2836, 14.0723, 19.0980, 21.2236], device='cuda:0')
SINR mean = 15.685568809509277
E[H^H] = 1e-07
E_MSE (Error Power) = 0.07073775678873062
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6164, 0.8077, 0.9709, 0.9755, 0.9757, 0.9924, 0.9892, 0.9867, 0.9819,
        0.9875, 0.8740, 0.9883, 0.9903, 0.8146, 0.9851, 0.9548, 0.9941, 0.9623,
        0.9878, 0.9925], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([285, 165,  31,  27,  26,   8,  12,  15,  20,  14, 116,  13,  11, 160,
         16,  47,   6,  40,  13,   8], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 23-----------
Real SNR = tensor([19.5081, 19.9020, 23.2907, 20.1663, 19.9355, 23.2270, 20.7871, 22.1528,
        24.3646, 27.8772, 25.4408, 23.9047, 19.4771, 21.8903, 23.4477, 21.9593,
        21.7296, 21.7444, 21.7985, 25.4859], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3612-9.2743e-10j, 0.5900-4.4703e-08j, 5.9429+1.1129e-08j,
        1.1770+1.0023e-08j, 2.3214-2.0843e-09j, 0.6410-5.1019e-08j,
        0.6576+2.8882e-08j, 0.9925-9.4090e-09j, 3.7060-2.0489e-07j,
        0.0245-9.0042e-08j, 4.8663-3.8171e-10j, 0.4652-1.4716e-08j,
        0.4237-8.2689e-09j, 2.8999+6.2740e-08j, 0.2443+2.8461e-09j,
        1.2532+4.4703e-08j, 2.0458+7.4506e-08j, 0.5034+9.3132e-08j,
        3.8107-2.0452e-09j, 0.0252-8.1956e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.6475895643234253-9.12398157026928e-09j)
torch.linalg.det(H.mH@H) = tensor([0.6213-3.3671e-08j, 0.4637+4.4703e-08j, 4.7896+1.4412e-08j,
        0.8681-1.8707e-09j, 1.9589+1.1637e-08j, 0.8549+1.8781e-07j,
        0.8612-5.9605e-08j, 0.6821-2.7642e-10j, 3.3270-5.0573e-08j,
        0.0371-7.7032e-08j, 4.9225+1.2326e-07j, 1.1637-6.9028e-08j,
        0.6386+5.6686e-09j, 2.8724-2.6267e-08j, 0.0279+1.6310e-07j,
        0.4267+9.6858e-08j, 2.4201+1.4901e-08j, 0.1214+5.5879e-08j,
        2.9760-1.2865e-08j, 0.1539-3.0547e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.509350061416626+4.0779659649103905e-09j)
SINR torch.Size([20]) = tensor([16.6264, 14.3989, 22.2523, 18.9196, 19.2948, 16.0674, 17.1551, 15.9209,
        21.2900, -1.1539, 21.4696, 17.2231, 17.0377, 20.6845, -0.6356, 12.9496,
        19.3202,  5.7332, 21.4066,  4.5819], device='cuda:0')
SINR mean = 15.027114868164062
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1497432440519333
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9787, 0.9650, 0.9941, 0.9873, 0.9884, 0.9759, 0.9811, 0.9751, 0.9926,
        0.4340, 0.9929, 0.9814, 0.9806, 0.9915, 0.4635, 0.9517, 0.9884, 0.7892,
        0.9928, 0.7417], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 23,  37,   6,  14,  13,  26,  21,  27,   8, 395,   8,  20,  21,   9,
        376,  50,  13, 177,   8, 208], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 24-----------
Real SNR = tensor([22.9843, 24.6716, 19.9601, 24.2583, 22.4453, 20.8436, 20.7398, 25.8344,
        23.0468, 24.6570, 24.7758, 22.9091, 23.0167, 25.4374, 28.3158, 19.5869,
        22.9939, 21.0998, 26.5395, 24.0074], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.5212+2.3842e-07j,  0.4417-7.7486e-07j,  0.3956-1.1635e-09j,
         2.1089-3.3886e-08j,  0.8866-4.4703e-08j,  0.3956-1.1005e-08j,
         0.4713+5.8511e-09j,  1.8939-5.5234e-09j,  0.6279+4.3509e-08j,
         1.0183+1.2646e-08j,  6.4962-4.1370e-08j,  0.7942+3.3762e-09j,
         0.6631-1.9766e-07j,  3.3293+2.3842e-07j, 11.5811-2.3577e-07j,
         0.3869+2.2352e-08j,  1.1262-3.7839e-09j,  3.7231-2.4653e-08j,
         6.5413+7.1269e-07j,  2.3717-3.5763e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.3387057781219482-2.2737106419867814e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.9849+5.9605e-08j,  0.1269+5.6997e-07j,  0.2175+1.6294e-09j,
         2.0059+4.4839e-08j,  0.9877-3.7942e-08j,  0.6057-1.8236e-09j,
         0.3743+2.5664e-08j,  2.0240-2.5277e-08j,  0.5280+1.2559e-08j,
         0.9965+4.7886e-09j,  5.9750+5.8150e-08j,  0.7191+1.9101e-08j,
         0.7604+7.0498e-08j,  3.4778-0.0000e+00j, 11.6456+4.7740e-08j,
         0.3968-0.0000e+00j,  1.8585-1.2328e-08j,  3.1317-1.3298e-08j,
         5.7971-5.2137e-07j,  1.9495-1.7881e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.228149890899658+6.184157630428899e-09j)
SINR torch.Size([20]) = tensor([16.4014,  5.1333, 16.4352, 19.8760, 17.8143, 19.1209, 16.2460, 19.6556,
        15.6549, 17.7507, 23.5643, 17.3861, 15.4775, 21.0722, 23.5804, 17.0050,
        21.3342, 22.7192, 22.2014, 19.4230], device='cuda:0')
SINR mean = 18.392578125
E[H^H] = 1e-07
E_MSE (Error Power) = 0.027134716510772705
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9776, 0.7653, 0.9778, 0.9898, 0.9837, 0.9879, 0.9768, 0.9893, 0.9735,
        0.9835, 0.9956, 0.9821, 0.9725, 0.9922, 0.9956, 0.9805, 0.9927, 0.9947,
        0.9940, 0.9887], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 24, 193,  24,  11,  18,  13,  25,  12,  29,  18,   5,  20,  30,   8,
          5,  21,   8,   6,   6,  12], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 25-----------
Real SNR = tensor([22.6226, 24.2187, 23.3901, 25.8712, 21.4204, 26.3477, 23.4827, 20.3083,
        25.2091, 25.3259, 23.2544, 20.4392, 22.0170, 19.8772, 19.6529, 23.1313,
        25.3331, 21.4517, 24.2600, 23.9233], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.4539+9.4168e-08j, 2.8553-1.1489e-07j, 1.3484-2.4770e-09j,
        9.0060+1.7258e-07j, 0.4983+5.9605e-08j, 0.6716+1.0874e-08j,
        1.5251-0.0000e+00j, 1.0551+6.6291e-09j, 1.1910+1.2403e-07j,
        1.3255-1.5235e-09j, 0.4040-2.6054e-08j, 0.2553+7.5884e-09j,
        0.7205-9.1342e-09j, 0.7019-0.0000e+00j, 0.0752+1.4901e-08j,
        1.6668-6.1793e-08j, 0.6217+1.5520e-08j, 1.1821-5.9387e-09j,
        2.2751-8.1218e-08j, 3.4108+7.5054e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.5621851682662964+1.389551851360693e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6092-1.6189e-08j, 3.1667+1.2323e-07j, 1.3157-1.1921e-07j,
        6.7094+1.5237e-07j, 0.3719+4.4703e-08j, 0.8900+6.2126e-10j,
        1.1135-1.7881e-07j, 0.8471-1.5949e-09j, 1.1982+3.7781e-08j,
        1.3946-1.8238e-08j, 0.5310-1.9471e-08j, 0.3214-6.4558e-09j,
        0.9485+1.6560e-08j, 0.3400+4.4703e-08j, 0.1911-7.4506e-09j,
        1.6769+3.2966e-09j, 0.6824+1.5811e-08j, 1.0415-3.5021e-09j,
        2.1663+1.3568e-08j, 3.1470-5.6251e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4331172704696655+1.273457117534349e-09j)
SINR torch.Size([20]) = tensor([17.0877, 22.0271, 20.2668, 25.2145, 13.4279, 16.5553, 18.4711, 19.3352,
        19.4317, 20.6275, 18.0569, 18.0679, 21.1817, 16.0665, 14.9284, 22.3870,
        17.6215, 20.5851, 23.0245, 23.8801], device='cuda:0')
SINR mean = 19.412235260009766
E[H^H] = 1e-07
E_MSE (Error Power) = 0.012942942790687084
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9808, 0.9938, 0.9907, 0.9970, 0.9566, 0.9784, 0.9860, 0.9885, 0.9887,
        0.9914, 0.9846, 0.9846, 0.9924, 0.9759, 0.9689, 0.9943, 0.9830, 0.9913,
        0.9950, 0.9959], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([21,  7, 10,  3, 46, 24, 15, 13, 12,  9, 17, 17,  8, 26, 34,  6, 19,  9,
         5,  4], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 26-----------
Real SNR = tensor([22.9760, 24.1394, 28.1792, 23.8175, 30.7259, 23.8191, 24.4743, 30.1692,
        25.1378, 25.4012, 26.1304, 25.1442, 28.9429, 21.8610, 27.3324, 26.2046,
        24.2016, 21.5888, 22.9722, 22.5551], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.8846-1.2888e-07j,  1.9783+2.8124e-08j,  0.3823-4.7129e-07j,
         0.4401+7.0929e-09j,  1.3714+7.3002e-08j,  1.6681+4.1402e-08j,
         0.7109-3.5935e-08j,  2.3281-1.6721e-08j,  0.7098-6.8327e-09j,
         2.5166-9.5710e-09j,  6.6836+1.3027e-07j,  0.5777+6.5543e-09j,
        18.1725-4.7846e-07j,  0.3521+1.4520e-09j,  2.6917-1.3949e-09j,
         0.4195+2.9718e-08j,  1.6273-8.9374e-09j,  0.1137-2.9642e-09j,
         0.0667+3.0961e-09j,  0.3833-3.4808e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.203920841217041-4.218801663569138e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.8614+5.9677e-08j,  2.0764-4.7414e-08j,  0.1378-6.0683e-08j,
         0.1761+9.5478e-11j,  1.5765-4.1397e-07j,  1.6490+4.4965e-08j,
         0.7939-3.2128e-09j,  2.8688+6.1549e-08j,  1.1935-3.4968e-08j,
         2.2451-1.3030e-07j,  6.0774-5.9216e-08j,  0.6706+5.1583e-08j,
        18.8639+4.7265e-07j,  0.5235-1.0811e-08j,  3.5420-3.2356e-08j,
         0.1727+3.2154e-08j,  1.8625-6.3745e-09j,  0.1541+4.6680e-09j,
         0.2206+7.7676e-10j,  0.6820-1.3070e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3174009323120117-4.212769688649587e-09j)
SINR torch.Size([20]) = tensor([19.6417, 23.3598,  7.7187, 15.7144, 18.4185, 23.1212, 21.5243, 21.3219,
        21.3876, 22.5847, 26.6582, 19.0410, 28.9825, 20.3582, 24.0724, 13.4554,
        21.7862, 16.4859, 16.3324, 19.8796], device='cuda:0')
SINR mean = 20.09222412109375
E[H^H] = 1e-07
E_MSE (Error Power) = 0.018595805391669273
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9893, 0.9954, 0.8554, 0.9739, 0.9858, 0.9951, 0.9930, 0.9927, 0.9928,
        0.9945, 0.9978, 0.9877, 0.9987, 0.9909, 0.9961, 0.9568, 0.9934, 0.9780,
        0.9773, 0.9898], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 12,   5, 131,  28,  16,   5,   8,   8,   8,   6,   2,  14,   1,  10,
          4,  45,   7,  24,  25,  11], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 27-----------
Real SNR = tensor([23.7539, 21.4907, 25.3426, 26.8980, 25.2104, 24.5174, 29.0615, 28.5407,
        29.1663, 25.8571, 26.1590, 26.5156, 23.7036, 20.2848, 26.8136, 28.0913,
        22.4227, 22.9682, 24.3305, 26.8313], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.5695e-01+2.9802e-08j, 6.0394e-01-1.7299e-08j, 1.8122e-01-1.5731e-08j,
        1.8763e-01+5.9605e-08j, 2.4166e+00+3.5477e-08j, 2.0949e+00+7.7808e-09j,
        4.6425e+00+8.0945e-09j, 4.6639e-01-2.1103e-07j, 3.5956e+00+1.4287e-07j,
        2.5760e+00+6.5957e-08j, 1.0996e+00-1.1921e-07j, 4.9279e-01-5.2154e-08j,
        4.5411e-02-1.0451e-09j, 1.5802e-03-5.0199e-09j, 2.4354e+00+1.1921e-07j,
        4.5280e+00-2.6825e-07j, 3.1938e-01+4.8289e-09j, 8.6120e-01-1.3953e-08j,
        7.4336e-01+1.4901e-08j, 4.5981e+00+1.0092e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.6123346090316772-1.0253585536190712e-08j)
torch.linalg.det(H.mH@H) = tensor([0.3639-1.4901e-08j, 0.4768-4.0304e-09j, 0.1564-5.0749e-08j,
        0.3116-7.4506e-08j, 2.0233+8.6314e-08j, 1.3446+8.1553e-09j,
        3.6168-7.4557e-08j, 0.6679+1.2024e-07j, 3.4941-3.4674e-08j,
        2.6664+3.2018e-08j, 0.9315-0.0000e+00j, 0.3800-1.4901e-08j,
        0.0743+2.0932e-08j, 0.0057-5.7926e-09j, 2.4965-2.1819e-08j,
        4.3344-1.2749e-07j, 0.2693-1.1986e-08j, 1.0107+1.2732e-08j,
        0.4421+7.4506e-09j, 3.5660+3.3628e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4316197633743286-5.696821681056008e-09j)
SINR torch.Size([20]) = tensor([17.3565, 21.4878, 12.9870, 16.4511, 23.8297, 21.9691, 25.1184, 16.8564,
        24.6232, 24.5954, 21.3735, 17.0257, 13.5515,  5.3020, 23.6363, 25.1390,
        19.0815, 22.2852, 18.9895, 25.0344], device='cuda:0')
SINR mean = 19.834665298461914
E[H^H] = 1e-07
E_MSE (Error Power) = 0.02553705684840679
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9820, 0.9930, 0.9521, 0.9779, 0.9959, 0.9937, 0.9969, 0.9798, 0.9966,
        0.9965, 0.9928, 0.9806, 0.9577, 0.7722, 0.9957, 0.9969, 0.9878, 0.9941,
        0.9875, 0.9969], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 20,   8,  50,  24,   4,   7,   3,  22,   4,   4,   8,  21,  45, 188,
          5,   3,  13,   6,  14,   3], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 28-----------
Real SNR = tensor([26.4589, 27.3993, 22.4666, 25.6060, 27.9730, 22.4655, 30.5937, 30.8212,
        27.1869, 28.0589, 29.6779, 22.9143, 24.1150, 20.8494, 25.9448, 29.1419,
        26.2319, 22.9994, 27.0562, 23.5112], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2505-4.4703e-08j,  1.1118-6.6466e-08j,  0.2110+5.1588e-09j,
         1.5850-2.1569e-08j,  3.3579+8.3447e-07j,  0.0909+1.7976e-09j,
        18.4174+3.4980e-07j,  1.2327-5.0596e-09j,  1.3081+1.1090e-08j,
         2.3899-1.0720e-07j,  0.8975+9.2931e-08j,  0.3323-3.6286e-09j,
         0.5504-4.0425e-09j,  0.0245-2.7940e-09j,  3.5071-8.3447e-07j,
         7.6808+1.0625e-07j,  1.2349-5.9605e-08j,  0.2730-1.4901e-08j,
         0.2736+2.9802e-08j,  0.4838+3.5897e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.2606513500213623+1.3522785557995576e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3796+1.1543e-08j,  1.0220+1.5882e-09j,  0.2146+7.0646e-10j,
         1.6741-2.3895e-08j,  4.0824-4.7684e-07j,  0.0877-7.0337e-11j,
        17.4485+1.0468e-08j,  1.7815+2.3179e-08j,  0.9635-9.2302e-09j,
         2.4853-2.6869e-08j,  1.1734-5.1062e-08j,  0.3924+4.2453e-09j,
         0.4532-1.2649e-09j,  0.0336-3.7253e-09j,  3.0484+4.7684e-07j,
         6.2051+2.0624e-08j,  1.3620+1.1921e-07j,  0.4117+5.9605e-08j,
         0.3528+2.8312e-07j,  0.4176+1.3495e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1994714736938477+2.097619322682931e-08j)
SINR torch.Size([20]) = tensor([17.1432, 21.5186, 19.8204, 24.4086, 24.0333, 17.5015, 30.4384, 21.6030,
        21.9547, 25.4612, 21.8273, 22.4854, 21.3385, 13.4238, 22.7355, 28.1680,
        23.1431, 19.9777, 16.7090, 21.5526], device='cuda:0')
SINR mean = 21.762189865112305
E[H^H] = 1e-07
E_MSE (Error Power) = 0.008975351229310036
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9811, 0.9930, 0.9897, 0.9964, 0.9961, 0.9825, 0.9991, 0.9931, 0.9937,
        0.9972, 0.9935, 0.9944, 0.9927, 0.9565, 0.9947, 0.9985, 0.9952, 0.9900,
        0.9791, 0.9931], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([21,  8, 11,  4,  4, 19,  1,  7,  7,  3,  7,  6,  8, 46,  6,  1,  5, 11,
        23,  8], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 29-----------
Real SNR = tensor([31.3246, 30.9942, 29.9284, 24.7680, 27.5532, 25.9748, 26.8617, 31.6589,
        27.9512, 26.6529, 29.2808, 30.5177, 28.5679, 25.0303, 23.7555, 31.8679,
        32.9797, 28.9130, 29.1747, 24.9286], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.7454-2.5385e-07j, 1.8090+5.9605e-08j, 6.5881-1.0333e-07j,
        0.3100+7.4506e-08j, 0.7374-4.8646e-11j, 0.7885+1.4901e-07j,
        0.7508+2.9006e-08j, 8.2261-1.1890e-07j, 2.2212-3.5763e-07j,
        0.3724+1.3563e-08j, 0.8275-2.1612e-07j, 3.1806-3.0252e-07j,
        0.7239+1.0431e-07j, 0.3125+4.5217e-09j, 0.7980-3.8922e-09j,
        3.0137-7.6338e-08j, 1.6944+6.1331e-07j, 0.2810-1.1921e-07j,
        0.8197+1.6800e-08j, 0.3807+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.079045057296753-2.2869919291679253e-08j)
torch.linalg.det(H.mH@H) = tensor([7.0294+1.1970e-07j, 1.8768+2.3842e-07j, 6.7652+9.7757e-08j,
        0.2048-8.1956e-08j, 0.5826+3.1646e-09j, 0.6133-8.9407e-08j,
        0.7414-1.1566e-08j, 9.5518+5.7630e-08j, 2.6255-2.0828e-09j,
        0.4787-1.4465e-09j, 0.8050-1.2588e-07j, 2.5733-4.0595e-07j,
        0.8390-0.0000e+00j, 0.3338+2.6176e-10j, 0.9777-5.4658e-09j,
        3.1232+2.6071e-07j, 2.4675-9.6526e-08j, 0.5237-3.7253e-08j,
        0.8447+1.6050e-08j, 0.3205-7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.163891553878784-3.5651523955237963e-09j)
SINR torch.Size([20]) = tensor([28.0722, 23.3647, 29.5263, 17.9094, 22.2397, 21.8643, 23.8239, 29.2129,
        26.1346, 22.0084, 20.6017, 24.9818, 22.6974, 20.8887, 23.9399, 24.9873,
        23.3126, 19.6809, 22.7047, 20.7621], device='cuda:0')
SINR mean = 23.4356689453125
E[H^H] = 1e-07
E_MSE (Error Power) = 0.005204468499869108
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9984, 0.9954, 0.9989, 0.9841, 0.9941, 0.9935, 0.9959, 0.9988, 0.9976,
        0.9937, 0.9914, 0.9968, 0.9947, 0.9919, 0.9960, 0.9968, 0.9954, 0.9894,
        0.9947, 0.9917], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 1,  5,  1, 18,  6,  7,  4,  1,  2,  7,  9,  3,  6,  9,  4,  3,  5, 12,
         6,  9], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)

--- 処理中: 画像 21 から 40 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 20)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5159, 0.4950, 0.6478, 0.5684, 0.4895, 0.5508, 0.6202, 0.6527, 0.5857,
        0.6284, 0.7064, 0.7388, 0.7715, 0.6258, 0.9953, 0.6690, 0.7055, 0.8390,
        0.6214, 0.6514], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -8.1812,  -9.6009,  -5.9139,  -7.2014,  -7.7714,  -3.7798,  -5.7385,
         -6.9090,  -2.4886,  -2.9792,  -1.5040,  -4.6519,  -7.4184,  -1.9603,
        -13.1978,  -7.8356, -10.2522,  -7.5382,  -6.7270,  -8.3514],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([308.8606-2.8180e-06j, 785.6017-1.0646e-06j, 271.4426+3.3473e-06j,
        283.9842+2.2888e-05j, 950.9025+1.5353e-05j, 431.5081-9.9442e-06j,
        465.5605-5.0503e-06j, 150.3602-9.9231e-06j, 302.1095+2.1205e-05j,
         89.4029+7.6294e-06j,  21.1088-7.6016e-09j, 203.9071-6.4110e-06j,
        145.7743+1.9073e-05j,  93.6068+3.4784e-06j, 562.8186+3.1476e-06j,
          6.8231-4.1847e-07j,  20.5008-1.2687e-07j, 336.7167-3.6159e-06j,
         79.9150+3.8147e-06j, 175.1872-1.4765e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(284.3045349121094+2.954014235001523e-06j)
torch.linalg.det(H.mH@H) = tensor([ 1.6407-4.4966e-09j,  0.1907-2.1125e-09j,  1.2328+3.2842e-08j,
         1.5046+1.4185e-08j,  1.2772+3.4067e-08j,  2.9409+1.1485e-07j,
         0.9125+2.9802e-08j,  0.5476-0.0000e+00j,  1.2518+1.8881e-08j,
         1.3203+2.7519e-08j,  7.5835-4.7118e-08j,  0.5994+2.2948e-08j,
         0.0712+9.3039e-09j, 10.1141+1.0666e-07j,  0.5318-1.1786e-08j,
         0.5168-0.0000e+00j,  0.0617+1.7625e-09j,  1.7324-6.0960e-09j,
         1.2016+1.5286e-08j,  0.5457+6.4151e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7888649702072144+1.8145527747037704e-08j)
SINR torch.Size([20]) = tensor([ -7.3836, -13.4536,  -9.9623,  -7.9075,  -8.9215,  -7.7253, -12.4082,
        -12.7116, -11.4053, -11.1540,  -5.7401, -13.1512, -20.5461,  -4.2152,
        -10.4282, -13.1072, -17.7990,  -7.9181,  -9.0384, -10.1572],
       device='cuda:0')
SINR mean = -10.756672859191895
E[H^H] = 1e-07
E_MSE (Error Power) = 17.44881248474121
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1544, 0.0432, 0.0916, 0.1393, 0.1136, 0.1445, 0.0543, 0.0508, 0.0675,
        0.0712, 0.2105, 0.0462, 0.0087, 0.2748, 0.0831, 0.0466, 0.0163, 0.1390,
        0.1109, 0.0880], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([607, 782, 686, 624, 655, 618, 755, 763, 727, 720, 553, 774, 945, 502,
        700, 773, 887, 624, 659, 692], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -4-----------
Real SNR = tensor([ -3.5237,  -7.0646,  -4.6814,  -2.5579,  -3.4001,  -5.3232,  -3.9693,
         -4.0132,  -3.3844,  -4.1135,  -4.5172,  -7.1293,  -4.9712,  -4.5355,
         -5.1609,  -0.6256,  -2.9101, -11.8792,  -4.3833,  -5.3454],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 157.2907-1.3291e-07j,  337.7944-3.8338e-06j,  188.7360+7.5092e-07j,
        1200.6056-6.2437e-08j,   94.9636-2.4389e-06j,   70.5156+1.1723e-07j,
          11.4786+2.3277e-06j,   41.9715+5.7220e-06j,   30.3307-0.0000e+00j,
          31.5412+8.5831e-06j,   78.9566+5.7220e-06j,  128.4192-1.8539e-06j,
         591.4844-7.1275e-06j,   25.8071+5.1509e-06j,   23.9822-1.7936e-06j,
         113.4050-5.3245e-06j,   15.9700-7.9617e-06j,  157.2753-2.1820e-06j,
         384.0087-1.1870e-05j,  108.4761+9.8508e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(189.65061950683594-7.611084242853394e-07j)
torch.linalg.det(H.mH@H) = tensor([ 1.7063-1.5912e-08j,  0.3351+6.9633e-10j,  0.6395-4.2173e-08j,
         0.4880+2.2352e-07j,  3.3172-6.6329e-08j,  1.1395+5.9605e-08j,
         2.5566+4.6469e-08j,  3.6833-0.0000e+00j,  3.6363-3.5183e-08j,
         0.0453-4.1615e-08j,  4.5944-5.4640e-09j,  0.8224-1.9888e-08j,
         4.9033+8.5687e-08j,  0.5611-1.0403e-07j,  1.8508-9.3430e-08j,
        16.6653-3.0146e-07j,  1.9389-9.4282e-09j,  0.0279+6.5358e-10j,
         3.7734+2.9396e-08j,  0.3955+2.7354e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6540045738220215-1.3077037230857513e-08j)
SINR torch.Size([20]) = tensor([ -7.3436, -12.2750, -11.3746, -16.8928,  -5.4254, -10.4337,  -6.2116,
         -6.0663,  -5.4578, -23.8887,  -4.6937,  -8.5583,  -4.4847, -11.6141,
         -7.5309,  -1.9534,  -7.5154, -17.8382,  -5.0784, -14.4000],
       device='cuda:0')
SINR mean = -9.451830863952637
E[H^H] = 1e-07
E_MSE (Error Power) = 23.191320419311523
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1557, 0.0559, 0.0679, 0.0200, 0.2228, 0.0830, 0.1931, 0.1983, 0.2215,
        0.0041, 0.2534, 0.1223, 0.2626, 0.0645, 0.1501, 0.3894, 0.1505, 0.0162,
        0.2370, 0.0350], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 606,  751,  726,  866,  543,  700,  569,  564,  544, 1000,  518,  644,
         511,  733,  612,  423,  611,  887,  531,  806], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -3-----------
Real SNR = tensor([-11.7827,  -0.2808,  -5.3508,  -2.9935,  -5.2278,  -6.1263,  -4.2835,
         -5.2100,  -4.8102,  -1.3079,  -6.3651,  -0.0344,  -2.5126,  -2.7843,
         -2.9442,  -2.3283,  -3.0229,  -6.7583,   0.4388,  -4.9668],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 205.7584+3.4729e-06j,   13.9971+1.6689e-06j,  810.6669-9.7580e-06j,
          15.3359+1.9027e-06j,    2.0822+2.6822e-07j,   97.3946+1.9073e-06j,
        1104.5486-9.3420e-06j,  292.3843-1.1781e-05j,   32.4782-4.6158e-07j,
         117.3214-5.3377e-06j,   24.5005+2.2383e-07j,  292.6842-2.6967e-06j,
          88.5113+4.0310e-07j,   45.5844-1.0312e-05j,  454.7226+7.6453e-06j,
          60.0081-2.1915e-07j,  432.4265-2.1280e-06j,  223.5535-7.8760e-07j,
         145.0359-3.8109e-06j,  161.4035+3.8908e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(231.01988220214844-1.7625845885049785e-06j)
torch.linalg.det(H.mH@H) = tensor([0.0770+1.6792e-09j, 2.8392+6.5956e-09j, 0.7894-7.4506e-09j,
        1.8710-4.1906e-08j, 0.5342+1.4901e-08j, 0.9286-1.3541e-08j,
        0.1688-4.0978e-08j, 0.4863-4.4703e-08j, 0.3090+5.1885e-08j,
        0.7035-1.1002e-08j, 0.8639+1.4689e-09j, 7.1375+1.5674e-08j,
        5.1532-2.3842e-07j, 2.4699+6.7055e-08j, 2.0070+4.9776e-08j,
        4.5836+5.9605e-08j, 1.5041+2.9802e-08j, 0.4921-1.6816e-08j,
        3.1128-2.6006e-07j, 1.1883+8.4058e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8609650135040283-1.840114371987056e-08j)
SINR torch.Size([20]) = tensor([-12.4864,  -6.8607, -10.1410,  -7.1124, -10.9605,  -7.9254, -15.9626,
        -13.1406, -12.8406, -13.5397,  -7.7736,  -3.8269,  -5.7824,  -7.1146,
         -5.2224,  -6.2779, -10.1374, -10.0767,  -6.8296,  -7.1651],
       device='cuda:0')
SINR mean = -9.058833122253418
E[H^H] = 1e-07
E_MSE (Error Power) = 10.132501602172852
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0534, 0.1708, 0.0883, 0.1628, 0.0742, 0.1388, 0.0247, 0.0463, 0.0494,
        0.0424, 0.1431, 0.2929, 0.2089, 0.1627, 0.2310, 0.1907, 0.0883, 0.0895,
        0.1719, 0.1611], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([757, 590, 691, 598, 715, 624, 844, 774, 766, 784, 619, 488, 555, 599,
        536, 571, 691, 689, 589, 600], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -2-----------
Real SNR = tensor([-5.3737,  0.4417, -1.3656, -2.0140, -6.0170, -2.6970, -2.7218,  2.3609,
        -3.5642, -3.4627, -3.8672, -3.7035, -4.4857, -4.3763, -8.0868, -1.6814,
        -4.6844,  0.9134, -2.3145, -3.8491], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([136.6724-4.4603e-07j,  27.8126-4.7684e-06j, 583.4682+1.2980e-05j,
         73.0714-8.5831e-06j,  27.5062+9.5907e-07j,  20.8173+2.6505e-08j,
          1.7855+2.0862e-07j,  13.2775-7.8762e-08j,  39.9070+5.1019e-06j,
        185.6721+1.5642e-07j,  70.7926-6.2380e-07j, 575.4351-3.1527e-06j,
        228.5336-2.3546e-06j, 298.2076-9.4857e-06j, 212.7243+5.9683e-07j,
          8.6407-9.7273e-07j,  21.4807-1.9073e-06j, 149.0046-2.5460e-06j,
         87.4364-2.4734e-06j, 163.1918+1.5064e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(146.27188110351562-8.606484129813907e-07j)
torch.linalg.det(H.mH@H) = tensor([0.7594+5.4160e-09j, 3.2915+4.4836e-08j, 1.1506-6.8898e-08j,
        0.6501-1.2649e-07j, 0.0167+7.4506e-09j, 0.5023+1.4001e-08j,
        0.4952-7.4073e-08j, 6.8515-1.3474e-07j, 0.5461-2.4060e-08j,
        0.7896-1.0847e-08j, 1.9355-1.7466e-08j, 0.1769-3.3528e-08j,
        2.5978+2.8884e-08j, 2.9992-2.7707e-08j, 0.4991+1.4901e-08j,
        2.9568+7.8005e-08j, 1.0386+2.2378e-08j, 1.4451-1.8640e-10j,
        0.3642-2.1153e-08j, 0.8824+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4974335432052612-1.0203133449238067e-08j)
SINR torch.Size([20]) = tensor([ -6.1430,  -4.4542,  -8.6307, -10.0971, -22.9429, -10.7785, -10.6479,
         -4.3973, -10.2524,  -7.0059,  -4.9407, -16.1712,  -3.9220,  -4.3434,
         -9.9072,  -5.6601,  -7.9191,  -7.7348, -11.8097,  -7.9683],
       device='cuda:0')
SINR mean = -8.786306381225586
E[H^H] = 1e-07
E_MSE (Error Power) = 16.888450622558594
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1955, 0.2639, 0.1205, 0.0891, 0.0051, 0.0771, 0.0793, 0.2665, 0.0862,
        0.1661, 0.2428, 0.0236, 0.2884, 0.2689, 0.0927, 0.2136, 0.1390, 0.1442,
        0.0618, 0.1377], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([567, 510, 646, 690, 993, 710, 706, 508, 694, 595, 527, 849, 492, 506,
        684, 551, 624, 618, 738, 626], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -1-----------
Real SNR = tensor([-4.3579, -4.5065, -0.3329, -2.5802, -2.1055, -4.5209, -0.5494, -1.5222,
        -7.9236, -3.1723, -6.4856, -0.2485, -2.6306, -8.4820, -8.0560, -6.8808,
        -0.2735, -2.6791, -1.0435, -2.6702], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.2509e+01-0.0000e+00j, 1.4738e+01-2.1458e-06j, 9.0630e+01-6.3099e-06j,
        3.1974e+01-9.5367e-07j, 4.8780e+01-1.2145e-06j, 9.2458e+01+2.2990e-07j,
        2.4866e+00-1.1921e-07j, 8.6339e+01+4.1522e-07j, 9.6341e+00+4.7684e-07j,
        4.1860e+00+3.3305e-06j, 5.8899e+01-6.8297e-07j, 1.9048e+01-2.0959e-06j,
        3.9325e+01+1.0326e-07j, 5.1291e+01+1.1522e-06j, 2.2854e+01-2.1744e-07j,
        4.0031e+00-1.0439e-07j, 9.0324e+00+2.6435e-07j, 3.8243e+01-3.4841e-07j,
        7.4679e+02+2.6190e-06j, 4.0047e-01-7.0781e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(72.18099212646484-2.835809027601499e-07j)
torch.linalg.det(H.mH@H) = tensor([0.5811-5.2068e-10j, 0.8056+4.6252e-09j, 3.4575+1.0403e-08j,
        0.1378-2.2352e-08j, 2.8572-1.3512e-08j, 2.0747-1.1829e-08j,
        0.4035+8.2892e-09j, 0.2521+9.4088e-08j, 0.0728-0.0000e+00j,
        1.8802+2.8873e-10j, 0.2489-2.0489e-08j, 3.1465-5.8236e-08j,
        0.9517+3.0326e-08j, 0.2150-5.2371e-09j, 0.3830+6.8047e-09j,
        0.1079-1.1176e-08j, 1.4354-1.2131e-07j, 3.0409-2.0775e-09j,
        0.1208+6.7055e-08j, 1.3726+2.8186e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.177262783050537-8.334332668447075e-10j)
SINR torch.Size([20]) = tensor([ -5.8096,  -5.5340,  -2.5392, -16.1267,  -2.5945,  -3.5532, -11.0618,
        -14.2282, -13.1371,  -3.9410,  -9.9068,  -3.9667,  -7.2643,  -8.3415,
         -8.4921, -13.6229,  -7.0285,  -2.6532, -18.6865,  -4.8475],
       device='cuda:0')
SINR mean = -8.166762351989746
E[H^H] = 1e-07
E_MSE (Error Power) = 11.85963249206543
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2079, 0.2185, 0.3579, 0.0238, 0.3549, 0.3062, 0.0726, 0.0364, 0.0463,
        0.2875, 0.0927, 0.2863, 0.1581, 0.1278, 0.1240, 0.0416, 0.1654, 0.3518,
        0.0134, 0.2467], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([556, 547, 443, 848, 445, 479, 718, 802, 774, 492, 684, 493, 603, 637,
        642, 787, 596, 447, 906, 523], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 0-----------
Real SNR = tensor([ 1.1663, -2.7310, -0.9420,  2.5837, -1.3597, -0.8791, -1.7247, -4.1803,
         0.5823, -1.7659,  0.5262,  1.6799, -5.3710, -1.0899,  1.0685,  1.1929,
         1.7844,  2.3088, -4.9694, -1.4493], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 97.8262+1.7993e-06j,  23.4372-1.6628e-06j,  47.9324-9.7646e-07j,
        107.0540+1.0617e-06j,  11.7835-9.5367e-07j,  16.8945+2.8439e-07j,
          6.6949-1.4305e-06j,  18.2608+4.9024e-07j,  67.3963+6.1978e-06j,
          6.3106-7.9469e-08j,   7.4584-4.7684e-07j,   6.7192-2.6937e-06j,
          7.6237+2.8587e-07j,  21.6331+4.7684e-07j,  13.5114+1.1346e-07j,
         32.8541+2.7123e-07j,  12.4990+9.8811e-07j,  42.3126-6.4414e-07j,
          5.1372-1.0275e-07j,  80.1355-1.2208e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(31.673734664916992-4.62978931636826e-07j)
torch.linalg.det(H.mH@H) = tensor([9.7221-2.2657e-08j, 0.0441+3.8799e-08j, 0.8714+4.9398e-09j,
        4.5125-3.8723e-07j, 3.4883-1.2206e-08j, 0.5651-7.3434e-08j,
        0.7942-2.7384e-08j, 0.9289+1.2498e-08j, 7.3730-1.2823e-07j,
        0.4817-2.6486e-09j, 2.9310+6.7271e-07j, 4.9913+2.6934e-08j,
        0.1735+1.6558e-08j, 0.1246-2.6439e-09j, 0.4314+2.5332e-07j,
        4.9401-2.0093e-07j, 0.9916+3.4861e-08j, 3.2184-4.9708e-07j,
        0.3183-1.0925e-09j, 1.2138-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.40575909614563-1.4745814347350006e-08j)
SINR torch.Size([20]) = tensor([  1.4584, -17.3962,  -5.8795,  -2.5562,  -1.1100,  -7.6947,  -5.7622,
         -4.6900,   0.7845,  -6.3851,  -3.3624,  -0.3438,  -9.8410, -12.5625,
        -11.8757,  -2.0540,  -8.0658,  -4.3284,  -6.5198,  -5.3888],
       device='cuda:0')
SINR mean = -5.6786651611328125
E[H^H] = 1e-07
E_MSE (Error Power) = 6.831246852874756
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5832, 0.0179, 0.2052, 0.3570, 0.4364, 0.1453, 0.2097, 0.2535, 0.5450,
        0.1869, 0.3156, 0.4802, 0.0940, 0.0525, 0.0610, 0.3839, 0.1350, 0.2696,
        0.1822, 0.2243], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([305, 878, 558, 444, 393, 617, 554, 518, 328, 575, 472, 366, 682, 759,
        740, 426, 629, 506, 579, 542], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 1-----------
Real SNR = tensor([-0.4242,  0.1707,  3.6578, -1.3422,  0.3962,  2.5647, -1.2509, -0.3968,
         3.8957, -1.2791, -2.6462, -1.6677,  1.3943, -3.2731, -4.2015,  0.8024,
         1.9154, -0.4303, -1.2457,  2.0250], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  0.3726+3.7306e-09j,  14.9381-1.1069e-07j,  73.6927-0.0000e+00j,
         17.9217+1.4367e-06j,   9.3910-1.6906e-07j,   2.5957-0.0000e+00j,
         41.9461-1.3252e-07j,   9.8689+4.4643e-07j,  55.1783+2.4092e-06j,
         80.8547-1.0375e-06j,   4.6480+3.1994e-07j,   5.4783+5.9605e-07j,
         57.4851+1.2569e-06j,   1.9940-1.1921e-07j,  10.9274+9.6930e-08j,
         35.2560+2.2240e-08j, 117.9083-1.0463e-05j,  49.6088+1.1363e-07j,
          2.0720+1.3259e-09j,  46.8238+2.0475e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(31.948078155517578-1.6409292413754883e-07j)
torch.linalg.det(H.mH@H) = tensor([0.5754-8.9499e-09j, 0.5214-2.3366e-08j, 0.6898-4.0000e-07j,
        1.3018+1.0914e-07j, 0.3018-1.1176e-08j, 9.3391-2.0407e-07j,
        0.0753+1.7729e-08j, 0.7542+4.7790e-08j, 4.7920+2.8639e-08j,
        0.8761-1.9082e-08j, 0.6009+1.1176e-08j, 1.6748-8.4768e-08j,
        2.1771+8.0402e-08j, 0.3051-3.3771e-09j, 0.3525+4.1764e-10j,
        1.6174+2.2171e-07j, 1.0529-7.4506e-08j, 1.0848-1.7490e-07j,
        0.2782+1.7415e-10j, 2.0751-3.2884e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5222870111465454-2.5995587904503736e-08j)
SINR torch.Size([20]) = tensor([ -5.5538,  -6.8564, -10.6138,  -2.8332, -10.6445,   2.2308, -13.4111,
         -4.9509,  -1.5979,  -3.3112,  -5.7519,  -2.7378,  -3.7581,  -6.5060,
         -6.5346,  -3.9434,  -7.5644,  -5.4104,  -7.8076,  -3.2136],
       device='cuda:0')
SINR mean = -5.538491725921631
E[H^H] = 1e-07
E_MSE (Error Power) = 4.702959060668945
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2178, 0.1710, 0.0799, 0.3425, 0.0794, 0.6257, 0.0436, 0.2423, 0.4090,
        0.3181, 0.2101, 0.3474, 0.2962, 0.1827, 0.1817, 0.2874, 0.1491, 0.2234,
        0.1421, 0.3230], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([547, 590, 705, 454, 706, 280, 781, 527, 410, 470, 554, 450, 486, 579,
        580, 492, 613, 542, 621, 467], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 2-----------
Real SNR = tensor([-0.6506,  1.8319, -3.7998, -3.4029, -0.5970,  0.1856,  3.1986, -0.8301,
         0.1804,  1.3470,  5.2912,  6.2119, -0.4798,  3.0755,  1.8054,  4.3879,
         1.7460, -0.2048, -0.2592,  2.4105], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([21.9186-6.9488e-07j, 26.5390+1.3459e-07j, 19.7009-1.9073e-06j,
         2.1150-2.2352e-07j,  5.8590+1.9073e-06j, 39.1458+5.2754e-08j,
        54.9612+1.6476e-06j, 35.4668+3.8147e-06j, 29.8397+1.3892e-06j,
        12.3709-1.2099e-06j, 18.2627+4.1723e-07j, 76.4617+4.7876e-08j,
        15.4274+3.5763e-07j, 82.7466+1.6990e-06j, 55.5725-3.9006e-06j,
         4.8383+4.8257e-08j, 20.5134+2.4661e-07j,  9.5714-0.0000e+00j,
         5.0863-9.3869e-08j,  6.0186-4.7001e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(27.120779037475586+1.6312996820033732e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.9333+4.7247e-08j,  4.1859-6.0722e-08j,  0.1151+3.2723e-09j,
         0.3523+4.1967e-09j,  1.6489+4.2127e-08j,  4.4503+2.9948e-08j,
         0.4837-3.8810e-08j,  0.9765-8.0090e-09j,  0.9482-2.9802e-07j,
         1.2969+1.7881e-07j, 12.0148-1.8266e-07j,  6.1433+1.0729e-06j,
         0.2138-4.4703e-08j,  3.6133-0.0000e+00j,  2.2888-2.0237e-08j,
         4.1021+4.7684e-07j,  0.2896-8.9407e-08j,  2.6479-1.8577e-08j,
         0.1985+3.3131e-09j,  2.3386-9.3139e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4620869159698486+5.0217533242857826e-08j)
SINR torch.Size([20]) = tensor([ -2.7773,   1.1563,  -7.8005,  -4.0546,  -1.8946,   0.9933,  -8.9328,
         -1.4920,  -5.3417,  -3.7029,   3.8141,  -0.4374, -11.1474,  -0.3568,
         -0.9824,  -1.0944,  -9.3811,  -0.1128,  -8.2367,  -0.7589],
       device='cuda:0')
SINR mean = -3.127030611038208
E[H^H] = 1e-07
E_MSE (Error Power) = 3.009007692337036
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3454, 0.5662, 0.1423, 0.2822, 0.3926, 0.5569, 0.1134, 0.4149, 0.2262,
        0.2989, 0.7065, 0.4748, 0.0713, 0.4795, 0.4437, 0.4373, 0.1034, 0.4935,
        0.1305, 0.4564], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([452, 315, 620, 496, 421, 320, 655, 406, 540, 484, 230, 370, 720, 367,
        389, 393, 669, 358, 634, 381], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 3-----------
Real SNR = tensor([-2.1394,  4.2581,  6.0421, -2.2216,  6.5063,  2.0989,  4.1477,  0.8433,
         4.5051,  6.5190,  2.5539,  0.2027,  1.4042,  2.6942,  4.5643,  3.4586,
         0.9587,  2.3371,  3.5125,  1.2545], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  0.1626-3.5491e-10j,   0.8110-1.4901e-07j,  32.9205+8.5947e-07j,
        135.8606+6.8978e-08j,  11.7870-1.2064e-07j,   4.5111-3.1459e-07j,
         30.3586-0.0000e+00j,   2.8479-1.0729e-06j,   6.8047-7.5795e-08j,
         35.9880+1.9073e-06j,   3.7095-2.7477e-07j,  16.5255+2.1444e-07j,
          1.6505+2.3842e-06j,   1.1543+5.0664e-07j,   1.5278+4.3478e-08j,
         19.0529-1.5188e-07j,   8.0537+9.5367e-07j,  52.7581-0.0000e+00j,
          9.2649-2.1083e-08j,  10.3523+1.2043e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(19.30507469177246+2.438818285099842e-07j)
torch.linalg.det(H.mH@H) = tensor([0.0375+1.1057e-08j, 3.5564+5.7114e-08j, 0.9295-7.8794e-08j,
        0.2403+1.8464e-08j, 3.8669+4.7741e-08j, 5.5272+5.3410e-08j,
        4.4105+1.4671e-07j, 0.7876+9.0875e-10j, 3.4256-1.2894e-07j,
        8.9883+7.5849e-08j, 1.9863-6.4008e-08j, 0.8006-2.2167e-08j,
        1.2706-5.9605e-08j, 6.2977-7.1813e-08j, 0.5786-2.2222e-08j,
        1.9524-8.9249e-08j, 0.6295+2.9802e-08j, 1.3230-1.1836e-07j,
        0.1745-1.0246e-07j, 0.7533+3.5412e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3768064975738525-1.4057753183749355e-08j)
SINR torch.Size([20]) = tensor([-12.4332,   1.7426,  -6.6905,  -7.2682,  -0.5429,   1.8879,   2.2303,
         -3.2957,  -0.4059,   3.3090,   0.0376,  -2.5221,  -3.4660,   3.3739,
         -5.1576,  -2.5119,  -3.8395,  -2.7266, -11.8403,  -4.5392],
       device='cuda:0')
SINR mean = -2.7329235076904297
E[H^H] = 1e-07
E_MSE (Error Power) = 3.171934127807617
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0540, 0.5990, 0.1765, 0.1580, 0.4688, 0.6070, 0.6256, 0.3189, 0.4767,
        0.6818, 0.5022, 0.3588, 0.3104, 0.6850, 0.2337, 0.3593, 0.2923, 0.3480,
        0.0614, 0.2601], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([755, 295, 585, 603, 373, 291, 280, 470, 368, 246, 353, 443, 476, 244,
        534, 442, 489, 450, 739, 513], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 4-----------
Real SNR = tensor([-2.3658,  1.8676,  3.5781,  2.9679,  6.2932,  0.5108,  2.3593, -0.0116,
         5.0175,  4.0434,  1.9395,  0.3492,  2.7925,  0.7160, -1.2415,  2.5439,
         0.8819,  1.0443,  5.1046,  1.8923], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 7.3159-6.7582e-08j,  2.6154+2.2058e-08j,  7.8578+9.5367e-07j,
         9.6650-4.3598e-08j,  0.9730+4.4705e-08j,  3.1168-6.1199e-08j,
         8.6666+2.0954e-07j,  4.9389-2.3842e-06j,  1.6342-1.4643e-07j,
        10.4447+2.8610e-06j, 17.3066-0.0000e+00j,  1.3529-4.7684e-07j,
        13.8697+6.5565e-07j,  1.3970-0.0000e+00j,  4.2347+9.2645e-08j,
        10.9640-4.4924e-07j, 23.2239+3.1073e-07j,  0.4634+1.9262e-07j,
        15.2651+4.7684e-07j,  4.4325+1.4961e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.486905097961426+1.1026857293927605e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1431+9.3132e-09j, 0.6312+1.0440e-08j, 0.2036-1.8039e-08j,
        2.6468+5.2372e-08j, 0.6463+3.3129e-07j, 0.9995-3.8392e-09j,
        2.0636-2.1880e-08j, 0.7740-2.0913e-08j, 0.0134+1.9558e-08j,
        4.1991-1.0099e-08j, 2.7033-3.5763e-07j, 0.8423-3.2083e-08j,
        3.7312-9.2785e-09j, 0.0513-1.8651e-09j, 0.0760+2.8568e-09j,
        0.7900-2.9802e-08j, 0.1615-5.9605e-08j, 0.0286+2.0489e-08j,
        8.6072-1.5029e-07j, 0.5298-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4920881986618042-1.3449680480448478e-08j)
SINR torch.Size([20]) = tensor([ -6.5897,  -1.8692,  -8.8982,   2.3357,  -5.9624,  -1.8041,   1.7055,
         -0.4540, -23.2450,   2.7459,   0.0957,  -1.5888,   3.0706,  -8.8894,
         -9.3120,  -3.7557, -10.2999, -16.5221,   4.8846,  -4.5801],
       device='cuda:0')
SINR mean = -4.446625232696533
E[H^H] = 1e-07
E_MSE (Error Power) = 15.10462474822998
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1799, 0.3940, 0.1142, 0.6313, 0.2022, 0.3976, 0.5969, 0.4739, 0.0047,
        0.6530, 0.5055, 0.4096, 0.6697, 0.1144, 0.1049, 0.2963, 0.0854, 0.0218,
        0.7549, 0.2583], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([582, 420, 654, 276, 561, 417, 297, 370, 999, 263, 351, 410, 253, 654,
        667, 486, 696, 857, 200, 514], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 5-----------
Real SNR = tensor([4.6414, 1.8683, 3.5437, 2.3972, 8.1784, 2.4183, 2.3399, 5.9879, 5.0355,
        7.3055, 7.2664, 7.5832, 3.0005, 3.4663, 2.8183, 1.8713, 6.5344, 2.2863,
        6.1023, 4.2702], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.9541+5.2044e-06j,  8.2662-2.3505e-07j, 14.3636-0.0000e+00j,
         4.7446-2.3842e-07j, 17.3780-4.7684e-07j, 10.9405-2.4139e-07j,
         4.0051+1.2844e-08j,  2.3414+8.5718e-08j,  4.7669-1.5457e-07j,
        39.3608+3.4252e-07j, 24.7207-1.8235e-07j, 31.3408-5.5824e-07j,
         1.0842-2.0176e-08j, 54.5130+1.6476e-07j,  2.1282-6.5301e-08j,
        36.8349+3.6399e-07j, 12.1321+1.0465e-07j,  2.0841-0.0000e+00j,
         0.6323-1.0718e-08j,  6.3181-7.8004e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(13.945480346679688+2.0088921814931382e-07j)
torch.linalg.det(H.mH@H) = tensor([0.4014+2.8742e-08j, 0.2958-8.9926e-10j, 3.4833-2.1978e-08j,
        0.3259-0.0000e+00j, 1.2608+1.2981e-07j, 0.6657+4.6283e-08j,
        2.3722+2.5141e-08j, 0.7459+2.3842e-07j, 4.6464-1.2761e-07j,
        6.4074+6.9413e-08j, 3.9623-4.8501e-08j, 5.6718+1.7503e-07j,
        1.1204+1.7600e-08j, 0.6996-1.4901e-08j, 1.1933-1.2951e-07j,
        0.4911-2.5146e-08j, 0.6533+7.2469e-08j, 0.2408+1.4901e-08j,
        2.1898+3.2819e-08j, 0.0744-5.6030e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8450841903686523+2.1302810182532994e-08j)
SINR torch.Size([20]) = tensor([ -4.3170,  -3.0566,   3.7175,  -5.2980,  -2.9408,  -2.3291,   3.5123,
         -3.4362,   4.9667,   4.7493,   2.8385,   3.0334,   0.0633,  -2.5059,
         -2.2851,  -3.9649,  -2.9322,  -7.5182,   2.5441, -10.7093],
       device='cuda:0')
SINR mean = -1.293405294418335
E[H^H] = 1e-07
E_MSE (Error Power) = 2.062204360961914
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2701, 0.3310, 0.7018, 0.2280, 0.3369, 0.3691, 0.6918, 0.3119, 0.7583,
        0.7491, 0.6578, 0.6678, 0.5036, 0.3596, 0.3714, 0.2864, 0.3373, 0.1504,
        0.6424, 0.0783], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([505, 461, 233, 539, 457, 436, 239, 475, 197, 203, 260, 254, 352, 442,
        434, 493, 457, 611, 270, 708], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 6-----------
Real SNR = tensor([ 7.0961,  5.2356,  7.0199,  5.9944,  6.3206,  5.4950,  4.2699,  5.2669,
         1.0207,  5.4404,  3.1682,  7.2439,  3.3320,  5.5368,  9.1792,  7.3262,
         6.4761,  5.4492, -0.2031,  7.0938], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([10.7163-4.8803e-07j, 19.5696-6.5008e-07j, 10.2180-2.9210e-07j,
        41.2877-3.9913e-08j,  0.8629+7.2845e-08j,  1.3896+2.9802e-08j,
         1.1363-3.3571e-08j,  1.7422+4.8199e-08j,  4.5291-4.4314e-07j,
         2.3027+2.3913e-08j,  4.2262-1.2787e-07j, 37.6946+5.8794e-07j,
         2.2691-4.1723e-07j,  9.1796-2.3842e-07j, 26.0093+2.7095e-07j,
         9.0286+9.8449e-09j,  2.8248+2.3842e-07j,  3.3832+4.5040e-08j,
         2.1012+6.5378e-08j,  0.9360+1.5926e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(9.57034969329834-5.893833332493159e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.6413+1.0729e-06j,  0.5663+2.9916e-08j,  4.5485+1.1099e-07j,
         6.5989+9.0686e-08j,  1.6211-1.5529e-07j,  1.1546-0.0000e+00j,
         0.0599-3.9762e-10j,  0.1880+2.0600e-08j,  0.2323-1.3220e-09j,
         2.3330+1.1921e-07j,  1.0956-1.4901e-07j,  1.1737-1.5484e-07j,
         2.5070-7.7230e-08j,  5.9391+2.3842e-07j, 13.0156+2.6196e-07j,
         0.1755+5.0610e-08j,  2.4177+6.7813e-08j,  0.5370-3.4622e-09j,
         0.2062+5.7540e-09j,  0.8309+2.2834e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.342106580734253+8.778194882097523e-08j)
SINR torch.Size([20]) = tensor([-1.1389, -1.0515,  3.8289,  7.0352,  1.5172,  0.0892, -9.6170, -6.5848,
        -1.8573,  1.3179, -0.0194, -1.1416,  3.8121,  4.7601,  7.8550, -8.8293,
         2.1872, -1.1396, -3.3541, -1.0337], device='cuda:0')
SINR mean = -0.1682296246290207
E[H^H] = 1e-07
E_MSE (Error Power) = 1.7029637098312378
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4348, 0.4398, 0.7072, 0.8348, 0.5865, 0.5051, 0.0985, 0.1800, 0.3947,
        0.5753, 0.4989, 0.4347, 0.7064, 0.7495, 0.8592, 0.1158, 0.6233, 0.4348,
        0.3160, 0.4408], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([394, 391, 230, 146, 303, 351, 676, 581, 419, 310, 355, 394, 230, 203,
        128, 652, 281, 394, 472, 390], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 7-----------
Real SNR = tensor([ 7.0948,  7.2729,  6.0530,  7.8749,  3.9383,  3.3424,  5.7705,  7.2285,
         3.5859,  5.3130, -0.8591,  4.4334,  2.9230,  6.6485,  0.1083,  3.5361,
         3.0202,  4.1303,  3.9022,  3.4051], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.3926e+00-1.1921e-07j, 3.3328e+00+1.1403e-07j, 1.0451e+01+3.4895e-07j,
        3.2505e+00-1.4875e-07j, 2.4999e-01-6.7055e-08j, 3.7094e-02-1.8626e-09j,
        1.8076e-01-4.4007e-08j, 4.7060e+00-1.9073e-06j, 3.7752e+00-9.9717e-08j,
        2.2219e+00-1.1737e-07j, 6.6996e+00+2.3842e-07j, 1.1568e-01-1.0518e-08j,
        3.1765e+00+1.3742e-08j, 9.5633e+00-1.1169e-07j, 8.3996e-01-3.4528e-09j,
        5.8781e-01-7.8914e-09j, 4.0991e+01+3.0157e-07j, 1.2140e+00+2.8001e-08j,
        2.6406e-01-0.0000e+00j, 5.6136e+00-8.9806e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.983152389526367-8.01572141995166e-08j)
torch.linalg.det(H.mH@H) = tensor([3.1326-9.9778e-09j, 4.0776-3.3068e-08j, 0.6365+1.0431e-07j,
        7.2445-2.7702e-08j, 0.9199+1.6427e-10j, 1.7760+1.1903e-07j,
        0.2681-1.2395e-08j, 3.4811-4.4389e-08j, 0.0945+2.9171e-10j,
        0.2073+9.0595e-11j, 0.1348+3.6914e-09j, 1.1833+4.0636e-08j,
        0.4823+2.9802e-08j, 2.2505-1.1872e-07j, 0.1542-2.2352e-08j,
        0.3627+2.9275e-08j, 0.5812-8.4646e-09j, 1.1112+8.9632e-09j,
        0.8532-1.9661e-08j, 0.2902-1.2419e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4620951414108276+1.3550990329846968e-09j)
SINR torch.Size([20]) = tensor([ 5.1099,  6.7889, -0.4377,  8.0107,  3.0096,  3.2362, -2.6824,  5.8914,
        -4.8817, -3.6188, -2.5420,  2.5414, -1.3133,  4.0802, -3.5270, -1.5217,
         1.8035,  3.7691,  1.8482, -1.9262], device='cuda:0')
SINR mean = 1.1819053888320923
E[H^H] = 1e-07
E_MSE (Error Power) = 1.0009853839874268
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7643, 0.8268, 0.4748, 0.8635, 0.6666, 0.6781, 0.3503, 0.7952, 0.2453,
        0.3030, 0.3577, 0.6423, 0.4250, 0.7190, 0.3074, 0.4133, 0.6024, 0.7043,
        0.6048, 0.3909], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([194, 151, 370, 124, 255, 248, 448, 173, 525, 481, 443, 270, 400, 223,
        478, 408, 293, 232, 292, 422], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 8-----------
Real SNR = tensor([10.7905,  5.7824, -0.1088,  5.5700,  8.5761,  8.8091,  7.1105,  7.2318,
         6.1605,  6.5902,  4.6296,  6.3462,  7.4313, 10.1379,  2.7447,  6.9440,
         8.7474,  2.1570,  9.3367,  6.7263], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([15.0000-2.0325e-07j,  0.5041-2.9802e-08j,  1.6392-1.6014e-08j,
         3.1940-1.6043e-08j,  2.6050+1.9396e-08j,  5.9174-3.8537e-07j,
         1.8596+1.0488e-08j,  5.3488+1.5735e-07j,  0.5663-1.1921e-07j,
         9.0643+2.0284e-08j, 13.7764+4.5750e-08j,  9.0884+1.5566e-07j,
        10.1810-1.5217e-07j,  0.6556+1.4901e-08j,  0.5940-4.4871e-08j,
         3.3909-6.7196e-08j,  2.7580+2.4576e-08j,  1.6716+1.2865e-09j,
         3.7621-5.1153e-07j,  0.2520-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.591441631317139-5.478754516730078e-08j)
torch.linalg.det(H.mH@H) = tensor([0.2520-1.4671e-07j, 0.5372+2.9802e-08j, 0.1039-1.1997e-09j,
        0.5931-3.6033e-09j, 5.6565+1.8430e-08j, 3.8436+2.3724e-08j,
        2.8517+1.4328e-08j, 2.0877+4.3407e-08j, 1.6847-5.9605e-08j,
        0.1103-4.8429e-08j, 1.9096-5.3924e-08j, 2.1462-2.2259e-08j,
        1.1193+4.4221e-08j, 0.3324+8.5785e-08j, 1.2239+2.9802e-08j,
        0.1463+7.4506e-08j, 6.2849+3.5653e-08j, 0.1644+7.4506e-09j,
        0.4657-7.6141e-08j, 1.0057+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6259511709213257+1.252146830665879e-09j)
SINR torch.Size([20]) = tensor([-5.5536,  0.4178, -1.0676,  1.1664,  7.7914,  5.3551,  6.1642,  5.1388,
         3.9079, -7.1416,  5.2493,  5.2194,  1.9064, -1.9393,  3.2342, -5.5478,
         8.5227, -1.8407, -1.3596,  3.0813], device='cuda:0')
SINR mean = 1.63524329662323
E[H^H] = 1e-07
E_MSE (Error Power) = 1.0865826606750488
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2178, 0.5240, 0.4389, 0.5667, 0.8574, 0.7744, 0.8052, 0.7655, 0.7109,
        0.1619, 0.7701, 0.7688, 0.6080, 0.3902, 0.6780, 0.2180, 0.8768, 0.3956,
        0.4224, 0.6703], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([547, 340, 392, 315, 129, 187, 166, 193, 228, 599, 190, 191, 290, 422,
        248, 547, 114, 419, 402, 253], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 9-----------
Real SNR = tensor([ 6.7881,  7.8101, 12.6161, 10.5221,  6.0498,  4.4638,  7.8351,  5.1298,
         5.4188, 13.0517,  8.7891,  8.7699,  5.5339,  8.8470,  8.5227,  7.9733,
         6.0594,  5.0642,  5.1100,  8.1139], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.3688e+00+6.1483e-08j, 1.9664e+00-1.7881e-07j, 2.3283e+01-9.5278e-07j,
        2.7116e+01+1.3923e-07j, 7.2875e-02+9.7098e-10j, 3.9580e+00+1.0956e-07j,
        1.1245e+01+3.7846e-08j, 9.8476e-01-1.8728e-07j, 1.1608e-02-1.1100e-08j,
        6.4915e+00-0.0000e+00j, 9.4633e+00-2.6203e-07j, 7.0541e+00+1.5268e-07j,
        4.8171e-01+3.7669e-09j, 4.8875e+00+1.8095e-08j, 2.4857e+00-5.9605e-08j,
        2.6332e-01-4.4635e-08j, 1.8431e+00-1.7881e-07j, 1.4316e+00-2.9079e-08j,
        1.1280e+00+2.9802e-08j, 8.6474e+00-1.4928e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.709163188934326-6.828131660086001e-08j)
torch.linalg.det(H.mH@H) = tensor([1.3740e+00-1.3394e-08j, 2.5544e-01-1.7376e-08j, 3.8988e+00+1.9372e-07j,
        5.2627e+00+3.5757e-07j, 2.1487e-03-1.5798e-08j, 7.6455e-01+1.0932e-08j,
        3.5268e+00-7.0113e-08j, 5.3751e-02-3.2542e-09j, 5.0628e-01-5.1907e-09j,
        1.1540e+01+2.3842e-07j, 2.5605e+00-2.7641e-08j, 2.6399e+00-1.5643e-07j,
        4.9371e-02+4.4261e-09j, 1.3491e+00-4.2750e-08j, 3.1241e+00+2.1691e-09j,
        2.9246e+00-8.5031e-09j, 3.6723e-01+2.4807e-08j, 1.6893e-01-3.7253e-09j,
        1.1562e-01-7.0775e-09j, 4.2599e+00-2.8030e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2371952533721924+2.1637379887806674e-08j)
SINR torch.Size([20]) = tensor([  6.0954,  -1.0404,   4.4770,   7.3187, -20.3654,   3.5543,   7.7162,
         -7.1441,   2.8447,   9.3711,   7.1290,   5.7808,  -6.2775,   4.9523,
          6.6709,   6.3702,  -0.4874,  -2.3291,  -2.5131,   8.9771],
       device='cuda:0')
SINR mean = 2.0550377368927
E[H^H] = 1e-07
E_MSE (Error Power) = 5.961035251617432
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8027, 0.4404, 0.7371, 0.8436, 0.0091, 0.6939, 0.8553, 0.1618, 0.6581,
        0.8964, 0.8377, 0.7910, 0.1907, 0.7577, 0.8229, 0.8126, 0.4720, 0.3691,
        0.3592, 0.8877], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([168, 391, 211, 139, 942, 238, 131, 599, 260,  99, 143, 176, 571, 198,
        154, 161, 371, 436, 442, 106], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 10-----------
Real SNR = tensor([11.1239,  7.0435, 12.6709,  5.9916,  9.1323,  7.9673,  7.0999,  8.5211,
         3.3763,  7.3580,  7.4780, 12.0593,  9.4348,  3.4233,  6.9512, 10.3458,
         7.7769, 10.9158,  8.9071,  8.0793], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.7585-2.5189e-08j,  1.4474+2.6629e-08j, 11.1926-2.3866e-07j,
         0.5532+1.4542e-07j,  0.7371+1.6615e-08j,  0.5905+6.0519e-09j,
         1.2320+2.1662e-08j,  0.3467-5.2154e-08j,  6.2047-4.7489e-08j,
         3.9457-8.3447e-07j,  0.7502+7.7521e-09j,  2.2071-3.0926e-07j,
         1.5636+7.0824e-09j,  0.0232-1.6185e-08j,  1.4761+1.3172e-08j,
         0.0651-3.7253e-09j,  0.6776+3.7549e-09j, 14.2857+3.0792e-07j,
         2.4463-1.0718e-07j,  3.7062+2.9624e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.910480499267578-3.9100299886740686e-08j)
torch.linalg.det(H.mH@H) = tensor([4.4819e+00-6.1491e-08j, 7.9120e-01-5.9949e-09j, 8.9088e+00-1.7492e-07j,
        2.2652e-01+7.4506e-09j, 1.0967e+00+2.9802e-07j, 1.0638e+00+8.9407e-08j,
        1.9632e-01+2.1130e-08j, 7.0850e-01+2.9802e-08j, 6.9146e-03-2.5029e-09j,
        4.0300e-01-1.1196e-08j, 2.7255e-01-1.6527e-08j, 3.5465e+00-5.5002e-08j,
        3.1597e+00+1.1769e-07j, 1.4392e-02-1.8134e-09j, 1.1488e-01+1.6879e-08j,
        1.6371e+00-1.1921e-07j, 4.6979e-01+7.5391e-09j, 9.6799e-01-1.7881e-07j,
        4.6054e-01+5.4853e-08j, 9.2865e-01-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4727932214736938+7.650982070117607e-10j)
SINR torch.Size([20]) = tensor([  9.6229,   5.4472,   9.9818,   0.3968,   4.7294,   4.1714,  -1.2865,
          2.5456, -13.1564,   1.6064,  -0.4911,   7.6175,   8.1240,  -8.5352,
         -2.5667,   4.2335,   3.2647,   1.0898,   1.5064,   3.2816],
       device='cuda:0')
SINR mean = 2.07915997505188
E[H^H] = 1e-07
E_MSE (Error Power) = 1.8385146856307983
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9017, 0.7780, 0.9087, 0.5228, 0.7482, 0.7232, 0.4265, 0.6425, 0.0461,
        0.5914, 0.4718, 0.8525, 0.8665, 0.1229, 0.3564, 0.7261, 0.6796, 0.5624,
        0.5859, 0.6804], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 94, 185,  89, 341, 204, 220, 399, 269, 774, 300, 371, 133, 122, 643,
        444, 218, 247, 317, 303, 246], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 11-----------
Real SNR = tensor([12.4531, 10.0343,  8.7446,  6.6464,  6.9713, 13.7852,  8.6172, 10.5543,
         9.3324, 13.4046,  6.3442,  7.9522,  7.9011, 12.6791,  9.7977, 10.8834,
        11.7063, 13.7892,  9.2228, 11.6764], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.1596+3.5028e-08j,  0.2176+1.7069e-09j,  0.5182-0.0000e+00j,
         2.4283+5.0656e-08j,  1.0548-5.0076e-08j, 22.3864-3.9122e-07j,
         0.9558-4.4703e-08j,  4.7982+1.6702e-07j,  0.6863-1.1631e-08j,
         1.2048+5.5050e-08j,  3.6517+4.7348e-08j,  0.4975+1.2513e-08j,
         0.5086-4.0123e-09j,  0.8029-1.4455e-07j,  4.9947+2.3842e-07j,
        14.3733+1.8357e-07j,  7.2355-1.2290e-07j,  1.5258+1.9361e-07j,
         4.4648+4.0280e-08j,  5.4778+1.5984e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.097135066986084+2.0797392252802638e-08j)
torch.linalg.det(H.mH@H) = tensor([ 3.2278+2.5060e-08j,  0.4249+6.2883e-09j,  1.0701-3.7476e-08j,
         0.2475+7.4506e-09j,  0.0725+1.1176e-08j, 10.3440+7.6118e-08j,
         0.6904+1.4901e-08j,  3.2364-1.5471e-07j,  0.2625+1.2740e-08j,
         0.3705-3.2638e-09j,  0.6897+1.4558e-09j,  0.6325-1.9542e-08j,
         0.1169-3.7253e-08j,  1.8465-1.8164e-08j,  4.0804+1.1921e-07j,
         3.1566+3.2370e-08j,  1.1552-4.5822e-09j,  1.8809+1.2517e-06j,
         1.3167+5.9605e-08j,  3.1958+2.6797e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9008868932724+6.84939323036815e-08j)
SINR torch.Size([20]) = tensor([ 9.2175,  2.0687,  6.6156,  2.5137, -3.0970, 12.3640,  4.2390,  7.3858,
         1.1344,  0.1513,  6.4197,  5.2367, -2.7345,  4.6515,  8.3918,  8.2069,
         5.7336,  4.0930,  6.2267,  9.3735], device='cuda:0')
SINR mean = 4.909587383270264
E[H^H] = 1e-07
E_MSE (Error Power) = 0.4668954014778137
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8931, 0.6169, 0.8210, 0.6408, 0.3289, 0.9452, 0.7263, 0.8456, 0.5649,
        0.5087, 0.8143, 0.7696, 0.3476, 0.7448, 0.8735, 0.8687, 0.7892, 0.7196,
        0.8075, 0.8964], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([101, 285, 155, 270, 463,  57, 218, 138, 316, 349, 160, 190, 450, 206,
        117, 120, 177, 222, 165,  99], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 12-----------
Real SNR = tensor([15.0439, 12.3551,  7.5033,  9.5149, 10.2327, 10.1873, 14.6124,  9.2913,
         8.3971, 12.2361,  8.9745, 12.9179,  8.2111, 11.5030, 10.5889, 12.8791,
        10.5124, 12.3469,  7.9285, 13.0906], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.7957+9.7519e-08j, 5.5986+4.7089e-08j, 2.3344-5.1942e-08j,
        2.8343-1.2735e-08j, 1.1722+7.1612e-08j, 4.6212-1.2386e-07j,
        0.4612-3.9227e-08j, 0.3580-2.7307e-09j, 1.4325+3.3945e-08j,
        1.1005-5.3644e-07j, 0.3997-1.2181e-07j, 0.7833+1.7121e-07j,
        5.5341+7.6610e-08j, 0.5374-2.7098e-09j, 1.2405+1.8820e-08j,
        1.1874+1.7814e-08j, 2.1384+8.1718e-08j, 0.7263-7.9688e-07j,
        0.2602-5.9605e-08j, 1.0079+1.5646e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8761875629425049-4.8757023307643976e-08j)
torch.linalg.det(H.mH@H) = tensor([3.0161+5.8389e-08j, 1.3010-4.6251e-08j, 1.0909-6.2973e-08j,
        0.7813+2.1266e-08j, 0.9777-4.7010e-08j, 0.5011+2.9596e-08j,
        3.7358-1.1926e-07j, 1.4645-2.4001e-08j, 0.6211+3.8178e-09j,
        0.5731-5.9605e-08j, 0.3428-2.9302e-08j, 1.6141+4.3138e-07j,
        0.5316-2.9802e-08j, 0.6352-1.2706e-08j, 1.2512+1.2909e-08j,
        0.7809+1.7318e-08j, 1.9395+3.5703e-08j, 0.2390-3.7253e-08j,
        0.0892+7.4506e-09j, 1.0749-1.0431e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1280573606491089+2.2677000277582238e-09j)
SINR torch.Size([20]) = tensor([ 7.3165,  7.1635,  7.9859,  7.1726,  5.8540,  4.4300, 10.2866,  8.5572,
         5.5921,  1.0519,  1.9891,  5.9175,  4.2390,  3.9105,  8.8670,  4.6199,
         9.9229, -0.8393, -2.2625,  4.3263], device='cuda:0')
SINR mean = 5.305034637451172
E[H^H] = 1e-07
E_MSE (Error Power) = 0.37983497977256775
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8435, 0.8388, 0.8628, 0.8391, 0.7938, 0.7350, 0.9144, 0.8777, 0.7837,
        0.5603, 0.6125, 0.7962, 0.7263, 0.7110, 0.8851, 0.7434, 0.9076, 0.4518,
        0.3726, 0.7303], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([139, 143, 125, 142, 174, 212,  84, 114, 181, 318, 287, 172, 218, 228,
        108, 207,  90, 384, 434, 215], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 13-----------
Real SNR = tensor([ 6.7137, 11.7924, 12.0531, 13.0946, 14.1257, 12.2026,  8.6480,  7.6787,
        10.6655, 12.4407, 14.3050, 16.2913,  9.8697, 10.0962, 11.7865, 10.3373,
        10.1406, 10.9525, 17.7280, 12.0740], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.5235e-01-5.9605e-08j, 1.0387e-01-1.5466e-08j, 6.9777e-01+5.6694e-08j,
        1.7276e+00+2.2621e-08j, 1.2172e-01-8.5682e-08j, 2.2821e-01+6.0665e-08j,
        9.4735e-01+6.9991e-08j, 1.6844e-02+1.4655e-08j, 8.9710e-01+3.6082e-09j,
        2.3357e+00+1.2060e-07j, 5.4070e+00-3.3593e-08j, 4.4471e+00-2.9644e-07j,
        1.7588e+00+2.3842e-07j, 6.3996e-01-4.0978e-08j, 3.8493e+01+5.2529e-07j,
        5.0106e-01+1.4901e-08j, 8.8869e-01+8.9407e-08j, 1.1520e+00+2.4718e-08j,
        9.8752e+00-1.4290e-07j, 3.7101e-01-1.6391e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.5530967712402344+2.014889055601543e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1289-3.7253e-09j,  0.2601+3.6003e-09j,  2.9249+4.3240e-09j,
         1.0640+7.3585e-08j,  0.4490+1.6950e-07j,  0.3258-6.1768e-08j,
         0.7935+1.9321e-09j,  0.5544-3.6321e-09j,  1.2731+1.2189e-08j,
         2.1140+1.0059e-08j,  4.8353+4.4337e-09j,  3.0896-2.9373e-08j,
         2.0017-2.7316e-08j,  0.5140+7.4506e-09j, 15.7293+5.3380e-09j,
         0.6523+6.5237e-10j,  0.5480-7.4506e-08j,  0.1792-1.3127e-08j,
         2.4092-3.8881e-08j,  1.7633+3.1892e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0804812908172607+3.6314375950752265e-09j)
SINR torch.Size([20]) = tensor([ 2.9466,  2.9211, 11.3372,  7.4022,  1.8496,  1.8024,  9.4651,  7.3524,
        10.1916, 10.3597, 12.5107,  9.1024,  9.8926,  4.8182, 14.8902,  6.6200,
         5.4164,  0.0490,  7.4381,  9.0855], device='cuda:0')
SINR mean = 7.2725510597229
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2569889426231384
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6634, 0.6621, 0.9315, 0.8461, 0.6049, 0.6023, 0.8984, 0.8446, 0.9127,
        0.9157, 0.9469, 0.8905, 0.9070, 0.7520, 0.9686, 0.8212, 0.7768, 0.5028,
        0.8472, 0.8901], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([257, 258,  69, 137, 292, 293,  97, 138,  85,  83,  55, 103,  90, 202,
         34, 155, 185, 353, 137, 104], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 14-----------
Real SNR = tensor([13.3624, 13.8168, 10.7022,  8.3860,  9.5185, 14.7166,  9.9656, 14.1755,
        12.6595, 13.3863, 14.0512, 11.9840, 10.9312,  3.6975, 12.3135, 13.7540,
        11.7542, 16.3668, 14.5408, 11.4321], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.0754-2.1850e-08j, 2.2581-7.3084e-08j, 0.7258+7.4558e-09j,
        0.1120+1.5790e-08j, 2.3860-3.2345e-08j, 0.5184+2.5332e-07j,
        1.7709-1.1921e-07j, 2.0719+8.9407e-08j, 0.2812+2.9802e-08j,
        3.7059+3.1875e-08j, 1.9538+1.1656e-07j, 0.0109-6.0536e-09j,
        1.4498+4.3480e-08j, 1.0370+5.0948e-09j, 6.0617-6.8784e-08j,
        1.9299+5.3966e-08j, 0.6927+6.1044e-08j, 8.3503-1.7911e-07j,
        0.5602+4.6585e-08j, 1.3021-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.9626877307891846+9.717034288314608e-09j)
torch.linalg.det(H.mH@H) = tensor([2.6469-3.5008e-08j, 1.4743+6.9302e-08j, 1.2291-2.5591e-09j,
        0.0142-4.8501e-09j, 0.2445-6.2494e-08j, 0.2326+1.9372e-07j,
        0.2418-1.3052e-08j, 1.4629-8.3053e-09j, 1.6975+1.1921e-07j,
        2.7544-6.4464e-09j, 0.6366-7.9419e-08j, 0.2741-2.8312e-07j,
        0.2001+1.0836e-08j, 0.0246+9.3132e-10j, 1.6454-3.7314e-08j,
        2.3901+3.1392e-08j, 0.0668+1.5801e-08j, 5.9165+2.6482e-08j,
        0.4397+1.1341e-08j, 0.2468-7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1919423341751099-3.0505575843164934e-09j)
SINR torch.Size([20]) = tensor([12.6079,  8.6813, 11.1220, -6.1295,  4.8137, -0.6045,  4.9138,  7.7224,
         9.7288, 11.3190,  5.1094,  1.0682,  3.4675, -2.3647, 10.4518,  9.3592,
        -1.7171, 14.2478,  4.6676,  3.2559], device='cuda:0')
SINR mean = 5.586019992828369
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5815858840942383
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9480, 0.8807, 0.9283, 0.1960, 0.7518, 0.4653, 0.7561, 0.8555, 0.9038,
        0.9313, 0.7643, 0.5612, 0.6896, 0.3671, 0.9173, 0.8961, 0.4024, 0.9638,
        0.7455, 0.6791], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 54, 111,  72, 566, 202, 375, 199, 130,  93,  69, 194, 318, 241, 437,
         81,  99, 414,  39, 206, 247], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 15-----------
Real SNR = tensor([15.8417, 10.1554, 17.0391, 12.2575, 13.7975, 17.7763, 17.7611, 14.4494,
        11.4037, 12.3095, 15.4001, 13.7827, 11.3598, 11.2946, 11.9467, 11.8575,
         9.5555, 14.0424, 12.5656, 10.3896], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.6594-3.5763e-07j, 0.3350-6.8337e-10j, 2.0440-6.7229e-08j,
        2.2887-2.0452e-08j, 0.0338-3.6508e-07j, 4.9549+1.8991e-07j,
        4.3061-1.1727e-07j, 2.4359+2.5721e-08j, 1.2500+8.2048e-09j,
        0.8512-5.2204e-09j, 0.0913+2.3227e-07j, 0.7613+3.0463e-08j,
        0.6167-2.2352e-08j, 0.6808-5.6767e-08j, 1.6478+6.5523e-09j,
        1.0743+1.1921e-07j, 0.5873+6.2085e-09j, 1.2095-3.8743e-07j,
        3.3600-1.8596e-08j, 0.1468-1.7091e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.5667413473129272-4.086286509163983e-08j)
torch.linalg.det(H.mH@H) = tensor([4.6139-5.4275e-09j, 0.1479+6.4494e-09j, 2.5929-1.2342e-07j,
        1.0575-3.1044e-08j, 0.5602-1.4901e-08j, 4.8220-3.6025e-08j,
        5.2982+5.2165e-08j, 0.3869-2.1607e-07j, 0.0677+2.1174e-09j,
        0.5702-2.1860e-08j, 0.2855+8.7783e-08j, 0.7687+4.2967e-08j,
        1.1488-0.0000e+00j, 0.7714+4.2781e-09j, 1.2678+1.1921e-07j,
        0.0839+1.9372e-07j, 0.1385-1.8013e-09j, 0.0290-3.3528e-08j,
        0.3291-2.9802e-08j, 0.3000+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.261997103691101+1.2306359264968592e-09j)
SINR torch.Size([20]) = tensor([13.7808,  5.7373, 11.2349, 10.2295,  5.9020, 12.6958, 13.8167,  3.8777,
         1.7336,  8.2261,  2.4218,  7.8874,  9.3826, 10.0068, 10.1843, -1.6763,
         5.3620, -6.3936,  4.7583,  6.7404], device='cuda:0')
SINR mean = 6.795412540435791
E[H^H] = 1e-07
E_MSE (Error Power) = 0.45338866114616394
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9598, 0.7894, 0.9300, 0.9134, 0.7956, 0.9490, 0.9601, 0.7095, 0.5985,
        0.8692, 0.6359, 0.8601, 0.8966, 0.9092, 0.9125, 0.4047, 0.7746, 0.1866,
        0.7494, 0.8252], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 43, 177,  70,  85, 173,  53,  42, 229, 296, 120, 273, 127,  99,  88,
         85, 413, 187, 575, 203, 152], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 16-----------
Real SNR = tensor([18.6667, 16.3099, 16.1930, 17.1321, 18.8951, 12.0928, 15.7373, 12.3830,
        13.3257, 18.2630, 15.3124, 15.9974,  9.1295, 14.2173, 15.7498, 16.9243,
        17.7927, 16.1620, 13.3297, 12.8079], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.8212+4.2763e-07j,  5.3634+1.8776e-08j,  5.0498-1.5924e-07j,
        12.4278-1.4064e-07j,  3.1275+3.5763e-07j,  1.1496+1.0307e-08j,
         1.6208-7.5916e-09j,  0.2649+3.3919e-08j,  0.7619+5.6867e-09j,
         5.8706+1.1242e-09j,  3.8758-7.7271e-08j,  1.3468-7.7395e-08j,
         0.1150+5.6784e-10j,  0.2016+5.2154e-08j,  0.6796-4.5076e-07j,
         1.0657-5.6642e-08j,  4.3606+5.4402e-08j,  0.7520-4.2684e-09j,
         1.3844+1.0238e-07j,  2.1265+5.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.718261480331421+4.824406207859511e-09j)
torch.linalg.det(H.mH@H) = tensor([3.0583+1.4778e-07j, 5.2244+1.3857e-07j, 3.0390+7.0438e-10j,
        7.5671-8.5760e-08j, 8.4983+7.1526e-07j, 0.9427-1.0471e-08j,
        2.4068+2.7354e-09j, 0.2118+1.8126e-09j, 1.4911+4.1431e-08j,
        3.0294-1.1124e-07j, 2.7731+2.0219e-08j, 0.5991+3.7696e-08j,
        0.0168+8.4420e-10j, 0.9010-5.0116e-09j, 0.4631+5.9605e-08j,
        2.0530+7.8971e-08j, 1.3482+4.2247e-08j, 0.7422+6.8056e-09j,
        0.9595-5.4468e-08j, 0.5622+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2943496704101562+5.436666583591432e-08j)
SINR torch.Size([20]) = tensor([11.6361, 15.9862, 14.2537, 16.5983, 15.5732, 11.7394, 13.9809,  5.7928,
        13.6775, 13.0053, 14.2260,  7.8163, -0.8292, 10.8980,  3.9456, 11.1033,
        11.1985,  9.6712,  9.3327,  9.2631], device='cuda:0')
SINR mean = 10.943439483642578
E[H^H] = 1e-07
E_MSE (Error Power) = 0.14016714692115784
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9358, 0.9754, 0.9638, 0.9786, 0.9730, 0.9372, 0.9616, 0.7915, 0.9589,
        0.9523, 0.9636, 0.8581, 0.4524, 0.9248, 0.7127, 0.9280, 0.9295, 0.9026,
        0.8956, 0.8941], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 65,  27,  39,  23,  29,  64,  41, 176,  43,  50,  39, 128, 383,  75,
        227,  72,  71,  94,  99, 101], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 17-----------
Real SNR = tensor([18.7772, 19.1278, 17.8669, 17.7021, 16.5640, 19.2400, 16.4950, 17.1282,
        14.6387, 17.6903, 12.7649, 20.6274, 12.1540, 19.8495, 12.9459, 15.1805,
        12.9820, 18.5231, 19.0707, 14.7873], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.5579-1.1921e-07j, 9.4142-2.3650e-07j, 1.5131+9.1293e-09j,
        2.9623+2.3842e-07j, 1.2404+2.4636e-08j, 8.1185+1.1921e-07j,
        0.5189-1.0431e-07j, 1.7576+2.3403e-08j, 0.6048-8.9407e-08j,
        9.9189+3.1750e-08j, 0.5920+2.9802e-08j, 3.0915+4.7684e-07j,
        0.7908-0.0000e+00j, 0.3796-9.2993e-09j, 0.0661-1.4809e-09j,
        2.8359+4.6830e-08j, 0.5044-8.2331e-10j, 0.7179+1.0153e-07j,
        3.3301+5.9605e-07j, 1.5682+1.7881e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.674150228500366+6.576902222832359e-08j)
torch.linalg.det(H.mH@H) = tensor([6.2265e+00+7.1253e-08j, 8.5516e+00-6.9416e-08j, 8.0551e-01+4.5362e-08j,
        1.2796e-01+1.8626e-08j, 1.6395e+00-1.1462e-08j, 3.8609e+00+1.1921e-07j,
        1.8216e+00+5.9605e-08j, 2.1608e+00+5.6319e-08j, 5.8165e-02+2.3283e-09j,
        3.0892e+00+3.3624e-08j, 6.3564e-01+2.9802e-08j, 2.3422e+00-2.0862e-07j,
        3.7148e-01+2.9802e-08j, 4.5265e-01+3.7267e-10j, 9.8520e-04-6.4190e-09j,
        9.2818e-01-8.9407e-08j, 4.8927e-02+3.2420e-09j, 1.2909e+00-2.7311e-08j,
        4.2089e+00-2.3842e-07j, 1.1146e+00+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9868087768554688-3.1147429080391476e-09j)
SINR torch.Size([20]) = tensor([ 16.8074,  17.6697,   9.2605,  -1.6909,  12.8041,  12.9832,  11.6384,
         14.0135,  -0.1467,  15.8378,   9.7548,  10.0699,   8.0392,   6.5158,
        -14.2653,  10.2498,   0.6761,   9.9860,  13.8699,  12.2381],
       device='cuda:0')
SINR mean = 8.81556224822998
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5099352598190308
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9796, 0.9832, 0.8940, 0.4039, 0.9502, 0.9521, 0.9358, 0.9618, 0.4916,
        0.9746, 0.9043, 0.9104, 0.8643, 0.8176, 0.0361, 0.9137, 0.5388, 0.9088,
        0.9606, 0.9436], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 22,  18, 101, 413,  52,  50,  65,  41, 359,  28,  92,  87, 124, 158,
        803,  84, 331,  89,  42,  58], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 18-----------
Real SNR = tensor([16.2526, 16.7828, 21.2059, 18.6884, 15.8351, 19.5579, 16.6271, 20.4330,
        17.0208, 16.2087,  6.5869, 18.0722, 15.6892, 19.0445, 15.4017, 14.1599,
        15.1404, 14.2120, 15.3425, 16.3362], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1094-0.0000e+00j,  0.4894-2.9802e-08j, 16.9472+1.3516e-07j,
         4.6278-4.4017e-08j,  1.4449-1.8055e-08j,  2.0457+4.1723e-07j,
         1.8918-2.0660e-08j,  9.4707+1.1233e-07j,  2.2918-1.2999e-08j,
         0.7168-1.4901e-07j,  0.0649+4.6566e-10j,  4.4817+3.9446e-08j,
         0.3466+1.4901e-08j,  6.8087+3.0306e-08j,  5.2298-5.0650e-08j,
         0.0664+1.2107e-08j,  1.4625-2.0619e-08j,  0.7635-5.1665e-08j,
         1.7006-4.8353e-08j,  0.8955-2.4431e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.0927751064300537+1.568357710368673e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1198+1.4901e-08j,  0.1917+5.9605e-08j, 11.5892+1.2486e-07j,
         4.2042-1.1796e-07j,  0.9861+1.4901e-08j,  4.1831-0.0000e+00j,
         1.5992-4.0337e-08j, 12.5040-5.2475e-08j,  2.9309+7.4797e-09j,
         0.9253-2.9802e-08j,  0.0488-1.7203e-10j,  4.9266-1.2217e-08j,
         0.2695-2.2352e-08j,  3.8885-2.8871e-07j,  2.9266-6.0481e-08j,
         0.0725+7.4506e-09j,  2.7816+6.3527e-08j,  0.3409-1.5881e-08j,
         0.8012-1.6091e-08j,  0.8152-2.0125e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.805255651473999-1.828871454279124e-08j)
SINR torch.Size([20]) = tensor([ 4.3640,  5.5951, 18.4461, 16.2747, 12.5135, 15.0227, 15.1204, 19.8822,
        17.1948, 11.3857,  6.5257, 17.5357,  6.3404, 15.0673, 16.5797,  3.6037,
        16.1279,  8.4781, 13.7035, 12.0462], device='cuda:0')
SINR mean = 12.590374946594238
E[H^H] = 1e-07
E_MSE (Error Power) = 0.09756544977426529
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7320, 0.7839, 0.9859, 0.9770, 0.9469, 0.9695, 0.9702, 0.9898, 0.9813,
        0.9322, 0.8180, 0.9827, 0.8115, 0.9698, 0.9785, 0.6963, 0.9762, 0.8757,
        0.9591, 0.9412], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([214, 181,  16,  25,  55,  33,  32,  11,  21,  68, 157,  19, 162,  33,
         24, 237,  26, 115,  43,  60], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 19-----------
Real SNR = tensor([20.4698, 17.1438, 19.4636, 15.8151, 15.1715, 20.2041, 16.0887, 19.7577,
        14.5581, 13.7123, 18.5004, 17.4889, 19.7024, 15.3237, 14.8740, 18.0111,
        16.4744, 14.3526, 19.3652, 19.4473], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.7528-1.9886e-07j, 0.3876+1.4124e-08j, 0.3487+9.5302e-08j,
        0.0945-3.7253e-09j, 0.1307-2.6077e-08j, 1.0657-0.0000e+00j,
        0.3774+8.8210e-08j, 4.3682-5.9003e-08j, 0.2589+7.4506e-09j,
        0.2043+2.9802e-08j, 0.4952+4.5430e-08j, 0.6581-1.5755e-08j,
        0.6725-6.6075e-08j, 0.6797-9.8875e-10j, 1.8908+1.2805e-08j,
        2.2354+8.6192e-08j, 1.1852-1.1109e-08j, 0.0354+1.5675e-08j,
        4.5287+1.1921e-07j, 2.7744-1.1695e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.3572046756744385+6.045290046330365e-09j)
torch.linalg.det(H.mH@H) = tensor([4.4071-9.8171e-08j, 0.7506+1.9107e-08j, 1.6680-1.8511e-07j,
        0.0764+3.1199e-08j, 0.1646+7.4506e-09j, 1.0531-1.7881e-07j,
        0.7488+1.6067e-08j, 3.8278+5.2396e-08j, 0.3343-2.2352e-08j,
        0.1535-0.0000e+00j, 1.3564-3.0531e-08j, 0.7080+1.2165e-09j,
        1.2949+8.7088e-09j, 0.7525-1.5450e-08j, 1.0941-1.3474e-08j,
        2.2473-2.6372e-08j, 1.0463-1.4710e-08j, 0.1150+1.8967e-08j,
        4.0480+2.9802e-08j, 1.9407+1.3729e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.389356017112732-1.9317143440389373e-08j)
SINR torch.Size([20]) = tensor([17.1634, 13.6984, 13.8981,  3.6916,  7.2714,  9.3590, 12.2529, 16.4558,
        10.5742,  7.2455, 12.6854, 12.5692, 13.8232, 14.6960, 14.7597, 16.2710,
        15.2364,  5.5044, 16.8421, 15.9249], device='cuda:0')
SINR mean = 12.496121406555176
E[H^H] = 1e-07
E_MSE (Error Power) = 0.08503231406211853
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9811, 0.9591, 0.9608, 0.7006, 0.8421, 0.8961, 0.9438, 0.9779, 0.9194,
        0.8414, 0.9489, 0.9476, 0.9602, 0.9672, 0.9677, 0.9769, 0.9709, 0.7803,
        0.9797, 0.9751], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 21,  43,  42, 234, 140,  99,  58,  24,  80, 141,  53,  54,  42,  35,
         35,  25,  31, 183,  22,  27], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 20-----------
Real SNR = tensor([17.5154, 20.1921, 20.1385, 19.5023, 19.7176, 11.5570, 22.0845, 14.2065,
        23.6726, 17.6310, 15.9356, 18.4293, 20.6648, 16.7511, 19.3390, 13.7546,
        17.1795, 18.6956, 19.5276, 19.8029], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.2934-3.4702e-08j,  3.2913-1.0583e-08j,  6.7227-1.1391e-07j,
         3.3313+3.8251e-08j,  3.1880+9.7916e-08j,  0.0752-1.4901e-08j,
        18.8485-3.9196e-07j,  0.1250-1.0597e-09j, 25.3353+1.5182e-07j,
         0.2583+7.4238e-10j,  0.2929+5.2309e-10j,  0.4046-4.3753e-08j,
         2.2811-2.3229e-08j,  0.1596-7.4506e-09j,  5.5318+1.4566e-07j,
         0.0319-6.5193e-09j,  1.0864-1.1671e-08j,  0.5421+5.1683e-09j,
         5.3335+3.8439e-08j,  3.5705+1.2314e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.085179805755615-8.44545322564727e-09j)
torch.linalg.det(H.mH@H) = tensor([8.8199e-01+7.4729e-09j, 2.6827e+00+1.7236e-08j, 4.7105e+00+1.0509e-08j,
        3.0990e+00+7.3498e-08j, 1.8619e+00+4.2904e-09j, 4.5055e-02-2.8248e-09j,
        1.2542e+01-8.8671e-08j, 6.5743e-02-1.8626e-09j, 2.1904e+01+1.2628e-07j,
        3.2801e-01+8.5854e-09j, 4.1102e-01-5.1967e-09j, 9.6198e-01+5.0904e-08j,
        3.2714e+00-5.8752e-09j, 1.9691e-01-7.4506e-09j, 4.8893e+00+1.6241e-09j,
        1.7895e-02-1.3970e-09j, 7.8944e-01-2.8867e-09j, 1.0929e+00+1.1777e-08j,
        3.7565e+00+9.7890e-08j, 2.4231e+00-1.9936e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.2965824604034424+1.3698157275143785e-08j)
SINR torch.Size([20]) = tensor([14.7804, 18.5616, 19.4976, 18.6411, 16.3231,  6.3003, 21.3971,  7.4989,
        22.8549, 12.6881, 12.5208, 13.4695, 18.0805,  5.8033, 19.6940,  2.1638,
        15.7678, 16.3197, 19.4151, 17.1935], device='cuda:0')
SINR mean = 14.948559761047363
E[H^H] = 1e-07
E_MSE (Error Power) = 0.07189345359802246
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9678, 0.9863, 0.9889, 0.9865, 0.9772, 0.8101, 0.9928, 0.8490, 0.9948,
        0.9489, 0.9470, 0.9570, 0.9847, 0.7919, 0.9894, 0.6220, 0.9742, 0.9772,
        0.9887, 0.9813], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 35,  15,  12,  15,  25, 163,   8, 135,   5,  53,  55,  45,  17, 175,
         12, 282,  28,  25,  12,  21], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 21-----------
Real SNR = tensor([16.9985, 16.5962, 18.9237, 21.9613, 13.4837, 19.7479, 16.4351, 17.2085,
        23.5800, 18.7877, 12.9545, 21.4671, 19.4351, 23.6088, 17.1058, 18.5040,
        16.7077, 22.6616, 14.5026, 19.2970], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.4330+8.7527e-09j, 0.1179+9.1317e-09j, 0.4035+4.7879e-09j,
        0.7747-2.8406e-09j, 0.1864+6.1984e-10j, 1.2812+4.0871e-09j,
        0.3688-0.0000e+00j, 0.7930+8.3025e-09j, 3.5597+1.1858e-06j,
        0.6159-5.5879e-08j, 0.7265+8.2210e-09j, 1.7958+1.1420e-07j,
        0.7513+1.4901e-08j, 4.2930+1.3389e-08j, 0.0410-5.0291e-08j,
        0.2894-9.0572e-10j, 0.0361+1.8626e-09j, 4.5173+9.6433e-08j,
        0.1326-1.6864e-12j, 0.3460-7.2989e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.1231470108032227+6.438030908384462e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6941+3.1536e-09j, 0.0366-8.1818e-09j, 0.4219-5.6704e-09j,
        1.2271-2.2317e-09j, 0.1853+3.0407e-09j, 0.4675+3.3885e-09j,
        0.1870+1.1176e-08j, 0.6987+3.0582e-09j, 2.0497-1.4119e-07j,
        0.5069-6.1467e-08j, 0.3878+3.7288e-09j, 1.8075-2.0109e-08j,
        1.3107+5.9605e-08j, 3.8010+4.4924e-09j, 0.0550+1.1921e-07j,
        0.4737-7.6345e-09j, 0.0269+1.1931e-09j, 3.2624-9.2505e-08j,
        0.1565+3.7253e-09j, 0.1482-1.5389e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.8952326774597168-6.930538809513109e-09j)
SINR torch.Size([20]) = tensor([15.9746,  3.4504, 12.5921, 15.9480, 13.5052, 12.3348,  9.5750, 16.1977,
        15.0736, 12.3908, 15.3997, 17.3202, 15.7751, 19.7036,  2.4285, 12.7193,
         4.5704, 17.8004, 10.7635,  8.2871], device='cuda:0')
SINR mean = 12.590495109558105
E[H^H] = 1e-07
E_MSE (Error Power) = 0.10412273555994034
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9754, 0.6888, 0.9478, 0.9752, 0.9573, 0.9448, 0.9007, 0.9766, 0.9698,
        0.9455, 0.9720, 0.9818, 0.9742, 0.9894, 0.6363, 0.9492, 0.7412, 0.9837,
        0.9226, 0.8708], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 27, 241,  54,  27,  45,  57,  95,  26,  33,  56,  30,  20,  28,  12,
        273,  53, 209,  18,  77, 119], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 22-----------
Real SNR = tensor([16.5166, 21.2518, 22.7239, 23.8142, 22.9650, 18.5483, 20.5116, 20.4093,
        18.6465, 20.2972, 15.4024, 24.4998, 19.1542, 18.5824, 19.9235, 15.0360,
        18.8756, 23.9752, 21.7057, 20.1236], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3515+2.9802e-08j, 3.4177-3.5610e-08j, 3.3414+4.5395e-08j,
        7.6093-2.9802e-07j, 6.8579+2.1236e-07j, 0.6898-4.4703e-08j,
        1.0952-1.8408e-09j, 0.0302+4.7956e-08j, 2.5351+6.5947e-08j,
        2.0741+2.7126e-08j, 0.0884-9.3132e-09j, 3.8504+2.7950e-07j,
        1.0888+4.9263e-08j, 0.9241+1.8468e-08j, 0.0664-5.7372e-08j,
        0.0900+1.1345e-09j, 0.0444+3.2640e-11j, 0.0244-6.7537e-08j,
        0.2812+3.2660e-09j, 0.8338-5.0004e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7646989822387695+1.3042639857019367e-08j)
torch.linalg.det(H.mH@H) = tensor([0.2191+7.4506e-09j, 1.9106-9.2555e-09j, 5.1364+3.6356e-07j,
        5.9896+3.5763e-07j, 5.4483+1.0096e-08j, 0.3886-2.2352e-08j,
        1.4533+1.0978e-08j, 0.2976+3.2833e-08j, 1.2196+9.1706e-09j,
        2.2279-2.7342e-08j, 0.0061-3.4925e-09j, 4.1266-4.2150e-08j,
        0.9945+1.0712e-08j, 1.0639+8.3183e-09j, 0.1694+6.3557e-09j,
        0.1351-0.0000e+00j, 0.1696+4.5174e-09j, 0.0916-5.1495e-08j,
        0.0965-1.9197e-08j, 0.5829+6.8930e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.586370587348938+3.5763203953820266e-08j)
SINR torch.Size([20]) = tensor([11.9184, 19.8469, 20.2913, 19.8164, 21.9591, 12.3073, 19.1705, 11.1875,
        18.1008, 19.6032, -2.2522, 18.7612, 17.7351, 17.5474,  9.3998, 11.7306,
        11.6654,  4.0315,  6.4500, 14.0918], device='cuda:0')
SINR mean = 14.1680908203125
E[H^H] = 1e-07
E_MSE (Error Power) = 0.135378897190094
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9396, 0.9897, 0.9907, 0.9897, 0.9937, 0.9445, 0.9880, 0.9293, 0.9848,
        0.9892, 0.3732, 0.9869, 0.9834, 0.9827, 0.8970, 0.9371, 0.9362, 0.7167,
        0.8154, 0.9625], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 62,  11,  10,  11,   7,  57,  13,  71,  17,  12, 433,  14,  18,  19,
         98,  64,  65, 224, 159,  40], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 23-----------
Real SNR = tensor([25.2288, 21.8432, 22.1099, 22.5170, 20.9694, 19.2168, 25.7807, 20.9529,
        25.4120, 22.2133, 24.7348, 23.6144, 19.5973, 28.8741, 22.3880, 20.0054,
        20.5215, 20.3512, 24.1562, 20.6085], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.6061+1.1968e-07j,  1.1504+1.1921e-07j,  0.5034-3.2846e-08j,
         2.6418-4.4142e-08j,  0.5462+8.9407e-08j,  0.1859+2.5336e-08j,
        14.1115+1.1345e-07j,  2.4920+2.0108e-08j,  9.7079+2.2566e-08j,
         0.6000+9.0518e-08j,  4.9486-1.4501e-07j,  0.6700+4.9313e-09j,
         0.4214+1.2336e-09j,  1.4064-1.1182e-07j,  0.5652-9.3073e-08j,
         0.3111+2.0682e-08j,  4.1046-4.3753e-08j,  1.0621+8.8863e-09j,
         1.5119+2.9802e-08j,  1.0348+2.5136e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.429067611694336+1.1015128364988414e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.9998-5.9228e-08j,  0.9009+2.9802e-08j,  0.5180+4.5227e-08j,
         2.9074-6.6829e-08j,  0.2336-4.4703e-08j,  0.3813-7.0546e-09j,
        14.9597+3.6970e-08j,  1.5952-1.5634e-08j,  8.0973-2.3842e-07j,
         0.5092-1.3364e-07j,  2.5214-1.1611e-07j,  0.7573-9.0972e-08j,
         0.4180+5.0760e-09j,  2.1401+5.8990e-07j,  0.2495-7.4322e-08j,
         0.2135+2.1157e-08j,  3.3036-2.8855e-08j,  1.4902-3.9276e-09j,
         1.1512-0.0000e+00j,  1.0987-1.8349e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2222964763641357-8.495368852834417e-09j)
SINR torch.Size([20]) = tensor([14.7552, 16.4921, 14.6839, 21.5147, 12.4576, 15.5191, 25.3961, 19.1366,
        21.4780, 14.7432, 18.0703, 15.5844, 16.6693, 16.9067, 13.3253, 10.4051,
        22.0634, 20.1026, 14.7376, 19.4185], device='cuda:0')
SINR mean = 17.17299461364746
E[H^H] = 1e-07
E_MSE (Error Power) = 0.023797282949090004
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9676, 0.9781, 0.9671, 0.9930, 0.9463, 0.9727, 0.9971, 0.9879, 0.9929,
        0.9675, 0.9846, 0.9731, 0.9789, 0.9800, 0.9556, 0.9165, 0.9938, 0.9903,
        0.9675, 0.9887], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([35, 24, 35,  8, 56, 30,  3, 13,  8, 35, 17, 29, 23, 22, 47, 82,  7, 11,
        35, 12], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 24-----------
Real SNR = tensor([19.6523, 23.3431, 24.1879, 25.5267, 22.5383, 21.7346, 29.3960, 22.1856,
        24.7194, 11.7628, 14.5606, 23.7485, 25.7475, 25.3319, 24.7722, 22.0714,
        28.0170, 21.5999, 21.5483, 20.9078], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1347e-01-6.2431e-09j, 4.1571e+00+1.1650e-08j, 2.1891e-01-1.0053e-07j,
        1.8588e+00-2.7908e-08j, 2.0039e-01-5.4017e-08j, 2.2822e-01-7.5133e-09j,
        7.1790e+00-9.0058e-07j, 8.4790e-01+4.1131e-08j, 8.2910e-01-1.8461e-07j,
        5.6295e-03-2.9104e-10j, 1.1339e-01+5.7602e-11j, 7.5904e+00-2.3308e-08j,
        2.4490e+00-5.0307e-08j, 4.0214e+00+9.6423e-08j, 2.9284e-01-4.0857e-08j,
        5.7084e-02-1.8853e-08j, 1.8303e+00-6.1495e-07j, 2.2831e-01-4.2489e-08j,
        1.5861e+00-6.9616e-09j, 9.1913e-01+1.8044e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7363255023956299-9.560562830301933e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1662+1.9387e-09j,  4.2397+1.0097e-07j,  0.4703-1.0311e-08j,
         1.5597-9.2654e-08j,  0.5086+1.4901e-08j,  0.3220-6.7433e-09j,
        10.5762+3.2787e-06j,  1.0917+3.1642e-08j,  0.9930-2.0735e-08j,
         0.0147+1.1445e-10j,  0.0425-1.8626e-09j,  7.5486+6.1603e-08j,
         3.2932-1.8617e-07j,  4.2422-2.4040e-08j,  0.3763+4.6965e-08j,
         0.0580+1.1771e-08j,  2.1172+1.4762e-07j,  0.3133-1.4410e-08j,
         1.9338+2.9616e-08j,  1.0176-2.8385e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.044241428375244+1.6830635729547794e-07j)
SINR torch.Size([20]) = tensor([14.6636, 23.5316, 14.6036, 17.6977, 14.8146, 15.0028, 22.7653, 19.6493,
        16.6726,  9.9594, 11.1404, 24.9242, 20.5096, 23.7710, 13.0511,  6.0222,
        17.4021, 14.0482, 21.5060, 20.2686], device='cuda:0')
SINR mean = 17.100183486938477
E[H^H] = 1e-07
E_MSE (Error Power) = 0.03401106595993042
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9670, 0.9956, 0.9665, 0.9833, 0.9681, 0.9694, 0.9947, 0.9893, 0.9789,
        0.9083, 0.9286, 0.9968, 0.9912, 0.9958, 0.9528, 0.8001, 0.9821, 0.9621,
        0.9930, 0.9907], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 35,   5,  36,  18,  34,  33,   6,  12,  23,  89,  72,   3,  10,   4,
         49, 170,  20,  40,   8,  10], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 25-----------
Real SNR = tensor([23.1666, 27.2826, 23.3087, 22.4791, 27.4044, 20.3035, 24.9043, 24.3244,
        21.9740, 22.5229, 25.2146, 25.1763, 25.4942, 26.9600, 26.0813, 27.7430,
        19.7146, 25.2335, 24.7331, 21.5859], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.2297-2.2363e-09j, 5.2241-4.3150e-08j, 0.3193+2.8770e-08j,
        0.1188-1.5705e-08j, 2.4742+5.3394e-08j, 0.5428-6.3864e-09j,
        2.0487+1.1921e-07j, 0.3610-1.6827e-08j, 0.6262-8.9407e-08j,
        1.9547-3.4137e-09j, 3.9259-2.3842e-07j, 3.0101+2.0928e-09j,
        0.9086-3.0533e-08j, 0.7161-4.8186e-09j, 0.0751-5.7306e-08j,
        1.1753-8.9407e-08j, 0.0719-2.8326e-09j, 0.7103-1.2565e-09j,
        3.4391+1.6822e-08j, 0.0629+4.0676e-12j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.3997474908828735-1.907031155212735e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1594+8.4929e-09j, 5.4048-1.9405e-07j, 0.3424+8.7515e-08j,
        0.1109-1.8608e-08j, 2.2288-7.1534e-08j, 0.6047+8.0013e-09j,
        1.9409+1.1820e-08j, 0.4657+5.5614e-08j, 1.0549-0.0000e+00j,
        1.2551+3.7107e-08j, 5.3377-4.7112e-08j, 3.7208+2.0799e-08j,
        1.1310-4.1398e-08j, 0.8421+1.8119e-08j, 0.0519-2.3303e-09j,
        1.2029-2.9802e-07j, 0.0857-2.9776e-09j, 0.8083+4.4539e-08j,
        2.9796+1.8514e-08j, 0.1025+5.8409e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.491511583328247-1.7983296629608958e-08j)
SINR torch.Size([20]) = tensor([13.3242, 24.5450, 15.7925, 11.4464, 19.7316, 19.1219, 21.3102, 16.1156,
        20.4138, 20.2392, 24.0181, 23.4356, 18.9450, 18.4135,  6.6472, 15.6584,
        12.9536, 18.2848, 23.7248, 12.8006], device='cuda:0')
SINR mean = 17.846097946166992
E[H^H] = 1e-07
E_MSE (Error Power) = 0.029593665152788162
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9556, 0.9965, 0.9743, 0.9331, 0.9895, 0.9879, 0.9927, 0.9761, 0.9910,
        0.9906, 0.9961, 0.9955, 0.9874, 0.9858, 0.8221, 0.9735, 0.9518, 0.9854,
        0.9958, 0.9501], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 47,   4,  28,  68,  12,  13,   8,  26,  10,  10,   4,   5,  14,  16,
        155,  29,  50,  16,   4,  52], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 26-----------
Real SNR = tensor([30.0798, 26.9657, 26.1714, 20.9868, 22.6014, 22.6949, 25.3837, 18.8392,
        20.3887, 19.3630, 23.8499, 29.1289, 18.2293, 21.6042, 20.7304, 19.5765,
        27.7361, 25.3261, 26.6985, 23.8053], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.2566+1.0592e-07j,  2.6344+3.8489e-08j,  1.7195+5.9478e-08j,
         0.0511+3.1699e-08j,  0.0401-1.5069e-09j,  0.2081-9.3132e-09j,
         1.2382-1.8543e-08j,  0.0637-5.5879e-09j,  0.0893-0.0000e+00j,
         0.0546+3.7253e-09j,  1.2467+1.8700e-08j, 16.3201-1.6907e-07j,
         0.1421+1.4901e-08j,  0.8098-8.9407e-08j,  1.6542+3.1637e-09j,
         0.2515+2.6953e-09j,  3.2125-3.5198e-08j,  0.8632+8.3453e-09j,
         5.1528-1.3280e-08j,  0.1473-1.1973e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1077921390533447-2.799016796117826e-09j)
torch.linalg.det(H.mH@H) = tensor([ 3.6904-1.2181e-07j,  2.5954+1.9660e-08j,  1.5730-6.5680e-08j,
         0.0249-5.8208e-09j,  0.0867-2.6306e-08j,  0.3243-3.7253e-09j,
         0.8081-1.9965e-08j,  0.0755-3.7253e-09j,  0.0404+1.0245e-08j,
         0.1111-7.4506e-09j,  0.8417+4.9655e-08j, 14.6906+2.5210e-07j,
         0.1327-7.4506e-09j,  0.5256-0.0000e+00j,  1.1926-1.6437e-08j,
         0.1840-0.0000e+00j,  3.0902+1.7353e-08j,  1.0806+2.2992e-08j,
         5.8719+6.2490e-08j,  0.2490+2.2145e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8594303131103516+7.916890254477948e-09j)
SINR torch.Size([20]) = tensor([22.3336, 23.2918, 21.3071,  8.3135, 11.5303, 16.4456, 20.1692, 13.9734,
         9.8748, 14.9171, 20.3452, 28.1762, 15.7347, 17.0823, 22.9676, 16.3018,
        24.4214, 20.9949, 26.0042, 16.9797], device='cuda:0')
SINR mean = 18.558218002319336
E[H^H] = 1e-07
E_MSE (Error Power) = 0.02666510082781315
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9942, 0.9953, 0.9927, 0.8715, 0.9343, 0.9778, 0.9905, 0.9615, 0.9067,
        0.9688, 0.9908, 0.9985, 0.9740, 0.9808, 0.9950, 0.9771, 0.9964, 0.9921,
        0.9975, 0.9803], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  6,   5,   8, 118,  66,  24,  10,  41,  90,  34,  10,   1,  28,  21,
          5,  25,   4,   9,   2,  22], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 27-----------
Real SNR = tensor([23.2279, 24.6314, 24.4189, 24.6689, 23.0205, 25.2824, 25.0163, 26.0888,
        30.2666, 28.1663, 28.5342, 26.7315, 29.4482, 27.0718, 26.2061, 24.7800,
        27.4225, 24.0713, 20.2218, 24.1960], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2714+2.2464e-09j,  0.3582-8.5551e-09j,  1.2467+6.9834e-09j,
         0.6044+5.4849e-09j,  0.6167-2.1658e-08j,  1.2665+2.1617e-08j,
         0.5128-5.2154e-08j,  0.2805+1.0528e-08j, 10.7386+4.4241e-08j,
         1.6164+1.1169e-07j,  5.7707-3.2198e-08j,  1.6792-6.8420e-08j,
         1.3066-2.9441e-07j,  2.5777-1.1028e-07j,  0.4807-1.8367e-09j,
         1.4247-9.9488e-09j,  3.0190+2.5396e-08j,  2.9437+2.9106e-08j,
         0.5150+4.4906e-09j,  1.4814+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.9355592727661133-1.5393180063938416e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3087-8.2343e-09j,  0.3190-3.1745e-09j,  0.9825-2.4565e-08j,
         0.6853+2.0865e-08j,  0.7365-3.2094e-08j,  0.9864-5.5605e-08j,
         0.3274-8.9407e-08j,  0.0909-2.0489e-08j, 10.7401-7.8187e-08j,
         1.4322+6.9713e-08j,  5.8851-4.4413e-08j,  1.5180+2.7483e-08j,
         1.0814+5.7334e-07j,  2.3425+8.4538e-08j,  0.3671-5.5444e-08j,
         1.4670+6.7526e-09j,  4.3063+1.6247e-07j,  1.9161-2.9802e-08j,
         0.4616-1.7703e-09j,  1.1817-8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8567924499511719+2.0628432295666244e-08j)
SINR torch.Size([20]) = tensor([19.2460, 18.2938, 22.6309, 21.1407, 22.2291, 21.7157, 16.2561,  9.0148,
        28.2264, 19.6180, 26.0658, 22.5944, 19.7170, 24.2784, 18.2693, 23.3395,
        25.5759, 22.8793, 21.5826, 22.1839], device='cuda:0')
SINR mean = 21.242883682250977
E[H^H] = 1e-07
E_MSE (Error Power) = 0.012859731912612915
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9882, 0.9854, 0.9946, 0.9924, 0.9941, 0.9933, 0.9769, 0.8885, 0.9985,
        0.9892, 0.9975, 0.9945, 0.9894, 0.9963, 0.9853, 0.9954, 0.9972, 0.9949,
        0.9931, 0.9940], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 13,  16,   6,   8,   6,   7,  25, 105,   1,  12,   2,   6,  12,   4,
         16,   5,   3,   5,   7,   6], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 28-----------
Real SNR = tensor([25.1213, 26.7759, 29.9531, 24.8705, 25.7611, 24.4387, 28.5009, 26.9889,
        26.6716, 29.8214, 23.4920, 25.5340, 25.0665, 26.1949, 25.3121, 29.9451,
        30.1531, 24.9671, 26.9398, 31.6958], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.2904-6.8527e-09j, 0.2322-5.2154e-08j, 2.8288+6.2984e-07j,
        0.1878-1.3715e-08j, 0.0426+7.4506e-09j, 1.6474+2.9385e-08j,
        0.5027-1.8690e-08j, 2.5342-8.6422e-08j, 1.4660-1.2855e-08j,
        5.2517-1.6649e-08j, 0.3377+1.6764e-08j, 0.5029+3.4677e-08j,
        0.8978+1.0616e-08j, 1.5785-3.4328e-08j, 1.1278+8.3190e-11j,
        1.9690+5.9605e-08j, 5.2895+2.4945e-08j, 1.3266-5.9605e-08j,
        3.0280-1.0851e-08j, 3.1997-4.7334e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7620632648468018+2.2695408219419733e-08j)
torch.linalg.det(H.mH@H) = tensor([0.9998-8.6583e-09j, 0.2673+7.4506e-08j, 3.1114+3.5368e-07j,
        0.1639-2.8567e-08j, 0.0462-1.2107e-07j, 1.6275-4.4811e-08j,
        0.4871-2.9770e-07j, 2.2924+8.3167e-08j, 1.4589-2.9884e-08j,
        5.1788+5.6658e-07j, 0.2092-2.6077e-08j, 0.4706-1.0381e-07j,
        0.8765-5.8429e-09j, 1.5514-1.2593e-08j, 1.3623-4.2921e-09j,
        1.5097-4.7684e-07j, 4.8832-2.7138e-08j, 1.4634+1.4901e-07j,
        2.7425-2.1490e-08j, 2.9977+3.7388e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6849851608276367+2.7780131528487573e-09j)
SINR torch.Size([20]) = tensor([23.7198, 16.8650, 24.0699, 15.7859,  6.8526, 24.1851, 17.7618, 25.2239,
        24.0893, 26.1642, 17.1427, 20.0982, 23.5102, 24.4768, 24.5542, 21.0452,
        27.6717, 23.7447, 26.1556, 24.4135], device='cuda:0')
SINR mean = 21.876506805419922
E[H^H] = 1e-07
E_MSE (Error Power) = 0.0165364108979702
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9958, 0.9798, 0.9961, 0.9743, 0.8289, 0.9962, 0.9835, 0.9970, 0.9961,
        0.9976, 0.9811, 0.9903, 0.9956, 0.9964, 0.9965, 0.9922, 0.9983, 0.9958,
        0.9976, 0.9964], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  4,  22,   4,  28, 150,   4,  18,   3,   4,   2,  21,  11,   5,   4,
          4,   9,   2,   4,   2,   4], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 29-----------
Real SNR = tensor([30.6631, 28.7484, 27.2241, 24.1146, 29.5736, 31.0424, 20.9037, 31.1587,
        27.7234, 29.9673, 31.1831, 27.5076, 30.2059, 31.6246, 27.1441, 29.6526,
        33.3626, 31.0725, 27.5364, 31.2277], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.8369e-01-1.4901e-06j, 1.4866e+00-1.0055e-07j, 4.3742e-02-2.8041e-08j,
        4.2310e-02-3.1665e-08j, 1.4119e-01+3.7948e-08j, 8.2827e-01-8.1606e-08j,
        5.1286e-03-7.5418e-10j, 1.5349e+00-2.3842e-07j, 1.2881e+00+1.3496e-08j,
        1.5678e+00-1.1528e-07j, 9.0625e+00+3.2265e-08j, 4.3348e+00+8.4605e-08j,
        1.4906e+00-1.6573e-08j, 4.2093e-01-2.5373e-08j, 3.2498e+00-1.5184e-08j,
        9.7223e-01+3.7253e-09j, 4.1847e+00-1.3164e-07j, 2.1081e+01-1.2172e-07j,
        2.1342e+00+1.7416e-09j, 4.5031e+00+8.0914e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.952780246734619-1.0711095654869496e-07j)
torch.linalg.det(H.mH@H) = tensor([8.7669e-01+5.9605e-08j, 1.8393e+00+1.7145e-08j, 7.5433e-02-1.1704e-08j,
        3.9793e-02+9.3132e-09j, 2.4391e-01+1.0716e-07j, 6.4750e-01-1.8198e-07j,
        1.7156e-03+1.4966e-09j, 1.6236e+00-2.3842e-07j, 1.2178e+00+2.3846e-08j,
        1.5005e+00-9.7324e-09j, 9.9789e+00-3.9331e-08j, 3.4525e+00+1.4829e-08j,
        1.1637e+00-5.0492e-08j, 4.9464e-01+9.5192e-08j, 3.5646e+00-2.0162e-08j,
        4.8390e-01+1.4901e-08j, 4.9506e+00-2.0850e-07j, 2.2800e+01-5.5143e-08j,
        1.8006e+00-9.8741e-09j, 4.5831e+00-1.5242e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.066927433013916-3.1713526027488115e-08j)
SINR torch.Size([20]) = tensor([19.7971, 25.2349, 13.1307, 13.6806, 17.3165, 18.3355,  2.0813, 21.2552,
        25.1404, 24.1293, 30.4417, 27.7905, 23.3430, 18.4815, 28.2553, 16.3936,
        26.1246, 32.3470, 26.0999, 27.0261], device='cuda:0')
SINR mean = 21.82022476196289
E[H^H] = 1e-07
E_MSE (Error Power) = 0.039959754794836044
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9896, 0.9970, 0.9536, 0.9589, 0.9818, 0.9855, 0.6176, 0.9926, 0.9969,
        0.9962, 0.9991, 0.9983, 0.9954, 0.9860, 0.9985, 0.9776, 0.9976, 0.9994,
        0.9976, 0.9980], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 11,   3,  49,  43,  20,  16, 284,   8,   3,   4,   1,   1,   5,  15,
          1,  24,   2,   0,   2,   2], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)

--- 処理中: 画像 41 から 60 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 40)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6306, 0.6925, 0.4886, 0.7032, 0.5710, 0.5101, 0.6843, 0.5062, 0.6585,
        1.1102, 0.7262, 0.7535, 0.6937, 0.3628, 1.0899, 0.4007, 0.6435, 0.4448,
        0.6772, 0.7563], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -3.2698,  -9.4760,  -6.1288,  -3.6860, -10.5505,  -2.8392, -11.4378,
         -2.0580,  -3.2953,  -9.3436,  -8.0086,  -1.4556,  -6.6181,  -9.1010,
         -5.9017,  -9.5351,  -6.8195,  -7.4702, -11.9559,  -1.9611],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 798.4762+7.6943e-06j,  122.3490-2.0782e-06j,  131.3890+3.8147e-06j,
         313.1005-4.1437e-06j,  134.9492-2.1897e-06j, 1262.2021+1.1688e-05j,
         262.5976+3.2324e-06j,  813.2810+4.9443e-06j,   83.2134-0.0000e+00j,
        2385.0476-4.2198e-05j,  121.3593+3.6420e-06j,  150.3537-1.0454e-05j,
         149.0943+6.0512e-07j,  811.9620+6.3439e-06j,  103.1103+3.8147e-06j,
          31.7709+7.6294e-06j,   19.4310-2.1943e-07j,   19.3128-1.1921e-06j,
         180.9737+2.8851e-06j,  593.3798-1.2181e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(424.36767578125-9.181130735669285e-07j)
torch.linalg.det(H.mH@H) = tensor([ 9.5612+1.6783e-07j,  0.0314+4.0978e-08j,  3.1466+6.3367e-09j,
         4.5616-2.3693e-07j,  0.1298+2.0754e-08j,  3.5962-6.5496e-08j,
         0.2439-0.0000e+00j, 11.0338-4.4510e-08j,  2.3190-2.1234e-07j,
         0.6751-1.4901e-08j,  0.5321+2.6592e-09j,  6.1368-9.3283e-09j,
         0.4162-2.3311e-08j,  0.2880+2.6597e-09j,  1.3468+5.9605e-08j,
         0.6607+1.8386e-08j,  0.3367-5.9605e-08j,  0.5940+2.7982e-10j,
         0.3208+4.3081e-09j,  0.4074-4.3354e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.316903829574585-1.9298857623084587e-08j)
SINR torch.Size([20]) = tensor([ -4.2755, -24.9050,  -6.7611,  -6.9251, -15.9669,  -6.9702, -13.9986,
         -4.2166,  -9.3560, -11.6267, -11.1502,  -6.3542, -13.2005, -13.3396,
        -11.0061, -10.2208, -15.1426, -11.1650, -11.3495, -16.8907],
       device='cuda:0')
SINR mean = -11.241047859191895
E[H^H] = 1e-07
E_MSE (Error Power) = 28.67594337463379
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2720, 0.0032, 0.1741, 0.1687, 0.0247, 0.1673, 0.0383, 0.2747, 0.1039,
        0.0643, 0.0713, 0.1880, 0.0457, 0.0443, 0.0735, 0.0868, 0.0297, 0.0710,
        0.0683, 0.0201], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 504, 1000,  587,  592,  844,  594,  796,  502,  668,  733,  720,  574,
         776,  779,  716,  694,  825,  721,  726,  866], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -4-----------
Real SNR = tensor([-1.7045e+00, -3.8707e+00, -4.3726e+00, -5.2208e+00, -8.9581e+00,
        -6.7826e+00, -7.5596e+00, -5.1245e+00, -2.6583e+00, -2.1801e-03,
        -8.8861e+00, -7.1051e+00, -4.7272e+00, -4.4361e+00, -1.3602e+00,
        -2.8912e+00, -7.8050e+00, -7.4694e+00, -5.7477e+00, -1.0335e+01],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 727.1241+6.8458e-06j, 2007.8115-1.6300e-05j,  347.7440+3.2215e-06j,
         151.0780+3.8126e-06j,  446.1041+9.1297e-06j,  222.3001+8.1363e-06j,
         129.5127-1.7541e-05j,   24.1708-1.9073e-06j,   57.5294+5.7220e-06j,
           4.4354+8.3447e-07j,    7.7118+6.4166e-07j,    9.0244-1.4305e-06j,
         602.8196-3.8915e-05j, 1025.0531-2.6543e-05j,   79.6091+1.1444e-05j,
          13.0600-2.2921e-06j,   79.4675-1.0441e-06j,   37.1417-5.3392e-06j,
         101.9264-1.1444e-05j,  279.5895-7.8124e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(317.66070556640625-4.039047780679539e-06j)
torch.linalg.det(H.mH@H) = tensor([7.7288-8.0664e-08j, 2.9975-9.2617e-08j, 3.3396-2.5184e-08j,
        0.3558+1.7881e-07j, 0.5439+2.8098e-09j, 0.6097-3.1988e-08j,
        0.9259-0.0000e+00j, 0.1649+1.1176e-08j, 6.4512-1.0502e-07j,
        2.4856-2.5073e-07j, 0.5631-2.9802e-08j, 1.7758-2.6385e-08j,
        2.2085-1.0148e-07j, 0.5868+2.5980e-08j, 0.5522-5.3644e-07j,
        2.1676+5.9605e-08j, 0.5991+5.8928e-08j, 1.0618-0.0000e+00j,
        0.8097-8.7398e-08j, 0.2483+7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8087942600250244-5.1147249990890487e-08j)
SINR torch.Size([20]) = tensor([ -4.3599,  -6.7251,  -5.5013, -15.7065,  -9.5812, -10.0160,  -9.7734,
        -19.6472,  -3.3890,  -7.9610, -10.9502,  -6.9288,  -7.9566, -12.7265,
        -14.8942,  -7.8849, -11.0110, -10.1610, -11.3832, -14.4038],
       device='cuda:0')
SINR mean = -10.04803466796875
E[H^H] = 1e-07
E_MSE (Error Power) = 14.622294425964355
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2682, 0.1753, 0.2198, 0.0262, 0.0992, 0.0906, 0.0953, 0.0107, 0.3142,
        0.1379, 0.0744, 0.1686, 0.1380, 0.0507, 0.0314, 0.1400, 0.0734, 0.0879,
        0.0678, 0.0350], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([507, 586, 545, 838, 675, 688, 680, 927, 473, 625, 714, 593, 625, 763,
        819, 623, 716, 692, 727, 806], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -3-----------
Real SNR = tensor([-8.9151, -6.2613, -4.4874, -5.2287, -8.9345, -4.4858, -9.2169, -3.1204,
        -7.0412, -6.9272, -7.5418, -9.0304, -5.6460, -3.5387, -5.4352, -4.8090,
        -0.6842, -4.6963, -5.2113, -5.7800], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.5523e+02-4.6299e-06j, 3.6134e+02-1.4684e-06j, 1.0877e+02-6.0090e-07j,
        8.9486e+01+5.3359e-06j, 2.1220e+00-1.0989e-09j, 2.5925e+02+5.1211e-06j,
        6.1274e+01-1.7483e-06j, 8.6317e-01+1.3721e-05j, 2.5924e+01-3.5286e-05j,
        1.8339e+02-3.9601e-06j, 5.8294e-02-3.4459e-07j, 2.4937e+01+1.9073e-06j,
        3.3344e+01+2.3487e-05j, 1.9315e+01-6.6757e-06j, 4.2253e+02-5.5377e-06j,
        1.8540e+01+3.4268e-08j, 1.2835e+02-3.8539e-07j, 1.0868e+01+9.1617e-08j,
        1.2262e+01-3.8147e-06j, 4.0556e+02+1.1797e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(126.17107391357422-7.318249686250056e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1481+7.4506e-09j, 0.7476+8.1202e-09j, 0.3253-5.5879e-09j,
        1.3483-3.7661e-08j, 0.4625-3.1856e-09j, 1.1522+1.2090e-08j,
        0.1775-1.4901e-08j, 2.7184+3.3300e-08j, 0.2455+7.8935e-10j,
        1.4675-7.8820e-09j, 0.3583-7.3259e-10j, 0.0513+5.1368e-10j,
        0.0099+9.6741e-08j, 0.4211+4.3579e-09j, 3.4712-3.5991e-08j,
        0.6040-4.3629e-08j, 1.0838-2.7523e-08j, 0.5902-1.1295e-08j,
        0.8189-5.9605e-08j, 2.6984-7.1510e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.9450052380561829-7.807044788421535e-09j)
SINR torch.Size([20]) = tensor([-12.7378,  -8.3518, -12.6608,  -6.1166,  -9.2178,  -6.8488, -13.9638,
         -4.8573, -11.1358,  -5.9738,  -9.3355, -16.1350, -28.9160, -11.7378,
         -4.6320, -10.4252, -11.3685, -10.2766,  -8.6402,  -6.0982],
       device='cuda:0')
SINR mean = -10.471467971801758
E[H^H] = 1e-07
E_MSE (Error Power) = 48.174495697021484
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0505, 0.1275, 0.0514, 0.1965, 0.1069, 0.1712, 0.0386, 0.2463, 0.0715,
        0.2017, 0.1044, 0.0238, 0.0013, 0.0628, 0.2561, 0.0831, 0.0680, 0.0858,
        0.1203, 0.1972], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 763,  638,  761,  566,  664,  590,  795,  524,  720,  561,  667,  848,
        1000,  736,  516,  699,  726,  695,  646,  565], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -2-----------
Real SNR = tensor([-10.6316,   3.2991,  -5.7677,  -2.9993,   0.2540, -10.0136,  -1.0275,
         -3.0224,   0.1223,  -2.3605,  -1.3429,  -0.8711,  -0.8059,  -2.6486,
         -5.5066,  -5.8612,  -0.3880,  -2.3192,  -7.3639,  -0.2138],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 15.8370-1.0180e-07j,  92.4024-1.0385e-05j,  17.6335+9.5367e-07j,
        153.7646-7.6294e-06j,  20.4612+1.3152e-07j,  49.4740-7.6939e-07j,
        208.9830-3.6909e-06j,  10.9031-1.3902e-07j,   3.6088-2.9802e-07j,
        188.6553-6.4788e-06j,  72.0997-1.9073e-06j,  88.4466+3.8147e-06j,
        325.4008-3.5673e-06j, 102.7806+1.1444e-05j,   2.6607-3.6152e-07j,
        412.9911+2.6997e-06j, 378.4198-5.7553e-06j,  62.2967-3.3569e-07j,
         21.7478-4.1464e-07j,  81.7138+1.9073e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(115.51403045654297-1.0441356153023662e-06j)
torch.linalg.det(H.mH@H) = tensor([0.0490-1.8626e-09j, 4.4474-2.7405e-07j, 0.5301-8.8829e-10j,
        0.4002-0.0000e+00j, 1.6603-1.7378e-07j, 0.0668+1.8626e-09j,
        3.7477-3.7706e-08j, 0.0112-9.5926e-08j, 5.1931-4.9744e-10j,
        3.4899+4.7684e-07j, 4.5087+1.0009e-07j, 2.4049-1.7881e-07j,
        2.7162+9.0872e-09j, 1.3891+3.5459e-09j, 1.8057+2.0600e-08j,
        0.6936-0.0000e+00j, 2.2352+3.6787e-09j, 2.1622-3.5684e-07j,
        0.0921-5.5879e-09j, 6.1983+1.1141e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.190091371536255-1.994236775715308e-08j)
SINR torch.Size([20]) = tensor([-15.3425,  -5.6996,  -7.7086, -12.5437,  -8.6977, -13.0825,  -3.8538,
        -27.5581,  -2.5414,  -6.6671,  -2.9073,  -7.1622,  -4.5933,  -4.5046,
         -5.7279,  -8.0872,  -6.8162,  -5.8322, -17.3046,  -2.0590],
       device='cuda:0')
SINR mean = -8.434463500976562
E[H^H] = 1e-07
E_MSE (Error Power) = 33.729217529296875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0284, 0.2121, 0.1449, 0.0527, 0.1189, 0.0469, 0.2917, 0.0018, 0.3577,
        0.1772, 0.3386, 0.1612, 0.2578, 0.2617, 0.2110, 0.1345, 0.1723, 0.2070,
        0.0183, 0.3836], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 829,  552,  617,  758,  648,  773,  489, 1000,  443,  584,  456,  600,
         515,  512,  553,  629,  589,  557,  875,  426], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -1-----------
Real SNR = tensor([-9.3493, -2.3602, -3.7921, -2.7956, -3.3453, -1.1970, -1.5159, -1.8594,
        -4.4671, -0.7323, -0.9655,  1.3032, -4.0520, -4.8798, -0.6178, -5.9974,
        -0.3983, -5.6509, -3.5798, -5.6782], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([189.8699+4.5829e-06j, 109.6084+4.4725e-06j,  24.6395-1.9073e-06j,
         17.5667+1.3165e-06j,  16.8795+9.3567e-07j,  19.9580-5.2417e-07j,
         24.4177-3.4417e-08j,  60.7431+4.1978e-07j,  36.3308+9.5367e-07j,
         12.0351+2.3842e-06j,  20.8476+6.3248e-07j, 115.4645-1.0054e-06j,
        290.5216+3.1479e-06j,  16.9656-8.3267e-08j,   1.0071-1.4901e-07j,
          0.5922+8.9407e-08j,  16.1836-4.7684e-07j,  68.4008-5.7780e-07j,
         38.7328-0.0000e+00j,  45.4653-3.5414e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(56.31148147583008+6.91128377638961e-07j)
torch.linalg.det(H.mH@H) = tensor([0.0871+2.9202e-09j, 0.1594+2.4976e-09j, 0.5409+2.9802e-08j,
        0.8135+1.0897e-08j, 0.1935-2.9802e-08j, 0.9085+4.9218e-08j,
        3.5489-3.4880e-08j, 0.7687+8.1596e-08j, 0.0256-2.4214e-08j,
        4.4094-1.4272e-07j, 3.8245-0.0000e+00j, 8.8314-7.4506e-08j,
        0.1326-3.7881e-08j, 0.4176-5.9564e-09j, 8.1726-1.0096e-07j,
        0.2918+1.2514e-09j, 2.1527-1.7881e-07j, 0.7215-7.0687e-09j,
        3.2051-2.6538e-08j, 0.3366-7.0799e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9771015644073486-2.4292948097581757e-08j)
SINR torch.Size([20]) = tensor([-13.9936, -14.1940,  -8.7717,  -6.2902, -13.8950,  -6.0937,  -2.3210,
         -7.7785, -19.3459,  -2.3265,  -3.2559,  -2.2486, -12.6547,  -7.9111,
         -1.0234,  -8.2733,  -6.0233,  -5.1861,  -2.0878,  -7.7523],
       device='cuda:0')
SINR mean = -7.571328163146973
E[H^H] = 1e-07
E_MSE (Error Power) = 11.369626998901367
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0383, 0.0367, 0.1171, 0.1903, 0.0392, 0.1973, 0.3695, 0.1429, 0.0115,
        0.3692, 0.3209, 0.3734, 0.0515, 0.1392, 0.4414, 0.1295, 0.1999, 0.2325,
        0.3821, 0.1437], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([796, 801, 650, 572, 794, 565, 436, 620, 920, 436, 468, 433, 761, 624,
        390, 635, 563, 535, 427, 619], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 0-----------
Real SNR = tensor([-2.7119, -1.5631, -3.7587,  1.1303, -1.1819, -2.2020, -3.4691, -2.0164,
        -4.7419, -2.3467, -1.5441, -1.2909, -3.6689, -2.5637, -2.0412,  2.1119,
         1.4570,  1.4497, -2.1878, -0.8021], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 31.1814-1.4415e-06j, 215.1119-2.9139e-06j, 152.7701+2.5086e-06j,
          4.6721+1.8743e-08j,   3.9342-1.1921e-07j,  43.6629+3.7986e-07j,
         70.3853-1.1921e-06j, 123.9007+6.3148e-08j,  13.1066+1.2055e-07j,
          6.2674-1.0037e-07j,   4.8001+4.7684e-07j,   0.5410+4.6324e-09j,
          8.5365+1.6368e-07j,  17.5779+2.4300e-07j,   4.5872+1.4305e-06j,
         26.0420+7.7666e-08j,  50.1758-2.4521e-07j,  69.5766+3.8147e-06j,
         18.4813+2.3842e-06j,  18.1879-4.7684e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(44.17494201660156+2.59849201711404e-07j)
torch.linalg.det(H.mH@H) = tensor([0.5515-1.4901e-08j, 1.2031-1.1921e-07j, 0.7893-1.0573e-08j,
        0.6475+4.0798e-09j, 0.5640-3.3535e-08j, 1.4195-6.5505e-10j,
        0.8299+2.5573e-09j, 0.1003+6.8360e-09j, 0.0073+1.3163e-08j,
        4.8200-2.3842e-07j, 1.4084+1.3981e-08j, 0.5799-8.9407e-08j,
        1.7707-3.0421e-08j, 0.3785+2.6822e-07j, 4.7826+1.0454e-07j,
        4.8061+9.0918e-08j, 1.8884-1.4989e-08j, 1.3621-2.2144e-07j,
        1.1209-8.6701e-09j, 2.6330-1.7767e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5831670761108398-1.4784357738051312e-08j)
SINR torch.Size([20]) = tensor([ -9.4275,  -5.2265,  -4.4623,  -7.6826,  -8.6600,  -3.7061,  -3.9477,
        -13.3227, -21.9702,  -1.6114,  -3.5437, -10.0930,  -2.9052, -10.5369,
         -0.5089,  -1.3936,  -5.0458,  -6.1024,  -3.4628,  -3.6855],
       device='cuda:0')
SINR mean = -6.3647308349609375
E[H^H] = 1e-07
E_MSE (Error Power) = 12.145162582397461
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1024, 0.2309, 0.2636, 0.1457, 0.1198, 0.2987, 0.2872, 0.0445, 0.0063,
        0.4083, 0.3066, 0.0892, 0.3387, 0.0812, 0.4707, 0.4205, 0.2383, 0.1970,
        0.3106, 0.2997], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([670, 536, 510, 617, 647, 484, 492, 779, 974, 411, 478, 690, 456, 703,
        372, 403, 530, 565, 476, 483], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 1-----------
Real SNR = tensor([ 3.0133,  2.8920, -1.7173, -3.5618, -0.5293, -0.3804,  0.1953, -0.9702,
        -1.6398, -2.2111, -2.6580, -3.0126, -1.8777,  2.0360, -6.0085,  2.5612,
        -0.9137,  1.4115, -2.3293, -3.4921], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.5869e+01+9.5367e-07j, 1.0276e-01+3.2145e-08j, 1.8648e+01-1.1623e-07j,
        8.9295e+00+1.2090e-06j, 1.1642e+01-4.7684e-07j, 1.1083e+01+2.3684e-06j,
        1.7615e+01-1.9132e-07j, 2.4521e+00-1.1921e-07j, 8.8270e+00+3.7240e-07j,
        5.7398e-01-4.9213e-08j, 3.6802e+01-1.0076e-06j, 6.7198e+00+8.6749e-07j,
        4.8225e+00+7.5327e-07j, 2.0237e+01+2.4174e-07j, 2.2389e+00+8.3447e-07j,
        2.0150e+02+3.0518e-05j, 8.6270e+00-1.3265e-08j, 7.7109e+00-4.3644e-08j,
        3.7096e+00+4.8597e-08j, 1.9061e+01-9.6766e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(20.358592987060547+1.8042370584225864e-06j)
torch.linalg.det(H.mH@H) = tensor([0.5261-5.6044e-08j, 0.3223+1.5542e-08j, 0.7876-2.3149e-09j,
        0.5358-3.1214e-09j, 1.3830-1.4901e-08j, 0.5661-3.3591e-09j,
        0.6614-5.3820e-09j, 0.4819-1.1745e-07j, 0.3093-1.9150e-09j,
        0.0487+3.1943e-08j, 0.0576-2.7940e-08j, 0.9416-6.5731e-09j,
        1.2857-9.9169e-09j, 2.9074-1.6484e-07j, 0.9613+3.3693e-08j,
        3.2261-1.1921e-07j, 4.0328-3.2576e-08j, 2.4695-4.7749e-08j,
        0.6771-1.8554e-08j, 0.3234+6.7055e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1252237558364868-2.4180691227115858e-08j)
SINR torch.Size([20]) = tensor([ -8.4694, -11.1168,  -4.0919,  -5.6785,  -3.7534,  -6.4356,  -5.2896,
         -7.2836,  -7.9711, -16.4430, -16.8477,  -4.0320,  -2.4493,  -1.8775,
         -4.9656,  -3.1055,  -0.2874,  -1.9462,  -4.4139,  -8.7224],
       device='cuda:0')
SINR mean = -6.25900936126709
E[H^H] = 1e-07
E_MSE (Error Power) = 7.739326477050781
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1245, 0.0718, 0.2805, 0.2129, 0.2965, 0.1851, 0.2283, 0.1575, 0.1376,
        0.0222, 0.0202, 0.2833, 0.3626, 0.3936, 0.2417, 0.3285, 0.4835, 0.3898,
        0.2657, 0.1183], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([641, 719, 497, 551, 486, 576, 538, 604, 626, 856, 865, 495, 440, 420,
        527, 463, 364, 422, 509, 649], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 2-----------
Real SNR = tensor([ 0.5935,  1.8782,  7.0011,  1.4321,  0.6501,  1.3901,  4.5989,  5.0079,
        -0.0873,  0.8296,  4.1468,  1.8074, -0.4468, -1.3772, -3.0748,  0.6614,
         0.9247,  3.8686,  1.3696,  4.8014], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 23.9769-4.2743e-07j,   8.7411+2.6761e-08j, 105.2219-4.0394e-07j,
         16.3471-6.1426e-07j,  10.0568+4.9152e-07j,  15.0651+1.4744e-07j,
        104.3414-0.0000e+00j,   6.4505-1.4189e-07j,   0.9134+8.5031e-10j,
          0.8782-1.6093e-06j,  28.5315+7.9903e-07j,  40.1033-3.5479e-06j,
         19.2372+1.4395e-07j,   6.4186+2.1551e-07j,  22.7966+4.7684e-07j,
          8.4798+1.3432e-07j,  11.2495-4.7684e-07j,  17.3639+1.0136e-06j,
         38.0983+9.3362e-07j,   9.2858+2.6096e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(24.677837371826172-1.4189440378231666e-07j)
torch.linalg.det(H.mH@H) = tensor([0.0817-4.8429e-08j, 1.5293+8.5526e-09j, 6.1663+1.4040e-07j,
        1.3064-1.7436e-08j, 3.2976-2.7601e-08j, 0.3207-2.6877e-08j,
        8.3889+2.0976e-08j, 6.3031+9.9327e-08j, 0.4381-2.6914e-09j,
        0.3686+1.0233e-08j, 5.2195-6.0788e-08j, 0.2438+2.7428e-08j,
        0.5434+2.6889e-08j, 0.5376-0.0000e+00j, 0.2781+6.7055e-08j,
        0.9757-1.4599e-08j, 0.6370+4.1065e-09j, 2.2810-5.9605e-08j,
        1.0115-1.4108e-08j, 2.5087+7.3165e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1218438148498535+1.0299850750072892e-08j)
SINR torch.Size([20]) = tensor([-13.4185,  -3.2339,   0.2496,  -1.7196,  -0.0919,  -8.3085,   0.5876,
          0.2389,  -5.3134,  -4.9592,   0.1545,  -9.0990,  -4.2967,  -4.0584,
        -10.1226,  -3.1805,  -5.2410,  -2.7718,  -3.6857,  -2.4564],
       device='cuda:0')
SINR mean = -4.0363287925720215
E[H^H] = 1e-07
E_MSE (Error Power) = 3.6332805156707764
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0435, 0.3220, 0.5144, 0.4023, 0.4947, 0.1286, 0.5338, 0.5137, 0.2273,
        0.2420, 0.5089, 0.1096, 0.2710, 0.2820, 0.0886, 0.3247, 0.2303, 0.3456,
        0.2997, 0.3622], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([781, 468, 346, 414, 358, 636, 334, 346, 539, 527, 349, 660, 504, 496,
        691, 466, 537, 451, 483, 440], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 3-----------
Real SNR = tensor([ 1.9078,  1.2806,  3.4526,  5.8102, -1.8472, -1.4191, -0.3674, -2.7518,
         3.1060, -2.6302,  3.9093,  2.1994,  4.2121,  4.7685,  2.9046,  1.1830,
        -2.5536, -0.4722,  2.7790,  0.8357], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.6541e+01-2.5437e-07j, 1.7690e+01-8.4875e-08j, 1.2890e+01+1.0821e-07j,
        8.9489e+00-1.7670e-07j, 2.3323e+00+3.5763e-07j, 5.0442e+01-2.5597e-06j,
        6.7893e+00-1.6410e-07j, 2.1708e+01-1.0028e-06j, 1.0822e-02-6.6124e-08j,
        7.9984e+00+7.6654e-08j, 2.0782e+00-1.1921e-06j, 6.3095e+00+3.6927e-08j,
        2.0251e+01+1.3271e-07j, 2.0200e+01+3.5779e-07j, 1.3664e+01-6.5303e-07j,
        2.5710e+01-2.2660e-08j, 1.7669e+00+1.1254e-08j, 2.6512e+01+7.8354e-07j,
        3.0994e+00+4.4313e-07j, 6.7955e-01-1.8285e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(13.781021118164062-1.9434347109381633e-07j)
torch.linalg.det(H.mH@H) = tensor([3.2931-0.0000e+00j, 1.1096-2.7961e-08j, 2.9010+5.9713e-08j,
        9.2626-4.1131e-09j, 0.6443+8.8322e-09j, 0.2031+1.1073e-08j,
        0.2831-0.0000e+00j, 0.0789+3.7253e-09j, 1.8548+3.5934e-08j,
        0.2458+4.4667e-09j, 3.1469+6.5875e-08j, 0.4123+1.1838e-08j,
        2.1362+2.9802e-08j, 0.8592-3.8091e-08j, 0.3067+3.3670e-08j,
        0.5010-1.2708e-08j, 0.2192-7.4506e-09j, 0.8382-4.3948e-09j,
        2.1290+1.6038e-07j, 2.5398-8.1343e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6482330560684204+1.246232006479886e-08j)
SINR torch.Size([20]) = tensor([  0.6052,  -0.8445,   0.6356,   3.7826,  -1.8000,  -6.7148,  -8.1114,
        -10.1005,  -0.0333,  -5.1256,   0.7000,  -5.0894,  -1.8429,  -3.9772,
         -8.7510,  -4.6573,  -6.2350,  -2.1532,  -1.6893,  -0.4598],
       device='cuda:0')
SINR mean = -3.0930886268615723
E[H^H] = 1e-07
E_MSE (Error Power) = 2.609062910079956
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5348, 0.4515, 0.5365, 0.7049, 0.3978, 0.1756, 0.1338, 0.0890, 0.4981,
        0.2350, 0.5402, 0.2365, 0.3955, 0.2858, 0.1176, 0.2550, 0.1922, 0.3785,
        0.4040, 0.4736], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([334, 384, 333, 231, 417, 586, 630, 690, 356, 533, 330, 532, 419, 493,
        650, 517, 570, 430, 413, 370], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 4-----------
Real SNR = tensor([ 2.9518,  1.3430,  0.2444,  0.1173,  2.1827,  6.3463,  5.7579,  7.5663,
         2.1101,  3.5837,  4.8500,  4.4578, -1.8494,  0.4990,  4.0595,  4.3431,
         8.2576,  3.5092,  6.0045, -1.6579], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.7993e+01-3.6208e-07j, 2.6423e+00+5.4389e-09j, 2.7775e+00-4.4461e-08j,
        5.4908e+00+2.3842e-07j, 1.6811e+00+1.0654e-06j, 4.8749e+00-3.6955e-06j,
        1.7803e-02-8.8010e-08j, 2.0014e+01+4.5769e-07j, 1.2172e+00-3.5217e-09j,
        5.1745e+01+4.8083e-08j, 1.0752e+00+2.9802e-08j, 1.9950e+00+4.1723e-07j,
        2.5519e+01-3.9215e-07j, 1.7052e+00+1.1325e-06j, 3.5630e+00+2.3842e-07j,
        1.7313e+01+1.7079e-08j, 1.2570e+01+1.2933e-07j, 1.9608e+01-3.8258e-07j,
        4.0566e+00+4.1723e-07j, 1.1347e-01-1.3965e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(12.298644065856934-3.865165965066808e-08j)
torch.linalg.det(H.mH@H) = tensor([ 3.4087+7.3252e-08j,  0.2370-5.0291e-08j,  0.5756-1.6988e-09j,
         0.5833+1.9505e-08j,  2.2313+4.9586e-08j,  0.1862+1.4901e-08j,
         1.5412-1.0653e-07j,  1.1382+2.9022e-08j,  1.4079+1.0460e-07j,
         5.6923+2.4384e-08j,  0.6410-2.9802e-08j,  1.1601-5.9605e-08j,
         0.3170+1.8626e-09j,  0.4432-7.6043e-09j,  2.2131+7.0661e-09j,
         2.6135-2.3842e-07j, 20.7799-1.8505e-07j,  0.6932-1.2975e-08j,
        15.8002-8.3326e-07j,  0.0250+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.0843920707702637-5.856290385963803e-08j)
SINR torch.Size([20]) = tensor([  2.7537,  -8.8071,  -1.4821,  -1.0328,   1.3288, -12.4381,  -2.4715,
         -5.4929,  -0.7267,   3.9511,  -5.4356,  -2.6578,  -3.5942,  -2.9547,
          1.5760,   0.7766,   5.9409,  -2.4589,   5.4446, -16.6337],
       device='cuda:0')
SINR mean = -2.220710515975952
E[H^H] = 1e-07
E_MSE (Error Power) = 4.168269157409668
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6534, 0.1163, 0.4155, 0.4408, 0.5759, 0.0540, 0.3614, 0.2201, 0.4583,
        0.7130, 0.2224, 0.3516, 0.3042, 0.3362, 0.5897, 0.5446, 0.7970, 0.3621,
        0.7779, 0.0212], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([263, 652, 406, 390, 309, 755, 441, 545, 380, 226, 543, 447, 480, 458,
        301, 328, 172, 440, 185, 860], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 5-----------
Real SNR = tensor([ 4.9719,  2.1043,  2.8591,  1.1974,  3.7512,  9.0407,  7.5732,  1.7650,
         7.7309, -1.9581, -0.6956,  1.0263,  3.2234,  9.6471, -2.6291,  0.9322,
        -2.8057,  4.4901,  2.9125,  6.9330], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2079+1.6670e-07j,  7.8213+4.7684e-07j, 13.4882+9.2098e-08j,
         8.9335-1.2132e-07j,  0.1161+3.9407e-07j, 28.2389-2.7686e-06j,
        33.8783+2.3842e-07j, 10.3701+7.1526e-07j, 24.9503-1.8589e-08j,
         0.6616-0.0000e+00j,  3.1612+1.6964e-07j,  1.2843-5.6206e-08j,
         1.7601-1.0133e-06j,  5.8565-2.5211e-07j,  0.5356-4.5347e-07j,
         0.7195-6.7461e-09j,  1.2684+4.0147e-09j,  0.8178-1.2794e-07j,
         2.2701+1.9261e-08j, 23.6147-3.8809e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.49771785736084-1.4650287027961895e-07j)
torch.linalg.det(H.mH@H) = tensor([ 2.5565+3.0500e-08j,  0.5071-0.0000e+00j,  0.0162-4.1910e-09j,
         0.4833-2.9802e-08j,  0.9765+8.3189e-10j,  0.8433+2.8214e-08j,
         2.6528+8.5642e-08j,  0.9577+8.4818e-09j, 12.5995+1.0793e-07j,
         0.3929-1.6299e-10j,  0.2925-2.2809e-09j,  0.5716-3.7253e-09j,
         0.9400-0.0000e+00j,  3.9662+6.1716e-08j,  0.5713+9.2570e-09j,
         0.1568-7.8767e-09j,  0.1647-1.6478e-09j,  4.0043-3.2265e-08j,
         0.4484-2.8136e-09j,  3.1599-1.4324e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8130817413330078+1.2319020470386022e-08j)
SINR torch.Size([20]) = tensor([  2.9731,  -2.7332, -16.4340,  -3.1954,  -0.6582,  -4.4262,   0.2694,
          1.0868,   7.0084,  -1.3658,  -2.9554,  -2.4555,  -0.9875,   1.8027,
         -0.8768,  -5.5584,  -3.4404,   4.2465,  -3.2468,   3.2632],
       device='cuda:0')
SINR mean = -1.38418710231781
E[H^H] = 1e-07
E_MSE (Error Power) = 3.120570421218872
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6648, 0.3477, 0.0222, 0.3239, 0.4622, 0.2652, 0.5155, 0.5622, 0.8339,
        0.4220, 0.3361, 0.3623, 0.4434, 0.6023, 0.4497, 0.2176, 0.3117, 0.7267,
        0.3213, 0.6795], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([256, 450, 855, 466, 377, 509, 345, 317, 146, 402, 458, 440, 389, 293,
        385, 547, 475, 218, 468, 247], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 6-----------
Real SNR = tensor([ 5.6486,  7.1598,  5.2402, 10.0937,  2.0045,  7.1886,  1.4273,  3.5888,
         2.1576,  1.4245,  5.5739,  7.0352,  5.5522,  4.5396,  4.8658,  5.8220,
         1.9680,  6.5693,  2.9828,  3.0923], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.6038-3.3588e-07j,  4.5677-3.4957e-07j,  2.8950+9.0581e-08j,
         1.3624+9.0226e-09j,  9.5518-1.7755e-09j,  3.8755-9.5367e-07j,
         0.3748+1.1033e-08j,  2.2322-3.4028e-08j,  0.1078+5.6417e-08j,
         1.4321-6.6395e-09j,  0.9492+8.0466e-07j,  1.9179-6.3502e-08j,
         7.4851-2.1441e-07j,  7.5198+7.1526e-07j, 36.5572-5.7147e-07j,
         0.8920-5.9605e-08j, 10.5541+1.3293e-07j,  7.8803-1.0090e-07j,
         1.5644-1.8944e-09j,  0.8312-2.6869e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.257711410522461-5.710665007541138e-08j)
torch.linalg.det(H.mH@H) = tensor([1.3783-5.5434e-09j, 1.3194+2.8409e-08j, 0.4872-4.3884e-08j,
        3.4693+2.7553e-07j, 0.3742+4.9154e-09j, 2.2762+1.1287e-08j,
        0.3549+8.2507e-09j, 2.9133+2.5834e-08j, 0.1740+2.3844e-08j,
        0.1006+4.0978e-08j, 4.5371-5.1693e-08j, 3.1725+4.3810e-09j,
        0.5351-7.8598e-08j, 0.9176-0.0000e+00j, 3.7935-1.0431e-07j,
        1.1941-1.2796e-08j, 0.0933-3.7253e-09j, 1.1147-5.9605e-08j,
        0.9689+1.1379e-09j, 0.0812-2.2817e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4627810716629028+2.0797408240014192e-09j)
SINR torch.Size([20]) = tensor([  2.6860,   0.5414,  -2.4797,   1.8484,  -1.6377,   3.3932,  -0.6780,
          4.3801,  -4.0541,  -9.5179,   5.2836,   4.4248,  -3.9002,  -1.5680,
          3.3736,   0.0555,  -8.5358,  -0.5604,   1.9406, -11.7179],
       device='cuda:0')
SINR mean = -0.8361231088638306
E[H^H] = 1e-07
E_MSE (Error Power) = 2.2079086303710938
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6499, 0.5311, 0.3610, 0.6048, 0.4068, 0.6860, 0.4610, 0.7327, 0.2822,
        0.1005, 0.7715, 0.7347, 0.2894, 0.4107, 0.6850, 0.5032, 0.1229, 0.4678,
        0.6099, 0.0631], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([265, 336, 441, 292, 412, 243, 378, 214, 496, 673, 189, 213, 491, 409,
        244, 352, 643, 374, 289, 736], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 7-----------
Real SNR = tensor([ 0.6642,  4.2701,  3.9991,  7.4250,  5.5768,  7.7883,  7.8450,  2.7780,
         4.6829,  3.8400,  5.0211,  9.4479,  2.4429, 11.6167, 10.6140,  4.8058,
         4.7869,  4.1576,  3.3759,  2.5752], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.9433+6.1930e-09j,  0.1128+7.4506e-09j,  1.2819-2.5945e-09j,
         5.5823-9.3688e-08j, 11.9857-4.7684e-07j,  1.4092-1.6366e-09j,
         2.3239+5.8789e-09j,  4.4878+7.3128e-09j,  0.1322-4.6322e-08j,
         0.4041-5.2222e-09j,  3.9607-1.8207e-07j,  2.5955-1.4361e-08j,
         1.0605-5.9605e-08j,  7.1360-1.1921e-07j, 12.4178+3.1354e-07j,
         1.5129-1.0431e-07j,  2.2836-2.9802e-07j,  3.8164+2.3842e-07j,
         4.7927-2.3999e-08j,  3.2456+7.9659e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.624234914779663-3.847106810894729e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1769-4.8030e-10j,  1.4607-5.5654e-08j,  0.6807+4.0887e-09j,
         0.7841+7.4506e-07j,  0.2899+3.1292e-07j,  2.7708-4.8214e-08j,
         0.9209-2.1232e-08j,  0.8278-2.4322e-09j,  0.0396-4.0978e-08j,
         1.3104-2.9802e-08j,  0.0460-3.1665e-08j,  2.2122-1.1674e-08j,
         0.9158+7.0554e-09j, 12.3949+7.7919e-07j, 13.3955-9.5162e-08j,
         0.5289+2.9802e-08j,  1.6943-1.2033e-08j,  0.1775-2.2352e-08j,
         0.9881-3.1828e-08j,  0.8684+1.8580e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1241626739501953+7.465963847153034e-08j)
SINR torch.Size([20]) = tensor([ -1.1966,   3.2172,   1.5848,  -2.4593,  -4.7892,   4.7758,   0.6449,
          1.0925, -12.7394,   1.6211, -13.9766,   2.6867,   3.1361,   7.4317,
          8.1293,  -0.3438,   4.0559,  -3.9416,   1.4146,  -0.1087],
       device='cuda:0')
SINR mean = 0.01176829356700182
E[H^H] = 1e-07
E_MSE (Error Power) = 2.860182762145996
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4315, 0.6772, 0.5902, 0.3621, 0.2492, 0.7502, 0.5371, 0.5626, 0.0505,
        0.5923, 0.0385, 0.6499, 0.6731, 0.8470, 0.8667, 0.4802, 0.7179, 0.2875,
        0.5807, 0.4937], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([396, 248, 301, 440, 521, 203, 332, 317, 763, 299, 796, 265, 251, 137,
        122, 366, 223, 492, 306, 358], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 8-----------
Real SNR = tensor([-3.7540,  6.7775,  3.6667, 11.2095,  0.2207,  0.6512,  6.7209,  4.3458,
         4.8275,  5.0263,  4.8699,  6.5962,  7.2594, 10.0710,  7.7469,  8.2715,
         7.2397, 10.0211,  7.5071, 12.0777], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.5701-7.1596e-09j,  2.6845+2.5537e-07j,  1.0837-4.0107e-08j,
         1.9172-5.9605e-08j,  0.1179-2.2352e-07j,  2.2497-2.0989e-08j,
         2.1718-2.3842e-07j,  1.3437+7.4506e-08j,  1.0361-3.4341e-09j,
         4.9785-1.2575e-07j,  1.9853+5.8712e-08j,  2.0302-5.5838e-08j,
         0.7706-2.9802e-08j,  0.4537+1.2666e-07j,  6.4222+4.6591e-08j,
         0.3824-0.0000e+00j,  5.2888-4.9409e-08j,  5.0515+1.1322e-07j,
        21.4116+1.1921e-07j,  2.8280+1.1228e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.2388718128204346+2.6260209562423142e-09j)
torch.linalg.det(H.mH@H) = tensor([0.0062+4.8761e-09j, 1.0776+1.1166e-09j, 0.6870+4.2179e-10j,
        0.8012+2.6822e-07j, 0.1668-2.2467e-09j, 0.1110-3.8673e-09j,
        2.1424+8.7193e-08j, 0.2070-1.1176e-08j, 0.5354+6.1699e-08j,
        0.4232-7.4506e-09j, 0.6805+6.9197e-09j, 1.0274+3.4680e-08j,
        0.6770+2.6822e-07j, 2.7941+2.3842e-07j, 2.4687-3.9064e-08j,
        2.5657-7.4433e-08j, 0.8548+2.2235e-08j, 1.4422-2.8882e-08j,
        0.8380-2.0862e-07j, 4.2344+3.8111e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1870309114456177+3.2818881834373315e-08j)
SINR torch.Size([20]) = tensor([-12.4934,   2.1829,   3.0031,  -1.7801,  -0.2931,  -2.4957,   5.0909,
         -3.5986,   1.4815,  -1.8059,   0.8579,   3.6416,  -0.7637,   4.8668,
          5.9786,   4.9971,   2.5289,   3.2022,  -0.2828,   5.9594],
       device='cuda:0')
SINR mean = 1.013872504234314
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5875040292739868
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0533, 0.6231, 0.6663, 0.3989, 0.4831, 0.3602, 0.7635, 0.3039, 0.5845,
        0.3975, 0.5492, 0.6982, 0.4561, 0.7541, 0.7984, 0.7596, 0.6416, 0.6764,
        0.4837, 0.7977], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([757, 281, 255, 417, 365, 442, 194, 480, 304, 418, 325, 236, 381, 200,
        171, 197, 270, 249, 364, 171], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 9-----------
Real SNR = tensor([ 9.9315,  6.0801,  4.9871,  7.2556, 11.9957,  7.3262,  8.7216,  7.0745,
         2.4026,  8.8306,  9.4617,  6.4848,  9.6949,  5.1500,  8.4913,  9.4373,
         8.2452,  8.3642,  2.3080, 11.3383], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([20.7382-3.4223e-07j,  3.8647+1.4256e-08j,  2.6025+5.9605e-08j,
         3.4001-2.4587e-07j,  0.9594+8.9407e-08j,  4.6205-8.0006e-08j,
         0.1632-3.0917e-07j,  0.2206-7.4506e-09j,  0.3831-8.2148e-08j,
         1.7375-6.7067e-08j,  7.3803-2.3842e-07j,  4.5276+5.9605e-08j,
         0.3534+3.1020e-07j,  0.9309-1.3696e-08j,  4.8088+2.0106e-07j,
         4.4253+3.5763e-07j,  0.6933-5.4485e-08j,  2.1557-1.1236e-07j,
         0.2421+8.3885e-09j, 14.5691+1.5588e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.938816547393799-1.4843490880878107e-08j)
torch.linalg.det(H.mH@H) = tensor([ 2.1129+1.0431e-07j,  1.4057-1.2439e-08j,  0.5336+1.4930e-10j,
         0.7639-2.7940e-08j,  0.8326+6.2585e-07j,  1.8594-5.0483e-09j,
         0.0711+1.2527e-08j,  0.4077-4.4703e-08j,  0.1462-5.2832e-09j,
         0.3368+2.9245e-08j,  1.8814+1.7881e-07j,  1.3322+2.4705e-09j,
         2.5470+2.2207e-07j,  0.0508+6.7055e-08j,  2.3377-1.7355e-08j,
         0.9010+5.2154e-08j,  1.3773+4.1823e-08j,  0.2055-1.1176e-07j,
         0.2635-3.0803e-09j, 13.3230-2.4011e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6344751119613647+4.343714365973028e-08j)
SINR torch.Size([20]) = tensor([ 3.0199,  5.8977,  3.5221,  2.1296, -0.1290,  6.4698, -8.0787, -1.2342,
        -0.6555,  0.4081,  3.0078,  5.4605,  5.1856, -6.3541,  6.0116,  0.5300,
         5.2989, -3.8355,  1.0505, 10.2164], device='cuda:0')
SINR mean = 1.8960751295089722
E[H^H] = 1e-07
E_MSE (Error Power) = 1.0737783908843994
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6672, 0.7954, 0.6923, 0.6202, 0.4926, 0.8160, 0.1347, 0.4294, 0.4623,
        0.5235, 0.6665, 0.7786, 0.7675, 0.1880, 0.7997, 0.5305, 0.7721, 0.2925,
        0.5602, 0.9131], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([255, 173, 239, 283, 359, 159, 629, 397, 377, 340, 255, 184, 192, 574,
        170, 336, 189, 489, 319,  85], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 10-----------
Real SNR = tensor([ 9.8370,  5.7844, 11.3010,  6.4564,  6.3418,  9.1642,  9.4874, 11.4223,
         9.2480,  8.0834,  8.3795,  8.6197, 10.6232,  3.5875,  5.2444, 10.2993,
        10.1738, 10.4089, 10.0835, 13.2747], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 9.6158-5.5262e-08j,  4.3339+1.7021e-07j, 15.8386-7.3166e-08j,
         2.6476-1.6420e-07j,  0.0234+9.5023e-08j,  8.2666-0.0000e+00j,
         1.1238-1.8425e-08j,  2.0402-3.6184e-10j,  2.4371-8.1140e-10j,
         0.4698-2.6884e-09j,  2.1110-2.1701e-08j,  6.9169-1.0725e-09j,
         9.8516-6.7786e-08j,  0.0717-1.1176e-08j,  0.3042-4.8847e-09j,
         1.3118-1.1119e-07j, 17.9731+2.3986e-08j,  7.1162-7.1526e-07j,
         1.9625-2.9802e-07j,  9.2012-2.5474e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.180850982666016-1.9020875186015473e-07j)
torch.linalg.det(H.mH@H) = tensor([3.0384-3.0809e-08j, 0.5723-7.4506e-09j, 6.2585+5.7040e-08j,
        0.2546+1.1176e-08j, 0.0256+8.9004e-11j, 2.9970-3.2968e-08j,
        1.3454-4.8124e-08j, 1.2229+4.9741e-09j, 0.3695-4.8328e-09j,
        0.6792+6.9352e-09j, 1.4357+7.6025e-08j, 4.5110-1.3160e-08j,
        1.6290-9.4995e-09j, 0.1493+3.7253e-08j, 0.1579+3.6355e-10j,
        0.7421+1.1646e-08j, 7.3391-5.0788e-08j, 1.4058+1.1176e-07j,
        1.3752-1.1718e-07j, 0.9063-2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8207539319992065-1.367718716061006e-09j)
SINR torch.Size([20]) = tensor([ 7.6111,  3.4121,  9.1154, -1.2004, -9.4451,  7.0454,  5.3284,  4.6008,
         2.4643,  5.6815,  5.5213,  9.0965,  5.8035, -1.5878,  0.2751,  2.5117,
        10.2397,  4.0038,  3.9122, -0.4245], device='cuda:0')
SINR mean = 3.6982555389404297
E[H^H] = 1e-07
E_MSE (Error Power) = 0.8427742123603821
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8523, 0.6869, 0.8908, 0.4313, 0.1020, 0.8351, 0.7733, 0.7426, 0.6382,
        0.7872, 0.7810, 0.8904, 0.7919, 0.4096, 0.5158, 0.6407, 0.9136, 0.7154,
        0.7111, 0.4756], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([133, 242, 103, 396, 671, 145, 188, 208, 272, 178, 183, 104, 175, 410,
        345, 271,  85, 225, 228, 369], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 11-----------
Real SNR = tensor([ 9.0116, 11.5243, 10.8254, 10.4312, 10.1785, 15.7521, 13.5538,  8.3323,
         8.2479, 12.3621, 12.5373,  4.6373, 11.7922,  8.0073, 13.2050,  8.9583,
         9.8931,  9.6732,  6.5825,  7.5530], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.8760e-01+2.9802e-08j, 4.6159e-01-6.4383e-08j, 8.7381e+00+1.7831e-07j,
        6.6707e+00-1.4274e-07j, 5.6077e+00+1.4466e-07j, 1.2152e+01+7.8433e-08j,
        4.3211e+00-1.7964e-08j, 4.8296e-02-7.4506e-09j, 5.6097e-01+3.7434e-08j,
        1.2674e+01+2.3641e-07j, 6.1288e+00+2.3842e-07j, 9.3398e-02-0.0000e+00j,
        2.5656e+00-1.7056e-07j, 6.5091e-03+1.4435e-08j, 3.3878e-01+4.6650e-08j,
        4.7842e-01-1.5608e-08j, 3.7407e+00+6.0970e-08j, 3.1650e-01-4.4059e-08j,
        1.2716e+00-3.1329e-08j, 4.6503e+00+1.6041e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.570615530014038+2.937375676026477e-08j)
torch.linalg.det(H.mH@H) = tensor([3.1623-2.5750e-09j, 1.5790-8.8145e-09j, 1.5427-5.9605e-08j,
        2.7049+9.5400e-08j, 0.5054+5.8193e-08j, 6.0061-2.9383e-08j,
        1.5011+8.8904e-08j, 1.7970-1.3773e-08j, 0.2104+8.1504e-09j,
        5.4853-9.2887e-08j, 4.6563-0.0000e+00j, 0.3307+3.7860e-09j,
        0.8245+2.9802e-08j, 0.1460+2.6077e-08j, 0.4859+1.6172e-08j,
        1.3184+1.7812e-08j, 2.0974+2.5347e-08j, 0.6673+2.9902e-08j,
        0.8854+1.5345e-08j, 3.1994-1.8486e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9552748203277588+9.468402950574273e-09j)
SINR torch.Size([20]) = tensor([ 9.6536,  7.5359,  4.2431,  8.9580,  1.7241,  9.3379,  4.9517,  7.6859,
         0.8006, 10.7538,  7.7083,  4.6811,  4.2384, -1.5805, -1.0330,  6.8559,
         8.7651,  4.9774,  6.8763,  9.0955], device='cuda:0')
SINR mean = 5.811459064483643
E[H^H] = 1e-07
E_MSE (Error Power) = 0.3517444431781769
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9023, 0.8501, 0.7265, 0.8872, 0.5980, 0.8957, 0.7577, 0.8544, 0.5460,
        0.9225, 0.8551, 0.7461, 0.7263, 0.4100, 0.4408, 0.8290, 0.8827, 0.7588,
        0.8297, 0.8903], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 94, 134, 218, 106, 296,  99, 198, 131, 327,  77, 131, 205, 218, 410,
        390, 150, 110, 197, 149, 104], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 12-----------
Real SNR = tensor([ 5.4326, 10.6511,  6.8102, 11.1802, 10.4476, 10.7027,  8.2708,  8.4805,
        12.5182,  8.5087, 10.4729, 16.3258, 11.2238,  9.8908,  9.5942,  8.3580,
        12.6601, 13.9387,  8.6255, 10.6817], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.0215+8.1117e-09j,  2.3555-5.7748e-08j,  0.4940-1.4714e-10j,
         2.2942+3.6759e-08j,  0.1169-8.5682e-08j,  3.5140+4.7040e-08j,
         0.5395+2.9802e-07j,  0.4424-4.8806e-09j,  3.3225+2.6854e-08j,
         0.5968+5.9605e-08j,  6.2919-3.6826e-07j,  4.4958-7.5825e-08j,
         0.9198+2.9802e-08j,  0.7694-5.9605e-08j, 13.1401-1.2946e-07j,
         1.3947-2.6951e-09j,  0.4209-1.2853e-07j,  8.2906+2.1445e-07j,
         0.2529+6.7564e-10j,  0.6077-2.9410e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.5140652656555176-1.1045753645078094e-08j)
torch.linalg.det(H.mH@H) = tensor([1.8227e-01+2.4447e-09j, 2.9336e+00+1.0027e-08j, 1.7936e-01+7.4506e-09j,
        7.9457e-01-1.4323e-08j, 9.4104e-01-9.4092e-09j, 3.4478e-01-3.7253e-08j,
        1.5933e-03+5.8382e-08j, 5.9991e-01+6.8001e-09j, 4.5426e+00-6.4365e-08j,
        1.1308e-01-1.0908e-09j, 3.1668e+00+6.4492e-08j, 8.5662e+00-1.8412e-07j,
        1.7916e+00+1.4582e-08j, 8.1233e-01-4.4859e-09j, 2.5545e+00+2.8073e-07j,
        5.6393e-01+8.6408e-09j, 5.2277e-01-6.3357e-09j, 3.3452e+00-1.6588e-07j,
        5.6453e-01-2.2520e-09j, 7.8881e-01+8.7592e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6654739379882812-1.3605216953038735e-09j)
SINR torch.Size([20]) = tensor([  2.7002,  10.3836,   1.4267,   7.2443,   7.0865,   0.4524, -21.8497,
          6.1339,  11.0198,   1.6995,   9.8923,  12.1581,   9.5213,   7.8553,
          8.1074,   6.4740,   1.4601,   9.3205,   5.3063,   7.1093],
       device='cuda:0')
SINR mean = 5.175085067749023
E[H^H] = 1e-07
E_MSE (Error Power) = 7.162816524505615
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6506, 0.9161, 0.5814, 0.8413, 0.8364, 0.5260, 0.0065, 0.8041, 0.9267,
        0.5966, 0.9070, 0.9426, 0.8996, 0.8592, 0.8661, 0.8162, 0.5833, 0.8953,
        0.7724, 0.8371], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([265,  82, 306, 141, 144, 339, 972, 167,  73, 297,  90,  59,  96, 128,
        122, 159, 305, 100, 188, 144], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 13-----------
Real SNR = tensor([11.8054, 10.9489, 12.0579,  7.6670, 13.9824, 11.5564,  9.5932, 10.1513,
         6.0695,  7.2220,  8.2852,  8.8237,  7.8366, 11.6380,  7.3097, 13.9968,
        10.6322, 10.9816, 11.9596,  5.6529], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.4415+3.2121e-08j, 0.1446-3.3528e-08j, 1.5222+2.9802e-07j,
        0.3773+4.5519e-09j, 4.3387-7.1554e-08j, 4.3296+1.8349e-08j,
        0.6344-8.9407e-08j, 9.0965+1.8083e-07j, 0.2153-2.9802e-08j,
        0.0438+3.7253e-09j, 3.7835+2.1627e-08j, 0.0930-3.1005e-09j,
        1.2417+7.1387e-08j, 0.3612-0.0000e+00j, 0.0786-1.4901e-08j,
        2.2641+2.1498e-08j, 1.2991+6.2626e-08j, 0.4148+7.6851e-09j,
        2.6054+1.1921e-07j, 0.4958-8.5836e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.6890592575073242+2.9537948975644213e-08j)
torch.linalg.det(H.mH@H) = tensor([0.5647+2.4527e-08j, 1.7241+3.3235e-08j, 1.6811-8.7272e-08j,
        0.1063+2.9625e-09j, 2.7165+8.1368e-09j, 1.3273+1.7881e-07j,
        0.4621+4.4703e-08j, 2.3758-2.0902e-09j, 0.2906+5.1342e-09j,
        0.5479-5.8611e-09j, 0.6770+7.7600e-09j, 0.0871+3.7253e-09j,
        0.5693-2.3411e-09j, 0.4981-0.0000e+00j, 0.0306-6.5193e-09j,
        4.0188-2.2536e-08j, 0.4781+1.2089e-08j, 0.4009+4.1036e-09j,
        3.0028-2.6777e-08j, 1.0114+5.6177e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.128519892692566+8.870638446012435e-09j)
SINR torch.Size([20]) = tensor([ 5.0276,  9.3742,  8.9498,  3.0322,  8.9250,  7.7065,  4.8523, 11.3646,
         5.6450,  7.1055,  8.0366,  0.1194,  7.3074,  4.2909, -3.4224, 11.6846,
         5.6016,  5.7149, 11.0669,  8.8629], device='cuda:0')
SINR mean = 6.5622711181640625
E[H^H] = 1e-07
E_MSE (Error Power) = 0.31644344329833984
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7609, 0.8965, 0.8870, 0.6678, 0.8865, 0.8550, 0.7535, 0.9319, 0.7858,
        0.8370, 0.8642, 0.5069, 0.8432, 0.7287, 0.3126, 0.9365, 0.7841, 0.7885,
        0.9275, 0.8850], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([196,  99, 106, 254, 107, 131, 201,  69, 179, 144, 124, 350, 139, 216,
        474,  65, 181, 178,  73, 108], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 14-----------
Real SNR = tensor([15.4850, 10.7915, 17.1048,  9.2397, 11.2394, 15.1919, 12.3983,  8.8417,
         9.3391, 15.7155,  9.9404, 11.7197, 16.0630, 11.2554, 11.1821, 18.2380,
        10.0167, 16.6768, 15.1735,  7.9591], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.7021-3.4893e-08j,  0.3317-1.2214e-08j,  2.9902-2.7644e-08j,
         0.1443-3.3499e-09j,  0.5927+2.9802e-08j,  5.2830+3.6419e-08j,
         2.6238-8.6924e-08j,  0.2885+1.4901e-08j,  0.9618-1.8626e-08j,
         9.2998+7.6400e-08j,  1.1121+2.6685e-09j,  2.0379-1.8032e-08j,
         9.8224+1.8651e-07j,  0.0858-5.6670e-09j,  1.5925-3.2823e-08j,
         8.9075+1.1413e-07j,  1.7678+7.4309e-09j, 15.9483-6.5085e-09j,
         2.1487+2.3009e-08j,  1.8009+5.9673e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.4721009731292725+1.521347847699417e-08j)
torch.linalg.det(H.mH@H) = tensor([ 3.8539+8.4120e-08j,  1.3486-2.7930e-08j,  5.5798-8.9130e-08j,
         0.1097-1.2000e-10j,  0.4352+1.4901e-08j,  0.4358+1.8765e-09j,
         1.0070+6.1711e-08j,  0.4847+1.6353e-09j,  0.1092+1.8626e-09j,
         7.9803-3.3664e-08j,  0.4923-1.1638e-08j,  1.5155-1.4890e-08j,
        10.2554+9.5596e-08j,  0.0564+7.2382e-09j,  1.7698-3.1092e-08j,
        17.3286-5.0455e-07j,  1.5627+2.0340e-09j, 11.2928-1.1185e-07j,
         3.2254-6.1805e-08j,  1.1212-1.2355e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.498206377029419-3.140278437285815e-08j)
SINR torch.Size([20]) = tensor([12.8401,  9.8879, 13.2253,  4.4474,  5.2787,  4.2653,  7.6287,  8.7884,
        -0.5232, 14.7981,  8.3256, 10.4534, 14.9595,  0.8417, 10.7198, 16.0344,
        10.9375, 15.1327, 12.4241,  9.6415], device='cuda:0')
SINR mean = 9.505355834960938
E[H^H] = 1e-07
E_MSE (Error Power) = 0.19735834002494812
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9506, 0.9069, 0.9546, 0.7358, 0.7713, 0.7275, 0.8528, 0.8833, 0.4699,
        0.9679, 0.8718, 0.9174, 0.9691, 0.5483, 0.9219, 0.9757, 0.9254, 0.9702,
        0.9459, 0.9020], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 51,  90,  48, 212, 189, 217, 132, 109, 373,  34, 118,  81,  33, 326,
         77,  26,  74,  32,  56,  94], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 15-----------
Real SNR = tensor([14.2560, 13.5902, 16.0669, 14.5187, 14.0754, 12.2951, 15.8665,  7.1451,
        11.3480, 17.8099, 13.8579, 11.6738, 11.8941, 16.5636, 11.9286, 12.3608,
        11.8770, 12.7551, 10.9538, 15.5222], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.7374+2.5668e-08j, 3.3615+1.2430e-08j, 4.8324-3.9946e-09j,
        0.1881+1.4836e-08j, 0.8621-1.1921e-07j, 1.6512-1.7063e-08j,
        2.1551-4.9011e-08j, 0.2524-1.4690e-08j, 1.2272-9.5540e-08j,
        5.0224+2.2288e-07j, 2.3137-2.9802e-07j, 1.5047-1.4901e-08j,
        1.4087+2.6533e-08j, 2.8529+6.8242e-08j, 0.5864-1.2455e-08j,
        0.4463+3.0185e-10j, 3.6284+1.4847e-08j, 1.3031-3.6867e-08j,
        1.6755+2.9843e-08j, 2.5150-9.9360e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.9762210845947266-1.2805483784461558e-08j)
torch.linalg.det(H.mH@H) = tensor([0.7121+6.9702e-09j, 2.5580-3.5067e-08j, 3.3466+3.6395e-08j,
        0.0417-4.1332e-08j, 2.0124+1.3665e-07j, 1.3689+1.5409e-08j,
        2.6815+1.9362e-07j, 0.2018-3.7280e-10j, 0.0676-2.4214e-08j,
        7.0251+4.7787e-07j, 1.0601-5.9605e-08j, 0.6753+1.1176e-08j,
        0.7004+6.4855e-09j, 1.6356+9.5719e-09j, 0.3601-4.4150e-08j,
        0.1801+7.4506e-09j, 1.2042-2.0681e-08j, 0.8845+1.9215e-09j,
        0.7098-1.6011e-08j, 0.9193+2.1716e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4172576665878296+3.321252606269809e-08j)
SINR torch.Size([20]) = tensor([ 7.6068, 13.6414, 13.1363, -3.0833, 11.8058, 11.5447, 11.8079,  7.9289,
        -1.4017, 14.1177,  8.5207,  7.3343, 10.9646, 10.8488,  5.7804,  3.5871,
        11.2580, 10.0204,  9.3999,  7.3104], device='cuda:0')
SINR mean = 8.606443405151367
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2755274176597595
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8521, 0.9586, 0.9537, 0.3296, 0.9381, 0.9345, 0.9381, 0.8612, 0.4200,
        0.9627, 0.8767, 0.8441, 0.9259, 0.9240, 0.7910, 0.6955, 0.9304, 0.9095,
        0.8970, 0.8433], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([133,  44,  48, 462,  63,  66,  63, 126, 403,  40, 114, 139,  74,  76,
        176, 237,  70,  88,  98, 139], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 16-----------
Real SNR = tensor([13.9942, 16.6757, 15.7902, 13.8693, 14.5458, 15.5105, 13.1403, 15.9596,
        16.1749, 13.6001, 14.1069, 16.0312, 18.4593, 14.1891, 10.4979, 16.0859,
        19.7186, 12.5979, 15.9608, 14.7188], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.2891-4.4894e-08j, 13.0302-2.0325e-07j,  0.5923-1.4519e-09j,
         1.5678-2.6143e-08j,  1.5794-7.4506e-08j,  1.9816+4.3578e-08j,
         0.2302+6.1579e-09j,  2.1921+2.3842e-07j,  3.8536+9.1698e-09j,
         2.9047+1.0173e-07j,  2.0868+1.8437e-08j,  2.3448+4.0377e-09j,
        13.5893-2.2142e-09j,  0.3727+1.6972e-08j,  0.2629+5.9605e-08j,
         0.4997-2.9258e-08j,  4.7662+1.2166e-07j,  0.1698-1.3457e-09j,
         1.4129+2.8939e-08j,  0.7164-8.1762e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8221302032470703+9.194090822006729e-09j)
torch.linalg.det(H.mH@H) = tensor([3.8629e+00-2.6713e-08j, 7.6133e+00+9.7363e-08j, 4.8629e-01+4.3109e-09j,
        1.9110e+00-4.0507e-09j, 1.9237e+00-3.3528e-08j, 2.2069e+00+1.2709e-08j,
        3.7735e-01-8.8195e-09j, 5.3437e-01-2.0862e-07j, 5.8342e+00-9.1569e-08j,
        2.1084e+00+1.3860e-08j, 1.8897e+00+6.5708e-09j, 2.3817e+00-5.2045e-09j,
        1.5902e+01+3.0035e-08j, 5.7518e-01+9.7927e-09j, 1.2093e+00+2.9303e-08j,
        9.0163e-01+3.8141e-08j, 4.5453e+00-7.8152e-08j, 1.0650e-02-1.1372e-08j,
        9.0422e-01+3.0223e-08j, 5.7907e-01-1.4041e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.787865400314331-1.0487826607175066e-08j)
SINR torch.Size([20]) = tensor([14.5586, 15.7586,  6.8120, 13.3780, 11.5647, 12.9702,  8.7006,  4.9579,
        16.5244, 12.6026, 13.5599, 12.7069, 18.6038, 10.3979, 11.2642,  8.6424,
        12.5183, -7.4090, 10.2445,  9.3390], device='cuda:0')
SINR mean = 10.884770393371582
E[H^H] = 1e-07
E_MSE (Error Power) = 0.33229073882102966
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9662, 0.9741, 0.8276, 0.9561, 0.9348, 0.9520, 0.8812, 0.7580, 0.9782,
        0.9479, 0.9578, 0.9491, 0.9864, 0.9164, 0.9305, 0.8797, 0.9470, 0.1537,
        0.9136, 0.8957], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 36,  28, 151,  46,  66,  50, 111, 198,  24,  54,  45,  53,  15,  82,
         70, 112,  55, 608,  84,  99], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 17-----------
Real SNR = tensor([13.9520, 15.5142, 13.8979, 13.9670, 15.1470, 15.0214, 10.3828, 17.3724,
        10.8800, 13.6574, 11.7175, 13.2206, 15.8001, 19.6264, 15.1955, 17.1368,
        14.3674, 10.0040, 15.6126, 15.0830], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.5151+1.4055e-07j, 2.2469-1.9767e-07j, 0.1962+5.2154e-08j,
        0.4925+2.9802e-08j, 2.2990-2.3409e-10j, 0.5103+2.6077e-08j,
        0.1691-3.6065e-09j, 4.5681-2.3842e-07j, 1.4675+2.8809e-08j,
        0.1940-1.9668e-07j, 0.1008+1.7325e-09j, 0.2813+6.0033e-09j,
        2.2199-1.7881e-07j, 0.0137+5.9605e-08j, 0.4938-1.1940e-08j,
        4.4213-8.4299e-08j, 0.2895+5.0560e-09j, 0.0056-0.0000e+00j,
        3.3519-2.1235e-09j, 1.2159-7.9858e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4026216268539429-3.219309974156204e-08j)
torch.linalg.det(H.mH@H) = tensor([1.6578-6.1549e-08j, 1.1082+1.1080e-07j, 0.2489+7.4506e-09j,
        0.5328-3.2596e-09j, 0.8798-9.3760e-09j, 0.6214+1.3673e-08j,
        0.0874-1.0518e-09j, 5.3000-2.0823e-08j, 0.1389-9.3132e-10j,
        0.6761-7.0354e-08j, 0.0336-3.1508e-09j, 0.2819+8.8757e-09j,
        1.2444-7.3313e-08j, 0.5424-5.0664e-07j, 0.4763+6.1919e-08j,
        3.4887+5.6802e-08j, 1.3014+4.4813e-09j, 0.0527-1.1642e-10j,
        2.6328+6.4355e-08j, 1.4866-1.2446e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1396048069000244-2.7333035390597615e-08j)
SINR torch.Size([20]) = tensor([13.5111, 10.2522,  5.8950,  9.9279, 10.8850, 10.2367,  5.5055, 15.5477,
         6.3555,  9.9619,  1.2119,  8.8318, 11.7168,  6.2920,  9.2160, 15.3338,
        13.2649,  4.3866, 14.8341, 12.4018], device='cuda:0')
SINR mean = 9.778390884399414
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1458035409450531
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9573, 0.9138, 0.7953, 0.9077, 0.9246, 0.9135, 0.7803, 0.9729, 0.8121,
        0.9084, 0.5693, 0.8843, 0.9369, 0.8098, 0.8930, 0.9715, 0.9550, 0.7330,
        0.9682, 0.9456], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 45,  84, 173,  89,  75,  85, 183,  29, 162,  89, 313, 108,  64, 163,
        101,  31,  47, 214,  34,  56], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 18-----------
Real SNR = tensor([18.2984, 11.4535, 19.0453, 16.6057, 18.0583, 20.1091, 17.3322, 19.8046,
        13.2662, 21.6473, 19.1012, 19.3132, 16.8777, 15.9147, 15.6383, 17.7241,
        18.0550, 16.7356, 14.3913, 15.3633], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.8807+4.9905e-08j,  0.0714-3.7253e-08j,  4.6627+2.5610e-08j,
         4.1591-4.5546e-08j,  3.5826+1.3713e-07j,  1.9610+2.6569e-08j,
         0.4173-2.1895e-09j,  0.9803+2.8515e-08j,  0.1437-1.1488e-08j,
        26.3934+1.5232e-07j,  5.1740-1.4453e-07j,  4.9031+1.2112e-07j,
         0.4980+1.3988e-08j,  0.6069-0.0000e+00j,  0.0518+1.7531e-08j,
         3.7638-3.2962e-08j,  0.7598-2.4587e-07j,  0.5747-1.7881e-07j,
         0.4599+6.6105e-09j,  0.3447-9.4602e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.11944842338562-6.44094555468655e-09j)
torch.linalg.det(H.mH@H) = tensor([2.4623e+00-5.4607e-08j, 2.1113e-01+1.7604e-09j, 3.1902e+00+2.1394e-07j,
        2.9615e+00-8.0796e-08j, 1.8080e+00-3.4391e-08j, 1.8976e+00+1.5005e-08j,
        3.8375e-01+6.0388e-09j, 7.3432e-01-8.1855e-09j, 7.3463e-03-9.5461e-09j,
        2.0322e+01-3.6313e-07j, 3.8480e+00-4.3084e-08j, 3.5796e+00-1.1512e-07j,
        1.1190e+00+4.5173e-08j, 4.6067e-01+1.3411e-07j, 5.5229e-02-8.4383e-09j,
        3.1250e+00+2.4766e-09j, 1.9683e-01+8.3819e-08j, 3.0525e-01+5.9605e-08j,
        9.1564e-02-2.8436e-09j, 7.3972e-01-1.5804e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.374966621398926-8.701042553127536e-09j)
SINR torch.Size([20]) = tensor([15.5128,  8.7981, 15.1211, 16.5061, 12.9092, 14.1096,  9.4310,  9.0690,
        -5.3306, 20.8038, 15.7943, 15.9521, 13.7039,  8.7781,  3.4769, 16.2321,
         3.8389,  7.5644,  6.1341, 12.4649], device='cuda:0')
SINR mean = 11.043493270874023
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2649299204349518
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9727, 0.8835, 0.9702, 0.9781, 0.9513, 0.9626, 0.8977, 0.8898, 0.2266,
        0.9918, 0.9743, 0.9752, 0.9591, 0.8830, 0.6901, 0.9767, 0.7076, 0.8509,
        0.8041, 0.9464], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 30, 109,  32,  24,  51,  40,  98, 104, 540,   9,  28,  27,  43, 109,
        241,  25, 230, 134, 167,  55], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 19-----------
Real SNR = tensor([15.1887, 13.3781, 20.1699, 13.5916, 18.9136, 18.6204, 18.1143, 13.5530,
        20.4452, 11.5682, 15.0018, 17.3739, 14.0812, 14.9196, 13.2400, 16.8443,
        20.0593, 22.9510, 19.4113, 21.3699], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([9.1147e-01-5.8999e-09j, 5.1146e-01-1.8626e-08j, 1.0164e+01-8.0555e-08j,
        3.1050e-01-1.2717e-08j, 1.0202e+00-9.5461e-09j, 3.0420e+00+1.0745e-08j,
        1.0602e-02+2.2669e-08j, 7.5391e-01-2.0786e-08j, 1.9887e+00-8.9407e-08j,
        1.1773e-01-8.4391e-10j, 5.6644e-01-6.6173e-10j, 3.9829e-01-3.4334e-09j,
        1.1079e+00+1.1002e-08j, 4.5463e-02-1.5603e-09j, 7.6189e-01-4.7108e-09j,
        1.0894e+00-5.9605e-08j, 4.9596e+00-5.0542e-08j, 2.1686e+01-2.8296e-09j,
        2.1236e+00-8.7214e-08j, 6.1353e+00-2.3892e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8852574825286865-2.1420786922021762e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.5074+4.4909e-09j,  0.3599+3.7253e-09j,  6.4893+1.1490e-07j,
         0.2526-5.2750e-09j,  3.2082-1.0867e-07j,  1.8736+5.9605e-08j,
         0.3003+3.1861e-09j,  0.5544-1.9711e-08j,  1.3739-3.5018e-07j,
         0.0418+5.7126e-09j,  0.2203+1.7156e-09j,  0.6760+1.2273e-08j,
         0.1661+3.7253e-08j,  0.0848+5.9067e-09j,  0.5339+8.0606e-09j,
         1.3190+1.1618e-08j,  4.2080+8.8062e-09j, 22.3729-1.4519e-07j,
         2.0769-4.1981e-08j,  5.7916-5.1069e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6205458641052246-2.2241358976771153e-08j)
SINR torch.Size([20]) = tensor([13.5173, 11.3690, 18.7833, 11.1901, 16.7161, 14.8899,  9.2633, 12.3762,
        11.3991,  4.1401,  9.2190, 12.2830,  8.3107,  7.5163, 13.9236, 14.9312,
        17.5240, 22.2338, 15.3748, 18.6783], device='cuda:0')
SINR mean = 13.181955337524414
E[H^H] = 1e-07
E_MSE (Error Power) = 0.07325555384159088
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9574, 0.9320, 0.9869, 0.9293, 0.9791, 0.9686, 0.8941, 0.9453, 0.9324,
        0.7218, 0.8931, 0.9442, 0.8714, 0.8495, 0.9611, 0.9689, 0.9826, 0.9941,
        0.9718, 0.9866], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 45,  69,  14,  71,  23,  34, 101,  56,  68, 221, 101,  57, 118, 135,
         41,  33,  19,   6,  30,  15], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 20-----------
Real SNR = tensor([17.9669, 17.2411, 26.4113, 20.1751, 20.5279, 17.4427, 15.6462, 20.9181,
        23.5966, 14.7138, 18.2083, 16.0317, 20.0903, 23.8200, 22.5943, 19.4684,
        21.3389, 17.6902, 17.6494, 17.2177], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([9.6515e-02-2.1700e-07j, 1.5512e+00-9.1971e-09j, 3.5418e-01+1.1277e-07j,
        1.1198e+01+5.8988e-08j, 2.5067e+00-5.9605e-07j, 5.4472e-03+2.8056e-08j,
        1.0209e+00-0.0000e+00j, 3.8867e+00+1.6790e-07j, 8.3087e+00+6.2879e-08j,
        4.7759e-02+5.9605e-08j, 1.6555e-01+1.0872e-09j, 4.0230e-02-9.3132e-10j,
        3.6321e+00+1.7375e-08j, 1.0755e+01-1.2972e-07j, 1.2653e+01+1.7644e-07j,
        1.7867e+00+2.1993e-08j, 2.6416e+00-1.2842e-09j, 1.4213e+00+8.6324e-09j,
        7.2256e-01-1.4901e-08j, 1.9716e+00-8.3252e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.2382702827453613-1.6830496107900217e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.0445-1.7742e-07j,  1.9734-4.9161e-09j,  0.8470-1.5021e-07j,
         9.4329-1.1516e-07j,  1.9908-1.1921e-07j,  0.0284+6.0536e-09j,
         0.9060+1.4901e-08j,  1.2946-5.4709e-08j,  3.8632+6.6873e-08j,
         0.0196+4.8429e-08j,  0.2518+2.3238e-09j,  0.1859+2.8295e-09j,
         1.9536-2.0618e-08j,  5.7149-3.6814e-08j, 10.7049+1.3578e-07j,
         2.1689-5.0334e-09j,  1.5720+2.1684e-07j,  1.2379+2.1866e-09j,
         1.1305-2.7381e-08j,  1.2838-4.2754e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.330228567123413-1.2899843859770499e-08j)
SINR torch.Size([20]) = tensor([-2.8008, 17.7493,  8.4896, 21.4711, 15.2871,  0.8323, 14.5957, 12.9209,
        16.8727, -2.5127,  9.2866,  9.2760, 16.6274, 19.3809, 20.9372, 17.8719,
        13.8633, 16.8933, 15.3547, 15.8172], device='cuda:0')
SINR mean = 12.910687446594238
E[H^H] = 1e-07
E_MSE (Error Power) = 0.247074156999588
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3441, 0.9835, 0.8760, 0.9929, 0.9713, 0.5478, 0.9665, 0.9514, 0.9799,
        0.3593, 0.8946, 0.8943, 0.9787, 0.9886, 0.9920, 0.9839, 0.9605, 0.9800,
        0.9717, 0.9745], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([452,  18, 115,   8,  31, 326,  36,  51,  22, 442, 100, 100,  23,  13,
          9,  18,  42,  22,  31,  28], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 21-----------
Real SNR = tensor([18.6831, 16.7962, 20.9360, 18.2406, 19.7975, 18.6035, 14.8559, 21.4716,
        18.2985, 16.1246, 19.7439, 21.0947, 21.3308, 21.6218, 23.1105, 22.0402,
        23.3560, 18.5786, 20.0494, 18.5710], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3967-2.0231e-08j, 0.2423+2.3202e-09j, 0.6140-3.3604e-08j,
        0.1623+3.2485e-08j, 2.5315-7.2072e-08j, 0.3747-1.4901e-08j,
        0.3815+2.6363e-08j, 0.0533-3.3351e-09j, 1.3480-9.2966e-09j,
        0.5898-9.6231e-09j, 0.3407-3.5978e-08j, 0.8163-2.5332e-07j,
        1.6173-5.9605e-08j, 3.1634-5.2848e-08j, 6.3463+6.6557e-08j,
        2.5787+1.1921e-07j, 1.0027-8.0380e-08j, 0.6736+2.9403e-08j,
        1.4738+1.1877e-07j, 5.9915+1.7414e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.5349305868148804-3.797084424661534e-09j)
torch.linalg.det(H.mH@H) = tensor([1.2781-2.9744e-09j, 0.1266+2.4579e-09j, 0.2167-8.3470e-09j,
        0.0423+3.2914e-09j, 1.5574+2.9012e-09j, 0.3783-1.4901e-08j,
        0.3147+1.2796e-08j, 0.0597-4.4000e-08j, 1.0547-1.5253e-08j,
        0.5710+2.6767e-09j, 0.4504+4.2713e-08j, 1.4732+2.9802e-08j,
        1.7289-4.1723e-07j, 2.5838-2.0812e-09j, 7.9142-2.0723e-07j,
        3.7383-7.7272e-08j, 0.8378+2.4173e-07j, 0.8627-1.1102e-08j,
        1.9551-1.1553e-08j, 5.9334-7.7150e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6538654565811157-2.75363856161448e-08j)
SINR torch.Size([20]) = tensor([17.3115, 11.3393,  9.1822,  3.2492, 17.2637, 10.8523, 12.2171,  3.1567,
        16.8077, 15.6650, 11.2426, 14.5966, 15.8994, 18.7797, 21.4847, 18.8709,
        10.2460, 16.0701, 16.8791, 19.9982], device='cuda:0')
SINR mean = 14.055590629577637
E[H^H] = 1e-07
E_MSE (Error Power) = 0.0784989520907402
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9818, 0.9316, 0.8923, 0.6788, 0.9816, 0.9241, 0.9434, 0.6741, 0.9796,
        0.9736, 0.9301, 0.9665, 0.9749, 0.9869, 0.9929, 0.9872, 0.9137, 0.9759,
        0.9799, 0.9901], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 20,  69, 102, 247,  20,  76,  58, 250,  22,  29,  70,  36,  27,  14,
          8,  14,  84,  26,  22,  11], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 22-----------
Real SNR = tensor([17.8922, 19.4482, 20.0899, 21.3856, 21.1897, 23.4653, 23.5859, 25.3490,
        22.6956, 23.6270, 20.2499, 18.4020, 22.1406, 23.8887, 22.0257, 23.3552,
        21.8485, 18.0710, 14.7645, 23.8632], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.0327-9.3132e-10j,  1.8323+3.4401e-08j,  0.3792+3.7253e-08j,
         4.5474+9.3146e-08j,  4.3534+9.9150e-09j,  3.5787-2.0901e-07j,
         0.6034+3.4944e-07j,  4.4991+7.3834e-09j,  1.8070-7.4506e-08j,
         3.9821+5.7527e-09j,  0.0575-2.9802e-08j,  0.9603+3.9385e-08j,
         1.9624+3.1291e-08j,  1.3435-7.3515e-08j,  6.8628-1.9672e-07j,
        10.0866+2.5015e-07j,  0.3188+2.4104e-08j,  0.3092-4.6810e-09j,
         0.0991+5.4827e-10j,  0.9076+4.7812e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.4261579513549805+1.707110541815382e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0339-7.8704e-09j, 1.4230+4.6622e-08j, 0.1465+5.9605e-08j,
        3.4917-2.5870e-07j, 3.8075+1.8364e-08j, 3.3973-2.3337e-08j,
        0.1657+2.0037e-07j, 5.7898+8.5257e-08j, 2.1278-2.5543e-08j,
        3.2064-1.4439e-08j, 0.1544+7.4506e-09j, 0.3857-2.5468e-08j,
        1.3325+3.6020e-08j, 0.6203-3.5117e-08j, 5.9074+7.9011e-08j,
        9.5867-2.2746e-07j, 0.0311+7.2932e-09j, 0.3896+1.5833e-09j,
        0.0744-8.4066e-11j, 0.6937+1.9601e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.138263702392578-2.84180301513004e-09j)
SINR torch.Size([20]) = tensor([ 7.0075, 18.0032,  6.6773, 20.6761, 20.6849, 19.5180,  4.8887, 20.2955,
        18.8752, 20.9867, 10.4706, 14.0060, 16.5318, 12.2359, 21.6896, 23.4349,
         1.0836, 15.4519, 12.3066, 14.2551], device='cuda:0')
SINR mean = 14.953959465026855
E[H^H] = 1e-07
E_MSE (Error Power) = 0.08721305429935455
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8339, 0.9844, 0.8231, 0.9915, 0.9915, 0.9889, 0.7550, 0.9907, 0.9872,
        0.9921, 0.9177, 0.9618, 0.9783, 0.9436, 0.9933, 0.9955, 0.5621, 0.9723,
        0.9445, 0.9638], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([146,  17, 154,   9,   9,  12, 200,  10,  14,   9,  81,  41,  24,  58,
          7,   5, 317,  30,  57,  39], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 23-----------
Real SNR = tensor([18.8941, 20.7065, 24.2329, 24.1867, 25.5879, 26.4759, 22.1744, 22.6081,
        18.7967, 19.9227, 19.9444, 22.4940, 17.4193, 21.6916, 22.1312, 20.1004,
        20.7784, 18.8233, 23.5536, 24.1749], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.8380-2.2018e-09j,  0.0367+8.7544e-08j,  5.5854-7.7640e-08j,
         0.9824+2.2545e-07j, 10.7902+8.2766e-09j,  1.2578+1.8364e-07j,
         2.1461-1.6727e-08j,  0.7490+3.7253e-08j,  0.1911+5.2154e-08j,
         2.4455+3.5763e-07j,  2.5453-4.8542e-08j,  2.7590-6.3226e-08j,
         1.2645+2.7820e-09j,  0.1141+1.8626e-08j,  0.6222+4.8493e-08j,
         1.2802-2.1657e-08j,  0.2423-2.4123e-09j,  0.4599-3.7253e-08j,
         3.9107+2.2164e-08j,  0.7511-2.7535e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.9485667943954468+3.857973851495444e-08j)
torch.linalg.det(H.mH@H) = tensor([0.8542-2.2733e-09j, 0.0949-9.3132e-10j, 4.8608-1.5276e-08j,
        1.2533-6.6004e-08j, 9.6775+7.8921e-08j, 1.1361+1.6500e-07j,
        1.1161-9.2124e-09j, 0.5189+8.9407e-08j, 0.2392-5.2154e-08j,
        2.3365-0.0000e+00j, 2.5620+2.4202e-08j, 1.5136+1.7881e-07j,
        0.6850-3.7581e-09j, 0.1525+4.6566e-09j, 0.9167+3.6169e-08j,
        0.8015-4.8927e-09j, 0.1579+1.5789e-08j, 0.3765+3.7253e-09j,
        4.7018-1.1056e-07j, 0.8810+1.3967e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7417957782745361+1.727976872700765e-08j)
SINR torch.Size([20]) = tensor([18.0319,  7.4080, 21.7474, 17.4095, 23.4358, 14.8356, 17.5034, 14.0844,
        12.2692, 20.1787, 21.6781, 18.3115, 17.9955, 11.2239, 17.4422, 18.3481,
         9.4219, 14.9516, 21.5940, 15.5447], device='cuda:0')
SINR mean = 16.670774459838867
E[H^H] = 1e-07
E_MSE (Error Power) = 0.033235177397727966
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9845, 0.8463, 0.9934, 0.9822, 0.9955, 0.9682, 0.9825, 0.9624, 0.9440,
        0.9905, 0.9933, 0.9855, 0.9844, 0.9299, 0.9823, 0.9856, 0.8975, 0.9690,
        0.9931, 0.9729], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 17, 137,   7,  20,   5,  34,  19,  40,  58,  10,   7,  16,  17,  70,
         19,  16,  98,  33,   7,  29], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 24-----------
Real SNR = tensor([19.8280, 22.3347, 25.0128, 23.0301, 24.1055, 21.7237, 23.9550, 24.8678,
        25.0715, 26.9693, 22.9232, 24.7636, 24.3043, 20.0187, 27.4805, 19.0409,
        19.9045, 22.0789, 20.4393, 22.6886], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.5123e-01-2.2352e-08j, 2.0574e-01-1.6764e-08j, 4.7433e-01+2.1368e-08j,
        1.7682e+00-2.0966e-08j, 3.3144e+00+2.3842e-07j, 2.2687e-01+2.9802e-08j,
        1.3350e+00+5.9605e-08j, 2.5086e-02+5.4652e-09j, 6.2124e+00-1.9249e-08j,
        7.1343e+00+4.2405e-09j, 2.8451e+00+7.6536e-09j, 4.9039e+00-1.3612e-08j,
        2.2677e+00+1.1143e-07j, 3.1311e-02+7.4506e-09j, 9.4442e+00+2.0150e-07j,
        7.6614e-03+1.7252e-08j, 3.8167e-01-2.4377e-09j, 2.8992e+00+6.1063e-08j,
        2.0513e+00-1.9681e-08j, 4.9490e+00-8.0904e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.5464303493499756+3.210467269809669e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1577-1.8626e-08j,  0.2117+3.7253e-09j,  0.4719-3.1039e-08j,
         1.5494+4.0046e-08j,  2.8990+5.3247e-08j,  0.3780-2.7940e-08j,
         2.2311+4.7684e-07j,  0.2630+5.9592e-09j,  5.5889+3.3515e-07j,
         5.5902+7.3206e-08j,  1.2604+6.2411e-08j,  4.8666+6.7394e-08j,
         1.4885+2.6044e-08j,  0.1081+1.3776e-08j, 11.8470+6.7904e-08j,
         0.0303-5.9995e-09j,  0.1429-2.9678e-09j,  2.5482+5.4923e-08j,
         2.1377-1.1458e-08j,  3.1529+6.9876e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3461763858795166+5.947889647472948e-08j)
SINR torch.Size([20]) = tensor([11.1207, 12.4803, 15.2677, 21.3189, 20.9234, 15.1433, 20.2147, 11.6895,
        23.3154, 23.1274, 18.9601, 23.1028, 18.2816, 10.4356, 24.2700,  5.5235,
        13.4678, 21.9410, 21.9114, 20.6128], device='cuda:0')
SINR mean = 17.655397415161133
E[H^H] = 1e-07
E_MSE (Error Power) = 0.03593187779188156
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9283, 0.9465, 0.9711, 0.9927, 0.9920, 0.9703, 0.9906, 0.9365, 0.9954,
        0.9952, 0.9875, 0.9951, 0.9854, 0.9170, 0.9963, 0.7811, 0.9569, 0.9936,
        0.9936, 0.9914], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 72,  55,  31,   8,   9,  32,  10,  64,   5,   5,  14,   5,  16,  82,
          4, 183,  45,   7,   7,   9], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 25-----------
Real SNR = tensor([23.1942, 24.0695, 25.1646, 23.6810, 23.2174, 24.1623, 23.6258, 26.5867,
        24.5206, 21.7185, 24.2084, 25.6175, 24.7513, 26.2285, 21.7162, 23.0405,
        21.2398, 23.3280, 25.1523, 24.2517], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.8723+2.8223e-08j, 1.6749+5.0702e-08j, 1.4360+4.6928e-08j,
        1.3950+3.0359e-09j, 2.7707+1.9791e-08j, 0.8284-4.8961e-08j,
        0.0361+9.9313e-10j, 0.7301+1.4099e-07j, 3.3908+3.8235e-09j,
        1.3170-2.7629e-09j, 1.9030+8.1586e-09j, 6.5081-7.2166e-08j,
        3.2151+2.7927e-07j, 4.1508+3.3786e-09j, 0.0555+1.9865e-08j,
        0.8597-1.8888e-08j, 0.3161-0.0000e+00j, 0.6991+3.3999e-10j,
        4.0707+1.1669e-07j, 0.2029+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8216222524642944+2.9715469196389677e-08j)
torch.linalg.det(H.mH@H) = tensor([0.9595+7.1323e-09j, 1.4883-5.9605e-08j, 1.2993-4.6532e-08j,
        1.0955-2.7772e-08j, 2.8517+1.4607e-08j, 0.8277+4.7536e-08j,
        0.0194-6.5711e-09j, 1.1708+5.4525e-08j, 3.0882+2.3798e-08j,
        1.6671-4.5195e-08j, 1.5464-4.6980e-09j, 4.7484-1.2945e-07j,
        2.8496+5.4501e-07j, 3.5957-9.3099e-08j, 0.1399+9.9925e-09j,
        0.6852+2.9802e-08j, 0.3656-1.4901e-08j, 0.8976-9.2343e-09j,
        4.4440+4.6259e-08j, 0.3161+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7027971744537354+1.857032572161188e-08j)
SINR torch.Size([20]) = tensor([20.6298, 20.5076, 20.1102, 21.1434, 23.1111, 18.6175,  3.6629, 17.4868,
        24.2763, 22.4612, 21.0719, 23.9789, 21.6217, 23.8580, 11.9315, 18.7473,
        17.6265, 19.7141, 23.2826, 13.7866], device='cuda:0')
SINR mean = 19.381288528442383
E[H^H] = 1e-07
E_MSE (Error Power) = 0.030897444114089012
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9914, 0.9912, 0.9903, 0.9924, 0.9951, 0.9864, 0.6992, 0.9825, 0.9963,
        0.9944, 0.9922, 0.9960, 0.9932, 0.9959, 0.9398, 0.9868, 0.9830, 0.9894,
        0.9953, 0.9599], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  9,  10,  11,   8,   5,  15, 235,  19,   4,   6,   8,   4,   7,   4,
         62,  15,  19,  12,   5,  42], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 26-----------
Real SNR = tensor([26.7250, 26.1280, 24.0737, 31.1790, 25.4063, 26.5188, 20.0612, 22.7140,
        25.2381, 19.4684, 21.5213, 22.1255, 27.0031, 28.3296, 24.1619, 23.6098,
        22.6304, 22.7607, 21.3212, 19.4226], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.6498-4.0894e-08j, 1.2828-5.8685e-08j, 2.0433-8.1888e-09j,
        3.5768-2.4104e-08j, 0.5178-2.9432e-09j, 0.2292+7.5776e-08j,
        0.0211-2.1420e-08j, 0.2468-4.2512e-09j, 1.0346-8.9407e-08j,
        0.5378-1.0840e-09j, 0.1351+1.0437e-09j, 0.0593+1.3970e-08j,
        4.2267+1.7289e-08j, 6.5683+8.4394e-08j, 3.7005-8.3369e-08j,
        0.4040+2.9802e-08j, 0.5283+2.1553e-09j, 1.1879-1.0955e-08j,
        0.6138+2.9802e-08j, 0.1618+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4363065958023071-3.0633231506982384e-09j)
torch.linalg.det(H.mH@H) = tensor([1.9103-1.3691e-07j, 1.7530+2.1496e-07j, 1.7748+9.9790e-09j,
        3.3690-1.1402e-07j, 0.6294+1.0580e-10j, 0.2767-2.1443e-08j,
        0.0386+1.8626e-09j, 0.3946+5.0344e-09j, 0.6453+8.9407e-08j,
        0.4004+6.0125e-09j, 0.2314-2.7344e-09j, 0.0764-1.5134e-09j,
        3.6437-5.8162e-08j, 7.4621+2.1315e-07j, 3.6320-7.7624e-09j,
        0.3752-0.0000e+00j, 0.5156+9.3010e-09j, 1.0348-0.0000e+00j,
        0.4782+1.4901e-08j, 0.0910+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4366286993026733+1.1853974690723135e-08j)
SINR torch.Size([20]) = tensor([22.0275, 19.8301, 23.1872, 21.7468, 19.4003, 14.0347,  8.6819, 18.7766,
        18.7949, 19.7155, 16.3535, 12.7341, 25.0894, 26.5087, 23.6054, 17.3842,
        19.4170, 20.7740, 18.5127, 11.6138], device='cuda:0')
SINR mean = 18.909427642822266
E[H^H] = 1e-07
E_MSE (Error Power) = 0.020551985129714012
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9938, 0.9897, 0.9952, 0.9934, 0.9886, 0.9620, 0.8807, 0.9869, 0.9870,
        0.9894, 0.9774, 0.9494, 0.9969, 0.9978, 0.9957, 0.9821, 0.9887, 0.9917,
        0.9861, 0.9355], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  7,  11,   5,   7,  12,  40, 111,  14,  14,  12,  25,  53,   3,   2,
          5,  20,  12,   9,  15,  65], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 27-----------
Real SNR = tensor([30.4252, 27.4272, 28.7512, 25.5677, 22.6132, 27.9459, 23.0889, 24.8714,
        25.9063, 23.2578, 29.0985, 23.9983, 28.3760, 28.0712, 22.1958, 22.7885,
        24.1379, 26.3288, 26.3494, 24.7954], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.7488e+01-3.2666e-07j, 2.4626e+00+4.1723e-07j, 3.6525e+00+1.0407e-07j,
        6.0184e-01-6.2285e-08j, 4.6680e-02-5.1827e-10j, 2.4443e-02-4.0978e-08j,
        1.5690e+00+1.6577e-08j, 5.0760e-01-2.0080e-08j, 3.3735e+00+3.4466e-09j,
        3.4862e-01-9.8253e-09j, 2.3427e+00-8.3537e-10j, 5.2926e-01+4.4703e-08j,
        2.7420e+00+2.5809e-08j, 1.1581e-01-2.6275e-08j, 1.0151e+00+1.8688e-08j,
        5.4687e-02+7.4506e-09j, 3.4594e-03+1.3744e-09j, 1.7690e+00+2.8354e-08j,
        8.3787e-01-6.8918e-08j, 7.8570e+00+1.2356e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.3670647144317627+1.1744511141387193e-08j)
torch.linalg.det(H.mH@H) = tensor([1.7818e+01-2.9285e-07j, 2.9798e+00-0.0000e+00j, 4.3489e+00-8.2194e-08j,
        8.2677e-01+1.5994e-08j, 3.4963e-02+5.9142e-09j, 5.5697e-02+2.4959e-07j,
        1.1279e+00+1.1204e-09j, 6.4437e-01+5.4246e-08j, 3.6324e+00-4.0227e-08j,
        3.2708e-01-5.4376e-08j, 2.5404e+00+5.7789e-08j, 3.2720e-01+2.6077e-08j,
        3.4024e+00+1.3641e-07j, 9.6105e-02-2.0305e-08j, 1.1002e+00+6.9780e-09j,
        4.5393e-02+5.5879e-09j, 5.5328e-03+2.8223e-08j, 1.9086e+00+1.5819e-08j,
        7.8904e-01-1.4901e-07j, 7.9759e+00+1.1286e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.499328374862671+3.882945520672365e-09j)
SINR torch.Size([20]) = tensor([29.9118, 22.7133, 24.7815, 21.7965, 10.4153,  7.1605, 23.1490, 19.8879,
        25.1463, 16.9321, 22.7284, 17.4139, 23.7565, 11.2413, 22.4656, 11.1760,
         1.1238, 24.2330, 18.8246, 27.6627], device='cuda:0')
SINR mean = 19.12601089477539
E[H^H] = 1e-07
E_MSE (Error Power) = 0.05888241529464722
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9990, 0.9947, 0.9967, 0.9934, 0.9167, 0.8387, 0.9952, 0.9898, 0.9970,
        0.9801, 0.9947, 0.9822, 0.9958, 0.9301, 0.9944, 0.9291, 0.5643, 0.9962,
        0.9871, 0.9983], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  1,   6,   3,   7,  82, 143,   5,  11,   3,  22,   6,  20,   4,  70,
          6,  71, 316,   4,  14,   2], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 28-----------
Real SNR = tensor([30.0576, 29.6224, 30.3474, 27.1461, 23.9448, 31.1350, 27.6590, 27.8071,
        30.5436, 25.3177, 30.8894, 24.2135, 25.2290, 28.8867, 28.0520, 27.2951,
        27.7097, 27.7738, 22.7425, 19.0910], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.3678-5.8350e-08j,  6.1773-5.7836e-08j,  1.5165+2.9099e-09j,
         1.6225+1.1106e-08j,  0.7982-2.2562e-08j, 10.1094+2.9193e-07j,
         6.1253-6.8313e-08j,  5.9809+8.4372e-08j,  0.2038+6.3827e-08j,
         0.6431-7.9137e-09j,  7.1391+3.5763e-07j,  0.7048-0.0000e+00j,
         2.6578+3.4887e-08j,  2.1837+5.8706e-08j,  1.0905+2.0332e-09j,
         0.9137+3.8717e-08j,  1.4992+1.3356e-08j,  3.6667-2.9418e-08j,
         0.0239+4.6566e-09j,  0.1465+1.8008e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.678539991378784+3.599602038661942e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4893-5.5062e-08j, 6.4550-1.3668e-07j, 1.5666+6.0288e-09j,
        1.6744-2.5303e-08j, 0.7075+4.2852e-08j, 8.7580-4.5539e-08j,
        5.6765-8.2652e-08j, 5.8258-9.8392e-08j, 0.1340+5.4031e-09j,
        0.6434-8.0817e-10j, 6.7459-1.0374e-07j, 0.5020+7.4506e-08j,
        2.6792+9.4873e-09j, 1.6848+2.0029e-07j, 0.8464+2.2867e-08j,
        0.7761-2.5654e-08j, 1.2234+3.7188e-08j, 3.1542+6.0617e-08j,
        0.0571-1.8626e-09j, 0.1772-1.2773e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4888389110565186-5.886129805787732e-09j)
SINR torch.Size([20]) = tensor([16.1547, 28.3990, 22.0673, 24.2190, 22.5513, 28.6285, 28.0692, 28.1753,
        13.0439, 23.1774, 26.7391, 20.6077, 26.9289, 23.4741, 21.4673, 21.4040,
        22.3330, 25.9567, 11.5420, 18.8094], device='cuda:0')
SINR mean = 22.687389373779297
E[H^H] = 1e-07
E_MSE (Error Power) = 0.010371741838753223
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9763, 0.9986, 0.9938, 0.9962, 0.9945, 0.9986, 0.9984, 0.9985, 0.9527,
        0.9952, 0.9979, 0.9914, 0.9980, 0.9955, 0.9929, 0.9928, 0.9942, 0.9975,
        0.9345, 0.9870], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([26,  1,  7,  4,  6,  1,  1,  1, 49,  5,  2,  9,  2,  5,  8,  8,  6,  2,
        66, 14], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 29-----------
Real SNR = tensor([28.5052, 26.1973, 28.8029, 31.1082, 28.7041, 30.7811, 28.7309, 25.2754,
        22.7665, 25.3446, 30.2256, 28.5127, 27.0086, 27.5079, 28.6368, 27.8289,
        30.6032, 28.4281, 26.6411, 26.3724], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.1195-4.1904e-08j, 2.1574+2.7416e-09j, 2.1383+2.4297e-08j,
        2.6224+1.4978e-07j, 1.2158-7.4345e-08j, 2.0568-6.1880e-08j,
        1.0663+2.6468e-08j, 0.7486-2.7278e-10j, 0.1183+9.3132e-10j,
        0.9134-1.0918e-08j, 0.3844-5.3171e-08j, 0.5640-8.3180e-09j,
        4.7576+2.2719e-09j, 1.8421-1.5895e-08j, 4.4920-1.1921e-07j,
        3.1271-1.2339e-08j, 7.7285+7.8951e-08j, 0.1658-1.2506e-07j,
        1.2543-2.4511e-08j, 0.2736-7.4506e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.0873219966888428-1.6844035499730126e-08j)
torch.linalg.det(H.mH@H) = tensor([4.9427-5.7916e-08j, 1.7980-2.1112e-08j, 2.0983-3.6187e-08j,
        2.9390-5.9605e-07j, 1.1059-8.5509e-08j, 2.4295+5.1956e-09j,
        0.8288-1.3812e-08j, 0.7553+6.4298e-08j, 0.0929+7.4506e-09j,
        0.8094+5.1606e-10j, 0.5962+5.9119e-08j, 0.3209+3.7906e-08j,
        3.9024-3.9233e-08j, 1.8548-1.2408e-09j, 4.1976+1.7881e-07j,
        3.6124+8.2713e-09j, 6.9941+5.1272e-08j, 0.2335-7.3872e-08j,
        1.1177+8.4102e-09j, 0.4366+4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.053300619125366-2.2948615452378363e-08j)
SINR torch.Size([20]) = tensor([28.1410, 26.6037, 26.3502, 25.8135, 23.5634, 26.1533, 23.5292, 22.6434,
        17.3264, 23.2427, 18.8508, 18.6189, 28.6354, 26.0172, 26.9078, 27.8914,
        29.1974, 17.7125, 23.6526, 19.2377], device='cuda:0')
SINR mean = 24.00442123413086
E[H^H] = 1e-07
E_MSE (Error Power) = 0.005395601969212294
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9985, 0.9978, 0.9977, 0.9974, 0.9956, 0.9976, 0.9956, 0.9946, 0.9818,
        0.9953, 0.9871, 0.9864, 0.9986, 0.9975, 0.9980, 0.9984, 0.9988, 0.9833,
        0.9957, 0.9882], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 1,  2,  2,  3,  5,  2,  5,  6, 20,  5, 14, 15,  1,  2,  2,  1,  1, 18,
         5, 13], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)

--- 処理中: 画像 61 から 80 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 60)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6583, 0.6377, 0.7080, 0.4698, 0.4843, 0.5120, 0.8771, 0.5660, 0.6880,
        0.6601, 0.6396, 0.6971, 0.6009, 0.7180, 0.5978, 0.4435, 0.5451, 0.5308,
        0.7748, 0.5434], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-7.7169, -5.8596, -7.4647, -2.0754, -6.9575, -5.7327, -4.4672, -4.9815,
        -7.3128, -3.7971, -4.5665, -7.4823, -1.8882, -6.6908, -5.7802, -4.9444,
        -5.0204, -7.9469, -4.9971, -7.4940], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([618.8245-4.5959e-05j, 204.9224-3.1378e-11j, 478.8835-7.7189e-06j,
        465.6022-1.3733e-04j,  21.1610-2.3365e-05j,  64.3468+4.3869e-05j,
        281.3347-4.2707e-06j, 865.6691+8.6068e-06j,  17.1350-7.1603e-08j,
        455.2824+3.5988e-06j, 257.3672+6.9452e-08j, 768.3654-0.0000e+00j,
        105.8723-3.7542e-07j, 264.1241+4.8374e-06j, 137.3747-1.6210e-06j,
        163.5066-3.8865e-06j, 153.4148+7.9278e-07j,  99.7247-6.9119e-07j,
        120.6575+1.6212e-05j, 173.1561-9.2466e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(285.8362731933594-7.827441550034564e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.2530-1.0204e-09j,  0.6267-3.9761e-09j,  0.1938+1.8626e-07j,
         0.3609-8.6620e-09j,  0.4371+7.4506e-08j,  0.3403+5.7123e-09j,
         0.7958+1.3609e-07j,  1.4163-1.7881e-07j,  0.5552+8.1703e-08j,
         3.1493-5.5321e-08j,  0.8317+4.4703e-08j,  0.2561+4.4703e-08j,
        11.1339+7.2916e-08j,  2.7532-5.9605e-08j,  0.9377+1.2161e-08j,
         1.0395+4.1959e-08j,  0.6736+2.9802e-07j,  0.1307+3.7253e-08j,
         2.0383-1.1921e-07j,  0.6697-1.1448e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4296414852142334+2.989672154285472e-08j)
SINR torch.Size([20]) = tensor([-13.9107, -12.0377, -18.1926, -15.7568, -13.1194, -15.4693, -13.6340,
        -11.9616, -12.6603,  -6.8774, -14.6865, -16.6110,  -4.1925,  -8.1436,
        -10.1827,  -9.3692, -14.5800, -17.8998,  -8.5489, -10.2598],
       device='cuda:0')
SINR mean = -12.404693603515625
E[H^H] = 1e-07
E_MSE (Error Power) = 22.283374786376953
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0391, 0.0589, 0.0149, 0.0259, 0.0465, 0.0276, 0.0415, 0.0598, 0.0514,
        0.1703, 0.0329, 0.0214, 0.2758, 0.1329, 0.0875, 0.1036, 0.0337, 0.0160,
        0.1226, 0.0861], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([794, 745, 895, 839, 774, 833, 787, 743, 761, 591, 813, 860, 501, 631,
        692, 668, 811, 889, 644, 695], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -4-----------
Real SNR = tensor([ -3.2708,  -3.3237,  -7.5193,  -1.2639,  -3.2112,  -4.7113,  -4.8959,
         -8.7924,  -5.9207,  -5.4747, -12.3881,  -6.2084,  -3.8642,  -6.2810,
         -4.8221,  -7.0726,  -7.3992,  -4.6065,  -7.1956,  -8.9496],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  7.5183+2.3333e-05j,   1.8771+1.7371e-07j, 336.0108+5.2594e-07j,
        136.4518+1.8423e-06j, 521.1913-1.0452e-05j, 454.1736-1.2340e-06j,
         10.9293-2.2141e-06j, 363.7415-7.4960e-07j, 408.8673-5.9940e-06j,
        166.8658-1.0119e-05j, 129.4283-2.9671e-06j, 853.2404-1.3312e-05j,
        122.9647+1.5860e-05j,  40.7508+1.9073e-06j,  15.0396-2.0194e-06j,
          7.7669-3.8403e-07j,  13.5477+4.7684e-07j, 119.2877+2.2085e-06j,
        232.8066-5.2008e-06j, 177.8298+9.3632e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(206.0144500732422-3.69150257029105e-07j)
torch.linalg.det(H.mH@H) = tensor([1.2471e+00+2.3505e-08j, 5.5582e-01-4.5497e-09j, 1.3754e+00-1.0937e-08j,
        1.2673e+01+2.7767e-07j, 6.2212e+00-9.5520e-08j, 2.2032e+00-9.3471e-09j,
        1.8707e-02+4.4036e-08j, 6.1218e-03-1.8859e-08j, 9.3964e-01+2.2352e-08j,
        1.1876e+00+1.6008e-08j, 2.8130e-02-1.6223e-10j, 6.7168e-01-1.2900e-08j,
        9.9416e-01-5.9605e-08j, 3.1705e-01+1.2044e-09j, 3.0228e+00-7.2994e-08j,
        4.7584e-01-1.4479e-08j, 1.2615e+00+4.1117e-09j, 2.1214e+00-2.4068e-08j,
        1.0306e-01+1.8626e-08j, 3.8854e-01-4.1954e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7906156778335571+4.1837391329124785e-09j)
SINR torch.Size([20]) = tensor([ -9.0511, -12.7286,  -7.3149,  -2.9361,  -3.7076,  -6.4148, -27.2604,
        -29.3055, -11.0163,  -9.1128, -18.7379, -11.3149, -11.2755, -13.3952,
         -5.5704, -10.5443,  -7.3377,  -7.0009, -18.4004, -11.4197],
       device='cuda:0')
SINR mean = -11.692249298095703
E[H^H] = 1e-07
E_MSE (Error Power) = 78.44738006591797
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1107, 0.0506, 0.1565, 0.3371, 0.2987, 0.1859, 0.0019, 0.0012, 0.0733,
        0.1093, 0.0132, 0.0688, 0.0694, 0.0438, 0.2171, 0.0811, 0.1558, 0.1663,
        0.0142, 0.0673], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 659,  763,  605,  457,  484,  576, 1000, 1000,  716,  661,  907,  725,
         724,  781,  548,  703,  606,  595,  900,  728], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -3-----------
Real SNR = tensor([-1.9051, -2.5847, -0.7920, -6.0461, -0.2667, -4.3367, -6.8201, -1.6832,
        -7.7267, -6.9786, -6.8189, -3.3884, -6.2799, -1.6740, -1.2954, -4.1082,
        -1.3804, -1.0320, -3.3539, -9.2403], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 32.5223+1.9771e-07j, 111.1981-1.1525e-05j,  56.7660-1.2241e-06j,
         64.3460+3.8147e-06j,   1.1615-7.4506e-09j, 313.4699-3.1201e-07j,
          3.6044+1.4305e-06j, 413.0338+2.6786e-06j,  14.2274+8.6596e-07j,
         47.8291+6.1371e-07j,  18.6530-5.0533e-07j,   2.4791-3.6240e-07j,
         40.4587+1.0329e-07j, 116.3739+2.8404e-06j,  53.9753-2.5821e-06j,
        131.2548-1.1399e-06j,  68.1769-1.4879e-06j, 348.5535+3.7716e-06j,
        179.5143-2.0562e-07j, 887.2162+3.4439e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(145.24070739746094+2.0419788526737648e-08j)
torch.linalg.det(H.mH@H) = tensor([5.3454+1.4458e-07j, 0.9503-1.7912e-08j, 0.5797+3.8520e-08j,
        0.1773+1.8999e-08j, 1.5468+1.0431e-07j, 2.2680+3.4124e-08j,
        1.4977-5.9605e-08j, 3.6864+6.6562e-08j, 0.2487-3.3528e-08j,
        0.2860-7.4506e-09j, 0.7009-2.2542e-08j, 1.8370-0.0000e+00j,
        0.0817-2.6077e-08j, 0.3981-1.4753e-08j, 0.4834-9.2015e-08j,
        0.9244-4.8470e-08j, 1.6449+1.2317e-08j, 2.0271+1.7270e-07j,
        5.6517-1.6966e-08j, 0.2602-9.5316e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5297861099243164+1.2591796938465905e-08j)
SINR torch.Size([20]) = tensor([ -3.9255, -10.0582, -13.1711, -12.4489, -10.2015,  -6.6263,  -7.5320,
         -4.1661, -13.8034, -13.6608,  -9.3025,  -6.6680, -17.2666, -14.5722,
        -12.8811,  -7.9364,  -8.1664,  -7.1968,  -2.8537,  -9.9712],
       device='cuda:0')
SINR mean = -9.620436668395996
E[H^H] = 1e-07
E_MSE (Error Power) = 12.350520133972168
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2883, 0.0898, 0.0460, 0.0538, 0.0871, 0.1786, 0.1500, 0.2770, 0.0400,
        0.0413, 0.1051, 0.1772, 0.0184, 0.0337, 0.0490, 0.1385, 0.1323, 0.1601,
        0.3414, 0.0915], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([492, 689, 775, 756, 693, 583, 612, 500, 791, 788, 666, 584, 875, 811,
        767, 625, 632, 601, 454, 686], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -2-----------
Real SNR = tensor([-0.4849, -2.6005, -3.3978, -2.1958, -7.1329, -6.5785, -5.6057,  1.1951,
        -1.4694, -3.0118, -2.4525, -4.0628, -7.4209, -6.8545, -2.9144, -2.0405,
        -5.1607, -1.8105, -0.0871, -5.9687], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([150.4860+5.7627e-07j,  20.3448+1.3573e-05j,  15.5342-0.0000e+00j,
         55.7129-1.1921e-07j,   3.3459-7.7204e-08j, 133.0277+1.1745e-06j,
         73.0007+1.8511e-07j, 223.3978+5.1694e-07j,  36.6877+8.3484e-07j,
         30.6230-3.8147e-06j,  44.7165+2.1911e-06j,  23.9424-2.6557e-06j,
         45.2678-4.9653e-08j,  92.5867-9.9089e-07j, 200.7020+1.3218e-07j,
         66.1647-4.5720e-07j,  28.6066-1.3094e-05j,  30.9045+4.8741e-06j,
         94.5181-0.0000e+00j, 100.1411+1.9073e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(73.48555755615234+2.3535262982932181e-07j)
torch.linalg.det(H.mH@H) = tensor([3.4764+1.2320e-07j, 1.1832+3.3232e-08j, 0.7961+9.5149e-09j,
        0.6230+1.6391e-07j, 0.4753-1.7377e-09j, 0.1392+3.8902e-10j,
        1.2108+1.9964e-08j, 0.5986+6.2240e-08j, 0.4380-1.7313e-08j,
        1.3724+1.7881e-07j, 1.8391-5.9605e-08j, 0.9013-2.9802e-08j,
        0.2404-1.0245e-08j, 0.0539-2.5146e-08j, 0.7962-2.5481e-08j,
        2.1084+3.5820e-08j, 0.6402-2.3073e-08j, 2.5924-5.9605e-08j,
        3.9691-2.3842e-07j, 0.8238-7.7156e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2138941287994385+6.447407940868288e-09j)
SINR torch.Size([20]) = tensor([ -3.7041,  -6.5043,  -8.8379, -10.8098,  -7.9551, -12.3936,  -5.8749,
        -13.1472, -12.2221,  -8.2900,  -6.8055,  -7.7172, -10.5027, -18.1651,
         -8.9549,  -4.1080,  -7.3396,  -5.3008,  -6.7727,  -6.7038],
       device='cuda:0')
SINR mean = -8.605456352233887
E[H^H] = 1e-07
E_MSE (Error Power) = 10.078909873962402
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2988, 0.1828, 0.1156, 0.0766, 0.1380, 0.0545, 0.2054, 0.0462, 0.0566,
        0.1291, 0.1726, 0.1447, 0.0818, 0.0150, 0.1129, 0.2797, 0.1558, 0.2278,
        0.1737, 0.1760], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([484, 579, 652, 710, 625, 754, 558, 774, 750, 636, 589, 618, 702, 895,
        656, 498, 606, 539, 587, 585], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -1-----------
Real SNR = tensor([-1.7433, -3.1589, -0.3847, -0.7090, -2.4323, -1.7535, -8.0564,  0.5346,
        -1.3970, -1.8261, -0.7615,  1.3652, -1.7583,  1.2660, -3.5791, -0.4290,
        -1.0331, -4.4197, -4.0181, -5.5741], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.8577e+01-1.5770e-06j, 1.0821e+01+9.5367e-07j, 7.7883e+01-2.3399e-06j,
        4.3293e+01+5.9605e-07j, 2.6374e+02-1.0884e-06j, 2.7363e+01+4.3447e-06j,
        3.4065e+01-3.3956e-08j, 4.3808e+01-1.7166e-05j, 5.7353e+00-2.2053e-06j,
        2.2257e+01-2.2924e-07j, 8.1634e+00+3.3379e-06j, 5.1870e+00+7.0793e-08j,
        7.8714e+01-0.0000e+00j, 2.8786e+00+7.1526e-07j, 3.5467e+02+5.2271e-06j,
        3.0669e-01-2.8621e-07j, 6.0506e+00-2.9802e-08j, 2.6558e+01+8.5831e-06j,
        6.2281e+01-0.0000e+00j, 5.0565e+01-4.7954e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(57.14591598510742-8.034390219791021e-08j)
torch.linalg.det(H.mH@H) = tensor([1.6270+1.3083e-08j, 0.4955-2.6297e-08j, 3.0191-5.2266e-09j,
        1.9652-2.8288e-08j, 1.0280-5.9605e-08j, 1.8233-2.9802e-08j,
        0.0402+9.5461e-09j, 4.8884+3.8323e-08j, 0.1377-1.7625e-09j,
        4.3344+3.5763e-07j, 2.6876-4.6181e-08j, 5.9353-2.1004e-07j,
        1.3937+8.1590e-09j, 7.4258+6.7815e-09j, 0.7641-7.8940e-10j,
        1.3595-0.0000e+00j, 1.2424+1.9430e-09j, 0.2978-1.2107e-08j,
        0.5005+4.6654e-09j, 0.8841-9.1532e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0924770832061768+5.440551342772437e-10j)
SINR torch.Size([20]) = tensor([ -4.6892,  -8.3719,  -2.7328,  -4.1159,  -7.0450,  -4.8944, -16.4675,
         -1.6630, -15.8144,  -3.1555,  -4.6777,  -2.3408,  -5.0335,  -0.0353,
         -6.4812,  -5.5476,  -5.9434, -11.3579,  -7.9068,  -5.1636],
       device='cuda:0')
SINR mean = -6.171875953674316
E[H^H] = 1e-07
E_MSE (Error Power) = 6.958433628082275
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2536, 0.1270, 0.3477, 0.2793, 0.1649, 0.2447, 0.0221, 0.4054, 0.0255,
        0.3259, 0.2541, 0.3684, 0.2388, 0.4980, 0.1836, 0.2180, 0.2029, 0.0682,
        0.1394, 0.2334], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([518, 638, 450, 498, 596, 525, 856, 412, 841, 465, 518, 436, 530, 356,
        578, 547, 560, 726, 624, 534], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 0-----------
Real SNR = tensor([-4.8929, -2.3029, -2.9972,  4.3277, -2.2140, -3.8458, -2.5998,  0.0499,
        -6.7778, -4.6785, -1.6824, -5.1299,  1.3825,  1.8986, -2.4558,  2.5950,
         2.5581,  0.6589,  2.2409, -0.3779], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 39.6711+8.9343e-07j,  14.3429-1.1927e-07j,   4.2081+6.1196e-08j,
         34.1242+3.5113e-07j,  52.5859+4.7143e-07j,   7.3208+1.5262e-07j,
          4.5404-1.0774e-06j,   3.0531-5.6006e-07j,  33.5651-2.6806e-06j,
         28.3993-5.4029e-07j,  76.7347+2.6445e-07j,  44.6272+7.4235e-07j,
          3.3566+1.0013e-08j, 252.9159+2.4788e-06j,  36.1504+3.8147e-06j,
         33.0424+3.2974e-06j,   4.2805+4.4542e-08j,  14.3439-2.7468e-07j,
         36.7755-1.3489e-06j,   6.3035+8.3447e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(36.517086029052734+3.407653252907039e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.2342-4.4703e-08j,  1.4291+8.7346e-09j,  0.0783+3.9314e-08j,
         0.8077+5.0822e-09j,  0.9748-2.2352e-08j,  0.4553-1.1516e-08j,
         0.7917-2.7543e-09j,  0.3554+2.6758e-09j,  0.0866-2.7940e-09j,
         0.1436-2.2352e-08j,  1.2628-5.6023e-08j,  0.1297+2.5032e-09j,
         1.3905-5.2154e-08j, 11.2438+1.3583e-07j,  0.0721-3.0734e-08j,
         2.2454+2.3842e-07j,  6.7403-4.8936e-07j,  3.2532+8.8692e-09j,
        10.4789+1.0536e-07j,  1.1494-1.1291e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1661336421966553-1.5043134737879882e-08j)
SINR torch.Size([20]) = tensor([ -8.9078,  -3.9377, -13.8444,  -8.9850,  -5.6597,  -6.4240,  -7.1616,
        -10.8370, -13.4972, -12.6602,  -4.0687, -10.6077,  -7.1513,   1.2593,
        -15.9136,  -4.7451,  -0.4210,  -2.0977,   1.5424,  -5.4509],
       device='cuda:0')
SINR mean = -6.9784464836120605
E[H^H] = 1e-07
E_MSE (Error Power) = 8.125506401062012
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1139, 0.2877, 0.0396, 0.1122, 0.2136, 0.1856, 0.1612, 0.0762, 0.0428,
        0.0514, 0.2815, 0.0800, 0.1616, 0.5720, 0.0250, 0.2511, 0.4758, 0.3815,
        0.5879, 0.2218], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([655, 492, 792, 657, 551, 576, 600, 711, 783, 761, 497, 705, 600, 311,
        843, 520, 369, 428, 302, 544], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 1-----------
Real SNR = tensor([ 0.7999, -1.9723, -2.5251, -0.5221,  1.2474, -0.0566, -2.8163, -0.2947,
        -0.8461, -4.7167, -0.4312,  2.4307, -1.5218,  1.6571, -0.3634, -2.7603,
        -1.2587, -3.3979, -2.8614,  1.5964], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([25.7433+4.8644e-07j, 16.5905-2.6886e-07j, 18.5185-1.3147e-07j,
        42.9666+2.2291e-06j, 23.2036+4.0653e-07j,  1.2978-6.9818e-07j,
        34.3849-1.2344e-06j,  1.5065-1.2610e-07j, 44.5205-2.5008e-07j,
        16.9521+4.7582e-07j,  3.3082+7.1526e-07j, 52.6183-8.5302e-08j,
        22.2664-2.3842e-06j, 95.9371-8.4624e-08j,  5.5359+2.0242e-07j,
        54.6671-2.1929e-07j, 32.1352-1.0729e-06j,  0.4557-1.2368e-06j,
         6.0367-9.5367e-07j, 54.7826+6.1134e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(27.67138671875-1.8094536358148616e-07j)
torch.linalg.det(H.mH@H) = tensor([2.8491-2.9802e-08j, 0.8512+5.9605e-08j, 0.7391-7.9586e-09j,
        0.9488+1.4480e-08j, 6.9271-1.0285e-07j, 0.2135-3.5781e-08j,
        0.6563-5.9611e-09j, 1.1967+4.3626e-08j, 4.0491+6.6544e-08j,
        0.5477-8.6366e-10j, 2.8461+2.5230e-08j, 3.9791+5.2479e-08j,
        0.1815-0.0000e+00j, 0.6385-1.6391e-07j, 1.4893+1.5444e-08j,
        0.2548-1.9786e-09j, 0.4352+4.7111e-09j, 0.0168+3.4925e-10j,
        0.3192+2.6191e-09j, 3.1044-8.4473e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6121749877929688-7.424736825356604e-09j)
SINR torch.Size([20]) = tensor([ -1.8543,  -6.3382,  -3.9550,  -2.8249,   1.2027, -10.7168,  -3.7664,
         -3.4662,   0.0776,  -4.2641,   0.0332,  -1.4110, -11.3422,  -8.3403,
         -3.3723,  -6.7895,  -6.0283, -18.1698,  -6.1946,  -1.4162],
       device='cuda:0')
SINR mean = -4.946831703186035
E[H^H] = 1e-07
E_MSE (Error Power) = 6.377867221832275
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3949, 0.1886, 0.2869, 0.3429, 0.5688, 0.0782, 0.2958, 0.3104, 0.5045,
        0.2725, 0.5019, 0.4195, 0.0684, 0.1278, 0.3151, 0.1732, 0.1997, 0.0150,
        0.1937, 0.4192], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([419, 573, 493, 453, 313, 708, 486, 476, 352, 503, 353, 404, 725, 637,
        472, 588, 563, 895, 569, 404], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 2-----------
Real SNR = tensor([ 3.7681,  3.5714, -0.7745,  0.2466, -4.3887,  1.3692,  2.5337,  3.8010,
        -1.9927,  3.4796, -2.4820,  0.2696,  3.7284,  2.2087,  0.3087,  5.8107,
         3.0745,  2.9907,  2.1483, -4.2009], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 97.4366+4.2263e-07j,  25.5059+6.0685e-07j,  21.5178-1.7624e-07j,
          0.3897-5.9497e-07j,  33.1804-0.0000e+00j,  24.0866+6.4380e-07j,
         28.1822-2.8610e-06j,   3.3224+3.3279e-07j,   3.4939-1.4585e-07j,
          4.5709+1.4901e-08j,  22.9483+1.2522e-07j, 235.7118+9.9664e-07j,
        145.0870-2.5281e-06j,  23.7757-9.5367e-07j,  52.0717-1.0653e-06j,
         16.7035+7.9196e-07j,   1.8436+8.5785e-09j,   7.9124-1.1921e-07j,
         47.6160+3.4668e-07j,   0.8760-2.4280e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(39.81162643432617-2.0893033081392787e-07j)
torch.linalg.det(H.mH@H) = tensor([3.1225-4.8105e-08j, 2.0272-9.7565e-08j, 0.6657-4.9010e-09j,
        1.7052-7.5979e-09j, 0.2874+1.7334e-09j, 0.4953-2.0347e-08j,
        0.4086+1.1536e-08j, 4.5935+4.0093e-08j, 0.2927-0.0000e+00j,
        1.9777+7.4057e-08j, 0.1685+3.9439e-09j, 0.3828+7.4506e-09j,
        4.0767-2.7632e-08j, 6.4983-3.6635e-09j, 1.5529-1.5543e-09j,
        3.0627-3.1276e-08j, 2.3697+5.9131e-08j, 0.4129+4.0233e-07j,
        2.3484-1.8055e-08j, 0.0642+3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8256409168243408+1.7165303844990376e-08j)
SINR torch.Size([20]) = tensor([ -0.7269,  -2.3100,  -2.9190,  -0.3552,  -4.9265,  -6.6090,  -7.9340,
          1.6654,  -6.2237,  -2.4948,  -8.5078,  -7.8872,   0.3302,   2.0746,
         -1.3493,  -1.0388,  -1.0234,  -9.4682,  -0.9910, -12.5929],
       device='cuda:0')
SINR mean = -3.6643731594085693
E[H^H] = 1e-07
E_MSE (Error Power) = 3.442563772201538
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4583, 0.3701, 0.3380, 0.4796, 0.2434, 0.1792, 0.1386, 0.5947, 0.1926,
        0.3602, 0.1236, 0.1399, 0.5190, 0.6172, 0.4229, 0.4405, 0.4414, 0.1015,
        0.4432, 0.0522], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([380, 435, 457, 367, 526, 582, 625, 298, 569, 442, 642, 623, 343, 285,
        401, 391, 390, 671, 389, 760], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 3-----------
Real SNR = tensor([ 1.6814,  3.8025,  2.4218, -3.1287,  2.1473, -3.9727,  1.6858,  1.8225,
        -5.0020,  1.4533, -0.8511,  1.4000, -2.3273, -1.3372,  1.7140,  1.6912,
         2.6648,  4.0166,  3.7545,  4.2405], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.0690e+00+1.7469e-07j, 3.8534e+01+5.7220e-06j, 1.3581e+01-9.5367e-06j,
        2.9162e+01+6.0518e-07j, 1.3572e-02+2.4356e-07j, 1.2479e+01-0.0000e+00j,
        4.5380e+01+1.9960e-06j, 6.2356e+00+2.2051e-08j, 1.6169e+00-2.8227e-07j,
        2.1129e+01+1.2496e-07j, 7.7627e+00+2.5535e-07j, 5.9269e-01-2.9802e-08j,
        1.7934e+01+7.5387e-08j, 7.2812e+00-1.1921e-07j, 7.5785e-01+6.5771e-08j,
        1.7135e+00+2.2319e-08j, 6.4840e+00-0.0000e+00j, 4.9901e-01+1.4880e-07j,
        8.2490e+00+5.7807e-08j, 2.7874e+01+6.4249e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(12.667447090148926+9.419536262100792e-09j)
torch.linalg.det(H.mH@H) = tensor([0.8699+3.9342e-08j, 7.0015-5.2912e-09j, 2.5586-8.3884e-09j,
        0.3120+3.0702e-09j, 0.3133+1.4901e-08j, 0.1734-2.0645e-09j,
        0.3227+2.2424e-08j, 0.4541-1.2014e-08j, 0.2469-1.5679e-10j,
        0.1542+1.2828e-09j, 0.7836-2.2310e-09j, 1.8592-3.6035e-08j,
        0.2699-5.7416e-09j, 0.2946-1.7065e-08j, 1.0332+8.3524e-09j,
        1.0730+7.3533e-09j, 2.9323-1.2766e-07j, 0.2952-1.6614e-08j,
        0.2634-1.2621e-07j, 3.2373-5.1290e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2224056720733643-1.5702212863288878e-08j)
SINR torch.Size([20]) = tensor([ -2.8098,   3.4538,   0.5925,  -2.9901,  -7.8662,  -4.9690,  -7.3104,
         -5.1791,  -3.8959,  -8.7990,  -0.8305,   0.4991,  -4.4363,  -5.6284,
         -1.4291,  -0.1602,   0.2739,  -9.9867, -10.3364,   0.2916],
       device='cuda:0')
SINR mean = -3.5758118629455566
E[H^H] = 1e-07
E_MSE (Error Power) = 3.094658613204956
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3437, 0.6890, 0.5341, 0.3344, 0.1405, 0.2416, 0.1567, 0.2328, 0.2897,
        0.1165, 0.4523, 0.5287, 0.2647, 0.2148, 0.4185, 0.4908, 0.5158, 0.0912,
        0.0847, 0.5168], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([453, 241, 334, 459, 622, 527, 605, 535, 491, 651, 383, 337, 509, 550,
        404, 360, 345, 687, 697, 344], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 4-----------
Real SNR = tensor([ 1.4534,  7.3743,  2.5017,  2.7981,  5.1575,  3.3290,  5.1778,  2.7649,
        -0.4242,  0.7032, -0.3550,  3.9308,  3.1864,  0.9525,  1.1221,  4.6044,
         1.2230,  2.3546,  5.9177,  0.2590], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  4.5681-8.1492e-08j,  18.5421-2.0090e-07j,   0.7827-2.1742e-09j,
         10.7984-1.4637e-07j,  76.2747-3.0313e-07j,   5.9439+9.3881e-08j,
         45.9646+3.1046e-07j,  15.1961-1.3371e-07j,   1.0041-1.5186e-08j,
          8.5507-2.8203e-07j,   9.6158+3.6636e-07j,  38.6278+1.1057e-06j,
         12.1284-2.1583e-07j,   3.9877+3.6895e-08j,   2.7593-2.1441e-09j,
         19.3987-4.3961e-08j,   1.0074-2.9802e-08j,  14.0473+4.9390e-07j,
        129.2923-1.9351e-06j,   0.7142+1.8727e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(20.960205078125-3.986701813118998e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.0281-1.1978e-08j,  2.7112-4.8892e-08j,  4.3907-1.3017e-09j,
         0.6137-2.0489e-08j,  4.1692+7.1809e-08j,  2.1977-4.8119e-10j,
         6.3944-7.4180e-07j,  0.1205+2.2614e-07j,  0.5201-0.0000e+00j,
         0.4623+1.9862e-08j,  0.0739+1.4956e-08j,  3.5602+8.0164e-09j,
         2.0455+1.2836e-08j,  0.2234-1.1176e-08j,  0.6125-2.8081e-09j,
         0.8649+1.5816e-08j,  0.5667+2.9802e-08j,  0.2725-8.7221e-08j,
        15.4194+3.2292e-08j,  0.5988-3.0724e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3422813415527344-2.4884599270080798e-08j)
SINR torch.Size([20]) = tensor([ -0.2751,  -0.9318,   3.5047,  -4.4555,   3.0203,   1.8169,   2.0725,
        -12.4886,  -3.1828,  -3.4829,  -9.5508,   2.3267,   1.2852,  -6.7001,
         -0.8310,  -1.5155,  -3.1482,  -5.0916,   5.1111,  -1.8591],
       device='cuda:0')
SINR mean = -1.7187782526016235
E[H^H] = 1e-07
E_MSE (Error Power) = 2.5751359462738037
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4842, 0.4466, 0.6915, 0.2639, 0.6672, 0.6031, 0.6171, 0.0534, 0.3246,
        0.3096, 0.0998, 0.6308, 0.5734, 0.1761, 0.4523, 0.4136, 0.3263, 0.2364,
        0.7644, 0.3946], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([364, 387, 240, 510, 255, 293, 285, 757, 466, 476, 674, 276, 311, 585,
        383, 407, 465, 532, 194, 419], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 5-----------
Real SNR = tensor([ 4.2433,  5.9188, -1.2548,  2.6643,  4.2123,  3.9875,  3.2609,  2.5368,
         1.0003, -0.5502,  1.3530,  0.8992,  1.5841,  1.8313,  6.2657,  3.4025,
        -3.3102,  5.3796,  1.4167,  2.9066], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4555+1.2480e-07j, 16.2421+3.0854e-07j,  3.3843+2.6024e-07j,
         3.5412+5.9605e-07j, 14.5437+3.4576e-07j,  0.9521-2.1250e-06j,
        35.3014+8.4390e-07j,  1.8881-8.9407e-08j,  8.2031-7.6243e-07j,
         1.1269+1.1921e-07j,  6.5778-5.9605e-08j,  1.3450+8.9407e-08j,
        18.8114-3.9920e-07j,  1.2152-2.6077e-08j, 26.2849-4.1903e-07j,
        15.2598+1.8824e-07j,  1.5813-1.4901e-08j,  9.0850-0.0000e+00j,
        11.6745-4.0286e-08j,  2.2783-4.1819e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.987574577331543-5.507954980998875e-08j)
torch.linalg.det(H.mH@H) = tensor([2.6868+1.1172e-08j, 0.0836+5.0839e-09j, 0.3818+1.6998e-10j,
        0.4393+3.7253e-09j, 1.5005-0.0000e+00j, 0.6242+3.7841e-08j,
        0.1045-0.0000e+00j, 1.3790-5.9605e-08j, 0.2741-1.4901e-08j,
        0.2204+1.4859e-08j, 0.4536-3.2986e-08j, 0.3285+7.0669e-09j,
        1.0287+5.8386e-09j, 0.7046-3.0615e-08j, 4.8516-2.7386e-07j,
        1.8082-6.6725e-09j, 0.0524+1.6141e-09j, 4.1607+2.6925e-08j,
        0.8225+2.5154e-08j, 1.3223+3.0332e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1613672971725464-1.244297909153147e-08j)
SINR torch.Size([20]) = tensor([  3.0343, -13.1343,  -0.3976,  -3.6757,   0.3968,  -4.3385, -10.0560,
          0.4821,  -4.6022,  -4.6800,  -2.9265,  -3.0511,  -0.0569,  -0.7253,
          3.2005,   2.4680,  -5.5071,   3.5900,  -0.6403,   1.9219],
       device='cuda:0')
SINR mean = -1.9348868131637573
E[H^H] = 1e-07
E_MSE (Error Power) = 2.6517608165740967
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6679, 0.0463, 0.4771, 0.3002, 0.5228, 0.2691, 0.0898, 0.5277, 0.2574,
        0.2540, 0.3376, 0.3312, 0.4967, 0.4583, 0.6763, 0.6384, 0.2196, 0.6956,
        0.4632, 0.6089], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([254, 774, 368, 483, 341, 506, 689, 338, 515, 518, 457, 461, 356, 380,
        249, 272, 546, 237, 377, 290], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 6-----------
Real SNR = tensor([ 7.5998,  3.2575,  3.1494,  4.3949,  6.4091,  5.8130,  2.0098,  9.2481,
         2.1519,  5.3941,  5.3637,  1.2714,  2.0861,  2.5105,  5.0394,  3.9926,
        -0.0311,  6.0987,  5.4559,  7.0776], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([36.0468+9.5112e-07j,  3.5343+7.1758e-08j,  0.8104-0.0000e+00j,
         1.8170+1.5319e-09j, 17.2463-3.9411e-07j,  9.9969+2.4288e-08j,
         7.2861+1.2976e-07j,  9.4798+1.7881e-07j,  2.7971-4.0538e-08j,
         9.6982-2.4032e-07j,  7.2220+1.5983e-07j,  1.9454+1.4424e-07j,
        20.2084-9.5128e-07j,  0.6749-3.5886e-11j,  0.4916-4.1356e-07j,
         2.8966+1.1038e-08j, 12.1176+1.6694e-07j, 13.6282+8.8474e-09j,
         2.8720+2.3967e-07j, 16.8552-8.9858e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.88122844696045+1.949382655297427e-09j)
torch.linalg.det(H.mH@H) = tensor([2.3140+8.7976e-08j, 1.7970-4.9506e-09j, 1.0980-2.9802e-08j,
        0.8176+5.9605e-08j, 2.5835+7.9209e-08j, 0.1157+5.0866e-08j,
        0.5130+5.1223e-09j, 2.4424-1.1921e-07j, 0.1197-7.1814e-09j,
        0.7212-5.7200e-08j, 3.7424+8.1935e-09j, 0.1870-5.8509e-09j,
        0.4366+1.9543e-09j, 0.1981-5.1925e-09j, 0.9266-3.0584e-09j,
        1.0709-4.3277e-09j, 0.0183-2.0489e-08j, 2.5803+2.6267e-08j,
        1.4088-8.3498e-08j, 5.9532+1.0194e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4522161483764648-5.687031401357956e-10j)
SINR torch.Size([20]) = tensor([  2.1784,   3.4286,   0.9624,   0.5467,   2.9938, -10.2768,  -0.9531,
          1.7124,  -6.2089,  -0.6550,   5.2931,  -4.2229,  -0.6438,  -4.2821,
          0.0543,   1.5785, -12.9273,   3.8642,   1.0736,   6.8019],
       device='cuda:0')
SINR mean = -0.48410606384277344
E[H^H] = 1e-07
E_MSE (Error Power) = 2.348950147628784
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6228, 0.6877, 0.5552, 0.5314, 0.6658, 0.0858, 0.4454, 0.5973, 0.1932,
        0.4624, 0.7718, 0.2744, 0.4630, 0.2717, 0.5031, 0.5899, 0.0485, 0.7088,
        0.5615, 0.8272], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([281, 242, 321, 336, 255, 695, 388, 296, 569, 377, 189, 502, 377, 504,
        353, 301, 768, 229, 318, 151], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 7-----------
Real SNR = tensor([ 8.6373,  4.7371, -0.9705,  3.5847,  6.2321,  5.8404,  4.0911,  4.3214,
         5.2125, -3.8234,  6.6540,  5.8587,  3.3252,  8.0619,  8.6046,  8.2577,
         8.9048,  6.7008,  3.6077,  4.3804], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.9052+1.4901e-07j,  3.8988-0.0000e+00j,  1.2237-1.9372e-07j,
         2.8252+1.2854e-08j,  0.2932-1.0203e-07j, 12.0239-3.5763e-07j,
         1.8158-5.9605e-08j, 12.5795+1.5547e-08j,  1.4124+6.3248e-08j,
         3.0310-3.5588e-08j, 14.8142-9.5367e-07j,  0.4425-2.9143e-10j,
         0.6188-0.0000e+00j,  3.3060+1.1921e-07j,  8.0112+2.6482e-07j,
         9.6743+9.1867e-08j, 29.9995-1.2775e-07j,  1.3892-9.8530e-09j,
         3.4196-2.3566e-08j,  2.5131+3.9843e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.75985860824585-3.743609156003913e-08j)
torch.linalg.det(H.mH@H) = tensor([6.7010-1.6347e-07j, 0.6303-1.1921e-07j, 0.2350-3.9110e-09j,
        0.0902+3.2228e-09j, 0.2572-2.6077e-07j, 0.4436+7.0781e-08j,
        0.9309+9.0003e-09j, 1.2036-3.4667e-08j, 2.0067+4.8078e-08j,
        0.0171-1.1642e-09j, 4.8989+7.0831e-08j, 4.0320-4.2572e-08j,
        0.3831+1.2384e-09j, 8.0379-6.2882e-08j, 7.6571-6.8622e-08j,
        0.6263-1.5686e-07j, 0.5691+5.9605e-08j, 2.9604+3.3655e-08j,
        0.9575-1.4901e-08j, 0.5731+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.16054630279541-2.8651044203797937e-08j)
SINR torch.Size([20]) = tensor([ 7.2686, -0.4683,  0.0538, -6.1588, -5.9160, -2.7911,  1.7873,  3.8128,
         3.7925, -7.8578,  5.6376,  6.7091,  0.5219,  7.7714,  7.1374, -2.7154,
        -3.6590,  4.8628,  1.8572,  0.3592], device='cuda:0')
SINR mean = 1.100257158279419
E[H^H] = 1e-07
E_MSE (Error Power) = 1.292981505393982
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8421, 0.4731, 0.5031, 0.1950, 0.2039, 0.3446, 0.6015, 0.7064, 0.7054,
        0.1407, 0.7855, 0.8242, 0.5300, 0.8569, 0.8380, 0.3486, 0.3010, 0.7539,
        0.6053, 0.5207], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([140, 371, 353, 567, 559, 452, 294, 230, 231, 622, 180, 153, 336, 129,
        143, 449, 482, 200, 292, 342], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 8-----------
Real SNR = tensor([ 8.1550, 13.0600,  1.9787,  7.3375,  3.2189,  8.0970,  7.1515,  5.6922,
         7.2777,  9.9786,  3.0573,  5.6180,  2.9928,  7.1082,  6.9216, 11.0219,
         6.0650,  5.4777,  8.2429,  6.3026], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.3853-6.6618e-08j,  7.2970-3.1357e-08j, 15.7081+3.2296e-08j,
         7.1128-3.1278e-08j,  2.1320-5.9605e-08j,  2.5250-7.2900e-08j,
         0.8156+7.8975e-09j,  3.0516+3.0513e-08j,  1.4441+1.8988e-07j,
         1.1615-1.1299e-08j,  1.8081-0.0000e+00j,  3.2233+2.3300e-08j,
         0.5889+5.9605e-08j,  4.6554-1.6239e-08j,  1.9094-1.1779e-07j,
         4.1416-1.8658e-08j,  6.6681-1.1727e-07j,  2.9089-6.4748e-08j,
         1.6528+5.3136e-08j,  0.1894-1.2151e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.668947219848633-1.1164184243739328e-08j)
torch.linalg.det(H.mH@H) = tensor([2.5681e+00-1.6297e-08j, 2.8493e+00+4.3615e-08j, 3.1177e-01+3.2168e-10j,
        8.5536e-01+8.9407e-08j, 2.7660e-01+1.7983e-08j, 1.2718e+00-3.8419e-08j,
        6.8291e-02+1.6657e-08j, 2.3488e-01-8.6454e-09j, 7.8633e-01+2.8359e-08j,
        6.5095e+00+2.6590e-08j, 2.1826e-01-7.4506e-08j, 1.3115e+00-3.8381e-08j,
        5.0192e-03-3.6302e-10j, 3.5917e+00-3.7992e-08j, 1.0713e+00-3.3204e-08j,
        3.3004e+00-2.1207e-07j, 3.5312e+00-1.4719e-08j, 3.4972e-01+5.1223e-09j,
        3.6259e-01+4.0862e-08j, 9.9047e-01+5.2765e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5232038497924805-7.645693855806712e-09j)
SINR torch.Size([20]) = tensor([  5.7680,   2.0999,   1.1442,   2.1230,   0.0635,   3.0819,  -8.1064,
         -0.7690,   1.6587,   8.0327,  -2.5500,   4.3064, -17.4163,   6.4162,
          0.8111,   4.2590,   6.7433,  -0.9662,  -1.9410,   2.7732],
       device='cuda:0')
SINR mean = 0.8766135573387146
E[H^H] = 1e-07
E_MSE (Error Power) = 3.4122464656829834
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7905, 0.6186, 0.5655, 0.6198, 0.5037, 0.6703, 0.1339, 0.4558, 0.5943,
        0.8641, 0.3573, 0.7294, 0.0178, 0.8142, 0.5466, 0.7272, 0.8253, 0.4446,
        0.3901, 0.6544], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([176, 284, 315, 283, 352, 253, 630, 381, 298, 124, 444, 216, 878, 160,
        327, 217, 152, 388, 422, 262], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 9-----------
Real SNR = tensor([ 7.9182, 11.7153,  8.3958,  9.3520,  7.4520, 10.7183,  8.6523, 10.7945,
         7.3908, 10.2160,  9.9661,  7.9524, 10.4533, 11.2514, 12.2377, 12.8703,
         7.3966,  8.4511,  6.3416,  6.6009], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.0525-2.7651e-07j,  2.2873-1.1921e-07j,  1.9427-6.3846e-09j,
         2.8059+4.6082e-07j,  0.4991-4.6406e-08j, 12.4123+9.5367e-07j,
         1.3123+2.3842e-07j,  2.7446+5.7900e-08j,  0.2197-7.4506e-09j,
        10.2261-9.7326e-08j,  2.0153+1.3588e-08j,  6.9270-1.5280e-08j,
        15.6090-1.9829e-07j, 10.4655+6.1038e-08j,  9.3802-3.7327e-07j,
         1.9179-2.0970e-07j,  0.6825+2.9802e-08j,  0.6542-1.4901e-08j,
         8.1652+2.1431e-08j,  0.1419-2.7295e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.723050594329834+9.949883583715291e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.1486-4.3953e-10j,  7.7594-8.2170e-08j,  1.7515-0.0000e+00j,
         1.0495+1.1195e-08j,  0.8079+4.5936e-08j,  5.6571+1.4899e-07j,
         1.9877-8.9407e-08j,  3.0158-3.8986e-09j,  0.2098+2.2352e-08j,
         6.2325+1.4166e-07j,  0.9649-3.2183e-08j,  0.0920+5.3108e-09j,
         6.8711+5.1722e-08j, 12.1276+1.4341e-07j,  4.4392-4.5163e-08j,
         3.9951+1.4317e-07j,  0.8412-5.2315e-08j,  0.9930-0.0000e+00j,
         0.3374-6.7055e-08j,  0.2987-2.8874e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9789986610412598+1.5612213744020664e-08j)
SINR torch.Size([20]) = tensor([-5.8488,  8.7107,  4.7881,  3.4806,  3.7907,  8.3969,  3.0588,  6.5485,
        -3.1841,  8.8903,  1.7059, -5.7543,  9.6494, 11.1280,  6.9674,  5.1991,
         2.2336,  3.1779, -1.9163, -1.2431], device='cuda:0')
SINR mean = 3.488976240158081
E[H^H] = 1e-07
E_MSE (Error Power) = 0.8081148266792297
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2064, 0.8814, 0.7507, 0.6903, 0.7053, 0.8736, 0.6691, 0.8187, 0.3245,
        0.8857, 0.5970, 0.2100, 0.9022, 0.9284, 0.8326, 0.7680, 0.6258, 0.6752,
        0.3914, 0.4289], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([557, 111, 202, 240, 231, 117, 253, 157, 466, 107, 297, 554,  94,  72,
        147, 191, 279, 250, 421, 398], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 10-----------
Real SNR = tensor([ 4.2872, 10.3012,  9.2479,  9.9942, 15.1651, 10.2032,  5.0222, 12.5715,
         9.1027,  8.3138, 10.1466,  9.4316, 10.9722,  4.5610,  7.1531,  8.2009,
        11.9841,  9.6740,  9.1826, 10.2100], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.7437-2.5271e-08j,  7.9297-4.4019e-08j,  0.4766+8.1315e-09j,
        31.6357+1.6160e-07j, 62.8709+1.5176e-06j,  1.1928-1.1416e-07j,
         0.1033-2.9517e-09j,  8.1008-7.3184e-08j,  5.5307+2.9594e-08j,
         5.2614-5.8979e-08j,  0.9980+1.7106e-07j,  6.5497+1.6340e-07j,
         2.9972+1.6060e-07j,  5.2849+7.7475e-08j,  0.1692+3.5606e-09j,
         1.2888-1.8764e-08j,  8.1319-9.1403e-08j,  1.6056-1.3824e-07j,
         1.8245-1.9290e-07j,  4.7695-1.4305e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.873243808746338+5.129675351156493e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.2344+1.3318e-08j,  5.0910+3.1442e-08j,  0.7980-3.1872e-08j,
         2.9726-2.4002e-08j, 10.0146-9.9783e-08j,  1.2968+1.0875e-07j,
         0.6338+3.8838e-09j, 15.4229-2.1229e-08j,  0.2398-2.8312e-07j,
         1.9298+2.7516e-08j,  1.8169-2.4354e-08j,  0.8289-3.6344e-09j,
         0.4743-5.1955e-08j,  0.3955-4.5022e-09j,  0.5525+1.7996e-10j,
         0.1148+1.7672e-08j, 11.5830+8.8132e-08j,  0.7944-4.9328e-08j,
         0.2208-3.9603e-08j,  2.1911+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.880303144454956-1.1163888480325568e-08j)
SINR torch.Size([20]) = tensor([ 1.8042,  9.1426,  3.1577,  8.9398,  9.0247,  3.9794,  4.1645, 11.7684,
        -3.0893,  7.8061,  5.8506,  3.2713, -0.2424,  3.6003,  3.6149, -3.0846,
        12.0397,  2.3366, -1.6578,  6.0766], device='cuda:0')
SINR mean = 4.425164699554443
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5381725430488586
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6024, 0.8914, 0.6742, 0.8868, 0.8887, 0.7143, 0.7229, 0.9376, 0.3293,
        0.8578, 0.7937, 0.6799, 0.4860, 0.6961, 0.6969, 0.3295, 0.9412, 0.6314,
        0.4057, 0.8021], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([293, 103, 250, 106, 105, 226, 220,  63, 463, 129, 174, 247, 363, 237,
        236, 462,  60, 276, 412, 168], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 11-----------
Real SNR = tensor([ 9.9562,  6.5771,  9.7600, 10.0382,  9.9182,  7.7445, 11.3289,  9.1771,
        10.4475, 10.1574,  6.3545, 10.4299,  6.8527,  8.6308, 12.2396,  9.8792,
        12.8622, 13.1486, 10.4716,  6.7343], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.5592e+00-1.9941e-07j, 1.3430e+00+7.7956e-09j, 1.6489e+00-8.9407e-08j,
        2.3030e-02-8.3627e-09j, 1.3619e+00+5.3484e-08j, 1.6257e+00-5.9138e-09j,
        5.1924e+00-1.7225e-07j, 3.4409e+00-1.1621e-08j, 3.8956e+00+1.5114e-08j,
        4.8592e-01-6.1965e-09j, 7.5756e-01+1.5553e-08j, 1.7274e+00-2.2805e-08j,
        7.3324e-01+2.2893e-08j, 1.9162e-01+7.0781e-08j, 1.9959e+00-4.0057e-08j,
        4.3049e-01+7.4506e-08j, 2.3083e+01-1.9017e-07j, 1.1957e+01+4.6482e-08j,
        4.5806e+00+2.9106e-07j, 2.9684e+00+3.0519e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.5001068115234375-7.273927682405201e-09j)
torch.linalg.det(H.mH@H) = tensor([ 1.6191+6.4490e-08j,  0.2263+3.4242e-08j,  0.6147+1.2523e-08j,
         0.8232-1.2371e-08j,  0.8794-6.0221e-08j,  0.8740+2.6678e-09j,
         2.6171-3.5586e-10j,  1.6388-1.6804e-09j,  1.0715+2.8466e-08j,
         1.0635+1.8365e-08j,  0.0585+4.9201e-10j,  0.6783-1.1921e-07j,
         0.1137+4.2477e-09j,  0.2605-1.1921e-07j,  3.1831+2.7082e-07j,
         0.4513-5.6703e-09j, 11.4452-3.6326e-09j, 10.0003+1.7529e-07j,
         1.7774+6.5300e-09j,  0.5363+1.3791e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9966118335723877+1.4858315466881322e-08j)
SINR torch.Size([20]) = tensor([ 6.0725e+00,  1.2562e+00,  3.5016e+00,  5.5425e+00,  5.3503e+00,
         6.4001e+00,  7.0559e+00,  8.7207e+00,  5.6917e+00,  5.7095e+00,
        -2.5623e+00,  2.4440e+00, -5.5491e-02, -1.4455e-03,  7.5506e+00,
         3.3044e+00,  1.2890e+01,  1.1973e+01,  7.5328e+00,  5.0799e+00],
       device='cuda:0')
SINR mean = 5.17281436920166
E[H^H] = 1e-07
E_MSE (Error Power) = 0.41142717003822327
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8019, 0.5718, 0.6913, 0.7818, 0.7742, 0.8136, 0.8354, 0.8816, 0.7876,
        0.7883, 0.3566, 0.6371, 0.4968, 0.4999, 0.8505, 0.6815, 0.9511, 0.9403,
        0.8500, 0.7631], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([169, 312, 240, 182, 187, 160, 145, 110, 178, 178, 444, 273, 356, 354,
        134, 246,  51,  61, 134, 194], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 12-----------
Real SNR = tensor([14.1521,  9.8840,  9.6097, 10.9219,  8.2089, 11.2512, 10.1688, 11.8581,
         7.5957,  4.8310,  7.7872,  7.9478, 10.0217, 13.8158,  8.3268, 12.5411,
        12.0900, 13.2306, 10.7826, 12.2531], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([10.9072-1.2213e-07j,  7.9449-1.3978e-07j,  3.2499-1.6743e-08j,
         1.3621-1.7207e-08j,  0.0318+1.4901e-07j,  1.3115-8.9407e-08j,
        11.8911-1.4306e-08j,  1.1101-2.5750e-08j,  0.3738+5.2789e-08j,
         0.2571+5.9605e-08j,  2.1562-1.0641e-08j,  4.8500-8.4291e-08j,
         0.8648-0.0000e+00j,  0.3652-2.0964e-07j,  0.3795+1.8195e-09j,
         2.9364-0.0000e+00j,  2.6218+2.6218e-08j, 11.8756+2.6677e-08j,
         1.0242+5.9605e-08j,  1.5440-3.7808e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.3528428077697754-1.9598948242105507e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.5699+1.2064e-07j,  2.2029-1.8591e-08j,  1.5384+6.7874e-09j,
         0.4659-0.0000e+00j,  0.0680-1.8539e-08j,  1.2524-5.9605e-08j,
         2.5581+2.1377e-08j,  1.2524+5.1899e-08j,  0.0772+2.7971e-09j,
         0.1516-7.4331e-09j,  0.1355+1.3517e-08j,  0.7455-4.7760e-09j,
         1.9940-4.2614e-08j,  3.9958+2.2902e-08j,  0.4912+3.6454e-09j,
         0.4845-1.3081e-08j,  2.2076-9.0162e-09j, 12.9995+1.2797e-08j,
         0.4432-0.0000e+00j,  1.5256-4.4466e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8079630136489868+1.9121946248645827e-09j)
SINR torch.Size([20]) = tensor([ 5.8321,  9.6192,  8.8024,  3.6929, -1.1007,  5.8003,  8.7030,  6.3600,
        -1.9734,  2.0168,  0.9579,  7.8952,  9.0129,  9.5788,  5.4596,  4.2962,
         9.7836, 14.2580,  0.6019,  7.9672], device='cuda:0')
SINR mean = 5.8781938552856445
E[H^H] = 1e-07
E_MSE (Error Power) = 0.37535008788108826
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7930, 0.9016, 0.8836, 0.7006, 0.4370, 0.7918, 0.8812, 0.8122, 0.3883,
        0.6141, 0.5549, 0.8603, 0.8885, 0.9008, 0.7785, 0.7289, 0.9049, 0.9638,
        0.5346, 0.8623], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([175,  95, 109, 234, 393, 175, 111, 161, 423, 286, 322, 127, 105,  95,
        184, 216,  92,  39, 334, 125], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 13-----------
Real SNR = tensor([12.2657, 15.1514, 14.4804, 13.7992, 16.1974,  8.8541,  9.0064, 12.4591,
        11.2017,  7.9656,  8.7510,  9.9493, 13.1310,  7.2756, 16.6496, 12.2414,
        14.2971, 14.0680,  9.5534, 14.5285], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.0038+1.7031e-08j,  1.4931+8.6108e-08j,  6.4132-9.9688e-08j,
         0.0745+2.1930e-09j,  8.3952-2.9548e-07j,  0.5695-7.4506e-09j,
         0.0451-4.3435e-09j,  2.1363+2.7334e-08j,  1.4163+4.7638e-08j,
         0.2851-2.2006e-09j,  2.2825-4.1866e-08j,  0.7973-1.1085e-08j,
         1.1577+2.9802e-08j,  0.1789+2.7550e-08j, 15.5108+5.5981e-08j,
         3.3007+4.5318e-08j, 11.7948+1.0755e-07j,  0.8592+2.3870e-09j,
         2.8038+6.9168e-09j,  4.1516-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.233468770980835-6.275472141936689e-09j)
torch.linalg.det(H.mH@H) = tensor([3.0751+5.4385e-09j, 1.2066-2.2734e-09j, 0.2563+2.2352e-07j,
        0.6138-7.0418e-09j, 3.9450+1.0526e-07j, 0.4870-0.0000e+00j,
        0.1418+2.1566e-08j, 1.5932+3.3888e-10j, 1.5223+6.2146e-08j,
        0.0129+9.7789e-09j, 0.7548-5.2183e-09j, 0.6252-1.6275e-08j,
        0.8991-5.9605e-08j, 0.3634-3.8693e-09j, 6.2194+6.6449e-07j,
        4.0903-1.2115e-07j, 5.9509-9.1071e-08j, 1.0632+8.2872e-08j,
        1.2617+1.2020e-08j, 3.0495+1.4750e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.856579065322876+5.1421576330312746e-08j)
SINR torch.Size([20]) = tensor([11.4913,  4.9016, -1.7254,  6.2215,  9.5428,  5.9425,  2.2464,  9.7350,
         8.2041, -7.4561,  9.3090,  7.2696,  4.8673,  6.1429, 10.1850, 12.4904,
        12.8945,  6.6686,  9.3332, 10.0516], device='cuda:0')
SINR mean = 6.9158034324646
E[H^H] = 1e-07
E_MSE (Error Power) = 0.4771159291267395
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9338, 0.7556, 0.4020, 0.8073, 0.9000, 0.7971, 0.6265, 0.9039, 0.8686,
        0.1523, 0.8951, 0.8421, 0.7541, 0.8045, 0.9126, 0.9466, 0.9512, 0.8228,
        0.8956, 0.9101], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 67, 199, 415, 165,  96, 172, 279,  93, 121, 609, 100, 140, 200, 167,
         85,  55,  51, 154,  99,  87], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 14-----------
Real SNR = tensor([13.2277, 17.7766, 11.6938, 13.4129,  6.3236, 12.6306, 11.4439, 14.1041,
        14.9070, 11.6069, 12.1170, 10.6495, 17.4165, 11.1988, 13.6928, 16.8953,
        16.8739, 14.8262, 14.6399, 14.1110], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.3283e-01+3.6979e-08j, 3.1171e+01+3.0725e-07j, 2.9822e+00-1.4901e-08j,
        1.5526e+00+5.7814e-09j, 8.0567e-03+1.1083e-09j, 3.5342e+00-6.4525e-08j,
        2.3589e+00-9.1013e-11j, 3.1927e+00+3.2596e-08j, 1.9203e+00-3.2746e-08j,
        4.0004e-01-7.8041e-08j, 3.8948e-01+1.0283e-08j, 1.7871e+00-5.7499e-08j,
        2.2784e+01+2.9212e-07j, 2.9198e+00-5.9634e-09j, 5.5609e+00+1.2450e-07j,
        6.6291e+00+9.8252e-08j, 3.7430e+00-4.7302e-08j, 4.7495e-01-3.8198e-09j,
        9.8183e-01+6.8604e-08j, 8.4404e+00+1.9170e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.068179607391357+3.4587866792890054e-08j)
torch.linalg.det(H.mH@H) = tensor([5.7825e-01-3.5390e-08j, 1.3130e+01-1.0650e-06j, 6.3264e-01+1.4901e-07j,
        2.9039e+00+6.2892e-09j, 3.4437e-03+1.5046e-10j, 2.8546e+00+6.6179e-08j,
        2.8759e+00+3.6111e-08j, 4.4224e+00+1.7881e-07j, 2.0186e+00+5.6794e-08j,
        1.5285e-01+3.8516e-08j, 6.9554e-01-4.3969e-08j, 4.4273e-01-7.4506e-08j,
        1.4089e+01-1.6110e-07j, 9.9481e-01-7.7055e-10j, 4.0243e+00+1.1350e-07j,
        4.2350e+00+1.2522e-07j, 3.4718e+00-1.2114e-08j, 1.9411e+00+1.3929e-07j,
        1.8909e+00-1.8109e-08j, 4.0685e+00-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.2712790966033936-3.101395762428183e-08j)
SINR torch.Size([20]) = tensor([ 5.4004, 14.7453,  5.6669, 13.0212, -9.5304, 12.0822, 12.0704, 11.6555,
         9.6836, -0.9776,  6.9357,  6.1304, 16.1824, 10.2337, 12.7187, 12.4400,
        11.4688, 10.4434,  9.9031, 11.9835], device='cuda:0')
SINR mean = 9.1128568649292
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5741477012634277
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7762, 0.9676, 0.7867, 0.9525, 0.1002, 0.9417, 0.9415, 0.9361, 0.9029,
        0.4440, 0.8316, 0.8040, 0.9765, 0.9134, 0.9492, 0.9461, 0.9334, 0.9172,
        0.9072, 0.9404], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([186,  35, 179,  50, 673,  60,  60,  65,  93, 388, 148, 167,  26,  85,
         53,  56,  67,  81,  90,  61], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 15-----------
Real SNR = tensor([11.8835, 12.6097, 13.1597, 13.7514, 12.1488, 11.6076, 14.3804, 12.7877,
        10.7353, 14.9455, 16.0280, 14.9670, 16.7413, 10.4937, 10.3914, 16.8629,
        15.0803,  3.2938, 11.9387, 16.5262], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.5549e-01+2.0526e-08j, 1.9064e+00+3.6000e-08j, 8.5148e-03-7.5561e-09j,
        3.1750e+00-3.5763e-07j, 1.5683e+00+1.5997e-08j, 6.0869e-01+5.9605e-08j,
        3.0547e+00+1.6373e-08j, 1.0428e+00+1.2136e-08j, 1.7761e+00-2.4964e-08j,
        4.3123e+00-2.0452e-07j, 1.2644e+01-8.4612e-08j, 2.4603e+00-7.9814e-09j,
        7.3098e-02-3.0734e-08j, 1.2236e-01+2.8420e-08j, 2.0789e-01-3.3848e-09j,
        6.8032e-01+5.8403e-09j, 5.3083e+00+7.7020e-08j, 2.4108e-01+5.2937e-10j,
        9.3047e-02+2.0975e-09j, 4.9486e+00+2.3842e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.2193443775177-1.04207282802804e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1845+1.1089e-09j, 2.0620+7.6937e-08j, 0.6586+7.6651e-08j,
        3.1440+2.1768e-07j, 0.6249-1.8267e-08j, 0.2759-0.0000e+00j,
        1.3694+1.7881e-07j, 1.3850+7.5785e-09j, 1.7362-2.3278e-08j,
        2.8677-1.4530e-07j, 6.6941+5.6912e-08j, 2.3104-1.2912e-08j,
        0.7686+1.6391e-07j, 0.1917-1.4901e-08j, 0.3137+5.7042e-09j,
        0.4557-1.4326e-08j, 6.1418+1.6136e-07j, 0.0171+1.3414e-10j,
        1.0229+8.4826e-09j, 9.2139-5.7913e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0719094276428223+3.3418594114209554e-08j)
SINR torch.Size([20]) = tensor([ 3.6750, 11.4631,  8.1843, 12.7303,  9.3193,  4.5248,  8.9064, 11.7842,
        12.5705, 12.2143, 15.5815, 12.2345,  5.1781,  3.3066,  7.4075,  5.1879,
        15.0488,  1.8696, 11.0181, 16.0278], device='cuda:0')
SINR mean = 9.41162109375
E[H^H] = 1e-07
E_MSE (Error Power) = 0.16816729307174683
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6998, 0.9334, 0.8681, 0.9494, 0.8953, 0.7392, 0.8860, 0.9378, 0.9476,
        0.9433, 0.9731, 0.9436, 0.7672, 0.6817, 0.8463, 0.7676, 0.9697, 0.6060,
        0.9267, 0.9756], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([235,  67, 121,  53, 100, 210, 107,  63,  54,  58,  29,  58, 192, 246,
        137, 191,  33, 291,  73,  27], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 16-----------
Real SNR = tensor([19.0328, 15.9579, 15.9659, 17.7911, 16.2993, 16.0836, 16.4305, 16.3549,
        13.3396, 17.4453, 16.8368, 14.3561, 14.8900, 20.2151, 17.1480, 14.5663,
        11.8621, 17.2981, 14.2665, 15.1628], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.8795+5.4907e-09j,  0.4850+8.9407e-08j,  2.9220-2.4608e-08j,
         4.2036-2.3842e-07j, 10.0545+5.0515e-08j,  1.3088-2.9802e-08j,
         9.7220-4.6608e-08j,  0.7692+2.3831e-08j,  3.1768+6.6268e-08j,
         1.8123-1.1582e-08j,  3.2771+5.9605e-08j,  4.6357-2.8732e-08j,
         2.9940+2.1080e-08j,  1.1579+9.0607e-08j,  0.7487-2.9802e-08j,
         1.1118+2.5818e-08j,  0.0252+2.4214e-08j,  5.9304+1.4470e-07j,
         0.8367-2.9802e-08j,  0.3231+1.5990e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.9187262058258057+8.18893131082632e-09j)
torch.linalg.det(H.mH@H) = tensor([ 7.2101-8.0787e-08j,  0.0730+1.3411e-07j,  8.1615-1.7565e-09j,
         4.0956-0.0000e+00j,  5.4166-9.2291e-08j,  2.2199-1.7881e-07j,
        10.6976-3.0831e-08j,  0.8612+1.0388e-08j,  1.7000-0.0000e+00j,
         4.3169+7.4379e-08j,  3.5204+2.3842e-07j,  2.4055+6.4822e-08j,
         2.0399+2.6322e-09j,  0.4231-5.7405e-09j,  3.6205+5.9605e-08j,
         0.8317-1.2427e-08j,  0.2721-2.8536e-08j,  5.5135+1.7099e-07j,
         1.6558+5.9605e-08j,  0.2268-1.6033e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.2630832195281982+1.9108062687678284e-08j)
SINR torch.Size([20]) = tensor([15.6763, -1.2326, 17.0916, 14.5755, 16.0456, 11.3190, 17.3290,  9.4080,
        11.7734, 14.6748, 13.2443, 12.9909, 13.4939,  3.1871, 13.2845, 11.1673,
         7.6122, 15.8399, 11.2109,  4.3829], device='cuda:0')
SINR mean = 11.653711318969727
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1449684351682663
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9737, 0.4295, 0.9808, 0.9663, 0.9757, 0.9313, 0.9818, 0.8972, 0.9377,
        0.9670, 0.9548, 0.9522, 0.9572, 0.6756, 0.9552, 0.9290, 0.8523, 0.9746,
        0.9297, 0.7329], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 29, 397,  21,  36,  26,  69,  20,  98,  63,  35,  47,  50,  45, 249,
         47,  71, 133,  28,  71, 214], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 17-----------
Real SNR = tensor([17.8717, 18.6285, 14.2121, 17.9601, 16.4653, 13.2661, 15.3117, 17.0762,
        12.9556, 13.5906, 12.9547, 18.3824, 21.3022, 13.4891, 18.5816, 16.1319,
        19.0818, 17.5541, 16.3559, 12.9749], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.1199+2.6638e-07j, 10.0047-2.0633e-07j,  0.8430-4.6859e-09j,
         0.7450+2.9802e-08j,  4.4157+2.0198e-07j,  0.3496+1.0914e-07j,
         0.1519-1.8626e-09j,  1.4833+2.3842e-07j,  0.8194+8.9043e-09j,
         2.0907-2.2101e-08j,  0.5076+2.0738e-09j,  7.7189+1.1718e-07j,
         5.1988-1.6073e-07j,  0.2409-7.4506e-09j,  1.6077-5.9605e-08j,
         0.2214-1.3411e-07j,  1.7603+2.2117e-07j,  2.3620-0.0000e+00j,
         3.8693-6.5247e-08j,  0.9734-5.4486e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.4741768836975098+2.6374051387278996e-08j)
torch.linalg.det(H.mH@H) = tensor([1.9362-3.7429e-08j, 5.8609+9.8581e-08j, 0.4192-2.1685e-08j,
        1.1740+1.1921e-07j, 4.0639-3.3852e-08j, 0.0452-2.0631e-08j,
        0.2165-7.4506e-09j, 1.1739-1.7881e-07j, 0.3142-1.9344e-09j,
        1.2506-1.0620e-08j, 0.7219+2.9587e-09j, 8.8090+2.1695e-07j,
        5.3438-2.9695e-08j, 0.9916+1.4929e-08j, 0.8552-2.0862e-07j,
        0.4076+1.4901e-07j, 1.8451+6.1354e-07j, 3.3120+1.0927e-07j,
        3.0616+2.0753e-08j, 0.5266+1.1713e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.116452217102051+4.030969691370956e-08j)
SINR torch.Size([20]) = tensor([12.1240, 16.7525,  9.1187,  9.6895, 15.7271, -1.3983,  3.7794, 11.6036,
         8.9650, 12.9451, 13.0001, 17.9031, 14.3766, 12.3230,  7.2538,  6.1411,
        11.0550, 14.2437, 15.5234, 10.8871], device='cuda:0')
SINR mean = 11.100682258605957
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1454051285982132
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9422, 0.9793, 0.8909, 0.9030, 0.9739, 0.4202, 0.7048, 0.9353, 0.8874,
        0.9517, 0.9523, 0.9841, 0.9648, 0.9447, 0.8416, 0.8044, 0.9273, 0.9637,
        0.9727, 0.9246], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 59,  23, 103,  93,  28, 403, 231,  66, 106,  50,  50,  18,  38,  57,
        141, 167,  73,  39,  30,  75], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 18-----------
Real SNR = tensor([19.8373, 16.1313, 19.8602, 18.4905, 17.1625, 16.3399, 13.4446, 17.8625,
        18.2511, 14.3606, 18.9567, 14.7668, 16.8491, 15.1176, 20.2999, 18.4587,
        15.9339, 13.3685, 17.9524, 14.6868], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.4985-4.5651e-09j, 2.5217+1.6523e-08j, 1.9279+3.8913e-09j,
        0.6182-4.7684e-07j, 1.9343-2.9802e-08j, 1.8672-1.2098e-07j,
        0.5557+1.0809e-08j, 2.8835-1.3357e-08j, 4.9483-2.1372e-08j,
        0.9338+4.6566e-10j, 9.4779+3.9589e-08j, 2.0439+9.9768e-09j,
        1.9117-1.1921e-07j, 0.5120+1.7280e-08j, 9.3273+1.1867e-07j,
        1.3516-0.0000e+00j, 0.1892+1.0431e-07j, 0.0810+3.7253e-09j,
        0.0390-5.3006e-10j, 0.3139+9.8648e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1968321800231934-2.3021478057216882e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0655e+00-1.2812e-08j, 5.1447e-01+9.8343e-09j, 1.9428e+00-6.5643e-08j,
        1.2369e-01+9.3132e-08j, 1.6261e+00-1.5463e-09j, 2.7896e+00+2.4447e-08j,
        4.1100e-01+9.8685e-10j, 1.6383e+00-2.1675e-08j, 2.4327e+00+6.5955e-08j,
        7.3199e-01-5.9605e-08j, 4.4257e+00+1.4105e-09j, 1.2144e+00+1.7548e-08j,
        1.4714e+00+1.0431e-07j, 8.8434e-03-4.7730e-09j, 7.4071e+00-2.1665e-08j,
        9.3948e-01+5.9605e-08j, 3.2910e-02+1.3039e-08j, 3.0739e-01-8.6163e-10j,
        1.6939e-03-6.8941e-10j, 3.1744e-01+2.2237e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4701266288757324+1.1161624513533752e-08j)
SINR torch.Size([20]) = tensor([ 11.1817,  10.9882,  13.3829,   1.5925,  14.1532,  14.6465,  11.1349,
         14.7236,  14.0586,  11.8019,  16.5606,  14.7890,  12.3132,  -6.6581,
         17.3040,  12.3851,  -1.1654,   9.4000, -14.1579,   8.7863],
       device='cuda:0')
SINR mean = 9.361042976379395
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5425134897232056
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9292, 0.9262, 0.9561, 0.5907, 0.9630, 0.9668, 0.9285, 0.9674, 0.9622,
        0.9381, 0.9784, 0.9679, 0.9445, 0.1775, 0.9817, 0.9454, 0.4333, 0.8970,
        0.0370, 0.8832], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 71,  74,  46, 300,  39,  36,  72,  35,  40,  63,  24,  35,  57, 584,
         20,  56, 395,  98, 800, 109], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 19-----------
Real SNR = tensor([18.3984,  9.8389, 15.4047, 17.9934, 10.6189, 20.4151, 18.4203, 19.4754,
        18.1287, 18.8076, 17.5397, 18.2449, 13.4990, 18.6870, 18.0046, 19.9966,
        14.9060, 17.7451, 18.8368, 18.5021], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.3929e-01-1.3078e-09j, 1.1776e-01+1.3634e-09j, 1.6597e+00+7.8938e-08j,
        2.6075e-01-1.6611e-10j, 9.9103e-03+1.6699e-10j, 2.0482e+00-1.4622e-07j,
        1.4039e+00+9.3563e-09j, 5.5244e+00-4.0015e-10j, 1.0833e+01-2.1201e-08j,
        1.1888e+00-2.0862e-07j, 4.6548e-01+6.4840e-08j, 5.6212e+00-2.6490e-08j,
        1.2059e-01-1.1214e-08j, 3.0537e+00-6.9256e-08j, 9.5175e-01-3.2091e-09j,
        2.5554e+00+3.2045e-08j, 1.3950e-01-7.5669e-11j, 1.1040e+00-1.1921e-07j,
        7.0276e-01-2.2015e-07j, 7.0097e-01+7.7682e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.955073595046997-2.8156014408864394e-08j)
torch.linalg.det(H.mH@H) = tensor([1.1101+2.3772e-08j, 0.0703-4.5997e-10j, 0.8965-5.5414e-08j,
        0.4829-4.0317e-09j, 0.0348-1.8626e-09j, 0.5567-0.0000e+00j,
        1.2698-5.9605e-08j, 4.5259+1.9580e-08j, 6.1283-7.2690e-09j,
        1.9329-1.7881e-07j, 0.4179-2.9802e-08j, 4.5966+6.7008e-08j,
        0.0100+2.1289e-09j, 3.3074-5.2967e-09j, 0.9986-9.1297e-09j,
        2.2497+9.4239e-08j, 0.1596+1.4044e-09j, 1.7846-1.7881e-07j,
        1.4160-1.0177e-08j, 0.0643-6.8918e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6006557941436768-2.007307209339615e-08j)
SINR torch.Size([20]) = tensor([13.1968,  9.3533, 13.1006, 11.8278,  5.4666,  6.6316, 14.2925, 18.7340,
        18.9043, 13.8671,  9.6709, 17.8960, -2.1199, 18.4824, 14.2281, 15.5556,
         8.4381, 14.1876, 13.6365,  0.0774], device='cuda:0')
SINR mean = 11.771357536315918
E[H^H] = 1e-07
E_MSE (Error Power) = 0.18240022659301758
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9543, 0.8960, 0.9533, 0.9384, 0.7788, 0.8216, 0.9641, 0.9868, 0.9873,
        0.9606, 0.9026, 0.9840, 0.3803, 0.9860, 0.9636, 0.9729, 0.8747, 0.9633,
        0.9585, 0.5045], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 48,  99,  49,  63, 184, 155,  38,  15,  14,  42,  94,  18, 429,  15,
         39,  29, 116,  39,  44, 352], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 20-----------
Real SNR = tensor([20.0202, 15.7555, 22.7382, 23.1944, 22.2383, 20.1348, 17.0909, 19.3287,
        20.9876, 15.6666, 14.1299, 17.3349, 14.9840, 18.0889, 20.1404, 18.4508,
        18.6215, 16.9227, 20.9321, 19.5168], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.0556+1.7546e-08j,  0.4002+6.1197e-09j, 10.0665+2.3912e-07j,
         2.5211-5.7927e-08j,  3.4070+2.0165e-07j,  5.3079-1.6480e-07j,
         4.6896-9.3714e-09j,  1.2922-1.2956e-08j, 10.5278+8.6825e-08j,
         0.0828-7.4506e-09j,  0.9118-1.7039e-08j,  0.3205+4.2477e-08j,
         0.1302-8.6974e-10j,  1.6518-3.6950e-08j,  0.6427+8.9407e-08j,
         1.1288-1.1804e-08j,  4.6191-5.4921e-08j,  0.3000-7.3550e-09j,
         1.8506+1.7631e-08j,  6.3665+4.5772e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8136279582977295+1.8255471800898704e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1560+7.7295e-09j, 0.4818-8.9574e-09j, 8.1013-7.6344e-08j,
        5.5714+1.4795e-07j, 3.7177+1.4724e-07j, 4.7077+6.4142e-08j,
        4.1126+4.0072e-08j, 1.8482+2.6892e-08j, 7.9473+1.0703e-07j,
        0.2361-0.0000e+00j, 0.2168+2.3827e-09j, 0.1369+4.3503e-08j,
        0.5887-6.2917e-09j, 1.8635+1.8462e-08j, 0.7051-1.1921e-07j,
        1.3294-3.6325e-09j, 3.2251+3.3376e-08j, 0.3085+6.3488e-09j,
        2.0984-3.3755e-08j, 4.9296+5.6883e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.614105224609375+2.2691285295195485e-08j)
SINR torch.Size([20]) = tensor([ 4.4287, 13.1676, 20.7577, 19.3960, 17.4486, 19.6352, 19.2119, 17.7063,
        20.6279, 10.7249, 12.1498,  7.3370, 15.3937, 16.9955, 11.4344, 16.7644,
        18.4713, 12.7791, 17.2487, 19.6569], device='cuda:0')
SINR mean = 15.566786766052246
E[H^H] = 1e-07
E_MSE (Error Power) = 0.04918767139315605
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7349, 0.9540, 0.9917, 0.9886, 0.9823, 0.9892, 0.9882, 0.9833, 0.9914,
        0.9220, 0.9425, 0.8441, 0.9719, 0.9804, 0.9329, 0.9794, 0.9860, 0.9499,
        0.9815, 0.9893], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([213,  48,   9,  13,  19,  12,  13,  18,   9,  77,  59, 139,  30,  21,
         68,  23,  15,  52,  20,  12], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 21-----------
Real SNR = tensor([22.1832, 19.5118, 17.2560, 19.4973, 21.6819, 24.5835, 13.0430, 18.3625,
        20.9481, 20.5564, 24.5932, 21.7321, 22.9909, 20.7479, 17.6378, 21.0562,
        17.7649, 18.1065, 22.4803, 23.3702], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.7493+2.8034e-08j,  0.0236+2.8083e-08j,  1.0066+3.0550e-09j,
         0.8779+1.1921e-07j,  4.6583-7.2880e-10j,  9.8671+7.4079e-08j,
         0.1638-3.7253e-09j,  0.2610-5.9605e-08j, 10.9935-3.4390e-08j,
         4.2091+1.6093e-07j, 11.4038-4.7684e-07j,  3.3504-2.9606e-08j,
         6.3638+1.0393e-07j,  1.2372-2.3554e-08j,  0.9814-4.4703e-08j,
         0.3558+2.4189e-09j,  1.2710+3.4892e-08j,  1.9781+1.0472e-08j,
         1.7040-2.0169e-07j, 17.2507+1.2573e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.9853157997131348-9.200547879117948e-09j)
torch.linalg.det(H.mH@H) = tensor([4.9571e-01+9.4719e-09j, 1.0775e-02-8.9256e-09j, 8.8552e-01+1.6518e-09j,
        7.5212e-01+5.9605e-08j, 3.2321e+00+4.2999e-08j, 1.1835e+01+4.1038e-07j,
        6.1144e-02-7.4506e-09j, 1.0423e-01+1.8626e-08j, 9.0318e+00-5.9793e-08j,
        4.5847e+00+4.3390e-08j, 1.4527e+01-4.7400e-07j, 1.8154e+00-4.0364e-08j,
        5.8183e+00+4.0488e-09j, 1.7155e+00+5.9605e-08j, 1.1711e+00-2.0697e-08j,
        3.4269e-01-5.8208e-09j, 6.4871e-01-6.0388e-10j, 1.1071e+00-1.8322e-09j,
        2.0390e+00+6.5680e-08j, 1.4904e+01+1.9995e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.75412917137146+5.798708180293488e-09j)
SINR torch.Size([20]) = tensor([11.2114, -2.8580, 16.6329, 14.9975, 19.3930, 21.7474,  6.2948,  6.8496,
        21.1201, 19.8756, 22.3567, 16.3429, 20.2831, 15.8714, 16.5295, 12.3438,
        14.5870, 17.4053, 15.3439, 22.0620], device='cuda:0')
SINR mean = 15.4194974899292
E[H^H] = 1e-07
E_MSE (Error Power) = 0.12592564523220062
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9297, 0.3412, 0.9787, 0.9693, 0.9886, 0.9934, 0.8099, 0.8288, 0.9923,
        0.9898, 0.9942, 0.9773, 0.9907, 0.9748, 0.9782, 0.9449, 0.9664, 0.9821,
        0.9716, 0.9938], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 71, 454,  23,  33,  13,   7, 163, 150,   8,  11,   6,  25,  10,  27,
         24,  57,  36,  20,  31,   7], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 22-----------
Real SNR = tensor([19.8762, 18.3178, 21.2799, 23.2437, 15.8744, 21.3719, 19.1723, 18.3779,
        18.8334, 16.1642, 24.2633, 20.2551, 23.3419, 20.8593, 23.3366,  5.5228,
        22.0063, 17.1515, 19.8384, 22.3847], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.0103-6.4438e-09j, 0.5600+4.2713e-08j, 2.8708-3.2487e-09j,
        4.4565+4.7637e-08j, 0.1906-5.7068e-09j, 0.8135-1.9123e-08j,
        1.0167-1.1351e-08j, 0.5600-6.8129e-09j, 0.2059+1.4901e-08j,
        0.0976-0.0000e+00j, 3.0908+6.6599e-08j, 0.9735-1.9810e-09j,
        0.1037-1.0431e-07j, 3.0248+1.8305e-08j, 3.6866+2.1284e-08j,
        0.0165-6.9574e-11j, 0.6136-0.0000e+00j, 0.3970-1.4901e-08j,
        0.7774-3.9974e-09j, 0.2790-1.9372e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.2372373342514038-8.010928809198958e-09j)
torch.linalg.det(H.mH@H) = tensor([1.1766e+00-1.2858e-08j, 6.3853e-01+1.0980e-08j, 3.9726e+00-2.8070e-08j,
        3.6911e+00-4.4896e-08j, 6.0523e-02+1.1176e-08j, 8.2818e-01-3.9432e-08j,
        1.5030e+00-1.8754e-08j, 8.3523e-01+1.2829e-08j, 1.3669e-01+1.0058e-07j,
        6.5109e-02+3.9508e-09j, 2.7700e+00+7.1470e-10j, 8.6592e-01-3.4009e-08j,
        1.8635e-01+2.0862e-07j, 3.1687e+00+5.4575e-08j, 3.3320e+00+4.0433e-08j,
        2.8880e-04-4.3656e-11j, 3.9507e-01-1.0431e-07j, 2.0750e-01-1.4901e-08j,
        9.5744e-01-5.1256e-09j, 3.3891e-01-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2564830780029297+6.3278706718961075e-09j)
SINR torch.Size([20]) = tensor([18.8057, 16.2107, 21.2707, 20.4466,  9.4345, 13.9390, 18.5756, 17.0386,
         9.4731,  7.5242, 19.4599, 17.4752,  6.0423, 19.8195, 19.7850, -2.6433,
        11.3848, 12.3944, 17.7338, 11.1738], device='cuda:0')
SINR mean = 14.26720905303955
E[H^H] = 1e-07
E_MSE (Error Power) = 0.13677705824375153
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9870, 0.9766, 0.9926, 0.9911, 0.8977, 0.9612, 0.9863, 0.9806, 0.8986,
        0.8497, 0.9888, 0.9824, 0.8008, 0.9897, 0.9896, 0.3524, 0.9322, 0.9455,
        0.9834, 0.9291], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 14,  25,   8,  10,  98,  41,  15,  21,  97, 135,  12,  19, 169,  11,
         11, 447,  68,  56,  18,  71], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 23-----------
Real SNR = tensor([19.2197, 22.8584, 23.9390, 23.0000, 18.2726, 18.4845, 15.4962, 23.6659,
        20.1668, 22.1523, 21.1265, 21.3382, 25.3534, 22.7653, 25.5964, 19.6183,
        22.0624, 18.7546, 22.0373, 25.7666], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.9710+1.1035e-08j, 2.5267-1.0412e-08j, 1.4550+2.8239e-08j,
        1.4450-1.9815e-09j, 0.4248-9.5878e-10j, 0.5435+1.8461e-08j,
        0.1388+3.5534e-09j, 2.5780+4.3520e-08j, 0.1366+9.5039e-09j,
        1.5918+2.8080e-08j, 1.7190+4.1242e-08j, 0.6129+1.2671e-08j,
        2.4544-2.6802e-09j, 2.3820+3.8194e-08j, 7.2380+6.9059e-08j,
        0.5382+1.3468e-08j, 0.1962+1.3701e-08j, 0.4374-7.4506e-09j,
        0.7537-8.2888e-08j, 8.5627+2.3672e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8352822065353394+2.3053999598232622e-08j)
torch.linalg.det(H.mH@H) = tensor([0.5814-1.5782e-08j, 2.9574+7.2757e-09j, 1.6210-3.0096e-08j,
        1.2585-4.2123e-09j, 0.4205-3.8999e-09j, 0.5035-1.4901e-08j,
        0.1722-7.9111e-10j, 2.8564+1.1436e-08j, 0.0596+1.2500e-08j,
        2.2099+6.1801e-08j, 1.5208+2.2743e-08j, 0.5475+1.4786e-08j,
        3.2369+7.4795e-08j, 1.5577-3.2355e-08j, 7.8109-6.4556e-08j,
        0.3641+1.4901e-08j, 0.1676+1.3437e-09j, 0.3680+2.2352e-08j,
        0.5929+2.9802e-08j, 8.2021-7.8323e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8504581451416016+1.4409956561323156e-09j)
SINR torch.Size([20]) = tensor([17.4198, 21.2732, 17.1787, 18.6705, 17.7738, 14.9535, 13.9342, 19.7213,
         7.9855, 20.8880, 19.8160, 15.4979, 19.9938, 19.6737, 22.8577, 15.9590,
         9.9940, 15.3794, 14.5360, 21.9373], device='cuda:0')
SINR mean = 17.272151947021484
E[H^H] = 1e-07
E_MSE (Error Power) = 0.027128932997584343
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9822, 0.9926, 0.9812, 0.9866, 0.9836, 0.9690, 0.9612, 0.9894, 0.8628,
        0.9919, 0.9897, 0.9726, 0.9901, 0.9893, 0.9948, 0.9753, 0.9090, 0.9718,
        0.9660, 0.9936], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 20,   8,  21,  15,  18,  33,  41,  12, 125,   9,  11,  30,  11,  12,
          5,  27,  88,  30,  36,   7], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 24-----------
Real SNR = tensor([25.7717, 23.7420, 28.4941, 23.2216, 21.6846, 24.1952, 24.6056, 19.5684,
        21.4063, 24.5988, 22.8765, 21.9637, 23.8228, 23.7920, 21.8065, 23.6132,
        27.8164, 22.9730, 24.6024, 18.0456], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.7804-3.0011e-09j, 0.8967+1.0855e-08j, 0.7149+1.2460e-07j,
        0.6844-2.5234e-08j, 0.8743-0.0000e+00j, 5.4043-9.1125e-09j,
        4.1939+2.1960e-08j, 0.3876-1.6862e-08j, 0.1891-1.2790e-07j,
        0.7681+1.5957e-08j, 0.8156+7.4506e-09j, 0.8283-8.9407e-08j,
        0.3175-8.9407e-08j, 1.6278+3.6828e-08j, 0.0719-1.2666e-07j,
        0.2743-2.9802e-08j, 1.3194-3.0740e-08j, 1.2089-1.1921e-07j,
        1.8298-5.4082e-08j, 0.4013+1.3089e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.1794283390045166-2.4533600040399506e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4944-1.6523e-08j, 0.8137-3.8217e-08j, 0.9680+3.9298e-08j,
        0.8808+7.4305e-08j, 0.8250+1.4901e-08j, 4.5174-1.7609e-09j,
        4.2796-4.1582e-08j, 0.2291+6.3967e-10j, 0.0166+1.0817e-07j,
        0.8243-1.7753e-08j, 0.7511-1.4901e-08j, 0.7722+2.9802e-08j,
        0.4882-4.4988e-09j, 1.5970+4.1048e-09j, 0.3544+4.4703e-08j,
        0.2748-2.2352e-08j, 1.0227+9.1560e-08j, 1.0907-0.0000e+00j,
        1.2492-2.9540e-09j, 0.2545-6.2446e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0851889848709106+1.2034940155558616e-08j)
SINR torch.Size([20]) = tensor([12.9515, 17.4715, 14.7132, 18.1497, 16.8829, 22.6449, 22.2170, 16.2359,
        -0.2483, 17.2098, 16.2402, 16.8665, 14.9021, 19.6528, 12.6678, 12.8980,
        15.2291, 18.0058, 18.4416, 16.3395], device='cuda:0')
SINR mean = 15.973578453063965
E[H^H] = 1e-07
E_MSE (Error Power) = 0.06963016837835312
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9518, 0.9824, 0.9673, 0.9849, 0.9799, 0.9946, 0.9940, 0.9768, 0.4857,
        0.9813, 0.9768, 0.9798, 0.9687, 0.9893, 0.9487, 0.9512, 0.9709, 0.9844,
        0.9859, 0.9773], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 50,  19,  35,  17,  22,   6,   6,  25, 363,  20,  25,  22,  34,  12,
         53,  51,  31,  17,  16,  25], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 25-----------
Real SNR = tensor([25.6882, 23.9351, 19.1430, 22.6523, 27.3548, 26.1764, 28.1051, 24.7882,
        24.4660, 18.1861, 26.7786, 25.7620, 24.3321, 16.1603, 26.8464, 25.1283,
        24.1916, 23.2071, 25.6939, 21.1114], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.5548-1.7573e-07j, 0.8938-2.7310e-08j, 0.3529+3.7230e-09j,
        0.1826-5.9605e-08j, 0.7773+1.7881e-07j, 1.8760+5.9605e-08j,
        4.0401+7.4031e-08j, 1.1471+6.7052e-08j, 1.7132+1.1921e-07j,
        0.5190+3.3632e-09j, 6.3067+2.3842e-07j, 0.4607-1.6391e-07j,
        2.3302-1.1921e-07j, 0.0555-0.0000e+00j, 1.5786+5.9605e-08j,
        1.1867+1.9530e-08j, 0.0128-3.2450e-10j, 0.6961+1.8006e-08j,
        5.3967+1.8127e-07j, 0.9203+3.4473e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.6500543355941772+2.399906939842822e-08j)
torch.linalg.det(H.mH@H) = tensor([2.4505+1.0165e-07j, 0.8025+9.7158e-09j, 0.4724-7.5702e-09j,
        0.1884-2.9802e-08j, 0.2543+2.3842e-07j, 1.7049+1.1325e-06j,
        5.9163+1.6610e-07j, 1.1845-4.3112e-08j, 1.8045-5.9605e-08j,
        0.4246-7.4171e-09j, 5.3202+2.3842e-07j, 0.6797-2.0862e-07j,
        1.7589-0.0000e+00j, 0.0699-0.0000e+00j, 1.0476-2.3842e-07j,
        1.5450+1.6173e-08j, 0.0307-1.0637e-09j, 0.9292-1.0572e-08j,
        5.5446-4.4405e-08j, 0.6050-1.8090e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6366767883300781+6.252861339817173e-08j)
SINR torch.Size([20]) = tensor([21.5976, 18.7985, 19.2538, 13.5903, 10.6002, 16.4880, 22.7860, 20.1603,
        20.1206, 19.3151, 22.9543, 15.2709, 20.6441, 14.4735, 14.5754, 21.8242,
         5.7228, 20.6874, 25.1923, 20.3041], device='cuda:0')
SINR mean = 18.217971801757812
E[H^H] = 1e-07
E_MSE (Error Power) = 0.0297288428992033
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9931, 0.9870, 0.9883, 0.9581, 0.9199, 0.9780, 0.9948, 0.9905, 0.9904,
        0.9884, 0.9950, 0.9711, 0.9915, 0.9655, 0.9663, 0.9935, 0.7888, 0.9915,
        0.9970, 0.9908], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  7,  14,  13,  44,  79,  24,   6,  10,  11,  13,   5,  31,   9,  37,
         36,   7, 177,   9,   3,  10], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 26-----------
Real SNR = tensor([28.5922, 26.5709, 22.4353, 28.6253, 18.1570, 23.2947, 24.3505, 25.6608,
        20.4106, 25.9753, 24.5468, 26.2695, 25.8388, 30.3793, 26.4697, 25.4048,
        25.5123, 23.4710, 25.9083, 19.3940], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.6595-1.0444e-08j,  3.3197-1.2115e-08j,  0.1194+7.0781e-08j,
         3.2633-3.1328e-07j,  0.1029-3.7253e-09j,  0.1469+2.5839e-08j,
         1.8738-1.9339e-09j,  2.4191-1.6269e-09j,  0.1586+2.7290e-09j,
         4.6528+1.1106e-07j,  3.3656+1.0030e-07j,  4.4362-5.3390e-08j,
         3.4444+1.1698e-07j, 17.3719+5.4599e-08j,  4.2972+9.0186e-08j,
         1.7935-1.7801e-08j,  4.9964+2.4011e-08j,  0.5315+1.4901e-08j,
         0.0614-1.7695e-07j,  0.0419+4.3969e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8527956008911133+1.0281866469341594e-09j)
torch.linalg.det(H.mH@H) = tensor([ 1.2976+4.0498e-08j,  3.4500-1.5506e-07j,  0.1813+7.4506e-08j,
         2.8776+2.6185e-08j,  0.0651-0.0000e+00j,  0.1763-2.5282e-08j,
         2.3042+5.2440e-08j,  2.3026+3.2337e-08j,  0.2201+1.8560e-09j,
         5.5005+3.0621e-08j,  3.8233-6.5525e-09j,  5.5371-9.6605e-08j,
         2.4637-5.4454e-08j, 16.2062+3.6758e-07j,  4.0033+2.6933e-08j,
         1.4465+9.4304e-08j,  4.2299+9.4290e-09j,  0.6220-4.4703e-08j,
         0.1061+2.6077e-08j,  0.0328+4.3757e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.8423142433166504+2.022385459099496e-08j)
SINR torch.Size([20]) = tensor([19.1640, 24.1098, 14.9117, 22.8752, 14.4159, 14.3512, 21.8415, 23.4142,
        18.3074, 25.8794, 25.3609, 25.1457, 22.8666, 27.9443, 24.6010, 21.6829,
        25.4515, 19.5124,  9.2068, 11.5841], device='cuda:0')
SINR mean = 20.631330490112305
E[H^H] = 1e-07
E_MSE (Error Power) = 0.017661696299910545
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9880, 0.9961, 0.9687, 0.9949, 0.9651, 0.9646, 0.9935, 0.9955, 0.9854,
        0.9974, 0.9971, 0.9970, 0.9949, 0.9984, 0.9965, 0.9933, 0.9972, 0.9889,
        0.8928, 0.9351], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 13,   4,  34,   5,  37,  38,   7,   5,  16,   3,   3,   3,   5,   1,
          4,   7,   3,  12, 102,  66], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 27-----------
Real SNR = tensor([28.9720, 27.1470, 23.5442, 26.9221, 26.6966, 27.5949, 20.7335, 30.7841,
        30.2398, 23.4897, 27.0385, 25.6697, 25.6140, 27.2640, 25.5479, 24.9822,
        25.4531, 22.5731, 24.1308, 25.8709], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.4576-7.3445e-08j, 1.5511-5.2531e-08j, 0.0701+5.4823e-10j,
        1.2902+3.1409e-08j, 3.6059-1.9278e-08j, 0.5928+9.1323e-08j,
        0.0272+2.4179e-09j, 2.6647-8.4856e-08j, 8.0101+2.8540e-07j,
        0.4392-2.9334e-08j, 0.7037-1.4823e-08j, 1.0572-5.9605e-08j,
        0.2298+1.2077e-09j, 2.5931+5.9605e-08j, 0.3278+1.1176e-08j,
        0.7026-1.6863e-08j, 1.0431+8.3298e-10j, 0.3603-1.2306e-08j,
        0.8300-7.0338e-08j, 0.2465+1.1763e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.340159296989441+3.115256719254944e-09j)
torch.linalg.det(H.mH@H) = tensor([0.9746+1.0986e-07j, 1.6049+8.2875e-08j, 0.0880+9.9586e-10j,
        1.3102+6.8704e-08j, 3.0264+1.1000e-07j, 0.3802-2.0246e-07j,
        0.0273-2.1861e-08j, 2.4067+2.3190e-07j, 9.3973+2.6100e-07j,
        0.4968-3.5741e-09j, 0.9854-1.5846e-08j, 0.8256-1.1921e-07j,
        0.2003+1.1280e-07j, 2.8646-0.0000e+00j, 0.2609-1.4901e-08j,
        0.8370-0.0000e+00j, 1.0314-6.9856e-09j, 0.2424+3.8626e-09j,
        0.8903-3.5879e-08j, 0.1794-3.9738e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4014753103256226+2.607649207675422e-08j)
SINR torch.Size([20]) = tensor([19.1037, 22.2220, 14.6280, 22.3090, 24.9340, 14.6947,  9.3392, 22.4322,
        27.3979, 18.3069, 20.4847, 18.3648, 14.4754, 23.1057, 14.9118, 21.1258,
        22.2295, 19.1876, 21.9762, 14.7658], device='cuda:0')
SINR mean = 19.29974937438965
E[H^H] = 1e-07
E_MSE (Error Power) = 0.01812482438981533
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9879, 0.9940, 0.9667, 0.9942, 0.9968, 0.9672, 0.8957, 0.9943, 0.9982,
        0.9854, 0.9911, 0.9856, 0.9655, 0.9951, 0.9687, 0.9923, 0.9941, 0.9881,
        0.9937, 0.9677], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([13,  6, 36,  6,  3, 35, 99,  6,  2, 16, 10, 16, 37,  5, 34,  8,  6, 13,
         7, 35], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 28-----------
Real SNR = tensor([25.3438, 23.5026, 24.5691, 29.5017, 23.8454, 29.2865, 28.7580, 27.5088,
        22.3576, 26.7798, 27.9760, 28.0612, 27.9640, 28.0273, 22.6845, 28.9244,
        27.8610, 27.3769, 28.3105, 22.0872], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.6538-9.2009e-09j, 0.7478+6.6069e-09j, 0.2856-0.0000e+00j,
        1.0644+3.1731e-08j, 0.0218+1.6202e-08j, 0.2864-1.8626e-09j,
        3.4607-8.9481e-08j, 4.6697-1.4630e-08j, 0.2773+5.5879e-09j,
        2.1147-1.6789e-08j, 3.4309-6.1981e-08j, 0.9683-1.0964e-07j,
        5.9261-2.3213e-09j, 0.3693-2.7493e-08j, 0.4524+3.2047e-10j,
        2.2151-6.7585e-09j, 4.1609+8.9335e-08j, 2.2700-7.3234e-08j,
        2.0629-2.9802e-07j, 0.4300+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8433952331542969-2.7336321650750506e-08j)
torch.linalg.det(H.mH@H) = tensor([1.3881-2.8075e-08j, 0.4889+8.1526e-09j, 0.2886-2.9802e-08j,
        0.5677-1.4776e-08j, 0.0372-1.7256e-08j, 0.1608-4.8662e-08j,
        3.5935-2.1227e-07j, 4.6494-8.8923e-09j, 0.1863-3.7253e-09j,
        1.8452-4.0398e-08j, 3.6648-6.5436e-08j, 1.3037-1.3999e-07j,
        6.3491+9.7837e-08j, 0.4815+3.5979e-10j, 0.3473-7.1355e-10j,
        1.9469-8.0006e-09j, 3.9073+1.7710e-07j, 2.2052+3.1760e-08j,
        1.6968-3.5763e-07j, 0.3264-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7717316150665283-3.3765811480179764e-08j)
SINR torch.Size([20]) = tensor([24.5001, 22.5457, 18.1075, 19.9662, 11.5756, 10.2394, 24.8587, 28.0084,
        18.5069, 24.8972, 27.3837, 21.7339, 28.2253, 19.7296, 21.3724, 24.1745,
        26.5685, 25.3522, 21.6616, 20.1581], device='cuda:0')
SINR mean = 21.978273391723633
E[H^H] = 1e-07
E_MSE (Error Power) = 0.01264992356300354
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9965, 0.9945, 0.9848, 0.9900, 0.9350, 0.9135, 0.9967, 0.9984, 0.9861,
        0.9968, 0.9982, 0.9933, 0.9985, 0.9895, 0.9928, 0.9962, 0.9978, 0.9971,
        0.9932, 0.9904], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 4,  6, 17, 11, 66, 85,  3,  1, 15,  3,  2,  7,  1, 12,  8,  4,  2,  3,
         7, 10], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 29-----------
Real SNR = tensor([32.5259, 22.5200, 29.0397, 29.7756, 27.3069, 27.7742, 28.7508, 26.5317,
        24.7891, 25.7800, 26.6418, 30.8666, 29.9367, 26.6138, 25.5268, 25.4372,
        30.1574, 29.2290, 23.2361, 27.6986], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.4856e+01-3.0375e-08j, 4.9352e-01+1.5923e-08j, 5.6629e-01+6.0182e-08j,
        1.5608e+00+1.8420e-08j, 1.1187e+00-3.7494e-09j, 1.2488e+00-2.3335e-09j,
        4.7400e-03+2.3984e-08j, 7.9911e-01+6.1751e-09j, 5.1237e-01-4.0201e-09j,
        2.6021e-01+2.9802e-08j, 7.2239e-01-1.1101e-08j, 3.5015e+00-4.8034e-08j,
        2.4974e-01-5.5019e-07j, 1.4513e+00+2.7767e-08j, 8.5461e-01-2.9962e-09j,
        5.1981e-01-1.4901e-08j, 1.3646e+00-2.2128e-07j, 2.8702e+00+2.3418e-07j,
        3.2440e-02-1.2456e-08j, 1.3010e-01-1.6750e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.6558395624160767-2.5087487642849737e-08j)
torch.linalg.det(H.mH@H) = tensor([1.4082e+01+1.5448e-09j, 2.7886e-01-3.3945e-09j, 5.0445e-01-2.2129e-09j,
        1.9924e+00-1.1102e-08j, 1.5958e+00-6.3493e-08j, 1.3290e+00-2.1422e-08j,
        5.2052e-03-5.1456e-08j, 6.5787e-01-1.4670e-08j, 4.6647e-01+2.9491e-09j,
        2.8287e-01+7.4506e-09j, 7.8765e-01+8.1610e-10j, 4.5480e+00-3.0048e-08j,
        1.9429e-01-2.6292e-07j, 1.7583e+00-3.9691e-08j, 4.8048e-01-0.0000e+00j,
        3.4176e-01+1.4901e-08j, 1.2449e+00+2.9289e-08j, 2.2153e+00-1.7881e-07j,
        2.6502e-02-2.6531e-10j, 9.5022e-02-8.4988e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.644329309463501-3.537605763881402e-08j)
SINR torch.Size([20]) = tensor([30.5911, 21.5475, 20.9728, 25.8957, 25.5780, 24.5530,  0.2612, 22.6619,
        22.9700, 19.4202, 24.0177, 28.2353, 13.9420, 26.1754, 20.7926, 20.4561,
        22.8952, 24.7330, 10.1335, 12.3153], device='cuda:0')
SINR mean = 20.907367706298828
E[H^H] = 1e-07
E_MSE (Error Power) = 0.05478334426879883
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9991, 0.9930, 0.9921, 0.9974, 0.9972, 0.9965, 0.5150, 0.9946, 0.9950,
        0.9887, 0.9961, 0.9985, 0.9612, 0.9976, 0.9917, 0.9911, 0.9949, 0.9966,
        0.9116, 0.9446], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  1,   8,   9,   3,   3,   4, 345,   6,   5,  12,   4,   1,  41,   2,
          9,  10,   5,   3,  86,  57], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)

--- 処理中: 画像 81 から 100 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 80)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6931, 0.5226, 0.7302, 0.7399, 0.7176, 0.6209, 0.5511, 0.6197, 0.7088,
        0.8136, 0.7387, 0.7753, 0.8751, 0.5915, 0.6488, 0.7575, 0.5067, 0.6304,
        0.9574, 0.5433], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -7.2271,  -4.5066,  -4.2441, -11.2542,  -8.7056,  -9.4707,  -3.1422,
         -8.5221,  -7.3483,  -7.9853,  -6.4876, -10.0979,  -9.5750,  -7.7046,
        -12.2772,  -9.0600,  -6.8584,  -4.9989,  -8.2851,  -4.7483],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 267.9373+1.6656e-06j,   94.9178-1.1375e-07j,   68.2113-3.8483e-07j,
         284.7925-2.1109e-06j,  251.2118-5.6199e-06j,  478.7058-4.3028e-07j,
         172.1472+3.3772e-05j,   45.2781-1.9073e-06j, 1184.1937-2.4768e-06j,
          30.6930-2.3842e-06j,  303.6360+9.5926e-08j,  495.0891+7.6991e-06j,
          64.7558+5.2176e-07j,   27.4173+2.5234e-06j,   50.0912+1.9073e-06j,
          87.1318+1.5259e-05j,  720.5660-5.9857e-06j,  297.3098+3.2663e-06j,
        1595.0050-5.2066e-05j,  426.5734-9.5367e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(347.283203125-8.153525641318993e-07j)
torch.linalg.det(H.mH@H) = tensor([0.7292-0.0000e+00j, 1.4326-2.0089e-08j, 2.1602-1.8247e-08j,
        0.0565+7.4506e-09j, 0.2788-1.1086e-08j, 0.0899+5.4611e-09j,
        2.4982+3.9553e-08j, 0.2727+1.1176e-08j, 1.3421+1.2717e-08j,
        1.0966-7.4506e-09j, 1.0975+2.2453e-08j, 0.6773-3.4566e-09j,
        1.6434-3.2793e-08j, 0.5094-0.0000e+00j, 0.0966+1.1898e-09j,
        1.0583+2.6179e-08j, 2.5932+1.9041e-08j, 1.8284-1.7881e-07j,
        0.2203+6.7055e-08j, 4.4591+7.6163e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.207025408744812+8.251396232950015e-10j)
SINR torch.Size([20]) = tensor([-12.4174, -10.5076,  -7.9750, -20.4694, -16.0851, -17.6932,  -8.2660,
        -14.8245,  -9.4766, -10.2553,  -9.7699,  -9.8611,  -7.0447, -12.6779,
        -15.6558,  -8.6337,  -6.9561,  -8.8738, -18.6110,  -4.6770],
       device='cuda:0')
SINR mean = -11.536555290222168
E[H^H] = 1e-07
E_MSE (Error Power) = 22.307106018066406
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0542, 0.0817, 0.1375, 0.0089, 0.0240, 0.0167, 0.1297, 0.0319, 0.1014,
        0.0862, 0.0954, 0.0936, 0.1649, 0.0512, 0.0265, 0.1205, 0.1677, 0.1147,
        0.0136, 0.2541], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([755, 702, 626, 944, 847, 884, 635, 817, 672, 695, 680, 683, 596, 762,
        837, 646, 593, 654, 904, 518], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -4-----------
Real SNR = tensor([ -9.0381,  -7.5534,  -7.1128,  -6.8261,  -5.8923,  -4.6241,  -2.0391,
         -3.5425,  -8.2935,  -7.0894,  -3.7728,  -8.5589,  -5.1678,  -6.7145,
         -2.9343, -11.5066,  -7.8056,  -4.7465,  -7.5450,  -3.5768],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([286.0824+5.5168e-06j, 389.7290-1.1776e-05j,  25.4399-2.6994e-07j,
        158.5426-6.4625e-06j, 369.3107+6.1035e-05j,  14.6668-2.7839e-06j,
         61.9784+5.0442e-08j,  41.3648+3.8147e-06j,   0.4728+3.8316e-06j,
        273.2428+6.7502e-06j,   9.9273-2.4100e-06j, 173.5305+6.6523e-07j,
         82.5315-1.2381e-05j,  11.5562+2.3842e-06j,   5.1455+1.1023e-06j,
         80.0232-1.9073e-06j,   4.6307-8.9407e-07j, 256.1600+1.0408e-06j,
        393.0912-1.1135e-05j, 249.8435+4.6743e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(144.36349487304688+4.145712864556117e-06j)
torch.linalg.det(H.mH@H) = tensor([0.2935+6.4153e-10j, 0.2820+1.4901e-08j, 1.1807-2.1190e-09j,
        1.6384-0.0000e+00j, 2.8538-1.5265e-08j, 1.1944+5.5959e-09j,
        8.2597+1.3440e-07j, 0.4192-1.1049e-08j, 1.0535-7.7803e-09j,
        0.1737-5.2773e-08j, 1.3366-2.4646e-09j, 0.3522-7.4506e-09j,
        2.1197-6.6625e-09j, 0.5342+1.1921e-07j, 5.9389-1.9141e-07j,
        0.2219+1.3530e-08j, 0.1177+1.0737e-08j, 0.1341-0.0000e+00j,
        0.1273-9.9264e-09j, 0.4093-3.9116e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4320276975631714-2.350334815659494e-09j)
SINR torch.Size([20]) = tensor([-13.9575, -14.1205,  -8.1517,  -9.2285,  -6.1132,  -9.2100,  -3.7008,
        -13.1041,  -8.6980, -16.3600,  -9.4591, -14.3833,  -5.8441, -11.3682,
         -4.8366, -13.1688, -16.9189, -19.0998, -17.2973, -14.3497],
       device='cuda:0')
SINR mean = -11.468504905700684
E[H^H] = 1e-07
E_MSE (Error Power) = 20.65814208984375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0386, 0.0373, 0.1327, 0.1067, 0.1966, 0.1071, 0.2990, 0.0466, 0.1189,
        0.0226, 0.1017, 0.0352, 0.2066, 0.0680, 0.2472, 0.0460, 0.0199, 0.0122,
        0.0183, 0.0354], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([795, 799, 631, 664, 566, 664, 484, 773, 648, 854, 671, 806, 557, 726,
        523, 775, 867, 915, 875, 805], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -3-----------
Real SNR = tensor([ -6.3865,  -1.1832,  -4.2948,  -8.5916,  -6.4803,  -5.9804,  -6.9676,
         -4.5010,  -3.0401,  -5.4367,  -8.8411,  -4.6679,  -8.6308,  -0.5276,
         -4.8872, -11.6383,  -6.0291,  -4.6815,  -5.9803,  -4.1754],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 226.3969-2.3624e-06j, 1049.4603+2.1550e-05j,  294.0887+7.6294e-06j,
          34.0931-5.4908e-08j,    8.1265+1.2998e-05j,  149.3459-2.1278e-06j,
         101.5418-1.0138e-05j,    4.4688-0.0000e+00j,   29.6486-1.4305e-06j,
         413.6281-1.1689e-06j,    1.7012+1.0201e-06j,  617.8004-3.0518e-06j,
          73.8948-5.7220e-06j,  223.1268+1.3850e-05j,  128.0568+3.8147e-06j,
         105.4615-2.5331e-06j,   79.7934+2.9028e-07j,  140.3807+3.1591e-06j,
          43.9437+5.7220e-06j,  205.3690+4.0682e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(196.516357421875+2.275638053106377e-06j)
torch.linalg.det(H.mH@H) = tensor([1.3747e+00+2.6884e-09j, 1.3255e+00+1.7881e-07j, 2.5999e+00-5.5298e-10j,
        1.1683e-01-3.4775e-11j, 7.6705e-01+3.8881e-08j, 1.7784e-01+9.3132e-09j,
        4.8886e-01+4.5518e-09j, 4.6246e-01+2.9802e-08j, 6.1217e+00-7.5074e-08j,
        1.1086e+00-2.4963e-08j, 4.4699e-03-4.0383e-10j, 1.6392e-01-5.2154e-08j,
        4.8974e-02+4.4945e-09j, 2.3448e+00-1.4490e-07j, 1.3609e+00-8.9407e-08j,
        2.0579e-01-1.7297e-09j, 5.3539e-01+2.4634e-09j, 3.4552e-01+1.4480e-08j,
        1.2109e+00+2.6131e-08j, 3.8973e+00-6.1486e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2330706119537354-4.187338031869103e-09j)
SINR torch.Size([20]) = tensor([ -6.8017, -10.9911,  -5.4560, -13.7582,  -8.1708, -14.9464,  -7.9717,
        -11.4933,  -2.4101,  -6.9841, -25.5808, -15.5276, -18.4123,  -7.0857,
         -9.2376, -10.9690,  -9.0268, -12.8141,  -6.9277,  -3.3631],
       device='cuda:0')
SINR mean = -10.396400451660156
E[H^H] = 1e-07
E_MSE (Error Power) = 30.37013053894043
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1728, 0.0737, 0.2216, 0.0404, 0.1322, 0.0310, 0.1376, 0.0662, 0.3647,
        0.1668, 0.0028, 0.0272, 0.0142, 0.1636, 0.1065, 0.0741, 0.1112, 0.0497,
        0.1687, 0.3155], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 588,  716,  544,  790,  632,  820,  626,  730,  439,  594, 1000,  834,
         900,  598,  665,  715,  658,  765,  592,  472], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -2-----------
Real SNR = tensor([ -5.6250,   0.6734,  -2.9002,  -1.8529,  -2.2891,  -7.5993,  -5.6879,
         -3.7705,  -8.3768,  -1.5704,  -2.4260,  -8.0664,  -4.0206,  -1.3405,
         -0.9107,  -1.8443, -11.5072,  -4.5295,  -1.0812,  -0.3102],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 31.2981+3.0271e-06j,   9.6780+2.5952e-07j,  85.6766+3.0335e-06j,
         69.7230+9.5037e-07j, 620.0835+5.6998e-06j,  67.2611-5.7969e-06j,
        170.9638-1.8996e-06j,  46.2241-1.8120e-06j,  91.5908-1.9073e-06j,
        193.3122+1.6779e-06j,  11.7516-5.3716e-07j,  19.8434+6.5565e-07j,
         57.1816+5.7220e-06j,   9.9532+4.7684e-07j,  64.4282-9.7008e-07j,
        437.5896+9.5758e-06j, 232.4767+1.5233e-05j,  21.8445+8.7410e-07j,
         58.3304-3.1203e-07j,  57.0323-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(117.81212615966797+1.6975485550574376e-06j)
torch.linalg.det(H.mH@H) = tensor([ 1.6161+1.8324e-08j,  5.2499+3.6464e-08j,  0.7854-8.3668e-09j,
         2.2232+5.9605e-08j,  2.4081+2.1239e-08j,  0.0204-4.9491e-09j,
         0.4865-2.3151e-08j,  0.5696+9.1142e-08j,  0.0282-6.5193e-09j,
         7.2796-1.7922e-07j,  1.0623-3.6849e-08j,  0.6257-1.4901e-08j,
         2.8184-1.1921e-07j,  2.4661-2.0744e-07j,  2.0673-1.2066e-08j,
         0.1847-3.1194e-08j,  0.0206+5.1223e-09j,  0.1695+8.7170e-09j,
         2.7018+6.9875e-09j, 10.1595+6.0936e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1471335887908936-1.6765989485634236e-08j)
SINR torch.Size([20]) = tensor([ -6.1089,  -3.4126,  -9.1704,  -6.2226,  -6.4290, -20.0667,  -7.8438,
         -9.5126, -18.3612,  -1.8915,  -8.2350,  -8.2779,  -5.3721,  -4.8513,
         -7.1238, -14.5668, -18.4492, -13.3224,  -4.7911,  -0.2364],
       device='cuda:0')
SINR mean = -8.712267875671387
E[H^H] = 1e-07
E_MSE (Error Power) = 16.579381942749023
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1968, 0.3131, 0.1080, 0.1927, 0.1854, 0.0098, 0.1411, 0.1006, 0.0144,
        0.3928, 0.1305, 0.1294, 0.2250, 0.2466, 0.1624, 0.0338, 0.0141, 0.0445,
        0.2491, 0.4864], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([566, 474, 663, 569, 576, 935, 622, 673, 899, 421, 634, 635, 541, 523,
        599, 810, 901, 779, 521, 363], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -1-----------
Real SNR = tensor([  1.1581,  -6.2291,   0.4288,   1.6502,  -1.2024,  -0.9901,  -2.3514,
         -4.0927,  -0.3874,   2.3471,  -6.2197,  -6.4851, -12.5506,  -3.0403,
         -1.7224,  -5.2690,   1.2295,   2.0488, -10.4875,  -4.6510],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([8.9233e+01+7.5653e-07j, 4.8649e+02-1.7728e-06j, 1.6186e+02-9.9805e-07j,
        3.2317e+01-1.1190e-06j, 5.5198e+00-4.8650e-07j, 2.0462e+02-1.9929e-06j,
        2.1440e+02-5.1911e-07j, 1.1370e+02+9.1099e-07j, 4.3066e+02-1.0350e-05j,
        1.2435e+01+1.0795e-07j, 2.2569e+00+3.5763e-07j, 4.3792e-02+3.2041e-07j,
        2.1245e+01+6.2374e-07j, 9.6148e+00+4.7684e-07j, 1.3256e+01+1.6456e-06j,
        4.7258e+01+5.6732e-07j, 2.2945e+01-0.0000e+00j, 1.0628e+00-2.5393e-08j,
        4.0901e+01+1.4887e-06j, 1.0893e+01+1.7881e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(96.03531646728516-4.914835471936385e-07j)
torch.linalg.det(H.mH@H) = tensor([9.5154e-01+4.2595e-07j, 2.3407e-01+2.2352e-08j, 1.3182e-01+2.6077e-07j,
        6.0226e+00-3.1851e-08j, 8.9536e-01+3.8723e-08j, 4.5765e+00+6.7682e-09j,
        1.2861e-01-7.4506e-09j, 1.6066e+00+4.7487e-10j, 2.1057e+00+1.1920e-07j,
        1.4466e+01+2.7603e-08j, 5.3915e-01-1.3875e-09j, 1.8174e-01+7.1791e-09j,
        1.4372e-02+1.5484e-10j, 2.1623e-02-3.6322e-08j, 7.0138e-01-6.0022e-09j,
        1.5313e-02-5.8726e-09j, 3.2073e+00+1.6778e-07j, 4.3738e+00-4.5218e-08j,
        4.8015e-02-3.7253e-09j, 3.0173e-01-2.9730e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0261638164520264+4.546969734064987e-08j)
SINR torch.Size([20]) = tensor([ -9.5353, -10.0114, -18.4631,  -1.5515,  -7.1221,  -1.1673, -16.7056,
         -3.5390,  -3.8733,   1.0434,  -6.7765, -13.3026, -14.6039, -23.7609,
         -9.5286, -20.6979,  -3.6231,  -3.5540, -15.1606,  -8.8400],
       device='cuda:0')
SINR mean = -9.538664817810059
E[H^H] = 1e-07
E_MSE (Error Power) = 28.444555282592773
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1001, 0.0907, 0.0140, 0.4116, 0.1625, 0.4332, 0.0209, 0.3069, 0.2907,
        0.5598, 0.1736, 0.0447, 0.0335, 0.0042, 0.1003, 0.0084, 0.3027, 0.3061,
        0.0296, 0.1155], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 673,  687,  901,  409,  599,  395,  862,  478,  490,  319,  588,  778,
         811, 1000,  673,  948,  481,  479,  825,  653], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 0-----------
Real SNR = tensor([-3.7580, -3.5689, -1.5915, -0.2910, -0.8395,  1.7576, -0.8003, -3.4536,
        -1.7649, -0.0520, -2.1999, -6.3358,  1.8057, -1.8603, -1.4021, -4.4779,
        -0.4985,  0.5521, -5.7724, -2.4761], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 34.1361-5.2229e-07j,  10.6820-1.8579e-06j,  17.2680+3.5866e-08j,
          0.7798+4.4703e-08j,  11.8328-1.3072e-07j,  23.0401+2.3335e-06j,
         45.6369-9.3756e-07j,  28.7994-2.8861e-07j,  35.1666+1.1062e-07j,
        159.8403-1.3302e-06j,  29.4632+4.7684e-07j,   4.8122+8.9407e-07j,
         37.6828+4.0507e-06j, 134.1121+4.8018e-07j,  15.4112-1.7582e-07j,
          1.6587-5.9605e-08j,  38.3312+1.3571e-07j,  59.1912+6.3085e-07j,
         19.7931-8.5831e-06j,   6.4320-5.2023e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(35.703468322753906-2.606438442853687e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1346-8.6346e-09j, 1.2605-3.5016e-08j, 1.4952+3.1677e-08j,
        3.6915+5.0030e-08j, 2.2635+9.8390e-08j, 1.1139-2.9802e-08j,
        2.6485+7.4527e-08j, 0.4211-1.0432e-08j, 2.5614-8.6962e-08j,
        0.5083-1.9799e-08j, 4.1201+3.4421e-08j, 0.4939+1.0018e-08j,
        0.1474-6.8381e-08j, 0.1658-3.7253e-09j, 2.5451+2.3274e-08j,
        0.9497+6.4591e-09j, 3.6882-2.5783e-08j, 1.0568-1.4278e-08j,
        0.6570-3.0475e-09j, 0.6935+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.530805230140686+2.636900475749826e-09j)
SINR torch.Size([20]) = tensor([-11.1152,  -5.1336,  -3.6654,  -2.4645,  -4.0266,  -9.5427,  -1.7848,
         -6.8655,  -2.5560,  -8.1060,  -0.1776,  -5.7529, -14.8282, -13.9898,
         -2.4224,  -4.6503,  -1.2696,  -6.2865,  -5.9122,  -6.9471],
       device='cuda:0')
SINR mean = -5.874845027923584
E[H^H] = 1e-07
E_MSE (Error Power) = 6.044917106628418
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0718, 0.2347, 0.3007, 0.3618, 0.2835, 0.1000, 0.3987, 0.1707, 0.3570,
        0.1340, 0.4898, 0.2100, 0.0319, 0.0384, 0.3641, 0.2553, 0.4274, 0.1904,
        0.2040, 0.1680], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([719, 533, 483, 441, 495, 674, 417, 590, 444, 630, 361, 554, 817, 796,
        439, 517, 399, 572, 559, 593], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 1-----------
Real SNR = tensor([ 0.7036, -7.8987,  3.5411, -0.0795, -4.2262, -0.8151,  3.1070,  5.1429,
         4.2434,  1.8336,  1.9573,  0.4813, -0.6892,  2.5686, -3.0608, -2.1797,
         0.9222,  5.0064, -4.7031,  2.0666], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  9.2324-6.7609e-09j,   0.1830-1.4901e-07j,  59.1073+3.1196e-06j,
         27.4185-2.1277e-06j,   7.7828+1.3993e-06j,  92.8347-3.9806e-07j,
         79.2036+4.9259e-06j, 123.2738+4.1657e-06j,   9.5153-4.7684e-07j,
         26.1586+1.9073e-06j,  34.0919-7.6500e-07j,   5.6611+2.2712e-06j,
         67.5207+1.4596e-06j,  16.6885-1.4305e-06j,  83.3759+7.6294e-06j,
         16.3374-3.6955e-07j,   8.8842+3.8932e-08j,  22.9103-2.8610e-06j,
          6.1475+2.0387e-08j,  12.8722-2.3379e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(35.45998001098633+9.16478541057586e-07j)
torch.linalg.det(H.mH@H) = tensor([ 1.0531-1.1597e-07j,  0.0559+2.7940e-09j, 12.8406-1.3117e-07j,
         0.1506-5.2515e-08j,  0.3237+1.2849e-08j,  0.7228-6.5809e-09j,
         7.7087-1.1965e-07j,  5.2852-0.0000e+00j,  8.0210-1.4041e-07j,
         2.0450-2.9802e-07j,  6.7498+5.4510e-08j,  1.1410-1.8859e-08j,
         1.2798+2.4629e-08j,  1.4703+1.0040e-08j,  0.4773-5.5941e-09j,
         0.6786+1.1442e-07j,  3.5616+1.5457e-08j, 17.6149+1.1362e-07j,
         0.2939-9.1183e-10j,  1.3890-5.1829e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.6431527137756348-2.7327383023134644e-08j)
SINR torch.Size([20]) = tensor([ -4.6338, -11.1694,   2.7383, -12.6300,  -7.5636,  -4.6722,   1.5716,
         -2.8049,   1.2573,  -3.6821,   1.5734,  -4.2850,  -2.7090,  -3.9520,
         -5.1463,  -6.3494,  -0.6997,   3.7326,  -5.8379,  -3.3583],
       device='cuda:0')
SINR mean = -3.4310195446014404
E[H^H] = 1e-07
E_MSE (Error Power) = 3.3359620571136475
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2560, 0.0710, 0.6526, 0.0518, 0.1491, 0.2543, 0.5895, 0.3439, 0.5719,
        0.2999, 0.5896, 0.2716, 0.3489, 0.2870, 0.2342, 0.1882, 0.4598, 0.7026,
        0.2068, 0.3158], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([516, 721, 263, 761, 613, 517, 301, 453, 312, 483, 301, 504, 449, 493,
        533, 574, 379, 233, 557, 472], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 2-----------
Real SNR = tensor([ 4.2776e-01, -4.7323e+00,  2.2721e+00,  3.1999e-01, -2.6786e-01,
        -7.7642e-01,  4.0432e-04,  1.3808e+00,  8.4172e-02,  2.9549e+00,
         1.8968e+00, -1.2485e+00, -1.1802e+00,  3.6357e+00, -1.7081e-01,
         3.2141e+00,  1.6942e-02,  4.6820e+00,  8.5095e-01, -8.0841e-01],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.0355+9.8582e-08j, 17.7504+6.0100e-07j, 28.6132-0.0000e+00j,
         5.7237+8.6791e-08j,  5.1179-7.4507e-08j, 39.8889+9.5367e-07j,
         7.8426+1.9813e-07j,  7.0992-6.4815e-08j, 22.7811+8.8730e-07j,
         3.8413+3.7736e-08j, 22.6083-4.3452e-07j, 10.9444+1.0431e-06j,
         6.3947+4.7684e-07j, 16.4844-9.1705e-08j,  0.3453-4.6194e-07j,
         6.4806+7.1526e-07j, 25.8922-8.1399e-08j,  1.7864+1.6326e-06j,
        32.7246+2.8610e-06j, 12.8689-4.7684e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(13.861175537109375+3.9531587958663295e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1658+2.2690e-08j, 0.1124-3.7253e-09j, 2.2765-3.6339e-08j,
        1.7446-6.1657e-08j, 1.7519-2.9090e-08j, 1.6910-1.9238e-09j,
        0.9520-0.0000e+00j, 1.1511+2.8119e-08j, 0.1450-1.1907e-08j,
        4.1756-1.1033e-08j, 0.5794-2.9802e-08j, 2.2592+4.8494e-08j,
        0.7420+3.9883e-08j, 1.1071+1.0211e-08j, 0.1643+5.9605e-08j,
        7.2283-4.4325e-07j, 0.6499-6.0810e-10j, 0.4268-3.2873e-08j,
        3.3672-1.1921e-07j, 0.4558-1.4513e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5572956800460815-2.934667797660495e-08j)
SINR torch.Size([20]) = tensor([-10.9574,  -9.9971,  -1.5459,  -1.6038,  -1.3153,  -0.8839,  -3.2787,
         -3.1720,  -9.9437,   0.7110,  -7.8999,  -0.5720,  -5.1328,  -4.1976,
        -11.6404,   0.6159,  -4.1122, -11.9634,  -0.7327,  -5.0550],
       device='cuda:0')
SINR mean = -4.633839130401611
E[H^H] = 1e-07
E_MSE (Error Power) = 4.471726894378662
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0743, 0.0910, 0.4119, 0.4087, 0.4249, 0.4493, 0.3197, 0.3251, 0.0920,
        0.5408, 0.1396, 0.4671, 0.2347, 0.2756, 0.0641, 0.5354, 0.2795, 0.0598,
        0.4579, 0.2379], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([715, 687, 408, 410, 400, 385, 469, 465, 685, 330, 623, 374, 533, 501,
        734, 333, 498, 743, 380, 530], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 3-----------
Real SNR = tensor([ 5.6752,  0.9598,  0.5095,  5.4751,  3.3206, -1.2077,  5.4484,  2.2496,
         0.9712,  2.6027,  1.2878, -1.8901,  3.5619, -2.6348, -1.1730,  5.2519,
         2.7626,  2.4429, -0.1946,  6.6454], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.6743+1.1603e-07j, 10.8554-2.0117e-07j,  1.4295-1.1136e-07j,
         3.0909+8.1468e-07j,  0.1228-4.4098e-07j, 79.8304-1.8414e-07j,
        20.9901+1.8238e-07j, 16.7685+9.5367e-07j,  5.5349-2.9691e-08j,
        19.1178-2.6506e-07j, 16.0074-1.5087e-07j,  3.9293+2.3464e-09j,
        13.4069-8.0099e-09j, 10.6395+3.3785e-07j,  9.9637-2.4248e-07j,
        79.8969+1.7510e-07j, 12.2361-8.6674e-08j, 15.3383-1.1056e-07j,
         2.4906-5.9516e-08j, 14.2292+3.6840e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(16.877614974975586+5.2997894073314455e-08j)
torch.linalg.det(H.mH@H) = tensor([ 3.4983-2.3842e-07j,  2.3049-1.2306e-08j,  0.0402-1.0335e-08j,
         5.1406-1.1921e-07j,  1.1557-7.4506e-09j,  0.3055-7.7758e-09j,
         1.6899+1.1096e-08j,  1.2978-5.9605e-08j,  1.6774+5.9605e-08j,
         0.3508+6.1357e-08j,  0.6533+8.0928e-09j,  0.6879+1.8114e-08j,
         1.2218-2.0862e-07j,  0.1005+7.4506e-09j,  0.6366+1.1176e-08j,
        10.4833+5.2677e-07j,  1.1458-2.3280e-08j,  2.4192-8.8064e-08j,
         0.5378-2.5159e-09j,  0.2340-4.6566e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7790619134902954-2.6978424827461822e-08j)
SINR torch.Size([20]) = tensor([ -0.1277,  -0.4175, -15.7434,   1.2821,  -4.0023,  -5.7713,  -3.3303,
         -1.9114,  -0.8787,  -7.7853,  -2.3360,  -2.8457,  -4.6362, -10.6431,
         -5.2427,   3.4336,  -2.1337,   0.7955,  -2.8948, -12.9172],
       device='cuda:0')
SINR mean = -3.905303955078125
E[H^H] = 1e-07
E_MSE (Error Power) = 4.795461654663086
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4927, 0.4760, 0.0260, 0.5733, 0.2846, 0.2093, 0.3172, 0.3917, 0.4496,
        0.1428, 0.3687, 0.3418, 0.2559, 0.0794, 0.2302, 0.6880, 0.3796, 0.5457,
        0.3393, 0.0486], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([359, 369, 839, 311, 494, 554, 471, 421, 385, 620, 436, 454, 516, 706,
        537, 242, 429, 327, 456, 768], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 4-----------
Real SNR = tensor([ 1.9608,  2.4513,  0.0277,  2.9640,  1.7888, -0.1248, -0.4670,  5.2293,
         2.2796,  3.7993,  3.5837,  6.0841,  2.1980,  2.8153,  4.2149, -1.9152,
         5.9212,  4.8635,  1.5014,  5.7588], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.3883+1.9372e-07j, 70.6283-5.7220e-06j,  1.5835+1.5159e-07j,
         4.6497-0.0000e+00j,  2.1907+1.3610e-09j, 17.8044+9.5367e-07j,
         6.9040-3.7617e-09j, 14.2061-7.7607e-08j,  4.3100+2.3842e-07j,
        79.5569+1.3386e-06j, 18.4173-1.1921e-06j, 18.6917-6.4182e-08j,
         1.1550-0.0000e+00j,  2.3166+4.7684e-07j, 15.4892+1.4305e-06j,
        12.1529-1.7236e-07j, 62.7158-2.1828e-06j,  3.6158-8.8204e-08j,
         0.1511+1.1176e-08j, 56.1172+7.4568e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(19.652225494384766-1.9807407625194173e-07j)
torch.linalg.det(H.mH@H) = tensor([0.9988-8.9407e-08j, 1.4452-0.0000e+00j, 0.3644-2.9802e-08j,
        2.0226-3.2030e-08j, 0.6661-3.2687e-08j, 0.7255-2.2441e-08j,
        0.0462+3.7253e-09j, 0.3425-8.0094e-08j, 1.2895-1.8483e-08j,
        4.4674+3.8294e-08j, 2.6021-3.5361e-08j, 1.7800-4.2220e-08j,
        1.1638-4.1820e-10j, 0.0591-4.6566e-10j, 1.0370+1.9558e-08j,
        0.0549-8.2523e-09j, 0.6196-2.5286e-08j, 2.1905+1.4013e-07j,
        1.8990-5.6894e-08j, 5.5414+3.1236e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4657728672027588-1.204490995831975e-08j)
SINR torch.Size([20]) = tensor([ -1.8531,  -3.1373,  -3.6094,   1.3066,  -3.2223,  -0.3233, -12.8387,
         -8.1512,   0.5104,   3.6981,   1.1018,  -2.7910,   0.7006, -13.3095,
         -3.0503,  -8.8981,  -6.4428,   0.3245,   0.6287,   4.1719],
       device='cuda:0')
SINR mean = -2.759228467941284
E[H^H] = 1e-07
E_MSE (Error Power) = 3.6155617237091064
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3949, 0.3269, 0.3034, 0.5746, 0.3226, 0.4814, 0.0494, 0.1327, 0.5293,
        0.7009, 0.5631, 0.3446, 0.5402, 0.0446, 0.3313, 0.1142, 0.1849, 0.5187,
        0.5361, 0.7232], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([419, 464, 481, 310, 467, 366, 766, 631, 337, 234, 317, 452, 330, 778,
        461, 654, 577, 343, 333, 220], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 5-----------
Real SNR = tensor([ 4.9224,  4.3392,  5.2259,  1.8545,  6.6265,  2.6628,  1.2424,  6.8388,
        -0.5122,  7.8905,  3.5576, -0.5099,  3.8447,  4.0362,  6.3289, -0.3879,
         5.9252,  3.8483, -4.2867, -0.2733], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.0412e+01+6.0286e-08j, 4.5484e+01-2.3512e-07j, 5.7185e+00+1.0305e-07j,
        1.9535e+01-7.1537e-08j, 3.4418e-01-2.3204e-08j, 1.5908e+00-1.1921e-07j,
        2.9200e+01+1.4305e-06j, 1.2179e+02+2.9848e-07j, 6.4304e-01-0.0000e+00j,
        7.1066e+01-1.0635e-06j, 1.5144e+00+2.9802e-08j, 2.4630e+00+2.0705e-07j,
        3.4852e+00-8.6535e-08j, 1.1068e-01-1.3039e-08j, 2.0527e+00-1.7881e-07j,
        4.3024e+00-2.0350e-07j, 3.0222e+01-1.8102e-06j, 1.7038e+01+6.1605e-07j,
        2.9536e+00-5.3239e-09j, 3.4014e+00+5.5712e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(19.16620445251465-5.045245288215483e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3800-0.0000e+00j,  2.2058-3.7376e-08j,  1.3489-8.0989e-08j,
         0.2610+1.9392e-08j,  1.1831+1.6959e-08j,  0.9342+1.2856e-08j,
         0.7949+3.0731e-08j,  1.7713+1.6347e-07j,  0.8693+2.8381e-09j,
        23.6113-2.4284e-07j,  2.0954-1.2318e-07j,  0.1044-1.7740e-08j,
         2.5023+1.5865e-08j,  3.7710-3.9859e-08j,  7.4257+4.5680e-07j,
         0.0799-3.0944e-08j,  1.1363+2.7841e-08j,  2.1902+1.1918e-09j,
         0.2056-1.0170e-08j,  0.2380-2.6706e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.655425786972046+8.108215432400812e-09j)
SINR torch.Size([20]) = tensor([-5.7205,  2.1714, -0.6124, -5.1413, -1.1715, -0.3094,  0.3727, -0.2527,
         0.8304,  8.2568,  2.2688, -9.8097,  2.5702,  4.0007,  3.8164, -9.7181,
        -2.0426,  2.4496, -3.2279, -2.1069], device='cuda:0')
SINR mean = -0.6687999367713928
E[H^H] = 1e-07
E_MSE (Error Power) = 1.8581390380859375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2113, 0.6225, 0.4648, 0.2344, 0.4330, 0.4822, 0.5214, 0.4855, 0.5477,
        0.8700, 0.6277, 0.0946, 0.6438, 0.7153, 0.7066, 0.0964, 0.3845, 0.6374,
        0.3223, 0.3810], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([553, 281, 376, 533, 395, 365, 342, 363, 326, 119, 278, 682, 269, 225,
        230, 679, 426, 273, 467, 428], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 6-----------
Real SNR = tensor([ 2.6044,  5.9185,  3.7375, 10.8247,  4.4738,  1.6220,  6.2863,  3.7727,
         3.7434,  6.5324, -1.1865,  1.8424,  6.9179,  4.8030,  0.4067,  3.7474,
         1.1526,  6.1794,  1.1695,  7.3557], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.1915+1.2500e-08j,  8.1905-1.2380e-07j,  3.5995+2.1259e-07j,
         2.4501+1.0622e-06j,  2.4298-1.0384e-08j,  0.4748+1.4901e-08j,
        12.4272+6.4945e-09j, 10.9427+8.5914e-08j,  4.1071-0.0000e+00j,
         8.5503+3.9318e-07j,  7.3939+1.5188e-07j,  0.5003+8.9407e-08j,
        39.1426+5.1253e-07j, 14.2936+1.5761e-07j,  7.4241-4.7684e-07j,
         0.9058-2.9802e-07j,  1.2191+7.5901e-09j, 14.6636-0.0000e+00j,
         2.2636+1.1921e-07j,  8.8753-8.4547e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.602267742156982+9.161812641877987e-08j)
torch.linalg.det(H.mH@H) = tensor([0.5870+4.9044e-08j, 1.3690-4.2123e-08j, 0.1775-2.6786e-08j,
        1.8359+2.6189e-07j, 1.6969+2.0264e-08j, 0.4867-2.9802e-08j,
        1.1511+1.1053e-08j, 0.0476+4.1893e-09j, 0.6692-0.0000e+00j,
        2.1946+2.0862e-07j, 0.0774+9.8856e-10j, 0.0992+7.4970e-11j,
        9.6149-7.7827e-08j, 0.5046+3.8810e-08j, 0.2608+9.3132e-09j,
        0.1445+3.8177e-09j, 0.0099+5.1026e-09j, 4.5374-0.0000e+00j,
        0.5158+2.9802e-08j, 9.6980+7.5966e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7839033603668213+2.7119488876792275e-08j)
SINR torch.Size([20]) = tensor([ -3.4183,   1.8011,  -5.3744,  -2.0996,   3.4991,  -2.6166,   0.7146,
         -9.6847,  -1.5776,   0.2858,  -5.8710,  -5.0165,   7.3316,  -1.5194,
         -4.9424,  -5.6139, -16.5183,   3.8950,  -1.2316,   6.6892],
       device='cuda:0')
SINR mean = -2.0633866786956787
E[H^H] = 1e-07
E_MSE (Error Power) = 3.7833898067474365
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3128, 0.6022, 0.2249, 0.3814, 0.6912, 0.3538, 0.5410, 0.0971, 0.4102,
        0.5164, 0.2056, 0.2396, 0.8440, 0.4134, 0.2427, 0.2154, 0.0218, 0.7103,
        0.4296, 0.8235], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([474, 294, 541, 428, 240, 446, 330, 678, 409, 345, 558, 529, 139, 407,
        527, 549, 857, 228, 397, 154], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 7-----------
Real SNR = tensor([5.2635, 9.3253, 4.8664, 6.9083, 6.6961, 8.2591, 5.2788, 7.5972, 6.8118,
        9.8204, 4.4560, 7.5393, 5.2134, 6.7734, 8.1928, 4.3348, 3.8941, 4.6955,
        5.0683, 6.7893], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.6609-5.1383e-07j,  4.2428-6.2016e-09j,  2.3067-1.3591e-08j,
        15.1335+8.0568e-08j,  3.3832-2.3842e-07j, 18.6747+4.0052e-07j,
         4.0452+1.7537e-08j,  1.9912+1.7881e-07j,  0.4607-1.6274e-08j,
        34.9556-1.3182e-06j,  5.5116-2.3842e-07j,  6.3210-2.3842e-07j,
         3.0825-1.4057e-09j,  1.8403-2.3842e-07j, 15.6257-2.3703e-07j,
         7.9088-2.9817e-07j,  1.1306+5.2201e-07j,  0.1947+6.9290e-07j,
         2.1176-1.1674e-07j,  3.0570+5.4858e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.6322150230407715-7.639469856712822e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.8589+3.2619e-08j,  6.2150+1.6306e-08j,  1.3328-2.1380e-08j,
         2.7920-5.1304e-08j,  1.0194+4.1723e-07j, 12.4200-1.8331e-09j,
         1.1392-2.1045e-09j,  2.7591+5.9605e-08j,  1.6133+3.8529e-08j,
         3.4625+1.9578e-07j,  0.0585-1.6391e-07j,  0.2321+2.2352e-08j,
         2.4033-6.5334e-09j,  3.1348-4.0267e-08j,  1.0569-1.5223e-08j,
         0.2820-7.4331e-08j,  0.1543-7.4506e-09j,  0.8246-0.0000e+00j,
         1.3534+6.4732e-08j,  0.1108-1.5223e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.211153745651245+2.237938900861991e-08j)
SINR torch.Size([20]) = tensor([  4.5521,   6.7695,   3.3605,   4.4781,  -0.8378,   9.0313,   2.6380,
          3.8806,   3.7452,   3.5051, -11.2192,  -5.6610,   5.0881,   5.3846,
         -0.9811,  -5.3579,  -5.0007,   0.0204,   2.2253,  -8.4337],
       device='cuda:0')
SINR mean = 0.8593703508377075
E[H^H] = 1e-07
E_MSE (Error Power) = 1.8023761510849
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7404, 0.8262, 0.6843, 0.7371, 0.4519, 0.8889, 0.6474, 0.7096, 0.7032,
        0.6915, 0.0702, 0.2136, 0.7634, 0.7755, 0.4438, 0.2255, 0.2402, 0.5012,
        0.6254, 0.1254], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([209, 152, 244, 211, 384, 105, 267, 228, 232, 240, 722, 551, 194, 186,
        389, 541, 529, 354, 280, 640], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 8-----------
Real SNR = tensor([ 8.5368,  4.7281, 11.3535,  8.5978,  8.5073,  7.8379,  9.9714, 11.1092,
         8.1380,  9.8307,  5.4124, -0.0849,  8.6970,  3.4683, 11.0314,  6.3459,
         6.0394,  6.2479,  7.0187,  8.7377], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 9.2212+1.6245e-07j,  1.3921+2.9807e-08j, 60.1930-1.2665e-06j,
         3.3469+5.5489e-08j, 11.6623-8.1437e-08j,  4.4635+3.0105e-08j,
         4.4499+1.3123e-06j,  4.1302+1.7979e-07j, 39.4250+1.6633e-07j,
         6.6033-4.7684e-07j,  4.2076-6.7455e-08j,  0.4340-2.5358e-08j,
         1.5817+1.9240e-07j, 11.2231-1.7540e-07j,  0.6262+6.7605e-07j,
         5.6555-9.8424e-08j,  0.8026-4.0001e-08j,  2.4763+1.1667e-07j,
         4.9540-8.3765e-08j,  2.3212+1.0647e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.958475112915039+3.563030048781002e-08j)
torch.linalg.det(H.mH@H) = tensor([ 6.7849-1.0832e-07j,  0.2918-1.1676e-08j, 14.9927+2.0026e-07j,
         2.6034+1.1522e-07j,  4.1247-2.1031e-08j,  5.2616+1.0136e-08j,
         0.0673-3.0175e-07j,  6.5135+2.6752e-07j,  8.6973-2.6952e-07j,
         1.7828-1.4901e-08j,  1.2051-4.8912e-09j,  0.1059-9.0539e-10j,
         1.2206+4.0288e-08j,  0.2236+4.4562e-08j,  4.6814+1.2664e-07j,
         2.9182-1.7881e-07j,  0.4356-2.6435e-08j,  0.5087+2.4352e-08j,
         2.9095-1.2302e-07j,  0.0866+2.7107e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.270759344100952-1.0259354255026665e-08j)
SINR torch.Size([20]) = tensor([  7.6677,  -0.1015,   8.8618,   5.1941,   5.2223,   7.7663, -12.8690,
          6.8239,   8.2680,   2.4194,   4.2078,  -1.3984,   1.9823,  -1.9383,
          6.4176,   4.2096,  -0.4510,   0.2104,   6.0701,  -7.8635],
       device='cuda:0')
SINR mean = 2.5349748134613037
E[H^H] = 1e-07
E_MSE (Error Power) = 1.6322567462921143
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8539, 0.4942, 0.8850, 0.7678, 0.7690, 0.8567, 0.0491, 0.8280, 0.8703,
        0.6358, 0.7249, 0.4202, 0.6122, 0.3902, 0.8142, 0.7250, 0.4741, 0.5121,
        0.8018, 0.1406], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([132, 358, 108, 191, 191, 130, 767, 150, 119, 273, 219, 403, 288, 422,
        160, 219, 370, 347, 169, 622], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 9-----------
Real SNR = tensor([ 7.9287,  9.0336,  9.7392,  8.6763,  5.0342,  5.0254,  8.6705, 11.9825,
         6.7050,  4.3024,  5.1245,  8.4002,  7.0588,  6.6915,  2.1969,  6.3921,
         7.1116,  6.8444,  3.3474,  8.2479], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.7122+7.2449e-08j, 4.3077+2.3842e-07j, 8.2496-1.2622e-08j,
        2.7652+8.4208e-08j, 4.0519+3.8585e-08j, 0.1998-9.1459e-08j,
        8.2687-3.4099e-08j, 0.8973+2.8916e-07j, 3.0315-4.5534e-08j,
        0.1918+7.4506e-09j, 0.1754+6.9005e-09j, 0.1105-1.4529e-07j,
        0.1705+3.7253e-08j, 0.2775-3.1285e-08j, 3.2141+7.3689e-08j,
        0.5639+1.7608e-08j, 1.3030-2.1351e-08j, 2.2720+1.1921e-07j,
        0.0317-4.2841e-08j, 4.4103-5.6359e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.260221242904663+2.520468278532917e-08j)
torch.linalg.det(H.mH@H) = tensor([0.9807-6.1165e-09j, 3.6507-9.0072e-10j, 1.6610-8.5646e-08j,
        0.1651-5.8476e-09j, 1.1958+4.4875e-09j, 0.1375+3.3528e-08j,
        3.1629-1.5040e-08j, 5.6794+1.7453e-07j, 1.9565-5.9605e-08j,
        0.3700-0.0000e+00j, 0.4022-2.0546e-08j, 0.2543-1.5269e-08j,
        0.4321-4.4703e-08j, 0.2831-3.5852e-09j, 0.1616+5.8633e-09j,
        1.9349-2.9288e-08j, 2.6623-4.9967e-08j, 0.3929-1.4901e-07j,
        0.1006-3.7253e-09j, 0.4813+1.1687e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.303235411643982-1.2958014217190339e-08j)
SINR torch.Size([20]) = tensor([ 3.6108e+00,  7.4654e+00,  4.4534e+00, -4.7801e+00,  5.5766e+00,
        -4.2746e+00,  7.0486e+00,  8.1952e+00,  4.2772e+00,  1.3886e+00,
         1.3854e+00, -2.0504e+00, -1.2966e-01,  5.4994e-03, -1.3585e-01,
         5.8999e+00,  7.3555e+00, -1.3370e+00, -3.9352e+00,  5.7683e-01],
       device='cuda:0')
SINR mean = 2.0298030376434326
E[H^H] = 1e-07
E_MSE (Error Power) = 0.8882705569267273
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6967, 0.8480, 0.7360, 0.2496, 0.7831, 0.2720, 0.8352, 0.8684, 0.7281,
        0.5793, 0.5791, 0.3841, 0.4925, 0.5003, 0.4922, 0.7955, 0.8447, 0.4236,
        0.2878, 0.5332], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([236, 136, 212, 521, 181, 504, 145, 121, 217, 307, 307, 426, 359, 354,
        359, 173, 138, 401, 492, 335], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 10-----------
Real SNR = tensor([ 6.4842, 10.3947,  8.8352,  2.3421,  7.3443,  8.5256,  8.7519, 11.3419,
         8.9657,  6.4339,  6.4114,  3.8551,  5.9647,  7.1813,  9.1860, 11.6857,
        10.5049,  9.0649,  5.8895, 10.8309], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.2691+5.8786e-09j,  2.4834+3.5763e-07j,  2.3379-2.9802e-08j,
         0.1031+8.2545e-11j,  3.0098-2.3842e-07j,  3.1182-1.1921e-07j,
         4.6070+2.1926e-08j, 23.0891+1.6766e-07j,  2.8284-1.1921e-07j,
         0.3884-1.6553e-08j,  0.1828-9.6858e-08j,  0.2646-2.7930e-09j,
         0.6286+9.2234e-09j,  4.8444+3.8901e-08j, 17.7986-5.2355e-07j,
         4.3008+1.2529e-07j,  1.2196+2.9625e-07j,  0.2566-1.5393e-07j,
         0.7595-3.1359e-08j,  7.3905+1.2354e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.044018745422363-9.26564247549777e-09j)
torch.linalg.det(H.mH@H) = tensor([0.5738+6.1279e-09j, 0.3421+4.0869e-08j, 1.7873+1.4819e-08j,
        0.0109+2.4585e-09j, 0.2488+5.2279e-10j, 2.3406-0.0000e+00j,
        2.4265-2.2026e-09j, 4.6105-3.0279e-08j, 2.6473-0.0000e+00j,
        0.1813-1.0841e-09j, 0.5795-2.1874e-08j, 0.3357-2.5375e-09j,
        1.6932-1.2698e-08j, 0.5247+2.9802e-08j, 2.4142-2.6822e-07j,
        6.9328-1.5955e-08j, 1.3856-1.2019e-07j, 2.1725+2.3842e-07j,
        0.5409+9.8985e-09j, 4.6631-1.0873e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.820561408996582-1.2042778330112469e-08j)
SINR torch.Size([20]) = tensor([ 4.5572, -0.5589,  6.6362, -7.8214,  1.2987,  6.6402,  8.1123,  8.6992,
         6.7404,  0.9075,  3.0642,  2.9847,  7.1064,  1.7229,  5.4734,  9.6693,
         4.3562,  6.5660,  3.7794,  9.5783], device='cuda:0')
SINR mean = 4.475602626800537
E[H^H] = 1e-07
E_MSE (Error Power) = 0.6222668886184692
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7406, 0.4679, 0.8217, 0.1417, 0.5742, 0.8219, 0.8662, 0.8811, 0.8252,
        0.5520, 0.6694, 0.6654, 0.8370, 0.5979, 0.7791, 0.9026, 0.7317, 0.8193,
        0.7048, 0.9007], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([209, 374, 155, 621, 310, 155, 122, 111, 152, 323, 253, 256, 144, 296,
        184,  94, 215, 156, 231,  95], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 11-----------
Real SNR = tensor([11.1925,  5.6675,  5.3770, 12.9627, 10.4272, 10.3025,  9.8984, 10.9452,
         2.7046,  6.8135,  7.6174, 10.4579, 10.9114, 12.0345, 14.1460, 13.1484,
         6.2574,  4.5631,  4.6396, 11.0864], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.3982-2.3842e-07j,  1.4798-5.7592e-09j,  2.6584-3.4817e-09j,
         2.9534-1.5852e-07j,  0.7004-6.3591e-10j,  5.4498-3.4075e-08j,
         0.7769+2.3842e-07j,  0.5823-5.0512e-09j,  0.7141-6.4554e-09j,
         1.2374+5.1178e-09j,  3.4055+8.4546e-09j,  0.5558+1.1921e-07j,
        27.2952+2.4178e-07j,  9.4392-2.5034e-07j,  1.8772+1.5081e-07j,
         0.7836-4.3005e-07j,  1.9530-1.1921e-07j,  0.5320-1.1176e-08j,
         1.4856+3.1909e-08j,  0.6815+1.5220e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.4479775428771973-2.2612869798877e-08j)
torch.linalg.det(H.mH@H) = tensor([4.4971-0.0000e+00j, 0.8952+1.5909e-08j, 0.1794-0.0000e+00j,
        3.4637-3.8766e-07j, 1.1531+8.8435e-08j, 2.2548+6.6607e-08j,
        0.1612+5.5879e-08j, 0.4571-1.5020e-08j, 0.0688+1.5212e-09j,
        0.4956-3.8815e-09j, 0.9700-1.5678e-08j, 1.6893+3.0134e-08j,
        3.0974-3.5763e-07j, 6.8015-1.4278e-07j, 1.9862-3.0211e-07j,
        0.4591+3.1893e-07j, 0.1789+5.5879e-09j, 0.2418+1.3539e-09j,
        0.8552-4.3396e-09j, 3.1902+2.1079e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6547825336456299-2.1697706742429546e-08j)
SINR torch.Size([20]) = tensor([ 8.2996,  7.1754,  1.6234,  7.8556,  5.0528,  9.2840, -2.9424,  1.3721,
        -0.5203,  5.6233,  6.1116,  6.8415,  8.2677, 10.9959,  3.8876, -1.4592,
         0.2481,  3.2425,  5.7637,  8.8602], device='cuda:0')
SINR mean = 4.7791523933410645
E[H^H] = 1e-07
E_MSE (Error Power) = 0.45904847979545593
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8711, 0.8392, 0.5924, 0.8592, 0.7620, 0.8945, 0.3368, 0.5783, 0.4701,
        0.7850, 0.8033, 0.8285, 0.8703, 0.9263, 0.7100, 0.4168, 0.5143, 0.6784,
        0.7904, 0.8849], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([119, 142, 299, 128, 195, 100, 457, 308, 372, 180, 168, 150, 119,  74,
        228, 405, 346, 248, 176, 108], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 12-----------
Real SNR = tensor([ 8.9213, 11.4233,  9.0429, 10.4970, 11.1619, 12.8583, 15.7330,  8.9184,
         8.8686, 10.6528, 10.7451,  9.2020, 13.0543, 11.2575, 11.8937,  7.0899,
         9.6696, 11.3692,  8.2981, 12.4289], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.2954-1.5898e-08j,  0.9262+1.7386e-08j,  0.1028-1.1642e-10j,
         3.3271-3.5664e-08j,  0.1333-2.9802e-08j,  1.2396-1.4761e-07j,
         5.1769+2.8791e-07j,  0.5198-7.8722e-09j,  1.0816-1.6342e-08j,
         1.1851-2.0673e-08j,  1.9339+1.0987e-08j,  1.2480+1.3796e-09j,
         2.8975+8.6988e-08j,  3.0904+5.2801e-09j,  3.9433-1.9471e-07j,
         1.9974-7.7068e-08j,  0.1757-1.4639e-09j,  1.5611-3.1679e-08j,
         0.0438-3.6356e-07j, 10.5348+5.7023e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1206817626953125+1.8853043570743466e-09j)
torch.linalg.det(H.mH@H) = tensor([0.8591+4.3306e-09j, 1.2575-8.3008e-09j, 0.8371+1.7600e-08j,
        1.9885-1.6348e-08j, 1.3619-5.9605e-08j, 0.3741+4.5568e-08j,
        2.2006-1.2813e-06j, 0.1003+1.5681e-08j, 1.2954-2.1937e-08j,
        0.1715-1.6764e-08j, 2.0139-4.3839e-09j, 2.1754+8.7683e-08j,
        4.0408+6.7494e-08j, 2.9829-1.5401e-08j, 2.0121-3.8116e-08j,
        0.5725+1.1177e-08j, 0.6272-1.6860e-08j, 3.3999-5.9864e-08j,
        0.7983-0.0000e+00j, 4.0622+1.0701e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6565601825714111-6.393189977416114e-08j)
SINR torch.Size([20]) = tensor([ 7.6641,  8.0055,  6.9007,  9.7686,  5.6970,  0.8710,  4.4211, -0.6722,
         8.3171,  0.2853,  9.3814,  7.9595, 11.1228, 10.7512,  9.0383,  5.3305,
         5.6544, 10.3423,  5.5750, 11.7969], device='cuda:0')
SINR mean = 6.910520076751709
E[H^H] = 1e-07
E_MSE (Error Power) = 0.274382621049881
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8538, 0.8633, 0.8305, 0.9046, 0.7878, 0.5500, 0.7346, 0.4614, 0.8716,
        0.5164, 0.8966, 0.8621, 0.9283, 0.9224, 0.8891, 0.7734, 0.7862, 0.9154,
        0.7831, 0.9380], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([132, 125, 149,  92, 178, 325, 213, 378, 118, 345,  99, 125,  72,  77,
        105, 188, 179,  83, 181,  63], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 13-----------
Real SNR = tensor([11.1700, 13.4435, 12.9118, 13.8321, 12.4363, 14.4990, 12.0102,  8.7790,
        12.1716, 14.8915,  4.9358, 11.3813,  9.8117, 11.5160, 13.4252,  7.4408,
        13.2466, 11.5105, 12.1570, 14.1054], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.5572+2.9802e-08j, 1.6340+1.2371e-08j, 2.2369+1.4221e-07j,
        3.4030+9.5367e-07j, 2.1918+5.8726e-08j, 8.2580-8.7174e-08j,
        0.2214-2.5522e-08j, 0.5890-3.8559e-08j, 0.9754+8.9407e-07j,
        5.3869-4.2478e-09j, 0.0680+4.9366e-10j, 2.9458-1.2177e-08j,
        0.1984+1.4901e-07j, 2.0625+7.5668e-08j, 4.0451-1.9547e-08j,
        0.1067-9.3132e-10j, 1.2483+5.9605e-08j, 7.6894-1.0991e-07j,
        1.3035-2.2697e-08j, 6.8257+5.2286e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.5973541736602783+1.0535802630329272e-07j)
torch.linalg.det(H.mH@H) = tensor([0.6752-5.1354e-08j, 0.2246-6.8782e-10j, 0.3180+2.3842e-07j,
        1.6513+1.4339e-08j, 1.8264-1.0712e-08j, 4.0598-3.6821e-08j,
        1.3382+2.7775e-08j, 0.1041+3.5566e-09j, 0.3824-1.0431e-07j,
        5.6861-2.3766e-08j, 0.2492-3.6976e-09j, 3.1694+8.9760e-09j,
        0.3895+2.2352e-08j, 0.0633-1.0927e-08j, 3.4454-1.5130e-08j,
        0.2619-2.1163e-10j, 2.4824+6.0672e-09j, 2.5175-1.8160e-09j,
        0.3968+6.4318e-08j, 6.7067-1.1174e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7974210977554321+5.759913879188616e-09j)
SINR torch.Size([20]) = tensor([ 6.8993,  2.4596,  1.7694,  7.8057,  9.6185, 11.6557,  8.0187,  1.7205,
         1.1003, 12.3939,  5.4460, 11.0567,  4.0982, -3.9178, 11.3896,  5.0683,
         9.1946, 11.7775,  2.7683, 13.1072], device='cuda:0')
SINR mean = 6.671513557434082
E[H^H] = 1e-07
E_MSE (Error Power) = 0.36993202567100525
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8304, 0.6379, 0.6005, 0.8578, 0.9016, 0.9361, 0.8637, 0.5978, 0.5630,
        0.9455, 0.7780, 0.9273, 0.7198, 0.2886, 0.9323, 0.7626, 0.8926, 0.9377,
        0.6542, 0.9534], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([149, 272, 295, 129,  95,  65, 124, 296, 317,  56, 185,  73, 222, 491,
         68, 195, 102,  63, 262,  49], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 14-----------
Real SNR = tensor([10.8669, 10.3117, 12.4432, 17.5825,  8.5932, 11.6642, 12.5129, 14.2017,
        11.6785, 14.3076, 13.0032,  3.9511,  4.2838,  9.2117, 10.2569, 12.5759,
        11.7814,  6.4041, 11.6096, 11.5576], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.6004e+00-4.8643e-08j, 1.6612e+00+2.7772e-08j, 4.0641e-01-2.7884e-09j,
        7.7942e+00-2.9346e-08j, 1.7877e+00-2.6819e-08j, 3.4438e+00-1.9325e-08j,
        4.3577e+00-0.0000e+00j, 4.4034e-01+7.4506e-08j, 1.0140e+00+3.3982e-08j,
        3.0705e+00+5.1598e-08j, 3.1196e-01-9.1602e-09j, 1.3782e-04+7.5161e-09j,
        3.2705e-02-2.7236e-09j, 8.1774e-01-1.7169e-08j, 1.6404e+00+1.0360e-07j,
        3.5095e+00+1.3828e-08j, 1.4613e+00-1.8140e-08j, 5.6297e-04-1.0768e-09j,
        1.5454e+00-2.0003e-08j, 2.6404e-01+2.4304e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.0079965591430664+5.892728527356894e-09j)
torch.linalg.det(H.mH@H) = tensor([1.2165+2.6272e-08j, 0.7564-7.6228e-08j, 0.2261-4.0868e-08j,
        2.1067-5.5997e-09j, 0.5784-1.0267e-08j, 1.8643-2.4103e-08j,
        3.1489+5.0893e-08j, 2.8261-1.1921e-07j, 0.4298-1.0431e-07j,
        1.7201-9.9582e-09j, 0.4998+1.7154e-08j, 0.0530-0.0000e+00j,
        0.0148-7.9162e-09j, 0.4083+5.3378e-09j, 0.5820+1.5270e-08j,
        4.2231-2.5114e-08j, 1.8449+2.3139e-08j, 0.1599-1.3464e-09j,
        1.3560+3.4989e-08j, 0.0989-2.0457e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2056870460510254-1.3616005212213622e-08j)
SINR torch.Size([20]) = tensor([10.0934,  7.4755,  1.6742,  8.9105,  9.1814, 10.6620, 11.8561, 10.4200,
         5.9341, 10.4742,  5.5949,  1.4639, -4.8254,  8.2929,  6.9469, 13.1038,
        11.1194,  6.2983,  9.4395,  1.0619], device='cuda:0')
SINR mean = 7.258892059326172
E[H^H] = 1e-07
E_MSE (Error Power) = 0.3551589548587799
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9109, 0.8483, 0.5952, 0.8861, 0.8923, 0.9209, 0.9388, 0.9168, 0.7968,
        0.9177, 0.7839, 0.5835, 0.2477, 0.8710, 0.8320, 0.9533, 0.9283, 0.8100,
        0.8978, 0.5608], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 87, 136, 298, 107, 102,  78,  62,  82, 172,  81, 181, 305, 523, 119,
        148,  49,  72, 163,  98, 318], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 15-----------
Real SNR = tensor([10.4187, 14.2421,  9.1398, 11.4123, 14.0889, 13.6715, 17.1165, 16.4252,
        11.0295, 16.8008, 11.4786, 13.8467, 16.1666, 13.6702, 21.1270, 11.3288,
        18.0671, 12.8740, 10.9149, 13.2675], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.8678e-01+8.9407e-08j, 9.6070e-01-6.0545e-09j, 4.8436e-01+3.8449e-08j,
        2.8863e-01-0.0000e+00j, 2.6755e+00-9.4652e-08j, 5.0762e-01-7.4506e-09j,
        2.1640e+00-2.3842e-07j, 2.4548e+00+4.7684e-07j, 7.7349e-01+2.4123e-09j,
        4.1088e+00+3.5751e-08j, 8.1809e-03+6.0536e-09j, 9.7744e-01+2.1635e-09j,
        7.7632e+00-3.5597e-09j, 4.4268e-01-1.1906e-08j, 3.4535e+00-2.6728e-07j,
        2.0421e-01-3.8596e-09j, 9.1656e+00-3.0796e-08j, 1.0720e+00-1.8626e-08j,
        2.0278e-02-0.0000e+00j, 2.0244e+00-8.8844e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.001814603805542-2.0209469653309498e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.3109-1.0245e-08j,  0.4903+6.1899e-09j,  0.4733-3.6592e-09j,
         0.3004-0.0000e+00j,  2.0579-1.3411e-07j,  1.7434+3.9784e-08j,
         4.1304-1.1921e-07j,  2.1510-0.0000e+00j,  1.0383+4.7111e-09j,
         3.3051-3.4923e-08j,  0.8891-2.1071e-08j,  0.2601+4.0217e-08j,
         8.5619+1.3532e-08j,  0.1350+1.4948e-08j,  4.3033-3.8801e-07j,
         0.9328+1.4671e-08j, 10.2684-8.7690e-08j,  1.0003-2.9802e-08j,
         0.1115-3.7253e-08j,  0.6103+9.2742e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1536781787872314-3.613240551203489e-08j)
SINR torch.Size([20]) = tensor([ 6.6685,  7.2160,  8.6329,  6.0849, 11.1734, 11.9466, 10.7837,  9.8422,
        10.4543, 12.8036, 11.1695,  2.8586, 16.6169,  2.3396, 10.1522,  9.8008,
        16.0637,  8.4928, -0.5164,  9.2507], device='cuda:0')
SINR mean = 9.091723442077637
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1908421367406845
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8228, 0.8404, 0.8795, 0.8024, 0.9291, 0.9400, 0.9229, 0.9060, 0.9174,
        0.9502, 0.9290, 0.6589, 0.9787, 0.6315, 0.9119, 0.9052, 0.9758, 0.8760,
        0.4703, 0.8938], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([154, 141, 112, 168,  71,  61,  76,  91,  81,  52,  71, 260,  23, 276,
         86,  92,  26, 115, 372, 101], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 16-----------
Real SNR = tensor([15.3238, 11.0356, 18.4238, 14.9988, 11.9992, 16.4101, 14.4702, 15.4134,
        15.3702,  9.0198, 13.6656, 18.5850, 16.5313, 18.6271, 16.1443, 16.6598,
        14.9588, 10.6798, 15.4761, 10.9481], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2522+4.4520e-09j,  0.2448+2.9802e-08j,  4.9777-1.7354e-07j,
         0.7770-2.0763e-07j,  0.3625-1.3126e-08j,  1.1170-0.0000e+00j,
         1.5219-2.3073e-09j,  0.4576+5.6144e-08j,  7.7045+7.5152e-08j,
         0.2752+7.4506e-08j,  2.1906-1.5819e-09j,  4.1882+1.1921e-07j,
         0.4721+2.8055e-09j, 11.5990+8.7111e-09j,  4.2095-3.8591e-07j,
         4.2697+3.4767e-08j,  3.3424-1.5531e-08j,  0.9943-1.6747e-09j,
         7.5849+1.7999e-07j,  0.0980-3.3336e-11j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8319594860076904-1.0788967053088072e-08j)
torch.linalg.det(H.mH@H) = tensor([0.7038+1.6909e-08j, 0.1445-2.2352e-08j, 4.7723+9.0576e-08j,
        1.6812+4.1482e-08j, 0.3490+1.1373e-09j, 3.3133+1.4875e-07j,
        1.2265-9.4626e-09j, 0.4988+9.2122e-09j, 3.8372+5.9385e-08j,
        0.0207+1.8626e-09j, 2.0382+1.1055e-09j, 6.0615+9.0469e-08j,
        0.6043-4.4051e-10j, 5.8365-8.7808e-09j, 7.2846+3.6938e-07j,
        2.3748+1.6740e-07j, 3.2882+4.9068e-08j, 0.1363-1.3339e-09j,
        4.5801+1.5943e-07j, 0.0306+4.0910e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.439117908477783+5.8209945308362876e-08j)
SINR torch.Size([20]) = tensor([10.4591,  4.5995, 14.6308, 11.8053,  8.6869, 14.5324, 11.9825,  7.6561,
        15.6170, -4.5019, 14.0711, 14.7861,  8.4836, 15.7687, 15.1113, 11.5924,
        14.3476,  6.0556, 14.4755,  1.3821], device='cuda:0')
SINR mean = 10.577072143554688
E[H^H] = 1e-07
E_MSE (Error Power) = 0.24081860482692719
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9175, 0.7425, 0.9667, 0.9381, 0.8808, 0.9660, 0.9404, 0.8536, 0.9733,
        0.2618, 0.9623, 0.9678, 0.8758, 0.9742, 0.9701, 0.9352, 0.9646, 0.8013,
        0.9655, 0.5789], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 81, 208,  36,  63, 111,  36,  61, 132,  29, 512,  40,  35, 115,  28,
         32,  66,  38, 169,  37, 307], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 17-----------
Real SNR = tensor([18.9395, 17.3503, 13.1425, 15.3422, 12.5527, 17.2839, 17.7915, 14.1048,
        18.4241, 19.8670, 14.9460, 13.4010, 16.9797, 17.2820, 14.0496, 16.3053,
        19.6152, 22.3242, 11.9514, 17.2764], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([8.6189-5.1853e-09j, 0.9918-3.2271e-07j, 1.2492+1.4045e-08j,
        0.9035+4.8240e-08j, 0.0500+5.0291e-08j, 4.3111+1.0311e-07j,
        5.0935-5.0730e-08j, 0.3792+3.7253e-08j, 1.8296+1.0772e-08j,
        1.3671-3.3549e-08j, 1.1121-2.2393e-08j, 1.5961-1.0394e-08j,
        5.4258+2.3842e-07j, 6.1100-2.0433e-08j, 3.0903-2.6379e-08j,
        0.5892+2.4431e-09j, 8.0121-4.7684e-07j, 6.5131+5.6940e-09j,
        0.8592+3.2715e-08j, 0.9794-5.1180e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.954056978225708-2.38403696783962e-08j)
torch.linalg.det(H.mH@H) = tensor([10.2455+1.3640e-08j,  0.6962-1.3536e-07j,  1.1762-1.5940e-08j,
         0.3139+6.5281e-09j,  0.1839+8.1956e-08j,  3.7224-4.5452e-09j,
         3.5171-8.5358e-08j,  0.1247+7.4506e-09j,  0.7025-9.9198e-09j,
         2.0670+1.1612e-07j,  0.8056-1.7881e-07j,  0.9213-2.2197e-08j,
         3.6353-5.9605e-08j,  2.1265+5.4723e-09j,  2.6216-2.6178e-08j,
         0.6768-2.7790e-08j, 10.5690-4.0110e-08j, 17.1643+5.1558e-07j,
         0.3761-3.7496e-09j,  2.0093+9.7199e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.1827573776245117+1.1719069270554883e-08j)
SINR torch.Size([20]) = tensor([19.1831,  9.6570, 13.4427,  5.4872,  5.1353, 15.2337, 15.0598,  2.9005,
         8.8659, 13.0039, 10.7391, 10.6885, 14.4081, 14.7294, 14.8578,  9.3153,
        17.5687, 17.8848,  7.6407, 13.2235], device='cuda:0')
SINR mean = 11.951252937316895
E[H^H] = 1e-07
E_MSE (Error Power) = 0.10096269845962524
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9881, 0.9023, 0.9567, 0.7796, 0.7654, 0.9709, 0.9698, 0.6610, 0.8851,
        0.9523, 0.9222, 0.9214, 0.9650, 0.9674, 0.9684, 0.8952, 0.9828, 0.9840,
        0.8531, 0.9546], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 13,  94,  46, 184, 193,  31,  33, 258, 108,  50,  77,  78,  37,  35,
         34, 100,  19,  18, 132,  48], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 18-----------
Real SNR = tensor([15.5412, 18.7725, 13.5686, 15.6853, 17.5496, 13.2082, 16.7875, 16.8582,
        20.8080, 15.9700, 17.8502, 13.7428, 13.1963, 18.1901, 21.2483, 20.4113,
        17.2742, 15.9555, 19.3997, 17.0293], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.7857-5.6680e-09j,  6.1604+1.1292e-07j,  0.3401-2.1279e-09j,
         0.2032+3.0200e-08j,  0.1032+2.7940e-09j,  1.0846+5.6869e-10j,
         2.0495+4.6764e-08j,  0.6770-2.9802e-08j, 12.7605-8.3998e-08j,
         1.0181+2.9698e-09j,  0.1394+8.1956e-08j,  1.1925+1.4901e-08j,
         0.5442+3.5475e-10j,  1.5519-1.2259e-07j,  1.7864-6.8060e-08j,
         4.3798-1.6359e-07j,  4.3508+1.6513e-08j,  0.2508+5.2154e-08j,
         1.8124+2.8723e-08j,  1.5599-7.1856e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.137519359588623-7.843599547641134e-09j)
torch.linalg.det(H.mH@H) = tensor([0.5362+1.0961e-08j, 3.5556+1.3371e-08j, 0.3190+3.7680e-09j,
        0.0517-8.2503e-08j, 0.0742+1.6764e-08j, 0.4617-4.0426e-10j,
        1.6451+1.1739e-08j, 1.8567-0.0000e+00j, 7.5039-4.2394e-08j,
        1.3230+1.8806e-08j, 0.4960-4.4703e-08j, 0.9195-1.4901e-08j,
        0.3738-3.7405e-09j, 1.5737-1.4736e-07j, 4.3868-2.6253e-08j,
        2.9257-1.4977e-07j, 3.3665+1.1158e-08j, 0.2113+4.0978e-08j,
        1.3802+4.5573e-08j, 1.7057-2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7333214282989502-1.84358608379398e-08j)
SINR torch.Size([20]) = tensor([11.7388, 16.3703, 11.2879,  2.0671, -1.5694, 11.9301, 14.4669, 14.3027,
        18.6941, 14.6758,  8.1687, 11.4082, 11.0869, 13.3961, 16.2265, 15.0882,
        16.6354,  5.6715, 12.7964, 14.4035], device='cuda:0')
SINR mean = 11.94229507446289
E[H^H] = 1e-07
E_MSE (Error Power) = 0.14851926267147064
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9372, 0.9775, 0.9308, 0.6168, 0.4106, 0.9397, 0.9655, 0.9642, 0.9867,
        0.9670, 0.8677, 0.9326, 0.9278, 0.9563, 0.9767, 0.9699, 0.9788, 0.7868,
        0.9501, 0.9650], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 64,  25,  70, 285, 409,  62,  37,  38,  15,  35, 121,  68,  72,  46,
         25,  32,  23, 179,  52,  37], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 19-----------
Real SNR = tensor([17.8400, 17.5916, 19.5614, 17.7243, 17.2786, 18.0456, 21.6787, 16.7182,
        19.8812, 16.6051, 16.0645, 17.0721, 14.4159, 23.1786, 18.0925, 16.3160,
        16.6787, 18.0672, 14.4949, 17.0168], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.6650+6.7134e-08j,  4.3275-4.6233e-08j,  1.2080-1.7881e-07j,
         0.1367-4.6517e-09j,  0.9998+1.5647e-08j,  1.1593+2.9802e-07j,
         2.4942-2.3516e-07j,  2.0268+1.0706e-08j,  1.0602-1.2325e-07j,
         0.5656-4.0899e-09j,  0.8547-2.9802e-08j,  4.3280-1.1921e-07j,
         0.3570+1.0373e-08j, 24.2227-1.4940e-07j,  1.5382+2.3842e-07j,
         0.3840+3.7253e-09j,  0.6737-1.4013e-09j,  0.6491-4.4703e-08j,
         0.7037+7.5463e-09j,  0.5312-7.3617e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.5942745208740234-1.4625229027842579e-08j)
torch.linalg.det(H.mH@H) = tensor([ 4.0165-3.0855e-08j,  2.4696+1.6037e-08j,  0.7613+8.9407e-08j,
         0.1330+6.9559e-08j,  2.0873-2.4639e-08j,  1.2359+2.9802e-08j,
         2.0787-2.9868e-08j,  1.3667+2.1889e-08j,  1.8383-6.6152e-08j,
         1.7350-2.2831e-08j,  1.2441-9.8937e-09j,  1.2264-0.0000e+00j,
         0.1203+1.2920e-09j, 25.7461+3.7850e-07j,  1.4965-0.0000e+00j,
         0.2302+2.6077e-08j,  1.1122+2.8424e-08j,  0.1045+3.7253e-09j,
         0.3246-7.2586e-10j,  0.7179+1.0031e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.502256155014038+2.4489006378303202e-08j)
SINR torch.Size([20]) = tensor([18.1841, 15.7463,  9.9007,  5.0827, 15.7472, 13.5735, 13.6888, 16.1068,
        15.1138, 14.8657, 15.1695, 11.6491,  6.0948, 22.7656, 13.9159,  7.0890,
        15.4437,  3.6134, 12.3300, 13.3995], device='cuda:0')
SINR mean = 12.97400188446045
E[H^H] = 1e-07
E_MSE (Error Power) = 0.08549866080284119
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9850, 0.9741, 0.9072, 0.7632, 0.9741, 0.9579, 0.9590, 0.9761, 0.9701,
        0.9684, 0.9705, 0.9360, 0.8027, 0.9947, 0.9610, 0.8365, 0.9722, 0.6968,
        0.9448, 0.9563], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 16,  28,  90, 194,  28,  44,  43,  26,  32,  34,  32,  65, 168,   6,
         41, 144,  30, 236,  57,  46], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 20-----------
Real SNR = tensor([21.2375, 18.0527, 18.5594, 18.6879, 21.4878, 18.4642, 16.0849, 18.1754,
        20.8966, 19.9981, 21.9223, 19.6761, 15.5512, 20.0737, 17.2204, 19.1816,
        19.6822, 19.8435, 22.1805, 19.5219], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.6497-2.9464e-08j, 1.1129-0.0000e+00j, 1.2317-3.1917e-10j,
        3.9490+4.7684e-07j, 3.0694+1.4694e-07j, 0.8548+1.1921e-07j,
        0.2164+2.2883e-08j, 1.5765+6.4328e-09j, 2.2850+1.5491e-07j,
        2.8571+2.3248e-09j, 7.7943+3.8828e-09j, 6.5516-8.0492e-08j,
        0.5858+1.4898e-09j, 4.6174+4.7342e-08j, 0.6565+7.4506e-08j,
        1.4378+1.1037e-08j, 4.2565-1.1921e-07j, 0.9732-9.9923e-08j,
        1.4153-1.0814e-08j, 1.6042-1.6261e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.5347602367401123+2.824837785908585e-08j)
torch.linalg.det(H.mH@H) = tensor([2.7434-2.3842e-07j, 0.5816-0.0000e+00j, 0.6737-2.6077e-08j,
        4.8137-5.9605e-07j, 3.4751-6.2589e-08j, 0.5613-2.9802e-08j,
        0.2745-1.4429e-08j, 1.4230+6.4342e-09j, 1.6740+9.7267e-08j,
        3.5191+6.6640e-08j, 8.6612-2.6057e-07j, 5.3513-1.1578e-07j,
        0.7511-1.4929e-10j, 3.1615+5.9605e-08j, 0.5670-6.1065e-09j,
        2.0078+3.1124e-09j, 2.1537+4.4703e-08j, 0.7253-4.5106e-09j,
        1.9182+6.1939e-08j, 1.4021-3.9409e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.321916341781616-5.2709356879176994e-08j)
SINR torch.Size([20]) = tensor([16.8477, 11.5274, 12.5223, 17.3014, 17.0701, 12.2337, 11.8123, 16.6500,
        15.7105, 19.1760, 21.0001, 18.4133, 16.0593, 17.7173, 12.9023, 17.5854,
        15.8909, 13.0673, 16.7425, 15.4693], device='cuda:0')
SINR mean = 15.784964561462402
E[H^H] = 1e-07
E_MSE (Error Power) = 0.029177609831094742
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9798, 0.9343, 0.9470, 0.9817, 0.9807, 0.9436, 0.9382, 0.9788, 0.9739,
        0.9881, 0.9921, 0.9858, 0.9758, 0.9834, 0.9512, 0.9829, 0.9749, 0.9530,
        0.9793, 0.9724], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([22, 66, 55, 20, 21, 58, 63, 23, 28, 13,  9, 16, 26, 18, 51, 19, 27, 49,
        23, 30], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 21-----------
Real SNR = tensor([17.3079, 20.7591, 18.4917, 20.2584, 19.5669, 16.3065, 21.0548, 19.9325,
        25.0877, 19.8536, 21.5217, 16.3959, 20.9935, 20.8206, 14.1617, 19.4417,
        17.4823, 22.5816, 22.5722, 20.0513], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.6603+8.7557e-09j, 3.5735-6.2469e-08j, 1.7834-2.8228e-08j,
        3.0332+4.7684e-07j, 0.8520+8.9407e-08j, 0.6592-4.0091e-09j,
        1.0028-8.9407e-08j, 0.1274-3.7253e-09j, 0.5917+7.8109e-07j,
        0.9137-1.4716e-08j, 7.0940+1.6741e-07j, 0.0961-7.9563e-09j,
        0.8050-4.1723e-07j, 6.3921+2.4590e-08j, 0.2737-2.9802e-08j,
        0.3295+2.5146e-08j, 0.3655+4.1383e-09j, 6.8822+3.5425e-08j,
        0.3646-9.1523e-08j, 4.3912+6.1027e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.009539842605591+4.623750626819856e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6095-9.9572e-10j, 4.2796-2.4792e-09j, 1.4358+2.0143e-08j,
        3.6254-3.5763e-07j, 0.5149+1.3411e-07j, 0.2880+1.8881e-08j,
        0.5828-2.7940e-08j, 0.0391+2.7940e-09j, 0.7615+7.5413e-08j,
        0.8747+3.8686e-08j, 7.7401+5.3646e-08j, 0.1904+6.4993e-09j,
        0.5734+2.9802e-08j, 5.3032-2.8202e-08j, 0.1956-0.0000e+00j,
        0.4752+9.6858e-08j, 0.5408-1.3922e-08j, 7.9439-1.2715e-07j,
        0.3136+3.9806e-09j, 4.6826-9.3957e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0485141277313232-8.572941467832607e-09j)
SINR torch.Size([20]) = tensor([14.8835, 20.0033, 17.9614, 18.2270, 12.7926, 13.2412, 11.5130,  0.5115,
        10.2482, 15.0341, 21.4262,  9.9526, 11.9830, 20.3053, 10.7481, 10.0705,
        14.3107, 22.2181,  8.5443, 20.7389], device='cuda:0')
SINR mean = 14.235674858093262
E[H^H] = 1e-07
E_MSE (Error Power) = 0.08604925870895386
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9685, 0.9901, 0.9843, 0.9852, 0.9501, 0.9547, 0.9341, 0.5294, 0.9137,
        0.9696, 0.9929, 0.9082, 0.9404, 0.9908, 0.9224, 0.9104, 0.9643, 0.9940,
        0.8773, 0.9916], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 34,  11,  17,  16,  52,  47,  67, 337,  84,  33,   8,  89,  61,  10,
         77,  87,  38,   6, 114,   9], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 22-----------
Real SNR = tensor([21.0856, 23.8726, 22.0523, 20.7486, 16.5877, 20.3932, 20.4710, 16.3278,
        21.8750, 20.1477, 19.9864, 23.7959, 20.1598, 20.4272, 23.9574, 21.6719,
        18.9711, 21.8493, 13.2669, 19.3282], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.7223-1.0095e-08j,  3.4139+2.1770e-08j,  1.0260+6.1825e-08j,
         2.0018-3.3589e-08j,  1.1768+9.7401e-09j,  0.9843+2.0862e-07j,
         2.4038+2.2726e-08j,  0.6371-2.6880e-09j,  0.1673+2.5816e-08j,
         1.8045-2.6335e-08j,  1.1922-5.9605e-08j,  2.5054-5.8638e-08j,
         0.5121-3.1408e-09j,  0.8386-5.9800e-08j, 10.2598-8.0727e-10j,
         1.0537-8.0662e-09j,  0.7948+1.9024e-08j,  1.4962-3.7691e-08j,
         0.2290-3.3420e-09j,  0.0114-3.9610e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7115360498428345+3.088016731211951e-09j)
torch.linalg.det(H.mH@H) = tensor([2.7345e+00-2.0307e-08j, 3.8250e+00-3.1180e-08j, 1.1229e+00-1.3127e-08j,
        2.2195e+00+2.6130e-08j, 7.7338e-01+3.0409e-08j, 6.8624e-01-0.0000e+00j,
        1.5705e+00+1.1921e-07j, 5.1051e-01-2.3101e-09j, 1.8122e-01-4.7754e-09j,
        1.8298e+00-1.1983e-08j, 1.2316e-01+1.8626e-09j, 2.4719e+00-1.0615e-07j,
        5.3898e-01-1.2024e-08j, 1.4768e+00+7.2575e-08j, 9.6596e+00-1.6817e-07j,
        8.3303e-01+4.3629e-08j, 8.9977e-01+1.3760e-08j, 1.9243e+00-1.9791e-08j,
        1.5638e-01-3.4240e-09j, 8.2614e-03-2.7422e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6772831678390503-4.420368071578196e-09j)
SINR torch.Size([20]) = tensor([20.3257, 20.5318, 16.8376, 19.9107, 17.0098, 14.8661, 17.8876, 17.3777,
         8.3331, 18.3783,  5.3176, 17.9891, 14.1284, 16.5152, 22.9011, 14.3506,
        17.2851, 19.3031, 12.8984, -0.7382], device='cuda:0')
SINR mean = 15.570444107055664
E[H^H] = 1e-07
E_MSE (Error Power) = 0.0964527279138565
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9908, 0.9912, 0.9797, 0.9899, 0.9805, 0.9684, 0.9840, 0.9820, 0.8720,
        0.9857, 0.7728, 0.9844, 0.9628, 0.9782, 0.9949, 0.9646, 0.9817, 0.9884,
        0.9512, 0.4576], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 10,  10,  22,  11,  21,  34,  18,  20, 118,  16, 188,  17,  40,  24,
          5,  38,  20,  13,  51, 380], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 23-----------
Real SNR = tensor([23.4425, 23.9830, 21.2863, 19.4120, 19.2418, 19.5404, 20.9976, 18.2513,
        24.8489, 20.8836, 18.3149, 25.6602, 20.4977, 18.1998, 20.3114, 17.7520,
        20.7499, 24.6330, 23.3459, 21.3701], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.8800+5.0881e-08j, 1.7968-5.2174e-10j, 0.5659-7.8425e-09j,
        0.8822+1.0431e-07j, 0.4720-1.5508e-09j, 0.7048-5.5550e-08j,
        0.2647+4.0017e-09j, 0.2500-3.2192e-09j, 0.1308-7.7375e-08j,
        0.9549-2.3926e-08j, 0.2682-3.9279e-09j, 3.8813+4.4207e-09j,
        0.9432+1.0710e-08j, 0.8080+2.2628e-09j, 1.0992+4.8429e-08j,
        0.4409-1.9052e-08j, 1.4600-4.5739e-08j, 2.2474+7.3083e-08j,
        1.5855-3.5111e-09j, 0.8549+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.0745337009429932+4.284128607423554e-09j)
torch.linalg.det(H.mH@H) = tensor([1.8726+8.5682e-08j, 1.6706-2.6816e-08j, 0.5818-7.9438e-10j,
        0.7044-1.1231e-08j, 1.0248-2.9940e-09j, 1.0394+9.0292e-11j,
        0.3451+2.6453e-09j, 0.2247+3.8045e-10j, 0.1256-2.7439e-08j,
        0.7651-5.0981e-09j, 0.1922+1.4450e-09j, 4.4612-8.7556e-08j,
        1.2479-2.3451e-08j, 0.7868+7.7631e-09j, 1.1287+1.4901e-08j,
        0.2616+1.6298e-08j, 1.8021-7.2314e-09j, 1.8958+8.5033e-08j,
        1.2836-2.5632e-08j, 0.9519-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1182827949523926-2.0031053205027405e-10j)
SINR torch.Size([20]) = tensor([17.6238, 19.3528, 16.3768, 16.1206, 18.9347, 19.1943, 14.2692, 16.0154,
         7.3843, 17.1041, 13.7914, 19.8111, 19.0303, 18.4296, 17.6418, 14.1273,
        20.1281, 18.0052, 17.9433, 16.0185], device='cuda:0')
SINR mean = 16.865121841430664
E[H^H] = 1e-07
E_MSE (Error Power) = 0.026816701516509056
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9830, 0.9885, 0.9775, 0.9762, 0.9874, 0.9881, 0.9639, 0.9756, 0.8456,
        0.9809, 0.9599, 0.9897, 0.9877, 0.9858, 0.9831, 0.9628, 0.9904, 0.9844,
        0.9842, 0.9756], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 19,  13,  25,  26,  14,  13,  38,  27, 138,  21,  42,  11,  14,  16,
         19,  40,  11,  17,  17,  27], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 24-----------
Real SNR = tensor([25.8136, 17.2743, 23.2581, 20.5051, 22.1011, 22.4740, 25.4370, 26.5481,
        24.4945, 26.6777, 20.5037, 19.8300, 24.9520, 23.8062, 21.6308, 22.2844,
        20.4643, 18.6801, 25.8717, 19.8577], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1654-2.2911e-07j,  0.1948+1.4901e-08j,  1.7649+5.9605e-08j,
         1.6870+4.4703e-08j,  2.2555+1.1304e-07j,  0.0679+7.6158e-08j,
         8.2760-4.5339e-08j,  1.7673+4.7684e-07j,  1.7399-2.4027e-07j,
        12.1505+2.8056e-07j,  0.1763-6.2863e-09j,  2.5358-2.8310e-08j,
         3.4560-2.5125e-08j,  1.3294+1.2627e-08j,  2.2819+4.3601e-08j,
         0.1028-1.1921e-07j,  0.2294+1.8626e-09j,  0.0894-1.4901e-08j,
         4.2377+1.0337e-07j,  0.0590+7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.228353500366211+2.6308475398195696e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1220-6.3114e-09j,  0.0885+7.4506e-09j,  1.6152+1.7881e-07j,
         1.5993+2.3740e-08j,  3.4927+8.6331e-08j,  0.0317-1.3160e-08j,
         7.1056-4.1903e-08j,  2.9690-0.0000e+00j,  1.3263+1.7026e-07j,
        12.9060+1.9373e-07j,  0.1486+9.0418e-10j,  1.7174+1.4528e-08j,
         2.6298+5.1299e-08j,  1.3228-7.8311e-09j,  1.9931+7.5354e-09j,
         0.1278+2.1420e-08j,  0.2884+1.8626e-09j,  0.0483+9.3132e-09j,
         5.6828+1.5243e-07j,  0.0872-1.1176e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2651257514953613+4.19620427294376e-08j)
SINR torch.Size([20]) = tensor([ 6.3634, 11.9484, 18.9911, 20.0599, 22.3219,  3.8161, 24.4673, 19.1108,
        17.5247, 25.2963, 11.8565, 21.2755, 21.8332, 18.2067, 21.4628,  6.7541,
        14.6762,  7.2114, 23.9235,  9.8094], device='cuda:0')
SINR mean = 16.34547233581543
E[H^H] = 1e-07
E_MSE (Error Power) = 0.06718496233224869
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8123, 0.9400, 0.9875, 0.9902, 0.9942, 0.7065, 0.9964, 0.9879, 0.9826,
        0.9971, 0.9388, 0.9926, 0.9935, 0.9851, 0.9929, 0.8257, 0.9671, 0.8403,
        0.9960, 0.9054], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([161,  61,  14,  11,   6, 230,   4,  13,  19,   3,  62,   8,   7,  16,
          8, 152,  35, 142,   4,  91], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 25-----------
Real SNR = tensor([22.4877, 25.3202, 22.7267, 23.7463, 16.3959, 20.1576, 24.4989, 21.5027,
        20.7955, 25.3347, 22.8640, 27.5187, 24.9695, 23.0804, 21.4003, 24.5197,
        21.1632, 25.4452, 18.9615, 28.7890], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.6146-1.4901e-08j, 3.5016-3.8755e-09j, 1.4523+1.2844e-08j,
        0.1858+2.9084e-08j, 0.2029-5.5616e-09j, 0.0882-2.9261e-09j,
        0.3451+3.7253e-09j, 0.3091+2.5665e-09j, 0.6469-8.4899e-09j,
        1.7124-5.9605e-08j, 0.8202+2.2588e-09j, 0.4502-1.3411e-07j,
        0.2782-1.6864e-07j, 1.7678+5.0315e-09j, 0.2926-4.4703e-08j,
        1.9701-2.9802e-08j, 0.2156+2.9392e-09j, 2.1293+2.6547e-08j,
        0.2287-2.2664e-09j, 9.0448-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.3128257989883423-1.9494496683591933e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.5319+1.4901e-08j,  2.9555+6.7715e-08j,  1.0497+2.7973e-08j,
         0.1556-2.0311e-08j,  0.2123-2.1483e-10j,  0.0274+2.4775e-09j,
         0.4504-9.3132e-09j,  0.2639+1.9960e-09j,  0.5387+1.0267e-08j,
         2.0467-2.3842e-07j,  0.6591+6.8754e-09j,  0.2143-1.3411e-07j,
         0.0767+6.5022e-08j,  1.3084-1.7935e-08j,  0.5298+5.9605e-08j,
         2.5392-8.9407e-08j,  0.1964+1.0209e-08j,  2.6100+1.3976e-08j,
         0.4605-7.8679e-09j, 12.1041-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4465261697769165-1.1828053203544187e-08j)
SINR torch.Size([20]) = tensor([17.6573, 23.1294, 20.7932, 11.5932, 16.9242,  7.6778, 14.3530, 16.0614,
        19.0080, 20.4557, 18.7135,  8.8570,  6.8668, 21.9707, 15.7234, 21.2747,
        15.9681, 23.6450, 19.5111, 25.7748], device='cuda:0')
SINR mean = 17.297910690307617
E[H^H] = 1e-07
E_MSE (Error Power) = 0.03774597868323326
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9831, 0.9952, 0.9917, 0.9352, 0.9801, 0.8542, 0.9646, 0.9758, 0.9876,
        0.9911, 0.9867, 0.8849, 0.8294, 0.9937, 0.9739, 0.9926, 0.9753, 0.9957,
        0.9889, 0.9974], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 19,   5,   9,  66,  22, 131,  38,  26,  14,  10,  15, 108, 149,   7,
         28,   8,  27,   5,  12,   3], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 26-----------
Real SNR = tensor([24.8219, 24.5384, 25.6674, 24.1541, 19.8135, 25.9608, 24.0088, 24.3460,
        21.5491, 22.1003, 22.6490, 20.5498, 23.6267, 24.4139, 25.0998, 22.0140,
        21.7555, 22.2886, 20.1925, 25.8000], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.2199-2.5880e-08j, 0.1953-8.3447e-07j, 1.8197+3.3941e-09j,
        2.6225-7.2485e-08j, 0.3942+8.3317e-09j, 4.7620+1.5680e-08j,
        0.1325-2.2596e-08j, 1.5460+3.3247e-09j, 0.1321+7.7610e-10j,
        0.4724-2.1650e-09j, 1.0093-2.8774e-08j, 0.4863+4.3829e-09j,
        0.5791-4.0058e-08j, 0.3168+4.4256e-09j, 2.2331-1.5897e-07j,
        0.4753-0.0000e+00j, 0.0509+4.1733e-09j, 1.5054+5.5847e-08j,
        0.0914-2.6077e-08j, 1.9048+2.3842e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.1474459171295166-4.363582206678984e-08j)
torch.linalg.det(H.mH@H) = tensor([2.3699+2.1879e-08j, 0.0646-1.2666e-07j, 1.1413+8.1601e-08j,
        2.8547-5.9420e-09j, 0.3793+1.7417e-08j, 3.3070-1.2231e-09j,
        0.2365-1.3498e-10j, 2.1825+8.1568e-09j, 0.0831+3.5758e-08j,
        0.6757-8.1778e-11j, 1.0184-4.7591e-08j, 0.3834-2.6986e-09j,
        0.6521-9.1370e-09j, 0.1210-1.3098e-08j, 2.1999-3.2872e-08j,
        0.5295+5.9605e-08j, 0.0280-3.0686e-09j, 1.8208+1.1439e-08j,
        0.1186-2.2352e-08j, 1.5716-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.086899995803833-4.430328548465923e-09j)
SINR torch.Size([20]) = tensor([24.4518,  5.6424, 19.9853, 24.4254, 19.2882, 24.5255, 15.6848, 24.3342,
        10.4723, 21.4902, 21.4923, 19.2158, 19.1583, 13.1058, 21.6458, 18.5837,
         8.1291, 22.9703, 13.6785, 21.3025], device='cuda:0')
SINR mean = 18.479095458984375
E[H^H] = 1e-07
E_MSE (Error Power) = 0.033918410539627075
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9964, 0.7857, 0.9901, 0.9964, 0.9884, 0.9965, 0.9737, 0.9963, 0.9177,
        0.9930, 0.9930, 0.9882, 0.9880, 0.9534, 0.9932, 0.9863, 0.8667, 0.9950,
        0.9589, 0.9926], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  4, 179,  11,   4,  13,   4,  29,   4,  81,   8,   8,  13,  13,  49,
          7,  15, 122,   5,  43,   8], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 27-----------
Real SNR = tensor([24.5945, 27.4872, 22.5965, 22.4375, 24.7452, 28.5319, 29.2134, 21.6522,
        27.4379, 29.3308, 27.9284, 26.6917, 28.4526, 28.3612, 26.5757, 22.2382,
        25.2195, 24.7848, 23.6054, 26.2812], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.9699e-01+1.1191e-08j, 7.9132e-02+1.0592e-08j, 1.3548e-01-1.1176e-08j,
        8.6797e-02-1.8626e-08j, 8.1250e-01-5.9605e-08j, 5.7084e+00-2.2496e-07j,
        4.0102e-01-7.3294e-08j, 3.9463e-03-3.2738e-10j, 3.8341e+00+1.7494e-08j,
        1.0226e+01+8.7748e-08j, 5.0821e+00-1.1921e-07j, 5.0029e+00+4.7684e-07j,
        2.6171e+00+4.2131e-08j, 3.9153e+00-5.9605e-08j, 8.4319e-01+1.1235e-08j,
        7.2344e-01+3.2414e-09j, 1.3805e+00+1.2498e-08j, 1.3743e-01+1.8626e-09j,
        2.1978e+00+2.9522e-08j, 6.7742e-01-1.5570e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.2330613136291504+6.099230898115593e-09j)
torch.linalg.det(H.mH@H) = tensor([ 1.1712+1.8581e-08j,  0.1768-2.1724e-08j,  0.0876+1.8626e-09j,
         0.1425+7.4506e-09j,  0.7154+1.7881e-07j,  8.0540-4.8680e-09j,
         0.6135+6.6498e-08j,  0.0268+1.6941e-09j,  3.9036-2.9261e-08j,
        10.1910+5.1839e-08j,  4.9709-2.9802e-08j,  5.4866-7.6026e-08j,
         1.2298+3.3302e-07j,  4.6333+6.5565e-07j,  0.9574+1.4021e-08j,
         0.7230+2.9105e-08j,  1.3852-2.3219e-08j,  0.1360+1.3039e-08j,
         2.2512-2.3779e-08j,  0.5375+1.7291e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.369659900665283+6.679054109781646e-08j)
SINR torch.Size([20]) = tensor([23.2421, 12.7694, 11.7594, 16.8416, 19.6526, 27.0420, 16.7850,  8.7602,
        26.5059, 28.0655, 24.1156, 25.4433, 19.4619, 24.5294, 20.8513, 21.5271,
        23.2260, 12.0134, 25.4990, 18.8886], device='cuda:0')
SINR mean = 20.34897232055664
E[H^H] = 1e-07
E_MSE (Error Power) = 0.02058587037026882
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9953, 0.9498, 0.9375, 0.9797, 0.9893, 0.9980, 0.9795, 0.8826, 0.9978,
        0.9984, 0.9961, 0.9972, 0.9888, 0.9965, 0.9918, 0.9930, 0.9953, 0.9408,
        0.9972, 0.9872], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  5,  52,  64,  22,  12,   2,  22, 110,   2,   1,   4,   3,  12,   4,
          9,   8,   5,  61,   3,  14], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 28-----------
Real SNR = tensor([27.7341, 27.9649, 25.4705, 27.0443, 26.1878, 26.5264, 23.7174, 27.8668,
        25.1758, 26.9739, 27.2987, 28.7359, 23.2724, 31.6300, 25.1642, 26.0996,
        25.6386, 31.0134, 24.8949, 30.7036], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.1495-3.4489e-08j,  1.4260-5.8674e-08j,  0.7485+2.2352e-08j,
         0.1721-2.0027e-09j,  2.0087-0.0000e+00j,  2.9725+6.2376e-08j,
         0.1941+1.4750e-08j,  1.9495+1.2526e-07j,  1.1369+7.8348e-09j,
         1.5279+1.5142e-08j,  0.4510+1.5085e-08j,  9.3921+2.9379e-07j,
         0.9512-1.6148e-08j, 10.8344-4.8987e-07j,  3.7001-4.8386e-08j,
         0.2086+7.8759e-10j,  0.0395+3.7253e-09j,  6.8025+1.3219e-07j,
         0.1573-3.3417e-08j,  5.1249+4.7684e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.5973689556121826+2.435720602989022e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.5885-8.6377e-08j,  1.2127-1.0788e-08j,  1.0088+2.2352e-08j,
         0.1334+8.5766e-10j,  1.5140+1.7881e-07j,  3.6202+1.4186e-07j,
         0.2515+3.7472e-09j,  1.7253+6.6515e-08j,  1.1147+7.1298e-09j,
         1.3076+1.0112e-08j,  0.3938+2.8360e-08j,  9.3653-2.8491e-07j,
         0.6446+4.1112e-09j, 11.4824-8.2636e-08j,  3.7431+3.1223e-08j,
         0.1359+2.3465e-08j,  0.1341+7.4506e-09j,  7.7388-3.0228e-08j,
         0.1208+1.0067e-08j,  5.0510-2.3842e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.61431884765625-9.864655758917706e-09j)
SINR torch.Size([20]) = tensor([23.5936, 23.3349, 22.6792, 13.6807, 21.4436, 26.6242, 19.2892, 23.1706,
        23.7244, 23.9982, 17.3889, 27.8062, 23.5898, 29.1732, 26.7069, 14.3643,
        13.2293, 28.3333, 13.8145, 25.6839], device='cuda:0')
SINR mean = 22.08144187927246
E[H^H] = 1e-07
E_MSE (Error Power) = 0.011368081904947758
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9956, 0.9954, 0.9946, 0.9589, 0.9929, 0.9978, 0.9884, 0.9952, 0.9958,
        0.9960, 0.9821, 0.9983, 0.9956, 0.9988, 0.9979, 0.9647, 0.9546, 0.9985,
        0.9601, 0.9973], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 5,  5,  6, 43,  8,  2, 13,  5,  4,  4, 20,  1,  5,  1,  2, 38, 48,  1,
        42,  3], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 29-----------
Real SNR = tensor([32.6357, 30.1932, 27.6315, 29.3515, 27.2678, 30.7571, 28.1554, 27.0326,
        28.1582, 27.4964, 18.2805, 23.8355, 31.8707, 25.9247, 32.1635, 30.2462,
        27.2664, 28.5832, 26.8766, 28.8390], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.2873e+01+3.8552e-07j, 3.4613e+00+2.2515e-08j, 7.7844e-03-1.2748e-07j,
        2.1450e+00+9.1807e-09j, 5.5201e-01-8.9407e-08j, 3.3776e+00-7.9573e-08j,
        1.2626e+00+1.2226e-08j, 1.8469e+00+8.6321e-09j, 1.0979e+00+2.0699e-07j,
        4.3957e-01+4.1604e-08j, 1.1548e-02+9.3132e-10j, 2.8882e-01-1.7906e-10j,
        9.6637e+00+7.7954e-09j, 4.6096e-01+2.7168e-08j, 5.7621e+00-1.7929e-07j,
        2.2964e+00+1.5070e-08j, 1.8049e+00-4.6606e-08j, 5.3471e+00+5.6132e-08j,
        8.5324e-01+3.1728e-08j, 1.7432e+00-4.3463e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.764758825302124+1.2974573415647228e-08j)
torch.linalg.det(H.mH@H) = tensor([1.1310e+01+2.9460e-07j, 3.4398e+00-8.7159e-08j, 1.0136e-02+6.1419e-08j,
        2.1682e+00+3.3117e-08j, 8.4303e-01-5.9605e-08j, 3.2622e+00-1.2741e-07j,
        1.3491e+00+2.8946e-08j, 2.0455e+00-1.6394e-08j, 1.0243e+00+9.3332e-08j,
        4.0988e-01-5.2629e-08j, 6.2568e-03+4.6566e-10j, 3.2973e-01+3.7370e-09j,
        9.9993e+00-1.4998e-07j, 5.3668e-01+2.4787e-08j, 5.9792e+00+2.0026e-07j,
        2.4798e+00+1.0277e-07j, 1.7974e+00+2.5678e-08j, 5.7204e+00+8.5716e-08j,
        8.4975e-01-7.1443e-08j, 1.4166e+00+4.4992e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.748844861984253+2.175968383255622e-08j)
SINR torch.Size([20]) = tensor([30.5496, 27.2013,  2.5638, 25.1845, 22.4700, 27.0327, 25.0296, 26.5744,
        20.3857, 19.7603,  9.3174, 21.9344, 30.6794, 21.3789, 28.0985, 25.5752,
        25.3470, 29.0147, 23.4207, 24.0626], device='cuda:0')
SINR mean = 23.279035568237305
E[H^H] = 1e-07
E_MSE (Error Power) = 0.033262770622968674
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9991, 0.9981, 0.6434, 0.9970, 0.9944, 0.9980, 0.9969, 0.9978, 0.9909,
        0.9895, 0.8952, 0.9936, 0.9991, 0.9928, 0.9985, 0.9972, 0.9971, 0.9987,
        0.9955, 0.9961], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  1,   2, 269,   3,   6,   2,   3,   2,  10,  11, 100,   7,   1,   8,
          1,   3,   3,   1,   5,   4], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)

全 100 枚の画像の処理が完了しました。
Your samples are ready and waiting four you here: 
outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate 
Enjoy.
