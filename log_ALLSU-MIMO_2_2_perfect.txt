Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
合計 100 枚の画像をロードしました。20 枚ずつのチャンクで処理します。

--- 処理中: 画像 1 から 20 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 0)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.7532, 0.6074, 0.6583, 0.7701, 0.8240, 0.5942, 0.6361, 0.7516, 0.5557,
        0.6154, 0.4440, 0.5926, 0.5110, 0.4479, 0.4735, 0.6824, 0.6127, 1.1112,
        0.5367, 0.5905], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -1.9205,  -8.1566,  -5.8495, -11.2153,  -3.5761,  -6.5500,  -5.8781,
        -10.7752,  -3.0277,  -7.0051,  -6.9639,  -5.1594,  -5.5964,  -5.0870,
         -4.0247,  -2.2517,  -5.4338,  -8.8515,  -9.2953,  -7.9551],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.4904e+02+1.4146e-06j, 1.4169e+00-5.5432e-08j, 1.4739e+02+8.2782e-07j,
        2.1838e+03+5.4344e-05j, 2.8362e+02-5.1947e-06j, 5.2291e+02+7.6294e-06j,
        9.1984e+02+2.8941e-06j, 4.4657e+02-2.7107e-07j, 9.2219e+02+4.9923e-06j,
        5.2702e+02+5.5473e-06j, 1.1479e+01+9.6739e-07j, 5.4983e+02+4.3219e-06j,
        6.5260e+02+6.4663e-06j, 4.2045e+01+1.2924e-08j, 8.9646e+01-3.7261e-05j,
        1.8116e+02+1.9073e-06j, 2.0260e+02+3.8147e-06j, 6.4300e+01+1.5965e-07j,
        8.7978e+01+3.7822e-06j, 1.3284e+02-1.1444e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(410.9132995605469+2.242773916805163e-06j)
torch.linalg.det(H.mH@H) = tensor([1.0447e+01+4.7684e-07j, 2.7944e-02-9.2055e-09j, 2.0785e-01-5.6828e-10j,
        2.3959e-01+2.6943e-09j, 5.6514e+00-2.4739e-08j, 9.7522e-03-3.5402e-09j,
        5.7352e-01-3.1665e-08j, 4.4905e-01+1.3970e-08j, 3.3512e-01+7.4506e-09j,
        1.9645e-01-4.2586e-08j, 1.1696e+00-5.9605e-08j, 3.3915e+00+3.3235e-08j,
        3.0146e+00+3.4829e-08j, 5.4266e+00+8.6363e-08j, 3.6776e+00+5.2724e-08j,
        8.8188e-01+3.1772e-09j, 2.4121e+00+5.7595e-08j, 3.2251e-01-9.3132e-09j,
        3.8591e-01-5.1966e-09j, 1.0054e+00+1.2616e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9912859201431274+2.9753596919590564e-08j)
SINR torch.Size([20]) = tensor([ -4.9566, -23.7905, -19.0214, -13.5499,  -8.8280, -30.3215, -15.4592,
        -14.0845, -19.2420, -17.1304, -11.1146,  -6.5120,  -6.4347,  -5.4369,
         -6.5758, -11.7401,  -7.6526, -13.0140, -11.7726,  -8.7376],
       device='cuda:0')
SINR mean = -12.7687406539917
E[H^H] = 1e-07
E_MSE (Error Power) = 78.83641815185547
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2421, 0.0042, 0.0124, 0.0423, 0.1158, 0.0009, 0.0277, 0.0376, 0.0118,
        0.0190, 0.0718, 0.1825, 0.1852, 0.2224, 0.1803, 0.0628, 0.1465, 0.0476,
        0.0623, 0.1180], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 527, 1000,  913,  785,  652, 1000,  832,  798,  918,  871,  719,  579,
         576,  543,  581,  737,  616,  771,  737,  649], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -4-----------
Real SNR = tensor([-7.1044, -3.4898, -7.2756, -6.3844, -5.4670, -5.5630, -3.0111, -4.9313,
        -3.7474, -9.7431, -7.4052, -8.8685, -1.4778, -4.8385, -5.7715, -4.5117,
        -1.7852, -6.7112, -2.8390, -6.3167], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.8414e+02-1.4853e-06j, 1.5199e+01+1.2547e-07j, 3.6404e+02+7.8061e-06j,
        7.0718e+02-2.0443e-06j, 1.6540e+01-2.8610e-06j, 1.5274e+02+1.1606e-06j,
        1.1791e+02-0.0000e+00j, 2.4611e+01-1.4305e-06j, 2.1292e+02-2.6424e-06j,
        1.4314e+02-2.5620e-06j, 2.2256e-01-7.5731e-07j, 1.9034e+02+7.6294e-06j,
        4.5404e+02-8.1990e-07j, 1.4420e+01+5.9227e-06j, 6.0537e+02+2.0406e-07j,
        5.2294e+01+1.9073e-06j, 8.0712e+01+1.2835e-06j, 1.6477e+02+9.7268e-06j,
        6.8034e+02+1.5758e-05j, 6.5862e+02+1.5259e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(251.97727966308594+2.6089880975632695e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.0287-6.8918e-08j,  1.0796+4.8647e-08j,  0.3335+3.3907e-09j,
         0.8743+1.5902e-08j,  0.4277+9.7789e-09j,  1.2433-3.3862e-09j,
         3.7143+8.0438e-08j,  2.3056+2.4270e-09j,  5.0032-2.4761e-08j,
         0.1472+1.4861e-08j,  0.1870-2.2363e-10j,  0.4364-6.7094e-09j,
        13.1510-9.3280e-08j,  2.8182-1.4832e-08j,  0.4382-4.4703e-08j,
         2.3014+4.4703e-07j,  4.4794+9.2909e-08j,  0.7297+2.9802e-08j,
         0.5289-1.9078e-08j,  2.0083-2.1346e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1117913722991943+2.2397562915443814e-08j)
SINR torch.Size([20]) = tensor([-23.4289, -11.2915, -11.0373,  -8.4650, -12.8577,  -8.8737,  -5.3589,
         -6.2807,  -4.4832, -13.2260, -13.0803, -10.3989,  -1.9090,  -5.9163,
        -15.6355, -10.2008,  -5.3181, -11.1508, -13.5160,  -6.4740],
       device='cuda:0')
SINR mean = -9.945128440856934
E[H^H] = 1e-07
E_MSE (Error Power) = 20.0483341217041
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0045, 0.0691, 0.0730, 0.1246, 0.0492, 0.1147, 0.2255, 0.1906, 0.2626,
        0.0454, 0.0469, 0.0836, 0.3918, 0.2039, 0.0266, 0.0872, 0.2271, 0.0713,
        0.0426, 0.1838], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  724,  717,  641,  767,  654,  541,  571,  511,  776,  772,  699,
         421,  559,  837,  693,  539,  720,  784,  578], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -3-----------
Real SNR = tensor([-1.9967, -3.2994, -1.8020, -2.7365, -8.3210, -1.7318, -0.5422, -4.4742,
        -6.1008, -8.0902, -4.5442, -1.3478, -2.5890, -1.6366, -7.5079, -0.9199,
        -1.4642, -7.3677, -3.3660, -4.8040], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([226.1973+2.5519e-06j, 110.2645-4.7684e-06j,  13.8874-1.3828e-05j,
        226.9446-9.7132e-06j,  36.1174+8.3447e-07j, 113.7084+1.0576e-06j,
        176.3015+9.1689e-06j,   8.9136-3.0994e-06j,   9.5891+1.7838e-06j,
         87.9757-2.6368e-06j, 229.8146-2.0928e-05j,  96.9395+1.4124e-05j,
        135.4553+8.9200e-06j,   4.2776+9.5367e-07j, 187.7676+1.5259e-05j,
         19.9396-3.8147e-06j,  36.7152+5.0984e-07j,  18.0273+4.7684e-07j,
         80.0382+7.3070e-07j, 288.6675-2.2600e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(105.37709045410156-2.3392503578634205e-07j)
torch.linalg.det(H.mH@H) = tensor([9.0817e+00+1.8532e-07j, 9.2923e-01-5.0296e-09j, 4.5657e+00+1.1291e-07j,
        2.9300e+00+1.1921e-07j, 2.5536e-03+1.6046e-09j, 1.6714e+00+2.1475e-07j,
        5.4012e-01-7.0452e-08j, 8.9018e-01-2.9802e-08j, 4.6575e-01+5.1851e-09j,
        1.9070e-01-7.4506e-09j, 1.1260e+00+2.9897e-09j, 7.3991e+00+1.1433e-07j,
        7.3515e+00-3.1372e-08j, 1.4420e-01+5.0398e-08j, 6.2524e-01-2.0916e-09j,
        2.4738e+00-2.2870e-08j, 2.8559e+00-4.0551e-09j, 9.7641e-02-6.0032e-09j,
        1.9351e+00-4.0978e-08j, 9.4599e-01-8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3110873699188232+2.4858991309884004e-08j)
SINR torch.Size([20]) = tensor([ -2.3775,  -8.4283,  -4.9087,  -6.2569, -33.6287,  -9.2106, -14.3757,
         -9.7991, -10.8635, -14.1629,  -6.2815,  -2.4184,  -2.2686, -18.7520,
         -9.7206,  -6.3280,  -4.7613, -16.9211,  -7.2141,  -9.4719],
       device='cuda:0')
SINR mean = -9.907476425170898
E[H^H] = 1e-07
E_MSE (Error Power) = 105.79898834228516
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3665, 0.1256, 0.2441, 0.1914, 0.0004, 0.1071, 0.0352, 0.0948, 0.0758,
        0.0369, 0.1906, 0.3643, 0.3723, 0.0132, 0.0964, 0.1889, 0.2504, 0.0199,
        0.1596, 0.1015], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 438,  640,  525,  571, 1000,  664,  806,  681,  712,  800,  571,  439,
         434,  908,  679,  573,  520,  867,  602,  672], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -2-----------
Real SNR = tensor([-4.6358, -2.8767, -0.7160, -3.8620, -1.3567, -3.7462, -5.6765, -0.7545,
        -2.5161, -7.3826,  1.2377, -3.2668,  0.5489, -0.4649, -5.4090, -5.0602,
        -3.4225, -7.2773, -5.7536, -1.2458], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([264.4260-4.9611e-06j,  74.5180+4.7684e-07j,  92.0855-1.4218e-05j,
         87.5999+6.7281e-08j, 364.3740-3.4345e-05j,   2.7792-2.9802e-08j,
         18.8831-2.3829e-08j, 140.3541+3.5815e-06j, 312.6331+5.1556e-06j,
          2.1380-2.0019e-06j, 137.8285+1.3978e-05j, 211.8053-2.5925e-05j,
         12.3526+2.3842e-07j, 120.8923-3.8501e-06j,   0.4469+2.6191e-08j,
        120.3703-4.9591e-05j,   8.9368-5.0664e-07j,  33.7376-9.5367e-07j,
         37.9217+4.7684e-06j,   3.6172+3.3828e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(102.38500213623047-5.388823865359882e-06j)
torch.linalg.det(H.mH@H) = tensor([7.9997e-01-1.1915e-08j, 2.8505e-01-2.8756e-08j, 1.3892e-01+5.5879e-08j,
        2.7004e-01+6.9443e-08j, 6.2672e+00-2.3842e-07j, 5.4472e-02+3.8650e-08j,
        5.7223e-01+1.1135e-09j, 6.8178e+00-1.2539e-08j, 8.3053e-01+3.7782e-08j,
        5.2265e-01-1.0972e-09j, 7.4938e-01+1.2773e-07j, 9.3268e-01+5.1898e-08j,
        1.9560e+00+1.3540e-07j, 2.5152e+00-1.2209e-07j, 1.9043e-03-2.1595e-08j,
        7.4438e-01-3.0074e-08j, 7.6449e-01-1.4901e-08j, 1.5921e+00-1.1921e-07j,
        7.8920e-01-1.0665e-09j, 2.5307e-01-7.4506e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3428633213043213-7.913813604432107e-09j)
SINR torch.Size([20]) = tensor([ -7.8136, -11.6728, -17.6508, -12.3144,  -4.4444, -20.1108,  -7.8030,
         -2.1971,  -9.1873,  -8.4897, -11.9680,  -8.7095,  -7.4626,  -5.3666,
        -33.8024,  -7.8544,  -9.9665,  -6.7464,  -7.6019, -16.1648],
       device='cuda:0')
SINR mean = -10.866353034973145
E[H^H] = 1e-07
E_MSE (Error Power) = 110.6870346069336
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1420, 0.0637, 0.0169, 0.0554, 0.2644, 0.0097, 0.1423, 0.3762, 0.1076,
        0.1240, 0.0598, 0.1186, 0.1521, 0.2252, 0.0004, 0.1408, 0.0915, 0.1746,
        0.1480, 0.0236], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 621,  735,  883,  752,  510,  936,  620,  431,  663,  642,  743,  649,
         610,  541, 1000,  622,  686,  587,  614,  849], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -1-----------
Real SNR = tensor([ 0.1916, -1.7080, -5.3729,  1.1678, -1.1772,  0.3075, -2.1221, -6.9456,
        -4.5484, -0.6122,  0.8884, -1.7560, -2.5968, -0.6105, -1.2137, -0.4405,
         0.5088, -5.3147, -1.9875, -1.5929], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  5.9401+5.3154e-07j, 251.5842-9.8552e-07j,  26.0840+1.5762e-06j,
        129.3364+7.7098e-08j, 130.3799+2.5296e-07j,  89.3820+8.5319e-07j,
        265.7963-2.6565e-06j,   4.2294+3.4571e-06j, 121.8903-3.9357e-06j,
         12.1912+1.1921e-07j,  47.6489-1.8936e-07j,  39.1301-6.7826e-07j,
         26.1073-4.1069e-08j,   2.0526-1.4901e-07j,   1.4301+6.8443e-06j,
          4.6975-3.5726e-07j,   5.1944-1.7774e-06j, 118.5792+1.1578e-08j,
        181.7304-5.0776e-06j,  76.7327-5.3048e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(77.00585174560547-1.327528309502668e-07j)
torch.linalg.det(H.mH@H) = tensor([2.5971+2.2329e-07j, 2.5192+1.2868e-08j, 0.0990+1.4901e-08j,
        3.2523+1.5150e-08j, 1.6091-8.9407e-08j, 2.9708-3.8166e-08j,
        0.3582-1.1113e-08j, 0.2634+4.8112e-09j, 0.9423+1.0050e-08j,
        6.2013+8.2816e-08j, 6.9988+9.7664e-08j, 2.6769-8.7209e-10j,
        1.5829-2.0466e-08j, 4.0270-7.3082e-09j, 0.1536+2.9591e-09j,
        1.3855-7.0357e-08j, 2.8227-7.1210e-08j, 3.2748-7.2642e-09j,
        3.6847-3.6491e-08j, 0.7228+2.9802e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4071223735809326+2.0493670760401983e-08j)
SINR torch.Size([20]) = tensor([ -4.7934,  -2.7537, -15.6239,  -3.5827,  -6.8079,  -3.0791, -10.8943,
         -9.0508,  -5.5069,  -1.7511,  -0.7254,  -2.5325,  -4.6673,  -2.1307,
        -13.9404,  -6.8036,  -5.1901,  -3.0918,  -2.0285,  -9.6193],
       device='cuda:0')
SINR mean = -5.728668212890625
E[H^H] = 1e-07
E_MSE (Error Power) = 5.834329128265381
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2490, 0.3466, 0.0267, 0.3047, 0.1726, 0.3298, 0.0753, 0.1107, 0.2196,
        0.4005, 0.4583, 0.3582, 0.2545, 0.3798, 0.0388, 0.1727, 0.2324, 0.3292,
        0.3853, 0.0984], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([521, 451, 836, 480, 589, 462, 713, 659, 546, 416, 380, 443, 517, 429,
        795, 588, 535, 463, 425, 676], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 0-----------
Real SNR = tensor([-0.7227, -1.3137, -1.3589, -2.9161, -1.9954, -0.0735,  0.2640, -0.2251,
        -1.4845,  4.0497, -4.2101, -0.5699, -0.7618, -0.5037, -2.2192,  0.5145,
         4.3439,  0.6351, -2.1026, -2.5704], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.5028e+01+9.2383e-07j, 1.3638e+01+1.0133e-06j, 2.3139e+01+8.2495e-08j,
        7.6519e+01-1.7574e-06j, 5.7021e+01+1.4938e-06j, 2.5699e+00+2.0387e-07j,
        4.0390e+01-6.8230e-07j, 4.0128e+02+3.2472e-06j, 1.1415e+01-6.3495e-08j,
        8.7825e-02-4.9339e-07j, 2.7789e+01-2.8610e-06j, 7.6529e+01-1.1331e-07j,
        2.7954e+02+5.1527e-06j, 5.7843e+00+4.9791e-07j, 4.6595e+01+6.2666e-07j,
        1.5091e+02+3.0399e-06j, 1.0374e+02+4.7616e-07j, 2.3194e+01+6.3309e-07j,
        9.0226e+00+4.7684e-07j, 1.1628e+01+1.3193e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(69.2909164428711+6.608028115806519e-07j)
torch.linalg.det(H.mH@H) = tensor([0.3070+1.1584e-08j, 1.3933+7.3827e-09j, 0.3154+7.5978e-08j,
        0.9082-2.1474e-08j, 1.2799-1.1849e-09j, 1.5956-3.2125e-08j,
        3.6662-4.1879e-08j, 1.3825-5.9605e-08j, 1.8841+9.3573e-09j,
        2.2497-1.3083e-08j, 0.6637+3.7495e-09j, 3.9481+5.8508e-09j,
        4.3245-5.5240e-08j, 0.6096+3.1885e-08j, 2.8323-5.4787e-08j,
        9.4289+2.4453e-09j, 2.2894-1.1061e-07j, 1.4562+2.6840e-08j,
        0.5293+3.9723e-08j, 0.5071-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.078547716140747-8.759582392769971e-09j)
SINR torch.Size([20]) = tensor([-11.4666,  -4.4724, -11.4066,  -5.3893,  -4.6448,  -4.3233,  -0.8214,
         -6.2269,  -3.7540,  -5.8769,  -4.4161,  -1.2763,  -0.8165,  -9.6132,
         -2.1633,   1.3797,  -6.9341,  -4.9391,  -7.0437,  -8.6262],
       device='cuda:0')
SINR mean = -5.141534328460693
E[H^H] = 1e-07
E_MSE (Error Power) = 4.089367866516113
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0666, 0.2631, 0.0675, 0.2243, 0.2555, 0.2698, 0.4529, 0.1925, 0.2964,
        0.2053, 0.2656, 0.4271, 0.4531, 0.0985, 0.3780, 0.5788, 0.1685, 0.2428,
        0.1649, 0.1207], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([729, 511, 727, 542, 516, 505, 383, 570, 486, 558, 509, 399, 383, 676,
        430, 307, 593, 526, 596, 646], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 1-----------
Real SNR = tensor([ 0.5015,  1.6734,  1.2511, -1.8900, -2.6413, -3.9515,  0.3679, -1.7468,
         0.7606,  0.0565, -5.2237, -0.5801,  1.4088, -0.2809, -0.6059,  4.0032,
        -5.1902,  1.4419, -1.2456, -0.1932], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  2.8265+1.4305e-06j, 121.2242+5.8250e-06j,   3.5835-5.2458e-07j,
          2.2194+5.1633e-08j,  13.8843-1.9073e-06j,  38.4061-6.3922e-08j,
         26.0487-1.9073e-06j,  14.9145+6.6849e-07j,  43.6843-3.2595e-07j,
        153.1459+8.5616e-07j,  59.8747-1.7075e-06j, 143.3826-3.0889e-07j,
         39.5821-4.5605e-08j,  57.3585-3.8147e-06j,  18.7574+8.4473e-06j,
         18.7559+1.2361e-07j,  23.5939-4.7684e-07j,  12.9643-1.9407e-07j,
        120.7927-3.5813e-07j,  26.2107-2.0433e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(47.06051254272461+2.7817424097520416e-07j)
torch.linalg.det(H.mH@H) = tensor([0.2096-7.4506e-08j, 2.3699-1.5801e-08j, 1.6528+4.1870e-09j,
        0.4767+3.2536e-08j, 2.1795-4.1228e-08j, 0.2362-1.4901e-08j,
        0.7573-2.9802e-08j, 1.3765-0.0000e+00j, 0.2087-3.0268e-09j,
        4.3584+3.2283e-07j, 0.1851-1.6040e-09j, 2.9449+6.2672e-10j,
        4.0795+5.5225e-08j, 0.2539-4.4703e-08j, 0.0519-4.7712e-08j,
        2.6139+8.3892e-07j, 0.2150+1.1176e-08j, 1.7209-2.7191e-08j,
        0.2755-1.4901e-08j, 0.7712-2.8076e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.346866488456726+4.736610037525679e-08j)
SINR torch.Size([20]) = tensor([-11.8624,  -2.0757,  -3.5616,  -5.1304,  -1.4471,  -8.0407,  -6.4989,
         -3.9885, -13.1239,  -1.1465,  -6.4158,  -1.0797,   0.3823,  -9.3555,
        -17.7659,  -4.2189,  -8.6203,  -3.0298, -10.1338,  -4.3269],
       device='cuda:0')
SINR mean = -6.071984767913818
E[H^H] = 1e-07
E_MSE (Error Power) = 6.99697732925415
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0611, 0.3827, 0.3057, 0.2348, 0.4175, 0.1357, 0.1830, 0.2853, 0.0464,
        0.4344, 0.1858, 0.4382, 0.5220, 0.1039, 0.0165, 0.2746, 0.1208, 0.3323,
        0.0884, 0.2697], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([740, 427, 479, 533, 405, 628, 579, 494, 774, 394, 576, 392, 341, 668,
        886, 502, 646, 460, 691, 506], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 2-----------
Real SNR = tensor([ 0.0156,  3.3725, -3.1075, -2.2296,  2.3674, -2.0595,  3.3841,  3.5465,
        -1.1713, -1.7383, -0.4068, -3.5236, -0.4375,  0.0248, -0.6663, -0.8971,
        -1.0021, -3.5559, -5.5890, -0.7904], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  2.7926+1.2591e-08j,  21.6249+1.1128e-07j,   6.0671-2.3242e-07j,
          0.5290-1.4806e-07j,  28.5590-4.1073e-07j,  13.5797-6.0807e-07j,
          1.9316-3.7025e-07j, 110.0453-3.2244e-06j,  47.7491-2.1477e-06j,
          5.6870-1.2049e-07j,   4.4672-1.1921e-07j,   6.3522-1.0870e-08j,
          4.1578+2.0862e-07j,  12.9888-5.2332e-08j,  14.5453+9.0590e-07j,
         38.2087-2.8071e-07j,   8.5555+1.7630e-06j,  93.7414+1.0381e-06j,
         22.1926+3.2812e-08j,  15.3834+1.9855e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(22.957908630371094-1.7271713659283705e-07j)
torch.linalg.det(H.mH@H) = tensor([2.1470-2.3234e-08j, 2.3641+3.7253e-08j, 0.6790+3.3571e-09j,
        0.0591+1.1176e-08j, 0.5867-1.7032e-08j, 0.0393+8.6290e-09j,
        2.9372-1.7130e-08j, 0.9488-2.9146e-08j, 0.9858-1.1047e-08j,
        0.1320-4.3770e-08j, 0.0609-5.6212e-08j, 0.0801+6.2034e-10j,
        1.5879-1.3498e-08j, 0.1510-9.5573e-08j, 0.1540-0.0000e+00j,
        0.4033+7.4506e-09j, 0.8716+4.2620e-09j, 0.8107-2.3021e-09j,
        0.1871+9.8627e-10j, 0.4872-1.6231e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.7836370468139648-1.1841616576191427e-08j)
SINR torch.Size([20]) = tensor([ -0.2884,  -3.0950,  -2.4629, -11.2288,  -5.6664, -15.3788,  -0.8474,
         -5.2149,  -3.5792, -10.6193, -13.4408,  -8.7119,  -0.0905, -11.7521,
         -9.5793,  -7.9119,  -3.1951,  -3.9341,  -5.0511,  -5.2091],
       device='cuda:0')
SINR mean = -6.362851142883301
E[H^H] = 1e-07
E_MSE (Error Power) = 6.814460277557373
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4834, 0.3290, 0.3619, 0.0701, 0.2134, 0.0282, 0.4514, 0.2313, 0.3049,
        0.0798, 0.0433, 0.1186, 0.4948, 0.0626, 0.0992, 0.1392, 0.3239, 0.2878,
        0.2381, 0.2316], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([364, 463, 441, 722, 551, 830, 384, 536, 480, 705, 782, 649, 358, 737,
        675, 624, 466, 492, 530, 536], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 3-----------
Real SNR = tensor([ 1.5465,  0.9168,  2.9669, -0.6682,  1.4349,  2.4534,  4.0666,  4.7929,
        -2.5072,  3.1547, -1.5095, -2.4303,  1.5960,  3.3939, -0.1638,  3.3875,
         4.6188,  5.7205,  3.6001,  2.9981], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([12.6308-6.5113e-07j, 16.6981+3.7653e-07j,  4.6152+2.9802e-07j,
        11.7065-2.3842e-07j, 27.0979-4.4308e-07j,  7.7730+2.3704e-07j,
         1.9889-1.1363e-07j, 23.8172-5.9971e-07j, 11.0196+5.6157e-07j,
        28.9568-1.9073e-06j,  1.7703+8.9407e-08j, 10.2237-9.5367e-07j,
         0.2645-5.1254e-08j,  7.4315+7.1526e-07j,  3.4160-1.4515e-07j,
         4.9950-3.0368e-07j,  0.5707-4.1723e-07j,  1.3335-1.9670e-06j,
        45.3852+1.3271e-07j, 17.2237-1.2424e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(11.94590950012207-2.752477143985743e-07j)
torch.linalg.det(H.mH@H) = tensor([2.4486+2.3842e-07j, 1.0408+3.7538e-09j, 0.9072-9.5801e-09j,
        0.3910-7.4506e-09j, 1.1581+4.7235e-08j, 2.0080-5.6783e-08j,
        2.2826-6.9695e-08j, 8.3828+5.7787e-08j, 0.2409+3.6139e-09j,
        3.0710-5.9605e-07j, 0.5089-1.1770e-09j, 0.4970-2.9802e-08j,
        1.0361+1.0990e-08j, 2.3687-0.0000e+00j, 0.2127-5.7810e-09j,
        0.6228-4.1241e-09j, 3.5368-1.0145e-08j, 0.5303+1.0012e-07j,
        1.2545-6.1597e-08j, 4.7377+6.5521e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8618217706680298-1.9185330657478517e-08j)
SINR torch.Size([20]) = tensor([-0.0829, -1.5172, -2.8891, -6.1921, -3.1575,  0.0831, -2.3681,  3.7773,
        -4.4602, -0.9482, -1.9031, -4.4624, -1.8475, -1.5249, -6.2889, -4.3762,
         0.8693, -7.1418, -2.7816,  1.4298], device='cuda:0')
SINR mean = -2.2891056537628174
E[H^H] = 1e-07
E_MSE (Error Power) = 1.8777048587799072
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4952, 0.4135, 0.3396, 0.1938, 0.3258, 0.5048, 0.3670, 0.7047, 0.2637,
        0.4456, 0.3922, 0.2636, 0.3952, 0.4131, 0.1903, 0.2674, 0.5499, 0.1619,
        0.3451, 0.5816], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([357, 407, 456, 568, 465, 352, 437, 231, 510, 387, 421, 510, 419, 408,
        572, 507, 325, 599, 452, 306], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 4-----------
Real SNR = tensor([-0.4996,  2.4793,  5.1325,  3.6419,  4.9402,  5.6071,  5.2595,  1.4550,
         3.6547,  1.3717,  8.9243,  0.0547,  5.0685,  0.9694,  3.2038, -1.3540,
         5.4718,  0.0659,  1.2464,  1.5169], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([8.3450e+00-1.1432e-07j, 2.3042e+00-2.7764e-07j, 3.9279e+01-1.9073e-06j,
        2.8674e+01-1.7057e-07j, 2.4941e+01+7.0506e-07j, 7.7378e+00+8.7990e-08j,
        5.0671e+00+1.4901e-06j, 7.0452e+00+2.3543e-07j, 6.3588e+00-9.5367e-07j,
        1.7647e+01+1.5874e-07j, 2.6336e+00-1.7703e-07j, 5.3930e+01+1.4174e-06j,
        2.1418e+01-1.0483e-07j, 8.0543e+00-2.3959e-07j, 2.4008e-02+3.5686e-07j,
        1.2098e+01+1.9339e-07j, 5.5041e+01-6.3890e-08j, 7.7286e+00+3.4725e-08j,
        1.0190e+01+1.2569e-07j, 1.5998e+00-5.1369e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(16.005840301513672+3.725640596030644e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0722+7.3659e-09j, 2.5208-3.9655e-08j, 5.5428+2.9673e-09j,
        3.7630+5.6060e-08j, 0.5531+8.9407e-08j, 3.0220+6.3916e-08j,
        3.0727+1.1921e-07j, 0.8858+6.2126e-10j, 3.1517-3.6367e-09j,
        1.3571+2.4275e-08j, 0.0189-4.6359e-07j, 0.0526+3.0734e-08j,
        0.8500+3.4273e-07j, 0.4357+1.3219e-08j, 0.7785-2.9802e-08j,
        0.0233+9.3132e-10j, 0.8636+1.6206e-07j, 0.1552-1.8292e-09j,
        1.7016-4.3172e-08j, 0.5907-1.6716e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4705581665039062+1.5754400450873618e-08j)
SINR torch.Size([20]) = tensor([ -8.9627,   2.1777,   3.8568,   3.2168,  -5.8412,   0.4810,  -0.2337,
         -1.2767,   2.3407,  -0.2558, -23.1696, -14.5339,  -3.7763,  -3.0739,
         -4.4884, -16.7366,  -4.6974,  -9.1557,   1.5577,  -2.9415],
       device='cuda:0')
SINR mean = -4.275635719299316
E[H^H] = 1e-07
E_MSE (Error Power) = 15.65868091583252
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1127, 0.6228, 0.7085, 0.6771, 0.2067, 0.5277, 0.4865, 0.4270, 0.6316,
        0.4853, 0.0048, 0.0340, 0.2954, 0.3301, 0.2624, 0.0208, 0.2532, 0.1083,
        0.5887, 0.3369], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([656, 281, 229, 248, 557, 338, 362, 399, 276, 363, 997, 810, 486, 462,
        511, 862, 518, 662, 302, 457], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 5-----------
Real SNR = tensor([ 8.4521, -4.1726,  1.9941,  3.2542,  3.1706,  0.2678,  7.1941,  6.0126,
         6.1441,  3.7878,  6.2173,  6.8675,  2.1567,  8.9225,  4.2954, -2.0905,
         3.0543,  0.4249,  3.6944,  3.2574], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.8139-2.3842e-07j,  1.4729+1.3900e-08j,  1.0362+1.9242e-08j,
         0.0502-3.8288e-09j,  0.8832+2.7528e-08j,  0.5491+2.0862e-07j,
         2.6446+8.0131e-09j,  8.3290+6.6675e-07j, 13.2109-1.1100e-06j,
        12.5536+1.1553e-06j,  3.6212-1.1921e-07j,  5.2833-1.1136e-08j,
         6.7672-9.7288e-08j, 17.7095-2.5492e-07j,  7.3224-2.1249e-07j,
         4.2221-7.1225e-08j,  3.2355-1.2628e-08j,  7.4653+2.5332e-07j,
         0.5763-3.6952e-09j, 12.6009-1.9195e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.817359447479248+1.293909757116296e-09j)
torch.linalg.det(H.mH@H) = tensor([4.0448-2.9802e-07j, 0.0465+1.8626e-09j, 0.3494-1.1685e-08j,
        0.8103-7.6181e-09j, 0.0735-3.8849e-09j, 0.9713+1.5714e-08j,
        7.4737-1.6355e-07j, 0.9127-3.0268e-09j, 1.2105-6.8304e-08j,
        1.1866-1.1921e-07j, 3.8476+3.3397e-08j, 4.3789-1.8863e-07j,
        0.8265-1.8178e-08j, 7.7167-1.7605e-07j, 2.5821-4.6124e-08j,
        0.4320+7.0705e-10j, 0.2627-5.2154e-08j, 0.5097-3.7296e-08j,
        0.9689-6.1601e-08j, 1.5467+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0075583457946777-5.869229724453362e-08j)
SINR torch.Size([20]) = tensor([  1.5761,  -7.1754,  -2.5175,  -0.8344, -11.0394,   1.2398,   5.2308,
         -1.9725,  -1.5217,  -3.0538,   3.7164,   3.4265,   0.9453,   3.8523,
          1.1106,  -0.9822,  -7.9178,  -3.6551,  -0.1147,  -0.2999],
       device='cuda:0')
SINR mean = -0.9993385672569275
E[H^H] = 1e-07
E_MSE (Error Power) = 1.8907390832901
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5897, 0.1608, 0.3590, 0.4521, 0.0730, 0.5709, 0.7693, 0.3884, 0.4133,
        0.3311, 0.7018, 0.6876, 0.5542, 0.7083, 0.5636, 0.4437, 0.1391, 0.3012,
        0.4934, 0.4827], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([301, 600, 443, 383, 717, 312, 190, 423, 408, 461, 233, 242, 322, 229,
        316, 389, 624, 482, 358, 365], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 6-----------
Real SNR = tensor([ 9.4144,  7.4303,  7.0162,  6.1068,  7.7309,  4.3388,  8.0098,  5.5814,
         6.4360,  4.0775,  1.2310,  5.5633,  5.1284,  8.7514, -0.1694, -2.6527,
         4.8177,  4.1647,  2.7355,  6.0204], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([13.3705-1.2030e-07j,  8.2662-1.2338e-08j,  5.9004-2.3842e-07j,
         8.8518-2.0446e-07j,  3.7346-2.0788e-07j,  0.4033-9.6858e-08j,
        21.9363-3.0324e-07j,  5.6034-7.1526e-07j, 18.3130-1.0542e-07j,
         3.3221-1.3113e-06j, 10.0501-4.5587e-08j,  4.3437+2.3842e-07j,
        10.0011+2.0383e-07j,  1.6321-1.9757e-07j,  0.3468-9.6858e-08j,
         0.5242-4.8679e-08j,  0.9736-1.7881e-07j, 12.6153+2.3842e-07j,
         0.3314+8.5262e-08j,  4.9556-9.0453e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.773780822753906-1.6037478189900867e-07j)
torch.linalg.det(H.mH@H) = tensor([17.8817+1.1538e-07j,  0.6294+4.4703e-07j,  0.1490-3.0175e-07j,
         1.0813-2.8652e-08j,  3.1407-9.7491e-10j,  0.2517-4.8728e-09j,
        10.1221-2.2490e-07j,  0.8798-1.1094e-07j,  6.2253-3.0270e-07j,
         1.5291-3.1464e-08j,  0.3352+3.7525e-09j,  2.2258+1.7881e-07j,
         1.5001-3.4616e-09j,  1.8648-3.6331e-08j,  0.2464+2.7557e-09j,
         0.1968-7.4506e-09j,  2.8676-3.5763e-07j,  5.5538+5.3260e-08j,
         0.7321-3.5157e-08j,  2.8933+3.7358e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.0153043270111084-3.03968654691289e-08j)
SINR torch.Size([20]) = tensor([ 8.6516, -4.3960, -9.7168,  0.9720,  3.2953, -4.7613,  7.4295, -1.8130,
         6.1116,  2.0751, -1.1611,  2.5810,  3.2753,  1.0232, -1.8354, -2.6093,
         3.1476,  5.0512, -0.1665,  4.4478], device='cuda:0')
SINR mean = 1.0800929069519043
E[H^H] = 1e-07
E_MSE (Error Power) = 1.2922611236572266
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8800, 0.2665, 0.0964, 0.5557, 0.6811, 0.2504, 0.8469, 0.3971, 0.8033,
        0.6172, 0.4336, 0.6443, 0.6801, 0.5586, 0.3959, 0.3542, 0.6737, 0.7619,
        0.4904, 0.7358], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([112, 508, 679, 321, 246, 520, 137, 418, 168, 285, 395, 268, 247, 319,
        419, 446, 251, 195, 360, 212], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 7-----------
Real SNR = tensor([4.2253, 5.7956, 6.6978, 8.7165, 2.1973, 8.8293, 8.9116, 0.6614, 4.6398,
        6.2255, 2.8186, 4.2503, 8.5871, 5.6212, 8.9211, 6.3731, 4.8999, 1.3632,
        6.3594, 6.5077], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.1657-3.8169e-08j,  1.3588-0.0000e+00j,  7.9720+3.8852e-09j,
        22.8911-2.0829e-07j, 10.9539+2.3842e-07j,  7.5872+2.2123e-08j,
         1.4668-2.9312e-08j,  0.1412+7.7399e-10j,  6.8582+1.1921e-07j,
         0.3464-1.4901e-08j,  3.1223-5.1199e-07j,  2.9120+7.4506e-08j,
        20.0256-5.2760e-08j,  0.1562-4.5180e-07j,  1.7889-4.2768e-07j,
         4.9157-1.5109e-08j,  2.3265-7.0693e-08j,  5.1616+1.7881e-07j,
         9.1468-4.6310e-08j,  1.1157+1.0172e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.720628261566162-6.095546467577151e-08j)
torch.linalg.det(H.mH@H) = tensor([2.0138-8.9649e-09j, 0.7009-2.9802e-08j, 2.2074+1.7327e-08j,
        4.0031+4.1830e-08j, 2.6447+2.2368e-08j, 1.3578-1.0696e-08j,
        2.6765-2.1818e-07j, 0.3601+8.1399e-09j, 0.4433+8.1382e-09j,
        0.3868-3.7253e-09j, 0.4061-1.9756e-09j, 0.3669+1.6133e-08j,
        0.4573-3.1292e-07j, 1.8474+4.1424e-08j, 5.7496-9.6108e-08j,
        4.4255-6.2703e-08j, 0.0326+7.6645e-09j, 0.6738-0.0000e+00j,
        0.7979-7.7763e-09j, 1.0564-4.9408e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.630392074584961-3.1961899793486737e-08j)
SINR torch.Size([20]) = tensor([  3.7435,  -1.1999,   4.8340,   6.0895,   4.3506,  -0.5471,   3.0330,
         -0.5165,   0.3567,  -4.0611,   0.3497,   0.2867,  -4.9728,   3.3770,
          6.1278,   6.1958, -11.5789,   0.8536,   1.8964,   0.2751],
       device='cuda:0')
SINR mean = 0.9446617364883423
E[H^H] = 1e-07
E_MSE (Error Power) = 1.4613265991210938
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7031, 0.4314, 0.7527, 0.8025, 0.7314, 0.4685, 0.6678, 0.4703, 0.5205,
        0.2819, 0.5201, 0.5165, 0.2414, 0.6852, 0.8039, 0.8064, 0.0650, 0.5490,
        0.6075, 0.5158], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([233, 396, 201, 168, 215, 373, 254, 372, 342, 496, 342, 345, 528, 244,
        167, 165, 732, 325, 290, 345], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 8-----------
Real SNR = tensor([ 2.1535,  7.8467, -2.3570,  3.7001,  5.0535,  7.8712,  9.5102,  4.5673,
         9.1055,  3.2344,  5.5462,  5.4628,  7.7469, 11.0339, 10.9223,  4.1735,
         5.0888,  4.3390,  3.8090,  8.7575], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4687-1.2353e-07j,  3.0847+8.0987e-08j,  0.1977+2.3283e-08j,
         0.8618-2.0416e-09j,  0.4132-1.9551e-10j,  2.9348-8.9998e-08j,
         3.1918-0.0000e+00j,  0.5111-3.6176e-09j,  6.4068+5.4927e-08j,
         0.0575-9.3132e-09j,  5.6807+1.1143e-07j,  2.8603-2.0821e-08j,
         1.3332+3.1158e-08j, 12.7381-7.2550e-08j, 20.6705+3.4666e-07j,
         5.1714-8.3706e-08j,  2.2409-3.6703e-08j,  1.2474-3.4704e-08j,
         0.1149-1.8626e-08j,  2.4075-8.2936e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.629645586013794+3.4853060437711747e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.1012-1.8626e-09j,  3.6029+1.6074e-07j,  0.0318-3.3358e-10j,
         0.5486+2.8390e-09j,  0.3262-7.7060e-09j,  3.0603-5.6616e-08j,
         2.5022-0.0000e+00j,  0.1539-4.1744e-09j,  0.2218-3.1937e-07j,
         0.1945-7.4506e-09j,  1.9096-1.4024e-08j,  1.0664+1.7691e-08j,
         0.0148-6.2237e-08j, 14.3367+7.3970e-07j,  4.9001-5.9605e-08j,
         0.0261+3.1665e-08j,  0.1436-0.0000e+00j,  0.1364+5.9227e-09j,
         0.1749-3.2924e-09j,  0.3839+2.2803e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6918045282363892+2.2234608820781432e-08j)
SINR torch.Size([20]) = tensor([ -2.5006,   5.7976,  -3.6448,   2.4640,  -0.3851,   6.2146,   3.4606,
         -2.0807,  -6.6131,  -2.2483,   6.3782,   4.4571, -15.6725,   9.0607,
          4.8574, -13.6951,  -5.8213,  -2.1209,  -0.9356,  -3.0792],
       device='cuda:0')
SINR mean = -0.8053507804870605
E[H^H] = 1e-07
E_MSE (Error Power) = 4.096936225891113
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3599, 0.7917, 0.3017, 0.6382, 0.4778, 0.8071, 0.6893, 0.3825, 0.1791,
        0.3734, 0.8128, 0.7362, 0.0264, 0.8896, 0.7537, 0.0410, 0.2074, 0.3803,
        0.4464, 0.3298], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([442, 175, 482, 272, 368, 165, 241, 427, 582, 433, 161, 212, 837, 104,
        200, 788, 556, 429, 387, 462], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 9-----------
Real SNR = tensor([ 9.6976,  2.8880,  5.8715,  8.1644,  5.2825,  7.8793,  6.6873, 11.0875,
         2.2355,  5.9837,  7.2421,  8.4527,  8.4616,  8.7874, 10.2524, 10.1634,
         6.3369,  9.6502, 10.3031,  6.6615], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.0725-8.9407e-08j,  3.1470+9.1909e-08j,  0.0147+2.0919e-08j,
         6.9170-3.1495e-08j,  1.4342+2.9802e-08j,  0.4244+5.2154e-08j,
         9.2807-1.9147e-07j,  0.2078+3.0945e-07j,  0.7159-2.0257e-09j,
         5.9081-3.9738e-07j,  1.9913+5.9206e-09j, 10.3492+2.6595e-08j,
         2.0703-4.6036e-09j,  4.0683-1.1921e-07j,  9.9403+2.7865e-07j,
         2.6139-9.2393e-07j,  0.2310-2.2615e-08j,  0.8149+7.4062e-09j,
         8.3960-9.8771e-08j,  0.2899+2.5332e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.4943768978118896-4.0239068965775004e-08j)
torch.linalg.det(H.mH@H) = tensor([0.3907+1.4901e-07j, 0.3743-5.7828e-09j, 0.4832+4.2902e-08j,
        6.5479+2.1659e-07j, 0.4151-2.9802e-08j, 0.4851-4.2912e-08j,
        1.7266-1.2875e-08j, 0.6706-3.6438e-08j, 0.0683+2.4536e-09j,
        2.2765+1.1079e-08j, 0.0661-9.8720e-08j, 2.7441-2.2389e-08j,
        0.3706-1.8075e-09j, 0.2154+8.9407e-08j, 3.1502-3.7597e-08j,
        3.7742-4.4787e-08j, 1.4747-1.4979e-08j, 1.2756+2.2052e-08j,
        2.2299-1.1932e-07j, 0.1879-1.6300e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4463441371917725+2.489348505108069e-09j)
SINR torch.Size([20]) = tensor([-2.5246,  2.9748,  2.4109,  9.3011, -2.7728,  0.5473,  5.4048,  0.0173,
        -2.6807,  7.0607, -7.1001,  7.4110, -0.3214, -3.9686,  5.6020,  7.5746,
         4.8335,  4.1586,  2.9845, -1.5025], device='cuda:0')
SINR mean = 1.9705113172531128
E[H^H] = 1e-07
E_MSE (Error Power) = 0.9764100909233093
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3586, 0.6648, 0.6353, 0.8949, 0.3456, 0.5315, 0.7763, 0.5010, 0.3504,
        0.8356, 0.1632, 0.8464, 0.4815, 0.2862, 0.7841, 0.8512, 0.7527, 0.7226,
        0.6653, 0.4144], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([443, 256, 274, 100, 451, 336, 186, 354, 448, 145, 598, 137, 366, 493,
        181, 134, 201, 220, 256, 407], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 0)

--- 処理中: 画像 21 から 40 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 20)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5159, 0.4950, 0.6478, 0.5684, 0.4894, 0.5508, 0.6202, 0.6527, 0.5857,
        0.6284, 0.7064, 0.7388, 0.7715, 0.6258, 0.9953, 0.6690, 0.7056, 0.8390,
        0.6214, 0.6514], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -3.7070,  -5.0525,  -6.1547,  -6.0123,  -5.8844,  -6.2531,  -6.9453,
         -2.2182,  -5.4538,  -3.1622,  -2.2645, -10.1240,  -6.0960,  -4.3073,
         -7.5564,  -5.7627,  -5.5003,  -7.3799,  -6.0165,  -3.6706],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.8809e+01+2.4555e-06j, 3.0165e+02+1.2207e-04j, 1.0905e+02+4.7684e-06j,
        1.4560e+02+6.1780e-06j, 3.3948e+02+4.6622e-07j, 1.7911e+03-8.3737e-06j,
        6.9579e+02+5.5395e-06j, 3.5691e+02+1.5259e-05j, 3.2314e+02-1.2777e-05j,
        5.0940e+02-2.0028e-05j, 2.1890e+02+8.6153e-06j, 2.9758e+02-4.0057e-06j,
        7.6022e+02-6.0106e-07j, 1.7406e+02-6.1035e-05j, 4.2607e+02-3.8599e-06j,
        1.2926e+01+1.4876e-07j, 1.1366e+03+1.7795e-05j, 9.3068e-01+3.8424e-07j,
        2.8199e+02+4.3879e-06j, 1.4697e+03+2.4933e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(468.49853515625+5.115991825732635e-06j)
torch.linalg.det(H.mH@H) = tensor([ 3.1731-1.4063e-08j,  0.2398-1.0435e-09j,  0.6568-0.0000e+00j,
         1.7110+2.8741e-08j,  0.0487+1.3305e-08j,  2.9770-3.0445e-08j,
         0.2578+1.7492e-09j, 10.5564-2.2770e-07j,  1.7104-1.8968e-10j,
         2.9763-0.0000e+00j,  0.9349+1.3105e-06j,  0.2190-0.0000e+00j,
         0.5389-4.1872e-08j,  7.6052-3.0152e-08j,  1.5285+1.9235e-08j,
         2.3311-1.6585e-08j,  1.0417-1.5309e-09j,  0.0269-6.1975e-08j,
         3.8454-3.5763e-07j,  3.1338+2.8906e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2756195068359375+3.096218037512699e-08j)
SINR torch.Size([20]) = tensor([ -6.7456, -16.7287, -12.1931,  -8.7154, -22.8737,  -7.2971, -14.5135,
         -4.8429,  -9.2733,  -9.2470, -15.7387, -13.5659, -14.0026,  -4.8200,
         -8.6113,  -9.1142, -10.1372, -25.7625,  -7.1734,  -7.5517],
       device='cuda:0')
SINR mean = -11.445385932922363
E[H^H] = 1e-07
E_MSE (Error Power) = 39.06110763549805
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1746, 0.0208, 0.0569, 0.1185, 0.0051, 0.1571, 0.0342, 0.2469, 0.1057,
        0.1063, 0.0260, 0.0421, 0.0383, 0.2479, 0.1210, 0.1092, 0.0883, 0.0026,
        0.1609, 0.1495], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 587,  862,  749,  649,  991,  604,  809,  523,  666,  665,  839,  785,
         796,  522,  646,  661,  691, 1000,  600,  612], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -4-----------
Real SNR = tensor([ -4.6150,  -7.6488,  -6.9482,  -7.7278,  -4.8454,  -4.4400,  -1.8437,
         -6.5151,  -2.7555, -10.7592,  -7.8432,  -9.2344,  -6.2496,  -6.1642,
         -6.4158,  -3.9608,  -4.2821,  -3.6318,  -3.2744,  -8.0970],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 317.2657+1.3522e-06j,   88.6399+1.9073e-06j,   79.1953-2.8610e-06j,
         150.1073+1.7264e-07j,  499.8316+1.4495e-05j,  334.1162+3.2372e-06j,
         381.2912-7.4477e-06j,   63.8234+5.7220e-06j,   14.5755+2.1322e-07j,
          30.4020-7.0759e-07j,  208.2185+1.1438e-06j,  600.8536+5.0072e-06j,
         108.5711+5.6648e-08j, 1565.4000-2.8479e-06j,   13.3399-1.9073e-06j,
           5.9770+1.6409e-06j,   32.1968+2.5158e-07j,  116.8898-2.0338e-06j,
         313.5690+6.7283e-06j, 1087.2750-6.8347e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(300.5769348144531+8.644083209219389e-07j)
torch.linalg.det(H.mH@H) = tensor([ 1.4614-1.2594e-08j,  0.1557-1.8626e-08j,  0.6692-3.8909e-09j,
         0.8376+3.7840e-10j,  0.7080-6.4548e-08j,  2.6974+1.1030e-07j,
         1.3156-4.0841e-08j,  0.7198-3.4567e-09j, 10.2394-6.7403e-09j,
         0.0780+1.6432e-09j,  1.5201-1.1519e-08j,  0.3311-1.4193e-08j,
         1.2545-1.7881e-07j,  0.6854+5.1768e-09j,  0.5867-7.5721e-10j,
         2.5639+1.2004e-08j,  0.0942-6.7055e-08j,  2.4182+3.1370e-08j,
         5.7466+6.0711e-08j,  0.1087+2.5327e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7095657587051392-9.945959611457056e-09j)
SINR torch.Size([20]) = tensor([ -8.0673, -15.5668,  -9.7437,  -8.1416, -11.9324,  -7.2029, -10.0959,
         -9.2283,  -3.5167, -15.0752,  -7.4646, -11.3183, -10.1209, -10.6800,
        -10.2434,  -6.9941, -21.6163,  -6.2008,  -4.2276, -16.5970],
       device='cuda:0')
SINR mean = -10.201702117919922
E[H^H] = 1e-07
E_MSE (Error Power) = 18.291732788085938
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1350, 0.0270, 0.0959, 0.1330, 0.0602, 0.1600, 0.0891, 0.1067, 0.3079,
        0.0301, 0.1520, 0.0687, 0.0886, 0.0788, 0.0864, 0.1665, 0.0068, 0.1934,
        0.2742, 0.0214], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([629, 835, 680, 631, 742, 601, 690, 664, 477, 823, 610, 725, 691, 707,
        694, 595, 967, 569, 502, 859], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -3-----------
Real SNR = tensor([-2.9224, -1.8369, -3.4166, -2.5013, -1.5273,  1.3785, -9.5373, -5.8160,
         0.4103, -7.5387, -2.3814, -4.9225, -3.3642, -7.6048, -4.6168, -2.6607,
        -6.4285, -4.8671, -5.0438, -3.7391], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  10.7588-1.8739e-06j,  189.9642-4.5499e-07j,   57.6579-1.5844e-06j,
          55.5225-1.1362e-07j,   31.5132-3.0341e-06j,  226.8941-7.6294e-06j,
          25.4313+1.4247e-06j,  700.5415+1.1516e-07j,   29.3842+2.4560e-07j,
         147.7848-5.4964e-07j,   82.2269+5.0981e-06j,   25.1989+8.8356e-08j,
         288.2285+4.2638e-06j,  381.5592-7.6294e-06j,   74.6226+1.1444e-05j,
         310.9756-3.5510e-06j, 1043.1991+2.7834e-05j,   79.5453-1.7983e-06j,
           1.7645+2.2352e-07j,   24.0867-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(189.34298706054688+1.1259165830779239e-06j)
torch.linalg.det(H.mH@H) = tensor([1.1054+1.7881e-07j, 3.5943+1.8016e-08j, 3.0021-6.7773e-08j,
        6.7077+5.4883e-08j, 5.5076-1.1165e-08j, 5.0383+2.6822e-07j,
        0.1590-3.4335e-09j, 0.0664+5.6355e-09j, 0.0530-1.3770e-08j,
        0.0090+8.8476e-09j, 7.2746+1.0813e-07j, 1.3574-6.2083e-09j,
        0.3887-1.0364e-07j, 1.0579+5.4628e-09j, 1.6527-3.0682e-08j,
        0.3080-3.9421e-07j, 0.6651-2.0573e-08j, 0.1558+2.9802e-08j,
        1.4680-2.3132e-08j, 1.6445-1.8028e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.060779333114624-7.400188795081419e-10j)
SINR torch.Size([20]) = tensor([ -9.5798,  -4.8268,  -4.2195,  -2.5718,  -2.8873,  -7.6884, -11.1677,
        -17.8532, -24.0581, -27.2167,  -2.7836,  -6.0077, -14.6920,  -6.5593,
         -7.1853, -16.1613,  -9.1171, -15.3737,  -5.9235,  -6.7070],
       device='cuda:0')
SINR mean = -10.128990173339844
E[H^H] = 1e-07
E_MSE (Error Power) = 48.0075569152832
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0992, 0.2476, 0.2746, 0.3561, 0.3397, 0.1455, 0.0710, 0.0161, 0.0039,
        0.0019, 0.3450, 0.2005, 0.0328, 0.1809, 0.1605, 0.0236, 0.1092, 0.0282,
        0.2036, 0.1759], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 675,  523,  502,  444,  455,  617,  721,  888, 1000, 1000,  452,  562,
         814,  581,  601,  849,  661,  830,  560,  585], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -2-----------
Real SNR = tensor([ -2.3476,  -1.4128,  -6.8528,  -2.0882,   2.0573,  -5.3901,  -2.6823,
         -0.0973,  -1.2140,  -1.2502,  -5.6865,  -0.7272, -10.9389,  -1.9536,
         -3.9369,  -3.1919,  -3.9757,  -0.7835,  -6.4685,  -2.4773],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 51.2834-3.8147e-06j, 208.4286+1.4749e-06j,   6.0940+1.0524e-06j,
        101.0685-1.0664e-06j,  59.0914-1.1134e-07j, 117.6113-8.1374e-07j,
          2.8515+2.8787e-06j,  23.8149+9.5367e-07j, 173.3243-3.2541e-06j,
        110.5931-0.0000e+00j,  22.4039+2.5628e-07j,  15.0640+1.0947e-07j,
         48.5100+1.1844e-06j,  48.3257-2.0696e-06j, 120.6210-4.2829e-06j,
        137.9475-6.6074e-06j,   1.4807-3.7381e-08j, 147.9021-1.2427e-05j,
         19.7706+4.9903e-07j, 298.1783+5.7008e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(85.71824645996094-1.2752834663842805e-06j)
torch.linalg.det(H.mH@H) = tensor([2.5698+1.7060e-08j, 2.6187-1.1921e-07j, 0.1178-9.3132e-09j,
        0.7548+1.8353e-08j, 5.4476-1.0864e-07j, 2.0098-4.8892e-10j,
        1.7337-2.0253e-08j, 1.2223+1.8957e-08j, 2.3744+1.9495e-10j,
        6.5425-7.1746e-08j, 1.3466-2.1906e-08j, 7.9302+7.2319e-08j,
        0.0332+1.6704e-10j, 0.3139-2.4787e-08j, 0.1242-1.4901e-08j,
        3.5542+9.5459e-09j, 2.1009-5.5971e-09j, 5.2519+2.4986e-08j,
        0.4075+9.3768e-09j, 1.7865-5.1396e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4120280742645264-1.3864088543869002e-08j)
SINR torch.Size([20]) = tensor([ -4.2373,  -6.1412, -14.4869,  -8.9400,  -4.4707,  -4.8109,  -4.9541,
         -8.7802,  -5.5396,  -2.5877,  -5.4916,  -1.2731, -15.1739, -13.1959,
        -17.7666,  -4.1408,  -4.1655,  -4.4900,  -7.6742,  -5.1584],
       device='cuda:0')
SINR mean = -7.173929691314697
E[H^H] = 1e-07
E_MSE (Error Power) = 9.360506057739258
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2738, 0.1956, 0.0344, 0.1132, 0.2632, 0.2483, 0.2422, 0.1169, 0.2183,
        0.3553, 0.2202, 0.4272, 0.0295, 0.0457, 0.0164, 0.2782, 0.2771, 0.2623,
        0.1459, 0.2337], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([502, 567, 808, 656, 510, 522, 527, 651, 547, 445, 545, 399, 825, 776,
        886, 499, 500, 511, 616, 534], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -1-----------
Real SNR = tensor([-4.6626, -3.5363, -1.2963, -0.8861, -0.4321, -6.7390, -0.1476, -2.7126,
        -1.0878, -1.2626, -4.2063, -2.6352,  0.5400, -2.8929, -5.9538, -3.7003,
        -0.0614,  0.0069, -3.5703, -4.8115], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  9.1642-1.3168e-06j, 119.2332-2.3473e-06j,  30.8913-0.0000e+00j,
         11.8763-7.6243e-08j,  96.1385+1.6625e-06j,   5.7704-4.3413e-08j,
         20.3069+3.5791e-06j, 282.6779+1.5903e-06j,   1.2337+1.7881e-07j,
         41.0381+1.0477e-06j, 104.7089+4.4095e-07j, 152.4221-3.8147e-06j,
          3.4066+1.1921e-07j, 170.3817+3.4579e-07j,  23.8339+4.7684e-07j,
         39.7591+3.4356e-06j,  34.1634+2.8610e-06j, 111.1341-2.7838e-06j,
          5.0946-3.5763e-07j, 216.5643-9.8344e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(73.9899673461914+2.4498018547092215e-07j)
torch.linalg.det(H.mH@H) = tensor([9.1288e-03-4.1597e-09j, 2.0230e-01-0.0000e+00j, 7.2183e-01-1.2886e-08j,
        4.1166e+00-4.0597e-08j, 6.2674e-01+1.3885e-07j, 1.7733e-01+5.6910e-09j,
        1.2859e-01-6.6617e-09j, 4.2899e+00-1.8592e-08j, 6.0806e+00+1.1289e-08j,
        5.3058e+00-8.5012e-08j, 8.1786e-01-1.2298e-07j, 1.8018e+00-1.2093e-08j,
        4.0825e+00-1.4392e-07j, 4.0970e-01-0.0000e+00j, 7.9474e-01+8.9407e-08j,
        1.2455e+00+9.2376e-10j, 9.3190e+00+9.6137e-08j, 4.3181e+00-5.5513e-08j,
        2.9987e+00+7.0667e-08j, 1.0882e+00-1.3684e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4267423152923584-5.157344329376201e-09j)
SINR torch.Size([20]) = tensor([-24.3251, -11.6589,  -7.5946,  -1.1289,  -9.8781, -10.5360, -15.2945,
         -1.6293,  -1.0165,  -1.2900,  -7.7084,  -5.7038,  -2.6752, -11.0949,
         -7.6450,  -5.8181,  -0.1017,  -1.4452,  -2.6973,  -5.3192],
       device='cuda:0')
SINR mean = -6.728033542633057
E[H^H] = 1e-07
E_MSE (Error Power) = 18.84882354736328
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0037, 0.0639, 0.1482, 0.4354, 0.0933, 0.0812, 0.0287, 0.4073, 0.4418,
        0.4263, 0.1449, 0.2119, 0.3507, 0.0721, 0.1467, 0.2076, 0.4941, 0.4176,
        0.3495, 0.2271], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  734,  614,  394,  684,  703,  828,  411,  390,  399,  617,  552,
         448,  719,  615,  556,  358,  405,  449,  539], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 0-----------
Real SNR = tensor([ 1.9849,  2.5178, -2.7015, -2.9888,  0.2132, -1.3003, -2.3595, -2.1510,
         1.5748, -1.8982, -3.4945, -0.2345, -3.6975, -3.0171, -0.6123, -0.3662,
        -0.6525, -3.1988, -2.3927, -1.9450], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([111.8767+1.5838e-06j,  35.7871-8.4478e-07j,  53.0489-1.5387e-07j,
          6.9001+1.1921e-07j, 109.5921-7.3925e-07j,  56.9641-1.5504e-07j,
         31.7730-1.0509e-06j,   7.3718-6.4786e-07j,  30.2402+2.8907e-06j,
         26.6281+4.8999e-07j,  25.4000+1.3156e-07j,  18.5203+1.9073e-06j,
         38.8826-5.0091e-08j,  67.7010-1.0109e-06j, 276.4191-4.9332e-06j,
         55.5173+2.3797e-08j,  19.5996-2.2548e-07j,  47.0976-1.4935e-07j,
          3.7700+1.3665e-07j,  21.6678-9.5367e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(52.23788070678711-1.81565553702967e-07j)
torch.linalg.det(H.mH@H) = tensor([4.9337+1.4991e-07j, 9.9956-4.4826e-08j, 1.1519+1.3693e-08j,
        1.0943-1.3457e-08j, 3.7083+4.7805e-08j, 0.7960-5.9605e-08j,
        0.1306+7.6120e-09j, 0.3462-2.5680e-08j, 3.4052+1.0934e-08j,
        1.8478+2.4129e-09j, 0.5109-2.6514e-08j, 2.6105+4.3851e-09j,
        1.3807-7.8182e-10j, 0.7149+7.1239e-10j, 1.8304-8.7658e-09j,
        4.4729-2.4592e-08j, 1.2976+3.1839e-08j, 0.0422-2.9314e-09j,
        1.1413-2.9484e-09j, 0.8465-1.7227e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1128857135772705+2.098925699911547e-09j)
SINR torch.Size([20]) = tensor([ -1.5967,   1.4765,  -3.4194,  -3.9204,  -0.6313,  -6.5469, -11.8492,
        -11.3167,  -1.9167,  -2.7962,  -7.9865,  -2.3828,  -3.2267,  -4.9952,
         -2.3841,  -1.3037,  -4.8042, -14.9289,  -3.5017,  -4.3983],
       device='cuda:0')
SINR mean = -4.621448516845703
E[H^H] = 1e-07
E_MSE (Error Power) = 4.733529090881348
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4091, 0.5842, 0.3127, 0.2885, 0.4637, 0.1813, 0.0613, 0.0688, 0.3914,
        0.3444, 0.1372, 0.3662, 0.3224, 0.2405, 0.3661, 0.4255, 0.2486, 0.0311,
        0.3087, 0.2664], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([410, 304, 474, 491, 376, 580, 739, 725, 421, 452, 626, 438, 467, 528,
        438, 400, 522, 819, 477, 508], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 1-----------
Real SNR = tensor([ 4.0137, -2.2108,  3.4039,  1.6723,  1.7567, -0.5356,  4.8636, -5.5953,
         0.3880, -4.2355, -0.6339, -1.3341,  0.0609,  1.0372, -0.5943, -0.1526,
         1.0593,  3.7267, -1.4150,  2.0903], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([96.6194+5.1650e-07j, 38.5392+1.7704e-06j, 25.2991+5.8920e-07j,
        43.3347-3.7162e-07j,  5.8886-0.0000e+00j, 24.7617+9.5367e-07j,
        67.6764+4.7053e-06j, 25.0698+2.3912e-07j, 33.6343+3.7056e-08j,
         0.5334-1.3709e-06j, 44.5467+6.4929e-06j, 29.0138-1.8373e-07j,
        19.8547+3.6673e-07j,  0.6401-4.7684e-07j, 40.5314-6.2181e-08j,
        11.6985+9.5367e-07j, 72.7787+9.8085e-07j, 52.0964+3.1190e-07j,
         0.5303-3.8961e-07j, 27.7232+1.4099e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(33.038516998291016+7.601755100949958e-07j)
torch.linalg.det(H.mH@H) = tensor([0.2929-6.1127e-10j, 0.3544+1.1176e-08j, 1.3620-5.3644e-07j,
        0.8264+8.9407e-08j, 1.1352-3.0126e-08j, 1.2283+6.8122e-09j,
        5.2724+3.7988e-07j, 0.1450-4.8581e-10j, 1.0182+1.3970e-08j,
        0.0604+4.6566e-08j, 1.4876+5.9605e-08j, 1.4646+1.3303e-08j,
        2.7665+5.6487e-08j, 0.4123-1.3894e-08j, 0.3570-2.2352e-08j,
        2.0731+4.4809e-08j, 0.8264-3.8417e-08j, 3.6585+3.8170e-08j,
        0.1885-2.7008e-08j, 6.5861-1.8081e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.575785517692566+3.638484846746337e-09j)
SINR torch.Size([20]) = tensor([-12.5983,  -7.2481,  -7.2829,  -6.9551,  -5.4309,  -4.4470,  -1.4070,
         -8.3703,  -4.9511, -14.5060,  -5.3352,  -2.0664,  -1.1776,  -6.6964,
         -8.7276,  -1.7351,  -5.7152,  -1.4562, -12.5520,   1.4931],
       device='cuda:0')
SINR mean = -5.8582682609558105
E[H^H] = 1e-07
E_MSE (Error Power) = 5.8101019859313965
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0521, 0.1586, 0.1575, 0.1678, 0.2226, 0.2643, 0.4197, 0.1270, 0.2423,
        0.0342, 0.2264, 0.3832, 0.4326, 0.1763, 0.1182, 0.4014, 0.2115, 0.4169,
        0.0526, 0.5851], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([760, 603, 604, 593, 543, 510, 403, 638, 527, 809, 540, 427, 395, 585,
        649, 415, 553, 405, 759, 304], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 2-----------
Real SNR = tensor([-4.4741,  2.1668, -0.0129,  1.9474, -1.7036,  1.5648,  0.0732, -1.6662,
         1.3472,  0.2151, -0.1514, -1.9546, -0.4476,  3.4888, -1.9357,  0.8954,
        -1.3245,  2.2744, -2.5436,  0.4237], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  7.5274-8.1549e-08j,  12.9004+6.7700e-07j,  18.3543+1.5299e-07j,
        101.8773-1.1871e-06j,  92.9871-2.4171e-07j,  45.6027+3.3056e-07j,
         23.7181-5.1253e-07j,   0.2468-0.0000e+00j,  26.0451-4.1564e-08j,
         90.5689-2.2895e-06j,  44.7593-1.1614e-06j,  49.9100-1.3388e-07j,
         24.0101+9.5367e-07j,  25.4942-4.6902e-08j,   7.2120+1.1803e-06j,
          7.8053-2.3842e-07j,  63.7781+4.9676e-07j,  11.4451+5.9605e-08j,
          4.8584-6.5794e-07j,  15.1169-4.0150e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(33.71087646484375-1.5716268819687684e-07j)
torch.linalg.det(H.mH@H) = tensor([0.0422-5.3753e-09j, 2.2406-1.3815e-08j, 0.5833+5.9358e-09j,
        0.5392-2.9802e-08j, 0.0717-2.2352e-08j, 2.5369-7.2367e-08j,
        1.3794-5.9027e-08j, 0.5562-6.8142e-09j, 3.6646+1.9997e-09j,
        0.2123+5.2154e-08j, 0.0963-3.0499e-09j, 0.9126+1.0114e-08j,
        1.7795-7.8582e-09j, 0.2025+1.5204e-07j, 1.6429+2.6014e-08j,
        0.2996-1.1921e-07j, 0.2949-6.7389e-10j, 0.6260-1.2809e-07j,
        0.1124+3.7253e-09j, 2.6376-2.3791e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0215466022491455-1.201194432809416e-08j)
SINR torch.Size([20]) = tensor([-11.2266,  -0.3431,  -4.5666,  -6.5146, -12.3262,  -0.9608,  -1.8716,
         -4.1348,   0.6609, -11.1754, -13.9278,  -1.9558,  -0.8860, -13.2687,
         -0.9058,  -9.6444,  -6.1644,  -4.8932, -11.0810,   0.1031],
       device='cuda:0')
SINR mean = -5.7541422843933105
E[H^H] = 1e-07
E_MSE (Error Power) = 6.3999762535095215
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0701, 0.4803, 0.2589, 0.1824, 0.0553, 0.4449, 0.3939, 0.2785, 0.5380,
        0.0709, 0.0389, 0.3893, 0.4492, 0.0450, 0.4480, 0.0979, 0.1948, 0.2448,
        0.0723, 0.5059], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([722, 366, 514, 579, 752, 388, 420, 499, 332, 721, 794, 423, 385, 777,
        386, 677, 568, 525, 718, 351], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 3-----------
Real SNR = tensor([ 1.5317,  2.5868,  2.4247,  4.0015,  5.3328, -1.2713,  3.7654,  2.6050,
         4.9002, -0.1211,  2.9604, -0.8413, -0.4601,  3.7898,  2.9131,  0.6548,
         0.1538,  2.5189,  3.2303,  3.2986], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([15.8061+5.4141e-07j, 33.7898-0.0000e+00j,  6.2538-0.0000e+00j,
         1.0967+1.9498e-07j,  2.4537-1.6852e-08j,  8.6118-7.4611e-08j,
        13.9836+1.5646e-07j,  0.6880-1.1623e-06j, 17.5686+1.9381e-07j,
        49.4138-2.3663e-07j,  0.9340-3.0768e-07j, 16.1999-1.8021e-07j,
        12.8150-9.5367e-07j,  1.2335-8.4692e-08j,  6.4893-1.0261e-07j,
         4.9674-2.3842e-07j, 15.6964+8.3843e-07j,  6.8827-9.5367e-07j,
         0.4110-5.9605e-07j, 12.3256-4.5383e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(11.3810396194458-1.7180610711875488e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.0113-5.8673e-08j,  0.8625+3.2520e-08j,  0.7391-1.3764e-07j,
         0.9948+9.8208e-09j,  6.7679-8.1016e-08j,  0.2339-3.1015e-09j,
         6.8699+7.9985e-08j,  1.8927-1.9782e-08j,  7.2341-6.6521e-07j,
         0.5729-2.9802e-08j,  6.0266-9.8720e-08j,  0.1678+1.8626e-09j,
         0.1108+3.7253e-09j,  0.9200+5.7485e-08j, 11.2153-5.6006e-08j,
         0.6324+5.9605e-08j,  0.3752+9.7177e-09j,  0.5104-4.2689e-10j,
         5.6383+2.3842e-07j,  0.9643+1.0349e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6370127201080322-3.2344516398552514e-08j)
SINR torch.Size([20]) = tensor([-21.9766,  -3.7939,  -4.2605,  -3.2480,   2.7083,  -6.8950,   3.6413,
         -0.9810,   2.9460,  -4.9675,   2.5267,  -7.7513, -11.8061,  -2.8783,
          4.2573,  -5.0886,  -5.5762,  -5.0912,   0.9068,  -3.3976],
       device='cuda:0')
SINR mean = -3.5362586975097656
E[H^H] = 1e-07
E_MSE (Error Power) = 10.151294708251953
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0063, 0.2945, 0.2727, 0.3213, 0.6510, 0.1697, 0.6981, 0.4438, 0.6634,
        0.2416, 0.6415, 0.1437, 0.0619, 0.3401, 0.7272, 0.2365, 0.2169, 0.2364,
        0.5520, 0.3138], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([974, 487, 503, 468, 264, 591, 236, 389, 257, 527, 270, 619, 738, 455,
        217, 532, 548, 532, 323, 473], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 4-----------
Real SNR = tensor([-4.5628,  0.9202,  3.6038,  2.2706,  6.5974,  1.3900,  4.0640,  1.3909,
         3.0811,  5.4930,  2.6754,  4.2160,  0.3966,  2.1840,  4.9010,  2.2647,
         8.2141,  0.4773,  2.8013,  6.0677], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  0.2832+7.4506e-08j,   4.0016-3.2783e-07j,  15.8961-1.4305e-06j,
         39.7930-1.6481e-07j,  78.8102-2.7128e-06j,   3.7161-5.0303e-08j,
          4.5670+3.2117e-08j,  28.6610+2.2200e-07j,  15.3369+2.3299e-07j,
         24.2572-9.5367e-07j,  71.0792-2.8952e-07j,  11.9725-2.4023e-07j,
         40.7425-1.9360e-06j,   0.8083-5.0800e-09j,   5.4033-4.7684e-07j,
          3.8847+1.3980e-07j, 183.8918+3.2968e-06j,   0.8287+4.4721e-08j,
          7.2552+4.5303e-08j,  52.1235-2.7611e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(29.665618896484375-2.2635049390373752e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.0914+9.5438e-10j,  0.3369+6.3873e-09j,  1.0711+2.9802e-08j,
         0.7273-8.9407e-08j,  9.0508-1.2782e-07j,  1.3419-1.9864e-09j,
         2.8359-6.7297e-09j,  1.3413-6.1703e-09j,  0.8462+1.7881e-07j,
         5.8255-2.3842e-07j,  0.4955-2.1182e-08j,  0.5023-5.5659e-08j,
         0.3108+7.4506e-09j,  1.0589+6.4227e-09j,  2.6261-0.0000e+00j,
         0.1419-3.4157e-08j, 25.1221-5.4715e-07j,  0.0734+5.0258e-09j,
         0.6449+5.9605e-08j, 14.1753+2.6605e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.430973529815674-2.840802260095643e-08j)
SINR torch.Size([20]) = tensor([ -4.7087,  -3.2134,  -2.4854,  -3.1377,   4.5441,  -0.6828,   2.8360,
         -0.1549,  -2.7902,   2.6777,  -3.5374,  -5.4898,  -6.8727,  -0.7949,
          0.8522, -11.1432,   6.5558, -11.0018,  -4.1511,   6.0706],
       device='cuda:0')
SINR mean = -1.8313875198364258
E[H^H] = 1e-07
E_MSE (Error Power) = 2.5347275733947754
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2527, 0.3230, 0.3607, 0.3268, 0.7401, 0.4608, 0.6577, 0.4911, 0.3447,
        0.6494, 0.3069, 0.2203, 0.1704, 0.4544, 0.5489, 0.0714, 0.8190, 0.0736,
        0.2777, 0.8018], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([519, 467, 441, 464, 209, 378, 260, 360, 452, 265, 478, 545, 591, 382,
        325, 720, 157, 716, 499, 169], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 5-----------
Real SNR = tensor([ 6.0262,  5.6492,  7.0271,  2.6381,  5.4496,  2.6408,  2.6215, -2.6146,
         3.7486,  8.1411, -0.9280, -5.4361,  5.1687,  5.8681,  0.9694,  2.4156,
         3.2302,  4.5827,  4.4499,  3.7646], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.0918-6.2683e-07j,  4.7177+2.0103e-07j, 86.0764+7.4254e-07j,
         4.1420-9.4792e-08j,  1.7855-0.0000e+00j,  0.3915+5.5062e-08j,
        10.7812-2.0249e-07j, 12.3132+3.4572e-08j, 13.9964+3.0935e-07j,
        27.1404+1.7262e-07j,  2.2918-2.1406e-08j,  0.4464-3.6248e-10j,
         4.4453-5.0212e-07j,  2.7735-2.9802e-08j,  3.4126+1.2995e-08j,
         2.7012-1.8171e-08j,  0.7668-4.8645e-08j, 33.3827+6.5537e-07j,
        10.7485+1.5091e-07j, 12.8203-2.9232e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(11.81125545501709+3.947760163214298e-08j)
torch.linalg.det(H.mH@H) = tensor([2.7583e-01+1.3411e-07j, 2.7620e+00-4.3041e-08j, 9.4862e+00+1.8583e-07j,
        1.0453e+00-2.1374e-08j, 6.3026e+00-7.6740e-08j, 7.1445e-01+3.0121e-08j,
        1.0306e-01-2.0023e-08j, 7.6356e-02+1.0404e-09j, 3.3642e+00-8.3813e-08j,
        4.8433e+00+3.2128e-08j, 3.0692e-01-7.4506e-09j, 3.8760e-03-5.8208e-10j,
        8.0355e-01-4.6226e-08j, 2.1634e+00+5.9454e-08j, 1.2120e-01+9.3132e-09j,
        1.6817e-01+2.1871e-08j, 3.7918e-02+6.3447e-08j, 1.7077e+00+2.4155e-08j,
        1.9212e-01-9.5177e-09j, 4.1226e+00+1.2835e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9300453662872314+1.3276994614841442e-08j)
SINR torch.Size([20]) = tensor([ -8.1862,   2.8918,   5.3719,   0.5800,   5.4083,  -3.0530, -11.6992,
         -4.7977,   4.5397,   3.4262,  -2.4689, -17.3822,  -2.9401,   0.9568,
         -6.7781,  -8.7556, -14.0515,   2.5239,  -6.2690,   4.8165],
       device='cuda:0')
SINR mean = -2.7933201789855957
E[H^H] = 1e-07
E_MSE (Error Power) = 6.1487932205200195
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1318, 0.6606, 0.7750, 0.5333, 0.7765, 0.3312, 0.0633, 0.2489, 0.7399,
        0.6876, 0.3616, 0.0179, 0.3369, 0.5549, 0.1735, 0.1175, 0.0379, 0.6413,
        0.1910, 0.7519], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([632, 259, 187, 334, 186, 461, 735, 522, 209, 242, 441, 877, 457, 322,
        588, 650, 798, 270, 571, 202], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 6-----------
Real SNR = tensor([4.7384, 8.0125, 9.2228, 7.1644, 6.6094, 6.2399, 8.4348, 6.4987, 6.9884,
        7.6708, 3.2355, 6.1092, 6.1885, 0.0753, 5.7874, 6.6092, 4.4696, 5.4106,
        9.0630, 5.9818], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([21.0213+3.4364e-07j,  5.9663-1.7902e-07j, 17.4829+2.3027e-07j,
         5.2850+3.5763e-07j,  2.3506+8.9407e-08j,  5.5521+2.3842e-07j,
         0.1233+1.2861e-07j,  6.1512-7.5929e-07j,  2.7965+7.6303e-09j,
         5.3856+6.8572e-08j,  9.3264-9.9000e-09j,  2.9158-6.4358e-08j,
        10.2536-0.0000e+00j,  1.3559+2.3266e-08j,  2.0842-2.0538e-08j,
         0.5060-7.4506e-09j,  2.1913+8.9783e-08j,  5.9427-4.3661e-09j,
        28.6724+9.5367e-07j,  0.5615-4.4703e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.796231269836426+5.194757690674123e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0046-2.2823e-08j, 0.6473+9.7919e-08j, 8.6427-3.6456e-07j,
        1.5911-9.5194e-08j, 4.1641-1.1921e-07j, 6.6328-5.2371e-08j,
        4.4180-2.4259e-08j, 7.3102-2.2462e-08j, 3.6107+2.7672e-08j,
        7.1776-2.4023e-08j, 0.6355+5.5964e-09j, 0.3400+3.8743e-07j,
        2.0575-2.9802e-08j, 0.2664-8.4840e-10j, 1.8446-1.7439e-08j,
        1.3032-0.0000e+00j, 0.7429-8.7063e-08j, 6.8167+3.1279e-08j,
        2.3150+5.2154e-07j, 0.1064+3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.081364154815674+1.0755312196408795e-08j)
SINR torch.Size([20]) = tensor([  1.3244,  -3.3501,   5.4736,   1.7286,   3.8601,   6.0358,   4.9993,
          6.4338,   5.0105,   6.3101,   0.2887,  -6.5561,   1.8965,  -3.1921,
          2.4791,  -1.0106,  -1.7498,   6.3135,  -1.6226, -11.3813],
       device='cuda:0')
SINR mean = 1.1645643711090088
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5568698644638062
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5757, 0.3162, 0.7791, 0.5982, 0.7086, 0.8006, 0.7597, 0.8148, 0.7602,
        0.8105, 0.5166, 0.1810, 0.6075, 0.3241, 0.6390, 0.4421, 0.4006, 0.8106,
        0.4077, 0.0678], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([309, 472, 184, 296, 229, 169, 197, 160, 196, 163, 344, 580, 290, 466,
        272, 390, 416, 163, 411, 727], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 7-----------
Real SNR = tensor([7.0897, 6.7779, 4.6614, 2.5247, 6.1083, 6.3498, 3.9232, 7.5687, 4.4251,
        8.8879, 6.9091, 6.4902, 4.8321, 1.9041, 7.3833, 2.9824, 6.2577, 1.9056,
        9.0805, 7.3602], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 7.0828+3.3937e-08j,  2.2989+2.8785e-07j, 11.8126+1.1480e-07j,
         0.3048+8.9435e-10j,  0.7826-1.7198e-07j,  2.3221+1.1921e-07j,
         0.8931+1.9610e-08j,  2.0556+9.4324e-09j,  2.1961+8.7928e-08j,
         9.2350-7.5226e-08j,  9.2319-6.1823e-08j,  7.0245+2.1645e-07j,
         7.7620-4.1808e-09j,  0.2194-2.2352e-08j,  5.4407-4.7684e-07j,
         4.6507-5.8740e-08j,  3.1586-1.3840e-08j, 15.6241-1.3958e-08j,
        11.6749+1.1487e-07j,  3.0587-3.9726e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.341465950012207+3.3160121315489732e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.7427-0.0000e+00j,  1.7524-6.9303e-09j,  0.2621-3.7253e-08j,
         0.0482+4.9203e-08j,  1.6181+1.2814e-08j,  6.0607-9.7031e-08j,
         0.0817+9.2954e-09j,  7.8814+1.2181e-07j,  0.4206-1.5699e-09j,
        13.4029-1.4480e-08j,  1.3119+2.8948e-08j,  0.7813-5.9605e-08j,
         1.5949+3.2912e-08j,  0.2647-0.0000e+00j,  6.0377-2.1929e-08j,
         1.2262-9.2582e-09j,  0.0512-1.0636e-08j,  0.5191-4.0256e-09j,
         9.2530-1.5061e-07j,  4.7080-9.4072e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9009368419647217-1.262095583598466e-08j)
SINR torch.Size([20]) = tensor([ -0.5378,   3.5428,  -4.4839,  -9.9132,   1.8347,   6.4585,  -6.4241,
          7.7461,   0.4279,   8.1382,   3.5178,  -1.5351,   2.3755,  -2.1562,
          6.9601,   3.3694, -11.0332,   1.8144,   8.1341,   6.1068],
       device='cuda:0')
SINR mean = 1.217139482498169
E[H^H] = 1e-07
E_MSE (Error Power) = 1.8697569370269775
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4691, 0.6933, 0.2626, 0.0926, 0.6041, 0.8156, 0.1855, 0.8561, 0.5246,
        0.8669, 0.6921, 0.4125, 0.6334, 0.3784, 0.8324, 0.6848, 0.0731, 0.6030,
        0.8668, 0.8032], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([373, 239, 511, 685, 292, 159, 576, 130, 340, 122, 239, 408, 275, 430,
        147, 244, 717, 293, 122, 168], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 8-----------
Real SNR = tensor([ 8.8197,  2.6215,  5.0258, 11.0528,  8.9241,  4.0273,  1.9103,  4.8446,
         9.4538,  4.4382,  3.1836,  7.7207, 11.4915,  2.9932,  7.8324,  7.0002,
         8.7655,  2.9546,  8.3586,  8.0229], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 8.6899+7.4728e-08j,  0.3414+2.0888e-08j,  5.9652-1.5846e-08j,
         6.6272-5.3116e-08j, 10.8053+1.3170e-07j,  2.6204-3.5416e-08j,
         3.5475-8.4692e-08j,  3.4435+1.5038e-08j,  6.1966-7.8826e-08j,
         3.4413-6.4526e-08j,  0.5313+3.8464e-09j,  0.1528-8.3819e-08j,
        14.2580+8.2729e-07j,  0.0422-2.8871e-08j,  6.1321+4.9590e-08j,
         7.0791+2.3842e-07j,  2.8800+3.0128e-08j,  0.2099+7.4506e-08j,
         1.5896+5.9605e-08j,  5.6537-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.510342597961426+4.8070770475305835e-08j)
torch.linalg.det(H.mH@H) = tensor([5.6990-2.0722e-08j, 0.1257+1.4514e-09j, 0.0465+2.2352e-08j,
        1.8371-5.3671e-09j, 4.9105-1.3295e-07j, 0.4135+1.4901e-08j,
        0.0196+1.0245e-08j, 2.2562-6.3898e-08j, 4.3098-6.8513e-08j,
        0.3014+1.4901e-08j, 0.2575-1.3623e-09j, 2.2979+2.9802e-08j,
        3.7334-2.6934e-07j, 0.4685+6.1539e-09j, 4.1475+2.7842e-09j,
        2.4610-1.1921e-07j, 3.3087-1.0589e-07j, 0.6374-2.0449e-09j,
        0.1642-1.0474e-07j, 1.1670+6.7055e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9281303882598877-3.6219656607272555e-08j)
SINR torch.Size([20]) = tensor([ 8.4681, -1.1207, -9.3172,  1.3040,  7.0707,  0.7160, -9.6594,  5.2546,
         5.9623, -0.5720,  0.8921,  3.8662,  3.3855,  1.7328,  7.3632,  4.0078,
         6.1052,  3.2408, -6.9981,  0.5466], device='cuda:0')
SINR mean = 1.6124151945114136
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5251586437225342
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8754, 0.4358, 0.1048, 0.5745, 0.8359, 0.5411, 0.0976, 0.7703, 0.7978,
        0.4671, 0.5512, 0.7089, 0.6856, 0.5984, 0.8449, 0.7156, 0.8031, 0.6784,
        0.1664, 0.5314], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([115, 393, 667, 310, 145, 330, 677, 190, 171, 374, 324, 229, 243, 296,
        138, 225, 168, 248, 595, 336], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 9-----------
Real SNR = tensor([ 8.7537,  8.7475,  9.2374,  8.5961, 10.7403,  8.2016, 10.1298,  8.7597,
         6.9200,  5.2170, -0.4639,  7.7180,  8.4635,  5.4189, 10.7150, 11.6106,
         3.0633,  2.7318,  5.3590,  7.4230], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.9127+2.1262e-09j,  3.7064-4.1954e-09j,  4.4602+3.5845e-07j,
         0.0431-9.3132e-10j, 34.1734+3.7356e-07j,  2.8260-9.0629e-09j,
         1.6028-2.6822e-07j,  2.2222-5.3644e-07j,  2.0688+3.1804e-10j,
         8.1744-1.6406e-07j,  0.4226-2.4713e-08j,  1.1655-7.5800e-08j,
         4.0426+2.3842e-07j,  2.0477-0.0000e+00j,  4.7185+8.9737e-09j,
        16.1676+3.1166e-08j,  4.8426-2.0108e-08j,  3.7236-4.1523e-08j,
         7.1471-1.4329e-08j,  0.3332+1.3698e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.240048885345459-6.633203764039308e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.6290-1.9588e-09j,  3.0841-9.0221e-08j,  3.0884-4.4294e-08j,
         3.9649+6.1547e-09j, 12.7031-2.1248e-07j,  0.5720-1.6406e-08j,
         2.6043-2.3842e-07j,  0.5704+5.2154e-08j,  0.1295-3.3528e-08j,
         1.2376-3.3145e-08j,  0.1163-3.9267e-09j,  0.3178-9.7194e-09j,
         4.5112+1.1199e-08j,  0.1409+2.9802e-08j,  4.0604+8.7391e-08j,
         8.1058-1.6909e-07j,  0.3508-3.2288e-09j,  0.1344-5.5129e-09j,
         0.8443+1.7602e-08j,  0.3541-1.1827e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.375962495803833-3.3472709048965044e-08j)
SINR torch.Size([20]) = tensor([ 1.8933,  7.4870,  6.6279,  8.2046, 10.9566,  1.3386,  3.9387, -1.5240,
        -4.9540,  5.3688, -0.7271, -1.0729,  8.3092, -4.5113,  7.5459,  8.9490,
         2.6990, -1.2670,  4.5656, -0.5364], device='cuda:0')
SINR mean = 3.1645729541778564
E[H^H] = 1e-07
E_MSE (Error Power) = 0.7678613066673279
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6073, 0.8486, 0.8214, 0.8687, 0.9257, 0.5765, 0.7124, 0.4132, 0.2422,
        0.7749, 0.4582, 0.4386, 0.8714, 0.2614, 0.8504, 0.8870, 0.6506, 0.4276,
        0.7410, 0.4692], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([291, 135, 155, 121,  74, 309, 227, 408, 527, 187, 380, 392, 118, 512,
        134, 106, 265, 399, 209, 373], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 20)

--- 処理中: 画像 41 から 60 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 40)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6305, 0.6925, 0.4886, 0.7032, 0.5710, 0.5101, 0.6843, 0.5062, 0.6585,
        1.1102, 0.7262, 0.7535, 0.6937, 0.3628, 1.0899, 0.4007, 0.6435, 0.4448,
        0.6772, 0.7563], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -7.6854, -12.9947,  -9.0670,  -7.3754,  -7.6733,  -7.8773,  -8.7374,
         -6.0069,  -5.3576,  -4.5739,  -9.7728, -10.4324,  -9.3408,  -3.8820,
         -5.8649,  -3.7237,  -3.3528,  -7.3960,  -7.3675,  -4.7361],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  58.3079-6.0725e-06j,  304.5324+1.9073e-06j,  248.5537-1.9894e-06j,
         236.8526+3.1061e-06j,   15.8039-4.1139e-06j,   78.0062+3.1436e-06j,
          37.6848+7.1380e-05j,  352.4245+1.0609e-06j,   75.3209+1.1444e-05j,
          71.7873+4.4083e-06j, 1176.5795-6.3516e-05j,  330.2599-2.8180e-06j,
        1494.7041+2.1899e-05j, 1663.7137-1.5380e-05j,   38.7216+1.9073e-06j,
        1556.7086+3.6555e-06j,  245.6363+1.2513e-06j,  523.6225-3.0518e-05j,
          40.2795-2.3582e-06j,  117.9609-2.3309e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(433.373046875-1.2456087006285088e-06j)
torch.linalg.det(H.mH@H) = tensor([0.2263-2.1721e-09j, 0.1036-3.7253e-09j, 0.2976+3.7253e-09j,
        1.7797+1.5096e-08j, 1.1321-2.6117e-09j, 0.5139-2.9802e-08j,
        0.5728-4.4703e-08j, 2.3750-3.3171e-08j, 0.2298+9.6858e-08j,
        2.0478+2.0809e-07j, 0.1096-3.8773e-08j, 0.4715-1.6725e-08j,
        1.8295-1.4610e-08j, 1.2046+5.9605e-08j, 0.3107-3.3163e-09j,
        2.7176-2.3842e-07j, 2.6688-1.1921e-07j, 0.1842-2.2352e-08j,
        0.8833+1.0919e-08j, 2.2416-1.6284e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0950052738189697-8.846318344524207e-09j)
SINR torch.Size([20]) = tensor([-14.4620, -15.4472, -14.9503,  -7.8725,  -9.9394, -12.0627, -12.9077,
         -8.4643, -17.4512,  -8.6610, -18.2325, -11.1255,  -7.8975, -11.1341,
        -15.4405,  -9.2758, -11.1526, -17.5307, -10.2705,  -8.4465],
       device='cuda:0')
SINR mean = -12.136232376098633
E[H^H] = 1e-07
E_MSE (Error Power) = 20.6207332611084
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0346, 0.0277, 0.0310, 0.1403, 0.0921, 0.0585, 0.0487, 0.1247, 0.0177,
        0.1198, 0.0148, 0.0716, 0.1396, 0.0715, 0.0278, 0.1057, 0.0712, 0.0174,
        0.0859, 0.1251], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([808, 832, 820, 623, 685, 745, 768, 641, 879, 647, 896, 719, 623, 720,
        832, 666, 720, 881, 695, 640], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -4-----------
Real SNR = tensor([ -5.1074,  -4.7661,  -7.2555,  -8.1105,  -7.0615,  -6.6985,  -7.0750,
         -4.2676,  -3.1316,  -7.2292,  -6.1489,  -5.8085, -10.0590,  -2.2619,
         -5.2645,  -4.8377,  -6.9982,  -4.1968,  -2.6975,  -6.3030],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  6.2727+2.3842e-07j, 316.1853-1.5023e-06j, 908.5405-2.3724e-05j,
         12.6650-6.7239e-07j,  99.7458+9.1511e-07j, 205.2910-4.7364e-06j,
         96.1771-3.8335e-06j,  25.8933-1.5532e-06j,   1.3355-1.5497e-06j,
        418.0051-3.3282e-06j, 238.0815+7.9528e-08j, 189.9235-6.4212e-06j,
        202.8054+5.4519e-07j,  24.2318-2.4931e-07j, 105.8820-3.5679e-06j,
         72.5855-3.4332e-05j, 378.6567-5.7532e-06j,  14.7929+1.7750e-06j,
         96.9134-1.2358e-06j,  12.7175+8.5752e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(171.3350830078125-4.402401373226894e-06j)
torch.linalg.det(H.mH@H) = tensor([3.4981e+00+1.6964e-07j, 7.4354e-01+3.7254e-08j, 6.6168e-01+2.9802e-08j,
        1.0223e-01-8.4129e-10j, 3.2892e-02-1.0803e-07j, 7.0506e-01-4.6388e-09j,
        1.8002e-01-6.6687e-09j, 3.3438e-01-9.6858e-08j, 1.2867e+00-3.6690e-08j,
        2.7036e-02-3.5390e-08j, 2.5835e-01-8.1425e-08j, 9.3097e-01-1.1211e-07j,
        6.1756e-04+4.3685e-08j, 3.6531e+00+1.4628e-07j, 6.3170e-01+6.2544e-09j,
        2.1501e+00-3.1884e-09j, 2.6862e+00+5.8637e-08j, 1.5490e+00+1.9333e-08j,
        6.2232e+00-7.2370e-08j, 1.0145e+00+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.33346688747406-8.758881953063735e-10j)
SINR torch.Size([20]) = tensor([ -5.5953, -11.2127, -10.3356, -15.9721, -24.6332,  -9.7100, -15.7351,
        -16.0179, -10.3642, -22.2349, -15.0407, -11.4487, -38.2768,  -5.9542,
        -12.2414,  -6.3535,  -6.4058,  -7.2834,  -3.8298,  -9.3850],
       device='cuda:0')
SINR mean = -12.901519775390625
E[H^H] = 1e-07
E_MSE (Error Power) = 362.51171875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([2.1613e-01, 7.0318e-02, 8.4721e-02, 2.4657e-02, 3.4292e-03, 9.6580e-02,
        2.6004e-02, 2.4405e-02, 8.4212e-02, 5.9418e-03, 3.0376e-02, 6.6847e-02,
        1.4868e-04, 2.0246e-01, 5.6323e-02, 1.8802e-01, 1.8618e-01, 1.5748e-01,
        2.9279e-01, 1.0331e-01], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 549,  722,  697,  845, 1000,  679,  839,  846,  698,  979,  822,  728,
        1000,  561,  750,  574,  575,  604,  488,  669], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -3-----------
Real SNR = tensor([-11.0905,  -7.1866, -10.9215,  -4.0395,  -5.1830,  -5.2215,  -3.6431,
        -10.2020,  -5.6406,  -7.2930, -10.4229,  -4.4403,  -2.7270,  -5.1869,
         -6.8044,  -3.8896,  -7.4104,  -5.1545,  -4.1633,  -0.1827],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([383.9875-1.4197e-05j, 314.6454+1.7439e-06j,  12.6554+5.4453e-07j,
         80.8182+3.6456e-07j,  11.1248+8.1062e-06j,  12.1483+4.6391e-07j,
        160.5393+8.8203e-07j,   1.0553+8.8836e-07j, 109.3733+2.6703e-05j,
         28.7056-3.8948e-07j,  52.4388+3.5358e-07j,  56.1164-1.1542e-06j,
        195.3515-0.0000e+00j, 119.5410+2.5494e-06j,  55.7431+6.9632e-07j,
         20.9652-6.2211e-06j,  13.7209+2.6109e-07j,   4.5410+5.9605e-08j,
         34.7041+1.1240e-06j, 217.3737+1.7083e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(94.27745819091797+1.224332322635746e-06j)
torch.linalg.det(H.mH@H) = tensor([0.2415+7.4506e-09j, 1.0080+2.9894e-09j, 0.0610-9.6578e-10j,
        0.8317+2.7082e-08j, 0.2235-5.1478e-08j, 0.0143+1.4203e-08j,
        3.5484-2.1320e-08j, 0.1435-7.4506e-09j, 0.1720-5.9605e-08j,
        2.5757-5.1290e-08j, 0.0172-6.5193e-09j, 0.5690+5.9414e-09j,
        2.3086-2.8817e-08j, 2.6281-1.4808e-08j, 0.2838+5.2154e-08j,
        4.2461-1.4726e-08j, 0.4340+1.1015e-08j, 1.4351-8.6675e-09j,
        0.8278+2.3503e-08j, 1.2106-4.7628e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1390072107315063-8.446768617886846e-09j)
SINR torch.Size([20]) = tensor([-10.9630,  -7.0623, -15.3205,  -7.6682, -14.0166, -25.4133,  -4.5012,
        -12.5748, -18.0489,  -5.1621, -20.0328, -10.5432,  -5.3558,  -4.7664,
        -15.9249,  -3.4694,  -9.2219,  -6.8579,  -8.3473, -11.0082],
       device='cuda:0')
SINR mean = -10.8129301071167
E[H^H] = 1e-07
E_MSE (Error Power) = 31.619062423706055
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0742, 0.1644, 0.0285, 0.1461, 0.0381, 0.0029, 0.2618, 0.0524, 0.0154,
        0.2335, 0.0098, 0.0811, 0.2256, 0.2502, 0.0249, 0.3103, 0.1068, 0.1709,
        0.1276, 0.0735], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 715,  597,  829,  616,  797, 1000,  512,  759,  892,  534,  935,  703,
         541,  521,  843,  476,  664,  590,  637,  716], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -2-----------
Real SNR = tensor([-3.7310, -0.8758, -0.0387, -5.1229, -3.7420,  1.4928, -2.5382, -4.6943,
        -4.0218, -2.0005, -4.7963, -3.0856, -4.3697,  0.6642, -6.2695, -0.8142,
        -3.1510,  1.9806, -2.5544, -4.0732], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([161.4453-4.1129e-07j,   2.8969-3.5763e-07j,  60.9008+3.0275e-08j,
         77.6758-1.4911e-07j, 281.0084-7.1581e-06j,  67.0438-3.0683e-07j,
        108.7800-1.2243e-06j,  66.8302+9.0903e-07j,  18.8096+8.8640e-07j,
         43.7538+2.0871e-07j,   8.3953-1.4324e-06j,  90.2019+7.6294e-06j,
        465.2902+5.4728e-07j, 179.3546-1.5878e-06j,  46.4547+4.2457e-07j,
        767.8454+4.5985e-06j,  18.6086+7.5673e-09j, 324.9489+1.3586e-06j,
        108.3375+2.0152e-06j, 101.8166-1.9073e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(150.0198974609375+2.040312523376997e-07j)
torch.linalg.det(H.mH@H) = tensor([ 2.2175+2.4562e-08j, 10.6466+3.9443e-07j,  1.7800-2.0873e-08j,
         1.1316-0.0000e+00j,  2.6601-8.1764e-09j,  0.3582+5.6450e-08j,
         2.8272-1.1921e-07j,  1.3689+2.8461e-09j,  0.1597+6.5193e-08j,
         1.3510+1.4901e-08j,  2.3802-2.0337e-09j,  4.1030-3.4454e-08j,
         1.5226+2.9624e-08j,  9.4685+2.9626e-08j,  0.5073+1.0119e-07j,
         0.1458+2.3515e-09j,  0.3646+5.4732e-09j, 11.2047+1.0911e-07j,
         2.1765+9.5950e-09j,  0.9185+6.7964e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.8646297454833984+3.337023457561372e-08j)
SINR torch.Size([20]) = tensor([ -5.8785,  -2.0001,  -8.9292,  -6.2936,  -4.4792, -13.8153,  -5.0643,
         -5.4646, -15.1930,  -7.6560,  -4.2332,  -3.2894,  -5.6929,  -0.4602,
        -11.7932, -17.0826, -12.3178,  -1.0052,  -4.6264,  -7.1096],
       device='cuda:0')
SINR mean = -7.119214057922363
E[H^H] = 1e-07
E_MSE (Error Power) = 8.878950119018555
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2053, 0.3869, 0.1134, 0.1901, 0.2628, 0.0399, 0.2376, 0.2213, 0.0294,
        0.1464, 0.2739, 0.3192, 0.2123, 0.4735, 0.0621, 0.0192, 0.0554, 0.4424,
        0.2563, 0.1629], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([558, 424, 655, 572, 511, 791, 531, 544, 826, 616, 502, 470, 552, 370,
        738, 870, 752, 389, 516, 598], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -1-----------
Real SNR = tensor([  1.1974,  -1.3525,  -2.8058,   0.9629,  -3.2853,  -1.2505,  -4.5149,
         -0.4302,  -1.1945,  -1.4348,  -0.3686,  -3.4495,   0.5322,   0.1580,
          0.1153,   0.3693,  -0.0557,   0.5491, -10.3809,  -2.3242],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 48.2571-4.2932e-07j,  52.0381+1.9073e-06j, 196.5319-1.9556e-06j,
         35.3264+3.8147e-06j,   7.0732+5.3681e-06j,   8.6540-8.5737e-08j,
         51.0266+3.9677e-06j,  71.1845+1.2559e-07j,   7.2431+4.7684e-07j,
          7.7186-4.1978e-07j,  14.8560-4.8240e-08j,  19.8675-4.8851e-07j,
         33.1528-9.4345e-09j,   9.1430+2.3842e-06j,  76.6464+1.9073e-06j,
          2.6187+4.7684e-07j,   1.5818+9.5367e-07j,  21.6372-3.8147e-05j,
        119.5270-2.3370e-07j,   6.9226-1.0146e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(39.550331115722656-1.0268220194120659e-06j)
torch.linalg.det(H.mH@H) = tensor([5.3096+8.1453e-09j, 0.9184-2.5368e-09j, 0.4085-4.4703e-08j,
        6.2196+1.6701e-07j, 0.7813-3.0855e-08j, 4.6844+1.3783e-07j,
        0.9407+6.3373e-09j, 5.9159+2.4751e-08j, 0.9747-7.6994e-10j,
        1.1546-1.1925e-08j, 5.4796-0.0000e+00j, 0.4095+3.7253e-09j,
        0.0389-1.7775e-08j, 1.6341-7.6625e-08j, 8.5221-1.5887e-07j,
        1.5080-5.9605e-08j, 6.0074+1.9822e-07j, 0.4908-2.5332e-07j,
        0.0323+3.7253e-09j, 0.2143-2.7485e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.5822370052337646-6.736297741838371e-09j)
SINR torch.Size([20]) = tensor([ -2.2034,  -6.3765, -10.8629,  -0.4717,  -6.3427,  -1.6510,  -6.3312,
         -0.9723,  -6.8850,  -5.7472,  -3.6955, -12.0399, -21.8618,  -4.2855,
         -0.1101,  -6.5515,  -1.9105, -13.1918, -13.9115, -13.1353],
       device='cuda:0')
SINR mean = -6.926858425140381
E[H^H] = 1e-07
E_MSE (Error Power) = 13.522453308105469
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3758, 0.1872, 0.0758, 0.4729, 0.1884, 0.4061, 0.1888, 0.4443, 0.1700,
        0.2103, 0.2992, 0.0588, 0.0065, 0.2716, 0.4937, 0.1812, 0.3918, 0.0458,
        0.0390, 0.0463], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([431, 575, 712, 371, 573, 412, 573, 388, 591, 554, 484, 745, 972, 504,
        358, 580, 421, 775, 794, 774], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 0-----------
Real SNR = tensor([-0.7750, -2.8497,  0.6654, -2.8197,  3.0841, -4.6808, -0.9222, -1.7435,
        -7.1354, -3.9170, -3.7122, -6.2640, -2.3943,  1.0926,  0.6872, -7.5033,
         4.5821, -0.9785, -7.0242, -5.7664], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.7299e+00+5.0482e-07j, 7.8868e+01+1.1499e-05j, 7.4255e+00-1.3262e-06j,
        3.9200e+01+2.3172e-07j, 2.2301e+00-1.7924e-06j, 1.0685e+01+9.4992e-08j,
        4.4047e+01+3.0646e-07j, 1.3960e+02+3.8147e-06j, 5.0391e+00+1.1921e-07j,
        4.9212e+01+4.7431e-07j, 7.8496e+01-7.9429e-07j, 4.6871e+01-1.2880e-06j,
        1.2672e+01-5.8961e-08j, 2.9777e+01-5.5176e-07j, 3.5496e+02+3.3222e-06j,
        7.7891e-02+8.7347e-09j, 3.5202e+01+1.0701e-06j, 1.3198e+01-3.9374e-07j,
        7.7910e-01-1.6042e-07j, 1.3429e+02-1.0567e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(54.31789016723633+2.2567819257801602e-07j)
torch.linalg.det(H.mH@H) = tensor([0.5353-1.1921e-07j, 0.2417-1.7886e-08j, 3.5989-3.5763e-07j,
        1.1207+5.8556e-09j, 7.1634-6.3899e-08j, 0.2039+1.4901e-08j,
        3.1788-3.1344e-08j, 0.2228-5.2154e-08j, 0.1979+1.2189e-09j,
        0.4549-2.9063e-08j, 1.4181+1.3652e-08j, 0.1867+2.1413e-09j,
        0.4098-0.0000e+00j, 0.4607-4.9048e-09j, 0.2903+5.2532e-09j,
        0.0482-3.5782e-10j, 5.5037-8.8366e-07j, 1.7282+2.5451e-09j,
        0.0464-0.0000e+00j, 0.4186-2.2036e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3714559078216553-7.583707173353105e-08j)
SINR torch.Size([20]) = tensor([ -9.8760,  -8.5744,  -2.8777,  -4.0971,  -0.4780,  -9.9288,  -1.6540,
        -11.5625,  -8.1924,  -7.0708,  -3.4410,  -9.1333, -10.6982,  -9.7266,
        -10.5457, -11.9830,  -3.5904,  -3.2601, -15.2002,  -7.7008],
       device='cuda:0')
SINR mean = -7.47955322265625
E[H^H] = 1e-07
E_MSE (Error Power) = 7.463284492492676
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0933, 0.1219, 0.3402, 0.2802, 0.4725, 0.0923, 0.4059, 0.0652, 0.1317,
        0.1641, 0.3117, 0.1088, 0.0785, 0.0962, 0.0810, 0.0596, 0.3043, 0.3207,
        0.0293, 0.1451], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([684, 644, 455, 498, 371, 685, 412, 732, 633, 597, 475, 661, 707, 679,
        703, 743, 480, 469, 826, 617], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 1-----------
Real SNR = tensor([ 1.3353,  1.8571, -3.0915,  0.2216, -1.0475, -7.3755, -2.0049,  1.2697,
         0.6396, -0.9132, -0.2384, -1.2244,  0.2509,  3.6028, -3.1232, -1.4585,
        -3.5806, -1.2063, -2.5759, -5.0591], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  8.6526+7.6174e-07j,  71.6227+8.5758e-07j,  19.5591+2.4431e-07j,
         10.2137+4.0532e-07j,   0.5898-2.7126e-07j,   5.5241-7.9336e-08j,
         19.6974-6.3908e-07j,  73.7079-1.3944e-07j, 102.9678-1.5962e-07j,
        123.1196+1.2225e-07j,  26.7174+4.8777e-07j,   9.2254-0.0000e+00j,
         64.6085+4.0477e-07j,   3.6050+1.6271e-06j,  38.5596-7.5429e-07j,
         32.4749-3.5793e-07j,  12.7882+8.8854e-09j,  26.6307+7.9842e-06j,
          1.3662-5.9605e-08j, 102.1609+2.1067e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(37.689579010009766+6.275033115343831e-07j)
torch.linalg.det(H.mH@H) = tensor([4.0577-3.0284e-08j, 3.8244-8.2557e-08j, 0.0870+3.3957e-09j,
        0.5864+1.3170e-08j, 0.9753+2.9802e-08j, 0.0122+6.9849e-10j,
        1.2710+5.6529e-10j, 1.1437+1.2036e-07j, 4.1144+8.4831e-08j,
        0.3605-8.1956e-08j, 1.2434-3.7033e-08j, 0.8969-1.1921e-07j,
        3.0546-8.4091e-09j, 1.3601+4.7121e-08j, 0.6677-3.2504e-08j,
        1.0630+1.0056e-08j, 0.0819+1.8285e-09j, 0.5282-2.2352e-08j,
        1.5159+5.9605e-08j, 0.0936-3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3468948602676392-2.3300863460917753e-09j)
SINR torch.Size([20]) = tensor([ -0.3563,  -0.8284,  -9.8395,  -5.1919,  -4.9417, -16.4722,  -2.4090,
         -5.4188,   0.0407,  -9.7056,  -3.6115,  -5.3754,   0.0401,  -6.5170,
         -5.9413,  -2.5199, -11.1863,  -6.3665,  -3.5425, -14.7411],
       device='cuda:0')
SINR mean = -5.744206428527832
E[H^H] = 1e-07
E_MSE (Error Power) = 6.391145706176758
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4795, 0.4525, 0.0940, 0.2323, 0.2427, 0.0220, 0.3648, 0.2231, 0.5023,
        0.0967, 0.3033, 0.2248, 0.5023, 0.1823, 0.2029, 0.3589, 0.0707, 0.1876,
        0.3067, 0.0325], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([367, 383, 682, 535, 527, 856, 439, 543, 353, 678, 481, 541, 353, 579,
        560, 443, 721, 574, 478, 815], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 2-----------
Real SNR = tensor([ 0.1372, -1.5697,  0.2366,  3.9063, -5.5131,  2.7849,  2.9928, -1.1728,
        -6.4631,  2.4230,  0.0960,  1.7633, -3.7102, -1.7503, -0.2939,  1.6390,
        -0.2185,  3.9324,  2.3560, -0.2616], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.3326e+01+4.4001e-07j, 5.9630e+01+6.9864e-07j, 1.3104e+00+1.1921e-07j,
        8.3856e+00+1.5761e-07j, 9.3504e-03+2.3362e-08j, 4.3125e+00+2.2794e-08j,
        2.9487e+01+5.4627e-07j, 9.5747e+00-1.1032e-06j, 4.2583e+01+1.1939e-07j,
        1.1520e+00+3.3766e-07j, 1.6572e+01-6.3801e-07j, 7.9492e+01+1.4095e-06j,
        2.4479e+00-7.4623e-08j, 5.9629e+01-2.1545e-06j, 4.8775e-01-5.9691e-09j,
        1.3208e+01+2.3842e-07j, 3.9234e+00-2.9802e-07j, 1.4317e+01-3.7998e-07j,
        7.0711e+00+3.8147e-06j, 7.5048e+01+7.0805e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(22.098350524902344+1.990654112660195e-07j)
torch.linalg.det(H.mH@H) = tensor([1.9621-0.0000e+00j, 0.6792+3.2096e-08j, 1.5395+1.1820e-08j,
        8.0819-8.8808e-08j, 0.4022+6.5421e-09j, 2.8394-1.0666e-07j,
        0.8966+1.7056e-08j, 0.1439-1.4901e-08j, 0.0476-2.9495e-09j,
        0.2798+7.3213e-08j, 0.3095+7.8111e-08j, 0.0478+7.6692e-08j,
        0.1603+8.1619e-09j, 0.1622-1.7432e-10j, 0.6876-0.0000e+00j,
        2.1831-1.6969e-08j, 1.2815-7.2823e-09j, 2.8490+5.9701e-08j,
        4.2698-9.3376e-08j, 9.9506+1.3124e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9386848211288452+8.175552679290377e-09j)
SINR torch.Size([20]) = tensor([ -2.4257,  -4.8511,  -2.3784,   2.7294,  -3.3124,  -1.6092,  -5.6634,
        -10.6993,  -9.3230,  -9.0098,  -9.3124, -18.5878,  -8.5732,  -8.1709,
         -5.9253,  -1.0156,  -1.7317,  -1.2468,   0.6210,   1.8231],
       device='cuda:0')
SINR mean = -4.933114051818848
E[H^H] = 1e-07
E_MSE (Error Power) = 6.623265266418457
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3639, 0.2466, 0.3664, 0.6521, 0.3181, 0.4084, 0.2135, 0.0784, 0.1046,
        0.1116, 0.1049, 0.0137, 0.1220, 0.1322, 0.2035, 0.4418, 0.4016, 0.4287,
        0.5357, 0.6034], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([439, 523, 438, 264, 470, 411, 551, 707, 667, 658, 667, 904, 644, 632,
        560, 390, 415, 398, 333, 293], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 3-----------
Real SNR = tensor([ 4.3835,  1.5548,  1.5134, -2.2830,  1.6020,  1.7025,  2.5774,  0.0696,
        -5.8628, -3.9338,  1.8173,  1.5592, -0.6250, -1.7687,  3.8470,  1.8113,
         2.3149,  0.4018,  3.1064,  1.7285], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([10.1847-4.3251e-08j, 46.6744-9.1366e-07j,  7.8384-1.6962e-07j,
         3.0566+1.0460e-07j, 22.9052-8.2394e-07j,  3.8842-1.0817e-07j,
         7.5163-2.3842e-07j,  0.8634+5.9522e-08j,  0.9920-2.6822e-07j,
         0.9493+6.3980e-08j, 57.6814-4.7769e-07j,  2.4432+2.3513e-06j,
         8.1494+1.9143e-06j,  1.5169-4.2030e-08j,  6.4797+2.6224e-09j,
         0.7679+7.9770e-08j, 70.3145-2.2341e-07j, 31.5784+2.3912e-07j,
         2.2677+2.4238e-07j, 29.3308+6.7251e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(15.7697172164917+1.210893145753289e-07j)
torch.linalg.det(H.mH@H) = tensor([5.3533+2.1118e-08j, 5.8731-0.0000e+00j, 1.2422-1.6326e-08j,
        0.0533+8.6852e-11j, 0.8691+5.0815e-08j, 0.4176-1.0431e-07j,
        4.9952+3.8601e-08j, 0.3074-1.4239e-08j, 0.0107-7.4506e-09j,
        0.1305-1.6832e-09j, 2.5345-1.2770e-08j, 0.0332+1.5181e-07j,
        0.7128+9.9563e-10j, 0.4933+4.9943e-09j, 0.1808+2.6436e-09j,
        0.1565-1.0074e-07j, 2.9024-6.1003e-09j, 0.4745+2.9802e-08j,
        1.6323-5.9605e-08j, 3.6608+5.4696e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.601679801940918+1.617128542186208e-09j)
SINR torch.Size([20]) = tensor([  2.6997,   1.6017,  -2.3595,  -8.9702,  -3.9036,  -8.8719,   2.5180,
         -5.7576, -17.1334,  -6.0011,   1.0361, -18.0553,  -4.2685,  -3.1739,
         -9.6831,  -9.9840,   0.4553,  -6.2427,  -1.5290,   1.3907],
       device='cuda:0')
SINR mean = -4.811609268188477
E[H^H] = 1e-07
E_MSE (Error Power) = 8.155734062194824
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6506, 0.5912, 0.3674, 0.1125, 0.2893, 0.1148, 0.6410, 0.2099, 0.0190,
        0.2007, 0.5594, 0.0154, 0.2723, 0.3250, 0.0971, 0.0912, 0.5262, 0.1919,
        0.4129, 0.5794], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([265, 300, 437, 656, 491, 654, 270, 554, 872, 562, 319, 892, 504, 466,
        678, 687, 339, 570, 408, 307], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 4-----------
Real SNR = tensor([-0.1763, -1.4815,  3.7006, -0.9264,  6.2887, -0.2274,  5.2983,  5.6080,
         2.8408, -0.5467,  6.9513,  6.0632,  1.2218,  4.5044,  0.1443, -0.8141,
         2.8956,  7.6628,  7.0553,  0.1552], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.8032-1.1176e-08j, 14.6364+3.5002e-08j,  1.4639-6.4283e-08j,
         1.4787+1.1921e-07j, 29.1453+1.1921e-06j,  4.2456-4.2538e-08j,
        17.8712+5.7220e-06j,  0.1907+1.0396e-07j,  1.5115-7.3097e-09j,
         9.4201+1.1982e-06j,  3.7410+2.6813e-08j,  0.5874-7.4506e-08j,
         6.0811+3.9649e-07j,  3.9888-2.1451e-08j,  3.2301+4.3977e-08j,
        18.7843-1.0113e-07j, 10.2657+4.5639e-07j, 24.6791-3.7245e-08j,
        59.0773-1.8260e-07j,  4.1600+1.4305e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(10.768080711364746+5.091253569844412e-07j)
torch.linalg.det(H.mH@H) = tensor([1.0549-1.7490e-08j, 0.5177+2.4666e-09j, 1.4855-1.1921e-07j,
        0.1594+1.1176e-08j, 6.3456-7.1088e-08j, 0.0687+3.7253e-09j,
        2.4785+4.6194e-07j, 3.0007+3.1562e-08j, 3.1338-1.6181e-07j,
        0.3873-1.0431e-07j, 9.1392-1.8087e-07j, 8.3007+1.6296e-07j,
        0.1939+6.7055e-08j, 0.1367-2.8587e-08j, 0.8313-9.7908e-09j,
        0.3738+1.1502e-09j, 1.3885-6.3208e-09j, 7.1983+3.1257e-08j,
        2.4306+2.4933e-09j, 0.2392-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.443222761154175+3.815114446581447e-09j)
SINR torch.Size([20]) = tensor([ -0.1995,  -2.5022,  -1.3528,  -6.2761,   2.2496, -12.7300,  -1.7955,
         -1.4061,   1.3317,  -7.3752,   3.6622,   4.7001,  -7.5367,  -9.7904,
         -0.0392,  -2.9483,  -0.0449,   3.7151,  -0.8990,  -6.9915],
       device='cuda:0')
SINR mean = -2.311420202255249
E[H^H] = 1e-07
E_MSE (Error Power) = 2.919649839401245
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4885, 0.3598, 0.4228, 0.1908, 0.6267, 0.0506, 0.3981, 0.4198, 0.5761,
        0.1547, 0.6991, 0.7469, 0.1499, 0.0950, 0.4977, 0.3365, 0.4974, 0.7017,
        0.4484, 0.1666], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([361, 442, 402, 571, 279, 763, 417, 403, 309, 607, 235, 205, 612, 681,
        356, 458, 356, 233, 386, 595], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 5-----------
Real SNR = tensor([ 1.8716,  0.6841,  5.0464, -0.5393,  3.2117,  5.9274,  5.0819,  2.5068,
         1.1046,  1.0186,  1.3352,  3.6150,  7.1907,  3.9647,  0.0754,  2.2320,
         1.2543,  4.5260,  1.2763, -1.6005], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.8966+1.1921e-07j,  0.0704-5.5588e-08j, 19.9792+2.1297e-07j,
         6.4050-1.3026e-07j, 11.7729-2.6252e-09j, 19.7335+8.3973e-07j,
         1.1920+3.1467e-08j,  1.0684+1.1363e-07j, 19.7606-4.7684e-06j,
         0.5783+4.2274e-07j, 25.1270+2.2220e-07j, 25.6710+7.2384e-08j,
         4.3818+4.7684e-07j, 15.8283-5.6408e-07j,  2.7407+3.9559e-08j,
         6.1034-2.5798e-07j,  3.9488-7.5020e-08j, 10.8193-8.3213e-08j,
         1.9362+4.5699e-08j,  2.4888+2.9802e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(9.125102043151855-1.5213461779239879e-07j)
torch.linalg.det(H.mH@H) = tensor([1.3876+1.2520e-08j, 0.1758+2.3840e-09j, 2.5155+6.7579e-08j,
        0.0499+8.0688e-09j, 2.7422-4.5340e-08j, 4.9079+7.2360e-08j,
        3.2850-2.0793e-08j, 1.3705-7.3913e-08j, 0.8174+3.4946e-08j,
        0.3755-4.5502e-09j, 0.7650-9.6960e-09j, 1.1162-5.7007e-09j,
        5.3198+6.2400e-08j, 1.4934-0.0000e+00j, 0.0361+1.7071e-09j,
        1.1007-2.0539e-08j, 1.1710-2.6820e-10j, 2.6942-0.0000e+00j,
        0.3257-1.3212e-09j, 0.3916+1.4643e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6020488739013672+4.724312496762195e-09j)
SINR torch.Size([20]) = tensor([ 1.8179, -4.5794,  3.1177, -8.5852,  2.2253,  4.2125,  3.9474,  0.8049,
        -0.9638, -1.0678,  0.2138,  0.6377,  4.7818,  0.4475, -8.2997,  1.2843,
         1.0739,  1.8099, -2.1654, -1.7991], device='cuda:0')
SINR mean = -0.05428817495703697
E[H^H] = 1e-07
E_MSE (Error Power) = 1.4558628797531128
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6031, 0.2584, 0.6721, 0.1217, 0.6254, 0.7251, 0.7128, 0.5462, 0.4447,
        0.4388, 0.5123, 0.5366, 0.7505, 0.5257, 0.1289, 0.5734, 0.5615, 0.6027,
        0.3779, 0.3979], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([293, 514, 252, 645, 280, 219, 226, 327, 388, 392, 347, 332, 203, 339,
        636, 311, 318, 293, 430, 417], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 6-----------
Real SNR = tensor([5.1470, 3.7527, 5.6730, 7.4559, 5.1292, 6.9787, 6.8103, 5.5983, 8.1669,
        5.1342, 6.6419, 3.7644, 8.6075, 2.1693, 3.8529, 7.9921, 3.2333, 1.5480,
        5.6747, 6.3550], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.8699+2.6812e-07j,  0.3278-1.0850e-07j,  3.0256-7.9338e-09j,
        17.5149+2.8147e-07j, 19.5818-2.7198e-08j,  6.4300+1.8267e-08j,
         9.1952-3.1915e-07j,  0.3316+2.2352e-08j,  6.0316+1.7234e-07j,
        24.6926+6.0842e-07j,  6.6106+5.6954e-08j,  1.1263-2.9057e-07j,
         0.3245+3.9959e-08j,  1.0839-3.1901e-09j,  5.8198-1.1255e-07j,
         8.0788+6.3095e-07j,  3.1078+6.3660e-08j,  0.9944-4.9472e-09j,
         3.7684-5.1822e-08j,  4.5475-3.5553e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.323147773742676+4.405570663834624e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1673+1.1720e-07j, 1.4837+4.2933e-08j, 0.2383-1.2559e-07j,
        6.1822-3.1284e-07j, 1.3351-1.2473e-08j, 0.2390+2.5030e-08j,
        1.5201+1.1015e-08j, 1.8601+9.4285e-08j, 5.2966-4.0267e-08j,
        8.3016+7.4848e-08j, 3.7671-1.8931e-07j, 0.4982+2.0789e-08j,
        7.3986-9.7093e-08j, 0.2155+5.9231e-10j, 0.5588-3.7091e-08j,
        2.3080-0.0000e+00j, 0.4633+3.7096e-09j, 0.3119-2.1345e-08j,
        2.6080-1.4666e-08j, 3.7511-4.2697e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4252281188964844-2.5148153781628935e-08j)
SINR torch.Size([20]) = tensor([-8.5237,  1.8520, -5.5202,  6.1889,  2.2295, -6.3527,  1.5874,  2.1026,
         5.3853,  5.2818,  4.3442, -1.7936,  5.9513, -3.7150, -2.6064,  1.0030,
        -0.7803, -3.1312,  4.1812,  4.6517], device='cuda:0')
SINR mean = 0.6167896389961243
E[H^H] = 1e-07
E_MSE (Error Power) = 1.3436259031295776
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1232, 0.6050, 0.2191, 0.8061, 0.6256, 0.1880, 0.5904, 0.6187, 0.7756,
        0.7714, 0.7311, 0.3982, 0.7974, 0.2983, 0.3543, 0.5575, 0.4552, 0.3272,
        0.7237, 0.7448], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([643, 292, 546, 166, 280, 574, 301, 284, 186, 189, 215, 417, 172, 484,
        446, 320, 382, 464, 220, 206], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 7-----------
Real SNR = tensor([ 6.9636,  0.1156,  6.8123,  6.6194,  5.6033,  3.8412,  2.3457,  4.1599,
         4.1584,  6.2803,  5.5898,  8.0705, -0.4704,  9.4451,  1.6164,  9.2096,
         3.7447,  8.3116,  9.2145,  3.8461], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.2025-7.1526e-07j,  1.9723+4.8586e-09j, 10.3744-1.9864e-07j,
         2.7363-2.3958e-07j, 13.5732+9.1641e-07j,  2.1370+2.5136e-07j,
         0.9099-8.7784e-09j,  7.6218-2.3842e-07j, 19.5711+2.6009e-07j,
        21.6713+7.2042e-08j,  7.2462-4.1746e-07j,  4.7711+2.3199e-07j,
         1.4670-1.7881e-07j,  0.1003-4.0358e-08j,  2.4684+1.1921e-07j,
         7.9105+2.6551e-07j,  0.6292+5.4757e-10j,  4.8809+1.3976e-08j,
         3.7164+3.1921e-08j,  1.8275+4.1723e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.939382076263428+2.7392056622943528e-08j)
torch.linalg.det(H.mH@H) = tensor([1.7229+8.3447e-07j, 0.4679-9.7893e-09j, 1.0524+1.7881e-07j,
        0.1811-7.5829e-08j, 0.0395-6.0689e-08j, 0.8303-1.7845e-08j,
        0.1229-6.9582e-09j, 2.1377+2.2427e-08j, 1.5210-8.4853e-09j,
        4.4348-5.0573e-08j, 0.3235-5.0513e-09j, 5.8069-1.5277e-07j,
        0.0968-3.7253e-09j, 0.5028+2.7368e-08j, 0.8528-3.7228e-09j,
        5.0994-1.5442e-07j, 2.3067+2.1874e-08j, 6.6703-1.7794e-07j,
        7.3346+2.2783e-09j, 2.3920+4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1948177814483643+2.0206298856351168e-08j)
SINR torch.Size([20]) = tensor([  0.1186,   1.1157,   0.2343,  -6.4959, -12.5772,   1.6252,  -4.1077,
          3.5480,   4.0821,   6.8086,  -2.3637,   4.8547,  -3.6657,  -1.8494,
          2.1720,   5.2863,   4.5510,   6.2026,   7.5318,   2.6916],
       device='cuda:0')
SINR mean = 0.9881502389907837
E[H^H] = 1e-07
E_MSE (Error Power) = 1.757323145866394
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5068, 0.5639, 0.5135, 0.1831, 0.0524, 0.5925, 0.2797, 0.6936, 0.7191,
        0.8275, 0.3672, 0.7536, 0.3007, 0.3951, 0.6225, 0.7716, 0.7404, 0.8066,
        0.8500, 0.6502], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([350, 316, 346, 578, 759, 299, 498, 238, 223, 151, 437, 201, 483, 419,
        281, 189, 209, 165, 135, 265], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 8-----------
Real SNR = tensor([11.2295,  9.3195,  3.0091,  4.1627,  9.4193,  7.0810,  6.5571,  3.6653,
         5.8660,  3.8445,  5.2886,  7.5313,  6.0813,  0.9618,  1.3344,  6.7546,
         5.9714,  3.0804,  2.9518,  8.1798], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([32.0270-1.9161e-07j,  8.5071-3.4018e-07j,  2.2906+3.0654e-08j,
         0.0869-2.7940e-09j,  3.2726-7.1526e-07j,  0.0551-3.7253e-09j,
         1.9883-1.1921e-07j, 12.6278+1.0523e-07j,  3.8446-1.9756e-08j,
         0.7047+2.3295e-09j, 11.3541-4.7693e-09j,  1.2306-2.3842e-07j,
         0.4801+1.6391e-07j,  0.6644+5.9605e-08j,  0.3443-2.9287e-08j,
         3.0259+1.8300e-07j,  3.3599-1.0379e-08j,  2.4168-7.1526e-07j,
         2.3616-5.9605e-08j,  3.0300+1.4879e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.683626174926758-9.453216165411504e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0782+2.8514e-07j, 1.2393+1.0751e-07j, 0.0138+2.4754e-09j,
        0.6058+2.9802e-08j, 6.5359+6.8114e-08j, 1.0178-1.8507e-08j,
        1.1825+1.7881e-07j, 0.5969-1.1998e-08j, 1.5602-5.9471e-08j,
        0.2860+3.9243e-09j, 0.1349+2.1203e-07j, 0.9010-6.0757e-07j,
        1.2889+5.9605e-08j, 0.1888-3.5540e-09j, 0.1435+5.2000e-09j,
        2.8054-3.8267e-08j, 1.9563+1.1921e-07j, 0.0535-1.8626e-09j,
        0.1368+7.9453e-10j, 8.0284-1.9749e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4877004623413086+1.5582115153733866e-08j)
SINR torch.Size([20]) = tensor([ -1.3527,   1.1342, -11.7355,   1.9168,   7.7986,   3.3775,   1.9126,
          0.7915,   4.2287,   0.1574,  -7.8796,  -1.3263,   2.5944,  -0.9934,
         -4.3428,   6.8763,   4.0131,  -7.5317,  -1.4352,   7.3578],
       device='cuda:0')
SINR mean = 0.2780788540840149
E[H^H] = 1e-07
E_MSE (Error Power) = 1.837950587272644
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4228, 0.5649, 0.0628, 0.6086, 0.8576, 0.6852, 0.6084, 0.5454, 0.7259,
        0.5091, 0.1401, 0.4242, 0.6451, 0.4431, 0.2689, 0.8297, 0.7159, 0.1500,
        0.4181, 0.8448], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([402, 316, 736, 290, 129, 244, 290, 327, 218, 349, 623, 401, 268, 389,
        506, 149, 225, 612, 404, 138], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 9-----------
Real SNR = tensor([ 7.5394,  2.6486, 12.4937,  5.3833,  7.4814, 10.7871,  6.4901, 11.6297,
         8.1330,  6.4245,  8.0792,  8.8861, 11.3676,  8.7624,  3.5670, 10.2922,
         6.0969,  8.7665,  6.9868,  7.0353], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.3280e-01-6.8319e-08j, 4.5916e+00+2.3842e-07j, 4.1525e+00-5.7993e-07j,
        1.1441e-01+5.5879e-09j, 2.6830e+00-1.9338e-08j, 6.5492e-01+1.7881e-07j,
        2.5303e+00-1.4017e-08j, 1.2937e+01-2.1476e-07j, 5.8573e+00-8.0310e-08j,
        2.7261e+00+5.2607e-08j, 1.8704e+00+6.8903e-10j, 5.4272e+00+8.4158e-08j,
        9.1263e+00+2.9735e-07j, 1.0710e-01-7.4506e-09j, 9.0173e-03-1.5367e-08j,
        6.0780e+00+4.8600e-08j, 6.6373e-01-2.0862e-07j, 8.1504e-01+2.7292e-09j,
        6.1047e+00-4.7684e-07j, 1.5829e+00-7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.418222188949585-3.917220681159961e-08j)
torch.linalg.det(H.mH@H) = tensor([1.2901-4.4703e-08j, 0.1264-8.2803e-10j, 5.4175-1.3450e-07j,
        0.6952+1.1921e-07j, 1.8121-8.9983e-09j, 1.8896+2.6690e-08j,
        0.1686+5.4955e-08j, 6.9337+3.9137e-07j, 0.6789+9.4813e-09j,
        2.3263-1.1921e-07j, 0.8726+3.7460e-08j, 3.7563+1.3811e-07j,
        2.7467+2.7921e-08j, 0.6059+2.4363e-08j, 0.0419+1.9551e-08j,
        5.1813-8.4311e-09j, 0.0531-5.5879e-08j, 1.8339-1.8670e-08j,
        0.3175+1.0431e-07j, 1.7020-2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9224880933761597+2.6620307735925053e-08j)
SINR torch.Size([20]) = tensor([  2.1078,  -0.2657,   7.0673,   1.7659,   5.3266,   4.8467,  -5.2126,
          7.0759,   2.2846,   5.8402,   3.0309,   6.4981,   5.5990,   2.3536,
        -10.1206,   8.6467,  -9.9564,   6.1212,  -2.7111,   3.3428],
       device='cuda:0')
SINR mean = 2.1820363998413086
E[H^H] = 1e-07
E_MSE (Error Power) = 1.4426681995391846
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6190, 0.4847, 0.8358, 0.6003, 0.7732, 0.7532, 0.2314, 0.8361, 0.6286,
        0.7933, 0.6677, 0.8170, 0.7840, 0.6323, 0.0886, 0.8798, 0.0917, 0.8037,
        0.3488, 0.6835], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([284, 364, 145, 295, 188, 201, 536, 145, 278, 174, 254, 158, 181, 276,
        691, 112, 686, 167, 449, 245], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 40)

--- 処理中: 画像 61 から 80 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 60)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6583, 0.6378, 0.7080, 0.4698, 0.4843, 0.5120, 0.8771, 0.5660, 0.6880,
        0.6601, 0.6396, 0.6972, 0.6009, 0.7180, 0.5978, 0.4435, 0.5451, 0.5308,
        0.7748, 0.5434], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-3.2487, -8.1673, -8.6370, -8.0409, -7.3086, -6.2752, -2.1023, -4.2856,
        -6.0214, -4.0304, -3.9769, -5.3571, -9.4728, -3.7784, -6.6081, -3.9127,
        -9.7903, -9.4290, -6.1287, -9.1005], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([110.3117+6.7163e-07j, 777.3338-6.2172e-06j, 589.8322-1.7062e-06j,
        158.1727+1.8556e-05j, 551.9744-1.0312e-06j,  80.3465-3.2376e-07j,
        976.2987+4.7336e-05j, 404.1093-4.5806e-06j, 670.4671+7.2134e-06j,
        238.5811+1.9073e-05j, 137.8855-0.0000e+00j, 690.2009+6.1035e-05j,
        438.2074+1.2259e-05j,   4.9410+1.5789e-05j,  54.8859-3.1034e-07j,
        154.2270-0.0000e+00j, 369.5050-4.1678e-06j,  39.4938+1.0341e-06j,
         86.7185-3.4744e-06j,  47.7662-1.4315e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(329.0629577636719+7.342072876781458e-06j)
torch.linalg.det(H.mH@H) = tensor([1.4915+2.9802e-07j, 0.0761-2.3041e-09j, 0.2212+5.4113e-09j,
        0.4491-4.4703e-08j, 0.4573-4.4703e-08j, 0.8560+3.7253e-09j,
        4.4979+3.5763e-07j, 5.3192+2.4676e-07j, 2.8755-9.1641e-08j,
        3.6773-7.2694e-08j, 0.6184+5.5879e-08j, 3.6989+1.0354e-07j,
        0.2596+4.8355e-09j, 3.2271+3.9161e-08j, 1.0444-8.9655e-08j,
        2.7345+5.7462e-08j, 0.2879+7.4506e-08j, 0.1193+2.3283e-09j,
        2.5327+8.6542e-09j, 0.2109+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7327464818954468+4.635541372977059e-08j)
SINR torch.Size([20]) = tensor([-12.2833, -19.1796, -12.7902, -12.1368, -13.1454, -11.8161,  -9.0821,
         -5.5721,  -7.0302,  -7.6010, -15.0176,  -6.6913, -13.6191,  -6.0985,
        -11.9387,  -7.4014, -13.3156, -16.7447,  -6.7415, -16.9913],
       device='cuda:0')
SINR mean = -11.259828567504883
E[H^H] = 1e-07
E_MSE (Error Power) = 18.711393356323242
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0558, 0.0119, 0.0500, 0.0576, 0.0462, 0.0618, 0.1100, 0.2170, 0.1654,
        0.1480, 0.0305, 0.1764, 0.0416, 0.1971, 0.0601, 0.1539, 0.0445, 0.0207,
        0.1748, 0.0196], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([751, 917, 765, 747, 774, 739, 660, 548, 596, 614, 822, 585, 786, 565,
        742, 608, 779, 863, 586, 868], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -4-----------
Real SNR = tensor([ -2.1007,  -8.6839,  -5.5831,  -6.7025,  -5.0132,  -6.5274,  -4.6911,
        -12.6080,  -4.1555, -11.8296, -14.1263,  -6.8195,  -4.0629,  -5.9723,
         -1.6045,  -3.3287,  -6.9544,  -7.0947,  -3.8597,  -5.1188],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([248.3710-1.0202e-05j,  43.0085+5.7433e-06j,   5.9559-4.5964e-07j,
        722.7910+3.8180e-05j,   9.6687+2.5683e-06j,  50.4597-4.7684e-07j,
        116.8138+1.9613e-06j,  73.5012+2.2824e-05j, 287.1046-1.0442e-05j,
        472.3594+4.1242e-07j,  44.6221-1.8120e-05j, 198.4619-0.0000e+00j,
        410.7142-7.3006e-05j, 392.5619+2.7582e-05j,  91.6284-1.2250e-05j,
        422.9522-6.5607e-06j,  33.3159+2.4796e-05j,  13.3043+4.2915e-06j,
        124.0325+8.8282e-07j, 186.4614+9.2473e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(197.4044189453125-6.750779135700213e-08j)
torch.linalg.det(H.mH@H) = tensor([1.2578e+01-2.3570e-07j, 3.0356e-01-2.9802e-08j, 2.2519e+00+3.1104e-08j,
        6.7083e-01+2.9802e-08j, 5.2655e-01-0.0000e+00j, 3.5491e-01+5.9605e-08j,
        1.0209e+00-1.3239e-07j, 1.6027e-02-2.8987e-09j, 7.8399e-01-7.8691e-08j,
        5.2130e-02-4.7065e-09j, 1.2760e-02-1.3970e-09j, 1.4242e+00-1.3075e-08j,
        5.2200e-01-1.8204e-08j, 2.0097e+00+9.1670e-09j, 1.6483e+01-1.8054e-08j,
        2.5986e+00-0.0000e+00j, 9.3147e-01-2.0627e-08j, 1.3044e-01+3.7253e-09j,
        2.6038e+00+3.9688e-08j, 1.8054e-01-1.8626e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.272775411605835-2.0054249816325864e-08j)
SINR torch.Size([20]) = tensor([ -2.1452, -12.6444,  -5.8262, -10.1878, -13.9697, -14.8732, -11.7487,
        -20.0740, -11.8100, -16.6543, -20.3444,  -7.0790, -12.3188,  -5.9451,
         -2.1835,  -8.6050,  -8.8389, -16.1379,  -6.9224, -17.5761],
       device='cuda:0')
SINR mean = -11.294229507446289
E[H^H] = 1e-07
E_MSE (Error Power) = 24.621885299682617
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3790, 0.0516, 0.2073, 0.0874, 0.0385, 0.0315, 0.0627, 0.0097, 0.0618,
        0.0211, 0.0092, 0.1638, 0.0554, 0.2028, 0.3769, 0.1212, 0.1156, 0.0238,
        0.1688, 0.0172], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([429, 761, 556, 693, 795, 818, 737, 936, 738, 861, 941, 597, 752, 560,
        431, 645, 652, 848, 592, 882], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -3-----------
Real SNR = tensor([ -6.7160,  -6.2426,  -1.8451,  -1.4671,  -2.7939, -13.8455,  -7.3999,
         -6.0421,  -5.9305,  -1.2164,  -5.9397,  -3.7350,  -0.0153,  -2.7738,
         -3.3080,   0.7638,  -4.5777,  -9.0606,  -6.0369,   1.3643],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.2704e+02-1.6115e-06j, 6.7065e+00+1.9073e-06j, 2.0850e-01+4.5449e-07j,
        2.3890e+02-2.0489e-06j, 7.5017e-01-5.2095e-07j, 2.2651e+02-4.5772e-06j,
        4.7929e+01-1.9073e-06j, 4.1521e+01-7.4335e-07j, 2.4215e+02-4.7513e-06j,
        2.6116e+01-2.0639e-06j, 1.0941e+02-2.3040e-07j, 8.1256e+02+1.7896e-05j,
        5.7400e+00-1.5995e-07j, 8.2687e+01+2.9338e-06j, 2.9349e+01+5.8153e-07j,
        3.3044e+02-1.7144e-06j, 1.2100e+02+2.3363e-06j, 1.3589e+02+9.3371e-06j,
        2.7157e+01-3.1758e-06j, 1.0362e+02+1.1875e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(135.783935546875+6.564337127201725e-07j)
torch.linalg.det(H.mH@H) = tensor([ 1.1337+2.9802e-08j,  0.8357+1.4402e-08j,  8.3852-1.0386e-07j,
         5.6930-3.5877e-09j,  2.7870+1.1921e-07j,  0.0197-4.3393e-10j,
         0.9517+4.0840e-09j,  0.2144-1.5987e-09j,  0.0751+1.4027e-09j,
         2.4644-1.3697e-08j,  0.2506-3.0381e-10j,  0.0366+7.3981e-08j,
         6.7517-1.0512e-07j,  2.4735-9.4586e-09j,  1.1523+9.3490e-09j,
         7.2088-8.1123e-08j,  0.5544-1.1921e-07j,  0.1082-1.4246e-10j,
         0.9789+2.9802e-08j, 13.6393-3.3305e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7857062816619873-9.490193519923196e-09j)
SINR torch.Size([20]) = tensor([ -8.3366,  -8.2221,  -1.8361,  -2.1652,  -5.7519, -15.8645,  -6.9915,
        -10.7961, -16.7359,  -6.0008, -11.6596, -23.0757,  -3.8510,  -5.3468,
         -8.1055,  -3.5051, -10.7494, -13.5006,  -8.3747,  -1.7156],
       device='cuda:0')
SINR mean = -8.629237174987793
E[H^H] = 1e-07
E_MSE (Error Power) = 18.818567276000977
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1279, 0.1309, 0.3959, 0.3779, 0.2101, 0.0253, 0.1666, 0.0769, 0.0208,
        0.2007, 0.0639, 0.0049, 0.2918, 0.2260, 0.1340, 0.3085, 0.0776, 0.0428,
        0.1269, 0.4025], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([637, 634, 419, 430, 554, 842, 595, 710, 862, 562, 734, 995, 489, 540,
        630, 477, 709, 783, 638, 414], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -2-----------
Real SNR = tensor([-3.0588, -5.3218, -5.9190,  0.7167, -4.8599, -1.1193, -5.8137, -4.8340,
        -5.5259, -2.5474, -4.3258, -4.5872, -2.9918, -0.2061, -0.3700, -1.9490,
        -0.5193,  1.2477, -7.6964, -7.7669], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 12.9402-3.7667e-07j, 108.9933+5.5831e-06j,  26.0452-7.7508e-07j,
         58.6799-3.1555e-06j,  64.8372+4.4646e-06j,   2.1165-6.6515e-07j,
         29.2930+2.6043e-07j,   4.9970+6.6757e-06j,  91.8903+2.6909e-06j,
          4.2560-0.0000e+00j, 261.8577+7.7638e-06j,  29.7048-1.0823e-06j,
          6.5406+6.8461e-07j,  16.0040-5.3588e-07j,   9.3317+2.1238e-07j,
         14.6555-4.4918e-07j, 100.2126-7.3207e-09j,   0.7366+4.6631e-07j,
        231.0275-4.0617e-06j, 400.3193-3.2760e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(73.72193908691406+7.208570309558127e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.6512+3.1664e-08j,  0.3460+1.6764e-08j,  0.2841-1.3545e-08j,
         2.2948-1.9108e-08j,  0.1987-2.0932e-08j,  2.8593+2.7811e-08j,
         0.0586-7.4506e-09j,  0.1315+1.4901e-08j,  1.0145+1.1723e-08j,
         0.3887-4.1910e-09j,  0.4381-1.4901e-08j,  0.4717+1.4901e-08j,
         0.4901-1.1921e-07j,  3.1772-3.5763e-07j,  6.4250-5.9068e-09j,
         0.8506+1.1921e-08j,  3.8784-1.1921e-07j, 16.5344-8.2773e-08j,
         0.0239-0.0000e+00j,  0.1753+1.0802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0346057415008545-3.121831682051379e-08j)
SINR torch.Size([20]) = tensor([ -8.4394, -12.4154,  -9.1991,  -6.5130, -11.8953,  -4.2258, -20.6844,
        -16.9300,  -5.7139, -14.9655, -10.2769, -10.8217, -10.8080,  -6.9815,
         -1.9279,  -8.3408,  -4.9964,   0.2066, -21.1177, -11.9670],
       device='cuda:0')
SINR mean = -9.900660514831543
E[H^H] = 1e-07
E_MSE (Error Power) = 20.82440185546875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1253, 0.0542, 0.1073, 0.1825, 0.0607, 0.2743, 0.0085, 0.0199, 0.2115,
        0.0309, 0.0858, 0.0764, 0.0767, 0.1669, 0.3908, 0.1278, 0.2404, 0.5119,
        0.0077, 0.0598], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([640, 755, 663, 579, 741, 502, 948, 867, 553, 820, 695, 711, 710, 594,
        422, 637, 528, 347, 957, 743], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -1-----------
Real SNR = tensor([-1.1676, -3.3440,  0.1792,  0.3087, -0.7173, -4.1095,  1.7035, -2.9180,
        -1.0015, -7.5357,  1.5449, -2.5077, -3.4736, -4.2830, -3.9231, -2.0005,
        -2.5164,  2.6759,  2.8360,  1.3573], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 37.5724-4.9555e-07j,  84.2545-3.8147e-06j,  14.6783+1.4546e-06j,
         92.2667-7.6294e-06j,  17.2291+7.7023e-07j,   3.6374+8.4247e-08j,
         62.5537-1.6035e-06j, 102.5449-8.0922e-06j,  16.9692-9.5367e-07j,
          1.0294-1.8626e-06j,  37.0345-5.7220e-06j,   7.4975+2.7419e-06j,
         16.9477-9.5367e-07j,  16.3194-6.2789e-08j,   6.4284-1.4323e-07j,
         30.9515+4.7684e-07j,  28.8321+1.4669e-07j,   9.9703-2.3842e-07j,
        598.9115-8.1628e-06j, 146.0510+2.4862e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(66.58396911621094-1.5786974927323172e-06j)
torch.linalg.det(H.mH@H) = tensor([1.8042e+00+2.9802e-08j, 5.2799e-01-1.4168e-08j, 3.2164e+00-3.6485e-08j,
        1.7838e+00-1.1921e-07j, 7.5297e-01-1.0081e-08j, 4.1948e-01-0.0000e+00j,
        8.3311e+00+7.8234e-09j, 5.9652e-01-0.0000e+00j, 1.7904e+00-9.3116e-08j,
        2.1158e-01-3.7253e-09j, 1.5456e+01+5.4233e-08j, 2.3414e+00-4.6554e-09j,
        1.1042e-02+5.8990e-08j, 2.9682e-01-3.6177e-08j, 3.5114e-01+1.9372e-07j,
        1.9954e-01-1.5321e-08j, 2.4622e+00+1.6041e-09j, 8.5360e+00+3.9629e-07j,
        1.9419e+01+4.4722e-07j, 1.4527e-01+4.0233e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.4326412677764893+6.295366716813078e-08j)
SINR torch.Size([20]) = tensor([ -6.6311,  -7.3788,  -3.0869,  -6.4039,  -7.2106,  -9.7116,  -0.6844,
         -7.3830,  -4.4283,  -9.4423,   1.5961,  -3.3348, -25.4261,  -9.8529,
        -11.9067, -12.5304,  -2.7649,  -1.4885,   1.0241, -19.1613],
       device='cuda:0')
SINR mean = -7.310330390930176
E[H^H] = 1e-07
E_MSE (Error Power) = 24.44882583618164
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1785, 0.1546, 0.3294, 0.1862, 0.1597, 0.0965, 0.4607, 0.1545, 0.2651,
        0.1021, 0.5909, 0.3169, 0.0029, 0.0937, 0.0606, 0.0529, 0.3460, 0.4151,
        0.5587, 0.0120], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 583,  607,  462,  575,  602,  679,  378,  607,  509,  671,  300,  471,
        1000,  683,  741,  758,  451,  406,  319,  916], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 0-----------
Real SNR = tensor([-8.8584, -3.3916,  1.0364,  1.5963, -1.9175, -5.2688, -0.4603,  1.5814,
        -1.9118, -2.2493, -0.8149,  0.8215,  0.1116, -0.3883, -0.6865,  1.7551,
         0.3347, -0.6825, -2.2718, -0.8884], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 81.0217-1.8720e-06j,   4.6064+2.4858e-07j,  28.8875-3.2476e-07j,
         85.9439+2.3842e-06j,   6.9139-4.7684e-07j,   1.8454+7.7486e-07j,
         17.8923-9.5367e-07j,   3.7169-7.5771e-08j, 146.8532-1.9378e-06j,
          1.9742-1.7285e-06j,  16.9435+5.9605e-07j,  34.9723+5.9156e-07j,
         29.2348+7.0484e-07j,   5.7278-1.7897e-07j,   0.1620-4.9174e-07j,
         31.6447+8.3236e-07j, 120.1777+1.0337e-07j,  31.0453+9.5367e-07j,
         10.2698-0.0000e+00j, 145.6794-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(40.27562713623047-4.253444174651122e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.0198+2.7940e-09j,  0.2895-3.7636e-09j,  3.5008-1.1997e-08j,
         6.6122+5.4218e-08j,  1.6343+5.7599e-08j,  0.0483+4.0745e-10j,
         4.9462-9.5367e-07j,  2.3205-8.9407e-08j,  0.4298+2.5332e-07j,
         2.4518+9.7070e-08j,  0.6793-5.9605e-08j, 13.0878-5.0167e-08j,
         0.2930+1.2646e-08j,  0.9695+5.9442e-08j,  2.9838-2.9879e-09j,
         1.2343+5.5247e-08j,  2.4372+9.3365e-08j,  2.4124-3.3740e-08j,
         0.6736+2.9802e-08j,  1.4791-5.5471e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4251632690429688-2.7245079081694712e-08j)
SINR torch.Size([20]) = tensor([-16.7667,  -7.4094,  -1.1368,   0.3524,  -3.9963, -16.5174,  -1.9257,
         -4.2733, -11.1354,  -2.0733,  -7.0834,   2.3407, -11.0617,  -6.5409,
         -1.5670,  -6.4086,  -3.6608,  -2.6156,  -6.8723,  -3.3511],
       device='cuda:0')
SINR mean = -5.585127830505371
E[H^H] = 1e-07
E_MSE (Error Power) = 7.3569231033325195
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0206, 0.1537, 0.4349, 0.5203, 0.2849, 0.0218, 0.3909, 0.2721, 0.0715,
        0.3829, 0.1637, 0.6316, 0.0726, 0.1815, 0.4108, 0.1861, 0.3009, 0.3538,
        0.1705, 0.3161], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([863, 608, 394, 342, 494, 857, 422, 504, 720, 427, 598, 276, 718, 580,
        409, 576, 482, 446, 591, 472], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 1-----------
Real SNR = tensor([-2.0262,  2.1472, -0.3691,  0.1217, -7.7875, -2.0550,  0.4492,  2.2667,
         2.1269, -4.7086, -4.4550, -2.4966, -1.9568,  1.1692,  0.2631, -0.0393,
        -3.7859,  2.5879, -0.6363, -0.4766], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([60.7574-9.5367e-07j, 22.5160-4.1483e-08j, 23.7481-3.2959e-07j,
         2.0958-6.6207e-09j, 15.1189+2.3391e-07j,  1.5290+1.9249e-07j,
        11.1638-1.7062e-07j,  0.2865+1.7500e-06j, 38.2973+3.0599e-07j,
        14.2468-7.1526e-07j, 98.3104-6.8705e-07j, 36.0993+4.4513e-08j,
        19.2707-1.5692e-06j, 25.2477-1.1115e-06j,  1.8100+8.3447e-07j,
        47.6456+1.4255e-06j, 25.3689+2.2883e-07j, 64.6867+1.6874e-06j,
         6.6892+3.4435e-09j, 65.6860-1.0496e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(29.02870750427246+3.5997516079078196e-09j)
torch.linalg.det(H.mH@H) = tensor([0.7546-1.4901e-07j, 1.5047-2.8716e-07j, 2.6423+8.0318e-09j,
        0.9869-4.2906e-09j, 0.0534-1.8626e-09j, 0.4139+2.9802e-08j,
        2.7818+2.0395e-07j, 0.1796-1.4849e-08j, 3.9114+1.6166e-08j,
        0.2242-1.8387e-10j, 0.0124+1.9092e-08j, 1.1678-1.9671e-08j,
        0.1300+2.9589e-08j, 1.6242+2.9802e-08j, 3.9671-5.9605e-08j,
        0.0662+1.3970e-08j, 0.4369-7.1236e-09j, 5.8367+1.0840e-07j,
        1.7996+2.4822e-08j, 0.3276-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4410661458969116-3.005865112370998e-09j)
SINR torch.Size([20]) = tensor([ -5.4891,  -5.4229,  -0.0213,  -3.6298, -10.7499,  -6.4595,  -1.7121,
        -12.9807,  -0.1491,  -7.4953, -20.7672,  -2.2378, -12.6533,  -4.8936,
         -2.0160, -16.6496,  -5.2204,   0.9864,  -1.5744,  -9.6645],
       device='cuda:0')
SINR mean = -6.440003871917725
E[H^H] = 1e-07
E_MSE (Error Power) = 12.412322998046875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2203, 0.2229, 0.4988, 0.3024, 0.0776, 0.1843, 0.4027, 0.0479, 0.4914,
        0.1511, 0.0083, 0.3740, 0.0515, 0.2448, 0.3860, 0.0212, 0.2311, 0.5565,
        0.4104, 0.0975], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([545, 543, 355, 481, 709, 577, 414, 770, 360, 611, 950, 433, 761, 525,
        425, 860, 536, 321, 409, 677], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 2-----------
Real SNR = tensor([-5.4961,  2.1471, -3.5635, -1.6375,  3.7167,  5.1108, -1.9881, -4.3475,
        -0.3232, -1.0522,  3.8696, -0.8907,  3.8191, -1.2701,  1.6448, -4.4197,
        -0.0216, -4.2874,  0.2122,  1.6887], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  5.0446-0.0000e+00j,  14.1985+2.1644e-07j,  47.5227+7.9593e-07j,
          0.2788+6.0135e-08j,   1.8390+7.7486e-07j,   5.2679-3.5763e-07j,
         32.3953-3.6078e-08j,   1.3003-1.3791e-07j,  35.7598-1.4846e-06j,
          2.0158-1.7881e-07j,  41.3415+1.9073e-06j, 188.4488+1.6192e-06j,
         11.2492+9.5367e-07j,  26.5319-4.9667e-07j,   0.7464-2.2264e-08j,
          0.3194+1.4560e-08j,   8.5234-1.7777e-06j,  19.8633+1.7386e-07j,
         63.9115-5.7220e-06j,  52.2355+1.3289e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(27.93967628479004-1.1844300473740077e-07j)
torch.linalg.det(H.mH@H) = tensor([1.8276e-01+3.7253e-09j, 5.8162e+00+2.0573e-07j, 8.6807e-02+1.6190e-09j,
        2.1864e-01-7.4249e-09j, 1.3929e+00-5.3644e-07j, 1.6606e+00+2.0388e-07j,
        4.0968e-01+1.7921e-08j, 2.8325e-02+1.0815e-10j, 4.1948e-01-5.5398e-10j,
        4.9615e-01+8.0785e-09j, 5.0487e+00-1.1921e-07j, 3.1137e-03+1.3634e-08j,
        3.2241e+00+2.3842e-07j, 1.1795e+00-1.2658e-09j, 1.5997e-01+3.4998e-08j,
        6.8239e-02+1.4112e-09j, 7.4162e-01-5.9605e-08j, 1.0480e-01-0.0000e+00j,
        3.8269e-01-4.4703e-08j, 3.7933e-01-2.6822e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1001808643341064-1.5395134056461757e-08j)
SINR torch.Size([20]) = tensor([ -6.7156,   1.0381,  -9.5869,  -7.7139,  -4.2698,  -5.0378,  -5.8691,
        -14.6257,  -5.8715,  -6.2178,  -0.4023, -27.5003,  -1.8834,  -1.0539,
        -11.7874,  -8.4842,  -4.9918,  -8.8128,  -8.0717,  -9.3028],
       device='cuda:0')
SINR mean = -7.358036994934082
E[H^H] = 1e-07
E_MSE (Error Power) = 32.346046447753906
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1756, 0.5595, 0.0991, 0.1448, 0.2723, 0.2387, 0.2056, 0.0333, 0.2055,
        0.1928, 0.4769, 0.0018, 0.3932, 0.4396, 0.0621, 0.1242, 0.2406, 0.1162,
        0.1349, 0.1051], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 586,  319,  675,  618,  504,  530,  558,  812,  558,  569,  368, 1000,
         420,  391,  738,  642,  528,  652,  629,  667], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 3-----------
Real SNR = tensor([ 4.6060,  2.6420, -1.4108,  3.4767,  2.0054,  4.5124,  2.3923,  4.0009,
         3.2482, -0.5908,  1.7297,  3.0114,  1.3245,  4.8812,  0.2755,  4.8248,
         6.2128,  3.7597,  3.4157,  0.0338], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([32.3524-8.3988e-07j, 21.1717+3.1135e-07j,  0.3923+5.1850e-09j,
        39.2523+1.9073e-06j, 17.2814-1.7739e-07j, 10.6704-3.3292e-08j,
         5.2318-7.3299e-08j,  3.4324+1.5608e-09j,  7.0402-2.3842e-07j,
        11.1003-2.3842e-07j, 10.6856+6.4499e-08j, 14.2112+1.4870e-07j,
        20.9165+1.4062e-06j,  1.9787+1.1241e-07j, 36.4065-0.0000e+00j,
        89.1581+6.2906e-08j, 20.7118-4.5063e-07j, 60.1653-4.4772e-07j,
        10.4455+9.5367e-07j,  6.0452-4.1049e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(20.932485580444336+1.2168788998678792e-07j)
torch.linalg.det(H.mH@H) = tensor([3.4044-2.4791e-08j, 2.4120-0.0000e+00j, 0.3576-1.4901e-08j,
        1.0424-8.9407e-08j, 1.6241-5.1619e-09j, 7.8950-7.8791e-08j,
        1.1469-6.8705e-08j, 2.8801-3.3618e-08j, 3.6451-6.4346e-07j,
        0.3642-3.7253e-09j, 1.0373+1.1921e-07j, 2.6220-3.7058e-08j,
        1.2112-9.7523e-08j, 0.2952-1.1921e-07j, 1.0054-5.9605e-08j,
        2.4302+1.0976e-07j, 2.2291+2.1294e-07j, 4.0742+9.0574e-08j,
        1.3570-2.4845e-08j, 0.4649-7.4506e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0749173164367676-4.214090765231049e-08j)
SINR torch.Size([20]) = tensor([-7.1692e-01, -1.0292e+00, -4.4581e+00, -3.3407e+00, -5.0333e-01,
         3.5278e+00, -2.3079e+00,  9.6902e-01,  6.0174e-03, -6.7224e+00,
        -2.5694e+00, -4.3703e-01, -1.0738e+00, -1.0470e+01, -3.3638e+00,
        -3.9217e-01, -2.5453e+00,  1.6241e+00, -2.0310e+00, -5.4269e+00],
       device='cuda:0')
SINR mean = -2.0630643367767334
E[H^H] = 1e-07
E_MSE (Error Power) = 2.0379700660705566
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4588, 0.4410, 0.2638, 0.3166, 0.4711, 0.6926, 0.3702, 0.5556, 0.5003,
        0.1754, 0.3563, 0.4749, 0.4385, 0.0823, 0.3155, 0.4774, 0.3575, 0.5924,
        0.3852, 0.2228], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([379, 390, 510, 471, 372, 239, 435, 321, 354, 586, 444, 370, 392, 701,
        472, 368, 443, 299, 425, 543], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 4-----------
Real SNR = tensor([ 2.2244,  1.1470,  3.6855,  3.7403,  4.5290,  2.6055,  1.8096,  2.7020,
         0.1655, -0.2112,  0.0823,  3.9557,  4.6679,  0.5417,  0.4722,  7.9505,
         3.7711,  3.2367,  3.9273,  3.4021], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4091-5.8620e-08j,  1.9262+2.8193e-08j,  4.5738+9.5773e-07j,
         1.6486-1.1921e-07j,  1.5935+1.5355e-07j,  0.3249-7.4089e-07j,
        10.7637+6.1714e-07j,  1.1827+1.3411e-07j,  0.5993-3.4273e-07j,
         1.6594-8.9407e-08j, 15.9841-1.1971e-07j,  1.5761-8.0202e-10j,
         2.0360+1.0775e-07j,  3.7003-7.1526e-07j,  1.0206-8.9407e-08j,
         4.4013-1.1921e-07j, 14.0274-1.6525e-07j, 43.5918-5.7220e-06j,
         4.1485-2.3842e-07j, 23.9273+7.4353e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.954734802246094-2.8894689307890076e-07j)
torch.linalg.det(H.mH@H) = tensor([1.3725-4.0743e-09j, 0.6500+8.0376e-09j, 0.1253+2.1048e-07j,
        2.6347-6.3128e-09j, 0.9638-1.0106e-07j, 0.1444-2.3852e-10j,
        0.3307+1.3741e-08j, 0.9147-9.8663e-10j, 0.0758+3.1665e-08j,
        0.3275+1.0920e-09j, 0.1425+1.4901e-08j, 0.6874-2.6938e-08j,
        0.8703-8.5507e-10j, 0.4035+3.0671e-08j, 0.3296+9.2081e-09j,
        7.4384+9.5741e-08j, 0.7540-5.2025e-08j, 2.7181+1.3509e-08j,
        0.4362-3.1412e-08j, 1.8024-1.9151e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1560897827148438+9.299742309565318e-09j)
SINR torch.Size([20]) = tensor([  0.1284,  -1.0164, -11.6191,   1.9314,  -2.8180,  -9.9011,  -5.4850,
         -0.8810, -11.6036,  -3.4649,  -6.6950,  -3.3128,  -2.8771,  -3.6564,
         -3.7618,   4.1703,  -3.5821,   1.4852,  -6.4002,   1.0892],
       device='cuda:0')
SINR mean = -3.4135022163391113
E[H^H] = 1e-07
E_MSE (Error Power) = 3.348351240158081
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5074, 0.4418, 0.0644, 0.6094, 0.3432, 0.0928, 0.2205, 0.4495, 0.0647,
        0.3105, 0.1763, 0.3180, 0.3402, 0.3011, 0.2960, 0.7232, 0.3047, 0.5847,
        0.1864, 0.5624], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([350, 390, 733, 289, 453, 684, 545, 385, 733, 476, 585, 470, 455, 482,
        486, 220, 480, 304, 575, 317], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 5-----------
Real SNR = tensor([ 6.3363,  2.5916,  4.3276,  7.5752,  0.1321,  7.0176,  8.5303,  3.8828,
        -1.6870,  5.4090,  5.4754,  6.4116,  5.9985,  7.7919,  7.5453,  5.9689,
         3.6428,  1.8903,  5.2695,  5.1579], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.4520+2.8905e-07j,  4.8746+4.7419e-07j, 13.8315-1.8654e-07j,
        31.9271+1.1450e-07j,  7.7607-5.9605e-07j, 19.4944+2.3993e-07j,
         2.7791+1.1559e-08j, 19.1701-1.5589e-07j,  0.2274+3.4733e-09j,
         1.4893-1.3114e-08j, 14.0865+2.4003e-07j,  0.0778+1.8823e-08j,
        17.7389+2.5684e-07j, 10.4973-2.0588e-07j, 11.2033-2.3842e-06j,
        15.8349-1.8475e-07j, 21.9373-2.2172e-07j,  1.6045-1.1728e-07j,
         8.6526+2.7028e-07j,  0.6322-2.4179e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(10.41357135772705-1.0745759482233552e-07j)
torch.linalg.det(H.mH@H) = tensor([1.2939-2.9499e-08j, 1.6838+2.9802e-08j, 0.8654-1.2032e-07j,
        8.5311+3.2891e-07j, 0.5363+8.6159e-09j, 4.4848+1.7345e-07j,
        1.1533+1.4804e-07j, 2.1925-1.9777e-08j, 0.5973+6.8034e-09j,
        0.5714-5.5270e-08j, 7.0962-3.5502e-08j, 5.0519+6.7151e-08j,
        0.7727+1.0786e-07j, 4.0681-1.1921e-07j, 1.8343-0.0000e+00j,
        3.1128+1.0956e-07j, 0.9482-8.9407e-08j, 0.9304-1.5818e-08j,
        0.5603+2.9186e-08j, 0.4306+3.5576e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.335763692855835+4.401730890890576e-08j)
SINR torch.Size([20]) = tensor([-1.9026,  1.0802, -1.7504,  5.4803, -0.1071,  2.9849, -3.0339,  3.1074,
        -0.0807, -4.6022,  5.6178,  4.1239, -3.5805,  2.0059, -2.5096,  2.5403,
        -0.8396,  1.2052, -3.3628, -4.6555], device='cuda:0')
SINR mean = 0.08605452626943588
E[H^H] = 1e-07
E_MSE (Error Power) = 1.1521694660186768
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3922, 0.5619, 0.4006, 0.7793, 0.4938, 0.6654, 0.3321, 0.6716, 0.4954,
        0.2574, 0.7847, 0.7210, 0.3048, 0.6135, 0.3594, 0.6422, 0.4518, 0.5689,
        0.3155, 0.2550], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([421, 318, 416, 184, 358, 256, 461, 252, 357, 515, 180, 221, 480, 287,
        442, 270, 384, 313, 472, 517], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 6-----------
Real SNR = tensor([ 6.7653,  6.7104,  1.9983,  6.9590,  3.2558,  1.1361,  4.4283,  9.4257,
         6.3818,  7.4542, -0.2482,  8.4423,  6.2445,  6.4599,  7.1259,  2.9575,
         0.2029,  1.1519,  8.8192,  4.8114], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([14.4420-2.7518e-07j,  1.4524+9.3555e-08j,  5.8804-2.0096e-07j,
         0.7605-6.8003e-08j, 10.9107-0.0000e+00j,  1.0047-8.9407e-08j,
         0.0587-5.6811e-08j, 44.4969+1.8892e-07j,  0.6273+4.7684e-07j,
         4.7281-8.7131e-07j,  0.3976+3.8146e-08j,  6.8836-3.0433e-07j,
        18.3455-4.5599e-07j,  3.3420+6.2783e-09j,  2.8115-1.6480e-07j,
         0.2711-1.7852e-08j,  5.7883+7.4710e-08j, 13.4644-2.7705e-07j,
         6.8106-1.5876e-07j,  4.4359+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.345611572265625-1.001206015871503e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.9013-8.4267e-08j,  4.7123+1.9882e-08j,  0.0907+1.1176e-08j,
         3.5009-4.6631e-08j,  0.0912-1.8626e-09j,  0.3216+1.1509e-09j,
         5.4830-1.1494e-07j, 12.4160+4.9618e-08j,  2.6382-0.0000e+00j,
        13.2813+3.1328e-07j,  0.2052-5.3406e-10j,  0.0679+8.5948e-09j,
         0.6197-1.6601e-08j,  0.3552-2.3261e-08j,  4.1312-1.2641e-07j,
         1.1753-1.6840e-08j,  0.0445-4.0302e-09j,  0.1314+7.4506e-09j,
         9.9852-1.5306e-07j,  2.5767-3.5618e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.136432647705078-1.064520471771857e-08j)
SINR torch.Size([20]) = tensor([ -3.0060,   5.1361,  -7.6132,   4.5767, -10.8401,  -0.7319,   5.8597,
          7.2577,   1.8681,   7.5723,  -2.2817, -13.1062,  -2.1439,  -3.0071,
          4.0520,   2.7370,  -7.7885,  -5.1553,   7.1558,   4.5282],
       device='cuda:0')
SINR mean = -0.24652345478534698
E[H^H] = 1e-07
E_MSE (Error Power) = 2.8223931789398193
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3336, 0.7654, 0.1477, 0.7415, 0.0761, 0.4580, 0.7940, 0.8417, 0.6059,
        0.8511, 0.3716, 0.0466, 0.3790, 0.3335, 0.7177, 0.6525, 0.1427, 0.2338,
        0.8386, 0.7394], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([460, 193, 614, 208, 711, 380, 174, 141, 291, 134, 434, 773, 429, 460,
        223, 263, 620, 534, 143, 210], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 7-----------
Real SNR = tensor([ 4.5260,  4.8247,  5.2364,  5.9066,  6.3205,  9.2034,  4.4246, -2.0058,
         5.7261,  7.6171,  5.0539,  8.2826,  0.1859,  3.7007,  6.2895,  8.4889,
         7.3172,  6.0693,  8.7700,  3.9292], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.3769+1.7881e-07j,  1.8383+3.5628e-08j,  2.3144+1.3618e-08j,
         0.3403-5.2154e-08j,  5.5828-4.5979e-08j,  2.8145+6.2154e-08j,
         9.1002+9.6708e-08j,  0.1919+2.8312e-07j,  2.0861+2.9802e-07j,
        12.6482-6.7069e-07j,  1.7984+3.3989e-07j,  1.0920-1.3210e-06j,
         1.8216-5.8680e-08j,  4.5786+3.5763e-07j,  2.7421-3.4918e-09j,
         4.4506+5.9067e-09j,  2.5895-1.2573e-07j, 10.0525+1.3034e-07j,
         0.3951+1.0439e-06j,  1.0325-1.7881e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.44232177734375+1.945762839739018e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0365+3.1665e-08j, 0.1864+4.7672e-08j, 0.2679-1.4901e-08j,
        0.4219-5.8086e-08j, 4.1482-3.7346e-08j, 2.1923-2.8411e-08j,
        0.2709-1.4901e-08j, 0.0541+1.5994e-10j, 1.0215+8.9407e-08j,
        3.4545+8.9312e-09j, 0.0492-1.9930e-07j, 0.2536-3.5018e-07j,
        0.1454-1.9894e-09j, 1.6681-8.5111e-09j, 1.6134+5.8126e-09j,
        1.5547+2.2774e-08j, 2.3138-2.6828e-08j, 0.3110-4.4703e-08j,
        1.0275+7.7585e-08j, 0.2763-2.7951e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0633565187454224-2.645507457543772e-08j)
SINR torch.Size([20]) = tensor([-10.7967,  -6.1455,  -4.7584,  -0.9101,   6.0630,   2.3847,  -4.1179,
         -2.9515,   0.6970,   4.7699, -12.9505,  -7.1646,  -1.8761,   4.4591,
          2.3185,   1.4962,   4.5224,  -5.0597,  -0.6129,  -3.1838],
       device='cuda:0')
SINR mean = -1.6908457279205322
E[H^H] = 1e-07
E_MSE (Error Power) = 2.9131672382354736
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0768, 0.1954, 0.2506, 0.4478, 0.8016, 0.6339, 0.2792, 0.3363, 0.5400,
        0.7499, 0.0482, 0.1611, 0.3937, 0.7363, 0.6304, 0.5853, 0.7391, 0.2378,
        0.4648, 0.3245], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([710, 567, 520, 386, 169, 275, 498, 458, 330, 203, 769, 600, 420, 212,
        277, 304, 210, 531, 376, 466], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 8-----------
Real SNR = tensor([10.1644, -2.9493,  5.0351,  4.2052,  8.1202,  5.8112,  7.9681,  8.8567,
         7.9730, 11.9869,  5.1179,  6.7724,  3.9536,  9.0287,  7.0276,  7.1262,
         8.5105,  7.6681,  9.6283,  5.2852], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.9267+1.9346e-07j,  1.4509-4.8151e-08j,  2.7250-1.5238e-08j,
         2.2422-3.0929e-08j,  0.9799+2.2805e-08j,  4.5816+5.4681e-09j,
         4.4638-1.2626e-07j,  0.3506+2.3692e-07j,  1.2131+2.8522e-08j,
        16.2423+3.8866e-07j,  0.6808-1.5634e-08j,  5.0184-2.0348e-07j,
         2.9487+8.3447e-07j,  4.3718-2.3893e-08j,  2.1642+5.1366e-08j,
        20.1760-6.3485e-07j,  3.0644+3.5763e-07j,  2.7853-9.1175e-08j,
         2.5119+1.1921e-07j, 22.1563-3.1313e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.1526923179626465+3.6787941581906125e-08j)
torch.linalg.det(H.mH@H) = tensor([1.2798e-02-5.0330e-07j, 1.9499e-02-9.3132e-10j, 1.3407e+00+1.0703e-08j,
        6.4605e-01+5.0448e-09j, 3.8595e+00+9.8015e-08j, 6.2127e-01-0.0000e+00j,
        6.6748e+00+2.5454e-07j, 9.9458e-01-2.7352e-08j, 1.2924e+00+4.3684e-08j,
        1.4679e+01-7.1863e-08j, 1.9943e-02+4.4238e-09j, 1.8090e+00+3.3484e-08j,
        1.0386e-01+1.8626e-08j, 1.3261e+00-2.9503e-09j, 1.3425e+00+2.6958e-08j,
        3.3035e-01+4.1093e-08j, 7.9047e-01+2.6709e-09j, 2.6292e-01-4.3768e-08j,
        1.4480e-01+3.6135e-07j, 1.9997e+00-1.2317e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9135159254074097+1.190593934552453e-08j)
SINR torch.Size([20]) = tensor([-20.5464,  -6.1867,   5.1849,   3.4431,   5.7480,   0.4619,   7.8728,
          2.1112,   2.8908,   8.8873, -12.8719,   4.3946,  -6.2389,   1.3520,
          3.6316,  -1.5464,   0.1976,  -3.9264, -10.4323,   5.8970],
       device='cuda:0')
SINR mean = -0.483804315328598
E[H^H] = 1e-07
E_MSE (Error Power) = 7.473942756652832
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0087, 0.1940, 0.7674, 0.6884, 0.7898, 0.5266, 0.8597, 0.6192, 0.6605,
        0.8856, 0.0491, 0.7334, 0.1921, 0.5772, 0.6977, 0.4119, 0.5114, 0.2882,
        0.0830, 0.7954], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([945, 568, 192, 242, 177, 339, 127, 283, 259, 107, 767, 213, 570, 308,
        236, 408, 348, 492, 700, 173], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 9-----------
Real SNR = tensor([ 8.6698,  9.5976,  5.2876,  6.0526, 11.3793, 10.9446,  0.9877,  5.0055,
        11.9041, 12.7079, 10.5631,  7.8166,  7.0554,  6.3989,  1.4341,  2.9731,
         3.5437,  7.9641,  8.3288,  7.9120], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([8.9603e+00-9.7430e-08j, 1.2969e+00-1.1176e-07j, 1.2391e+01+1.3549e-08j,
        1.0578e+00+3.9160e-09j, 8.6873e-01+7.1217e-07j, 8.3616e+00-3.8040e-07j,
        1.2664e-02-5.8208e-09j, 1.7699e-01-1.0246e-09j, 1.4358e+01+1.3863e-07j,
        1.6488e+00-2.0617e-08j, 3.3764e+00+1.4342e-07j, 1.5442e+00-4.0642e-08j,
        4.7874e-01+9.5466e-08j, 1.4694e-02-4.6847e-09j, 3.2338e-02-1.8626e-09j,
        3.1643e-01+7.5820e-09j, 6.9278e-01+1.1921e-07j, 2.3521e-02+1.8347e-07j,
        2.8478e+00-0.0000e+00j, 2.7795e+00+2.6332e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.061976432800293+3.8974924621015816e-08j)
torch.linalg.det(H.mH@H) = tensor([6.4105+1.0301e-07j, 2.3880-0.0000e+00j, 0.2237+2.2352e-08j,
        0.3135+7.9406e-09j, 1.3113-1.3483e-08j, 2.3172-5.1888e-09j,
        0.1285+1.4901e-08j, 0.1557+6.1733e-09j, 4.6833-2.2386e-09j,
        2.1558-4.1094e-08j, 1.8749+2.6271e-07j, 0.5988+2.9802e-08j,
        0.4095-1.1432e-08j, 0.6185+4.0960e-08j, 0.0407-2.0738e-09j,
        0.0768-3.7253e-09j, 0.2321+1.8626e-09j, 1.0204-5.0014e-09j,
        2.6822+4.3656e-08j, 4.1626+2.2997e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5902044773101807+2.3606586907476412e-08j)
SINR torch.Size([20]) = tensor([ 9.4234,  5.0900, -1.4457,  1.1735,  1.4741,  4.0235, -3.4444,  0.1127,
         6.4148,  3.6732,  4.0623, -0.0249,  0.5843,  0.6747, -5.5410, -2.3140,
         0.6271,  4.3090,  6.6433,  8.5522], device='cuda:0')
SINR mean = 2.203397512435913
E[H^H] = 1e-07
E_MSE (Error Power) = 0.8083803057670593
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8975, 0.7635, 0.4175, 0.5671, 0.5840, 0.7164, 0.3115, 0.5065, 0.8141,
        0.6997, 0.7182, 0.4986, 0.5336, 0.5388, 0.2183, 0.3699, 0.5360, 0.7295,
        0.8220, 0.8775], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 98, 194, 405, 314, 304, 224, 475, 351, 160, 235, 223, 355, 334, 331,
        547, 435, 333, 216, 155, 114], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 60)

--- 処理中: 画像 81 から 100 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 80)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6930, 0.5226, 0.7302, 0.7399, 0.7176, 0.6209, 0.5511, 0.6197, 0.7088,
        0.8136, 0.7387, 0.7753, 0.8751, 0.5915, 0.6488, 0.7575, 0.5067, 0.6304,
        0.9573, 0.5433], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -7.7913,  -5.7800,  -7.5209,  -9.1777,  -5.9462,  -7.0567,  -8.2928,
         -7.5013, -10.8272,  -6.5703,  -9.1419,  -2.3787,  -6.9174,  -7.5222,
         -4.3886,  -4.5872,  -7.7300,  -6.0585,  -8.2807,  -3.6878],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.3390e+02-9.4400e-06j, 1.5017e+02+1.4679e-05j, 1.3358e+02+1.4969e-06j,
        2.2155e+01-4.6957e-05j, 5.1009e+01-6.0768e-07j, 1.0460e+02-5.3406e-05j,
        4.4275e+02-7.3343e-07j, 3.3009e+02-1.0996e-06j, 1.2919e+00-2.4948e-08j,
        1.1970e+02-3.8147e-06j, 2.0388e+02-2.2888e-05j, 1.3335e+03-4.2496e-06j,
        7.7945e+01-9.7700e-08j, 1.1238e+02-1.7584e-06j, 5.2802e+02-3.2745e-06j,
        1.4117e+03+1.9891e-05j, 9.5196e+02+4.7274e-06j, 2.3462e+02-3.2870e-07j,
        1.6368e+02-1.5259e-05j, 7.1972e+01+7.6294e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(358.94830322265625-5.775756562798051e-06j)
torch.linalg.det(H.mH@H) = tensor([0.3959+1.4901e-08j, 1.3538+2.9802e-08j, 0.4648+1.3823e-08j,
        0.7542+5.9605e-08j, 4.2272+5.6762e-08j, 0.6135-1.8829e-08j,
        0.0409-4.0978e-08j, 1.3186+1.3879e-08j, 0.1170+1.7099e-10j,
        0.6862-9.1051e-10j, 0.2863-1.2270e-08j, 1.9987-1.0262e-08j,
        4.8087-1.0418e-08j, 0.4797+1.3799e-08j, 0.5706+1.9533e-07j,
        5.0530+2.0034e-08j, 0.1053-1.4901e-08j, 1.0433+1.6849e-08j,
        0.5702+1.6094e-08j, 2.1357-4.1379e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3511943817138672-3.5654978969290596e-09j)
SINR torch.Size([20]) = tensor([-12.5797,  -9.7603, -14.3836, -10.5122,  -6.2304, -11.1403, -21.9900,
         -8.0443, -17.2083, -11.4356, -13.5438, -11.6096,  -6.7157, -11.1744,
        -15.0286,  -6.1092, -20.4606,  -8.8203, -10.0233,  -8.3368],
       device='cuda:0')
SINR mean = -11.755349159240723
E[H^H] = 1e-07
E_MSE (Error Power) = 24.592470169067383
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0523, 0.0956, 0.0352, 0.0816, 0.1924, 0.0714, 0.0063, 0.1356, 0.0187,
        0.0670, 0.0423, 0.0646, 0.1756, 0.0709, 0.0305, 0.1968, 0.0089, 0.1160,
        0.0905, 0.1279], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([759, 680, 806, 702, 570, 720, 974, 628, 873, 728, 785, 733, 586, 721,
        822, 566, 944, 652, 688, 637], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -4-----------
Real SNR = tensor([ -9.5561,  -6.2972,  -5.1368,  -5.1496,  -6.8325,  -2.5284,  -4.2628,
         -4.5984,  -4.1626,  -7.1626,  -1.4195,  -5.9725,  -5.4123,  -6.7850,
         -6.2124, -10.5076,  -5.7175,  -6.8398,  -8.2251,  -4.2378],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  37.5294+8.5594e-07j,   98.6697+4.9406e-06j,  393.2454+1.0326e-05j,
        1423.4193-2.6997e-05j,   53.5644+9.5367e-06j, 1015.2786+7.9349e-06j,
          72.3856+2.0034e-06j,   20.9287+1.9073e-06j, 1229.3914-4.2744e-05j,
         467.0200-1.8279e-05j,  179.5116-7.0858e-07j,   26.2347+3.6976e-07j,
           5.1023+9.8086e-07j,   53.1282-2.6577e-06j,   58.9347+1.5639e-06j,
         105.2131-1.6973e-06j,  516.2054-0.0000e+00j,  141.5881-2.8573e-06j,
         754.9830-9.9254e-06j,   75.6693-9.7157e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(336.400146484375-3.3209187222382752e-06j)
torch.linalg.det(H.mH@H) = tensor([0.2374-2.9802e-08j, 0.5344+2.9760e-08j, 0.3344-1.4901e-08j,
        0.4668-1.4901e-08j, 1.0059-4.3195e-08j, 3.0435-7.2943e-08j,
        1.4942-5.5840e-09j, 0.2710-1.3411e-07j, 3.3267+4.8053e-09j,
        0.4208+2.9802e-08j, 3.6182+3.5763e-07j, 2.2809+4.8040e-09j,
        1.5367-8.0811e-09j, 0.7008+2.9802e-08j, 1.1007-5.9605e-08j,
        0.3555+6.1074e-09j, 0.0456+4.2960e-09j, 0.6631-1.4823e-08j,
        2.1064+2.8384e-08j, 1.7081+2.2503e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2625627517700195+5.997299101778708e-09j)
SINR torch.Size([20]) = tensor([-13.9251, -12.2247, -15.9701, -12.1709,  -8.8915,  -7.4437,  -8.6983,
        -14.7420,  -5.2718, -13.6145,  -8.5516,  -5.9936,  -9.5411, -11.3929,
         -9.5459, -11.6487, -21.2394,  -9.1582,  -5.6792,  -6.7146],
       device='cuda:0')
SINR mean = -10.620895385742188
E[H^H] = 1e-07
E_MSE (Error Power) = 17.269147872924805
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0389, 0.0565, 0.0247, 0.0572, 0.1143, 0.1526, 0.1189, 0.0325, 0.2290,
        0.0417, 0.1225, 0.2010, 0.1000, 0.0677, 0.0999, 0.0640, 0.0075, 0.1082,
        0.2129, 0.1757], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([794, 750, 845, 748, 654, 609, 648, 815, 538, 786, 644, 562, 674, 727,
        674, 734, 959, 662, 551, 586], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -3-----------
Real SNR = tensor([ -3.6981,  -4.2435,  -5.5332,  -4.6305,  -1.8185,  -2.3282,  -3.5407,
         -4.5282,  -7.7875,  -0.6441,  -6.5168,  -5.0806,  -4.5394,  -4.8965,
        -11.4864,  -5.7931,  -2.1563,  -0.1135,  -2.9656,  -5.5801],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  4.1337+9.5367e-07j, 989.5350-1.0512e-05j,   7.6066-2.3842e-07j,
         73.2982+1.4883e-05j, 140.2517+8.8714e-07j, 781.4940+1.2661e-06j,
        304.7161+5.5731e-06j, 367.0686+3.2961e-06j, 238.8075+1.2159e-06j,
         27.9876-1.2023e-06j,  91.0463+5.6611e-06j, 626.1105-4.4559e-06j,
          1.6136-9.0003e-06j,  13.8297-3.8147e-06j,  15.7855+6.0467e-08j,
        282.9142-6.7772e-06j, 396.3574+7.4729e-06j,  81.9475-3.6606e-06j,
        289.0116+3.7544e-05j, 189.5692-1.8329e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(246.15420532226562+1.8659902707440779e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.6359-1.6717e-08j,  1.8127+1.3926e-08j,  2.1714+8.6077e-08j,
         0.5292+6.7055e-08j,  6.9897+6.0367e-08j,  2.0006-1.9372e-07j,
         5.0364+3.2839e-09j,  1.1916-3.5073e-08j,  0.5172-9.0693e-10j,
         4.2776-6.4270e-08j,  0.5807-0.0000e+00j,  0.0219+8.3819e-09j,
         2.9156+4.0873e-08j,  0.8857-9.0595e-09j,  0.1096+4.6566e-10j,
         0.2492+1.0244e-08j,  0.0488+1.6764e-08j, 17.4273+6.7802e-08j,
         5.7040-2.7224e-08j,  0.3323+4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.671875476837158+3.6488712051863104e-09j)
SINR torch.Size([20]) = tensor([ -9.3593,  -6.3223,  -5.6114, -11.9870,  -2.8840,  -9.4855,  -3.1949,
         -7.0983,  -9.1234,  -5.0939, -10.6387, -23.8049,  -4.7322,  -7.8286,
        -14.4171, -14.3239, -23.5095,  -0.1428,  -3.3387, -14.0526],
       device='cuda:0')
SINR mean = -9.347455024719238
E[H^H] = 1e-07
E_MSE (Error Power) = 27.6741943359375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1039, 0.1891, 0.2155, 0.0595, 0.3398, 0.1012, 0.3240, 0.1632, 0.1090,
        0.2363, 0.0795, 0.0041, 0.2517, 0.1415, 0.0349, 0.0356, 0.0044, 0.4918,
        0.3167, 0.0378], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 668,  573,  549,  743,  455,  672,  466,  598,  661,  532,  706, 1000,
         519,  621,  807,  804, 1000,  359,  471,  798], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -2-----------
Real SNR = tensor([ -9.9054,  -5.3111, -12.9364,  -3.1171,  -3.6892,  -7.7252,  -8.6597,
         -5.4991,  -7.2797,  -3.7103,  -3.4114,  -0.2754,  -3.8895,  -2.7361,
          0.9630,  -6.8473,  -1.0994,  -0.3347,  -3.3006,  -0.3663],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 22.9493+7.0807e-08j, 375.5626-1.2238e-05j,  29.2972+5.1920e-07j,
         74.3839+5.3022e-07j, 603.5372-1.0330e-05j, 132.3662-1.8759e-06j,
         38.6355-0.0000e+00j,  74.2381-8.3632e-07j,   9.2183+4.4405e-06j,
         20.4610+4.8021e-06j,  15.3151-1.3882e-07j, 135.1497+7.9844e-07j,
         45.6059+5.7220e-06j, 115.2360-0.0000e+00j, 195.6937-3.2462e-06j,
        117.1650-4.7686e-07j, 163.3752-4.3598e-06j, 144.5045-4.5487e-06j,
         58.5711-5.7220e-06j,  16.7753-1.1921e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(119.40203094482422-1.4040628002476296e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.0890+3.7253e-09j,  0.6627+7.4506e-08j,  0.0477-3.7253e-09j,
         2.5500+6.6708e-08j,  3.4537-7.9647e-08j,  0.0702+7.4506e-09j,
         0.0305-2.3283e-09j,  0.8289+7.9785e-09j,  0.5918-1.1193e-08j,
         0.6585+7.1029e-09j,  1.9959+3.4896e-08j, 20.3073-1.8520e-07j,
         1.5112+5.9605e-08j,  0.6583+1.6692e-08j,  6.4366-9.5469e-08j,
         0.4495-1.2392e-08j,  9.7832-4.3771e-09j,  4.4233+1.5244e-07j,
         2.1733-3.7892e-08j,  9.5407+4.5137e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.3131206035614014+2.200853499445543e-09j)
SINR torch.Size([20]) = tensor([-14.1290,  -9.0324, -14.1635,  -3.9232,  -3.8375, -16.7674, -18.2831,
         -7.2174,  -8.1528,  -8.3078,  -3.8228,   0.4780,  -7.2764,  -9.2102,
         -2.8821,  -8.3095,  -0.9307,  -3.3995,  -4.6196,  -0.9698],
       device='cuda:0')
SINR mean = -7.2378387451171875
E[H^H] = 1e-07
E_MSE (Error Power) = 10.726283073425293
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0372, 0.1111, 0.0369, 0.2884, 0.2924, 0.0206, 0.0146, 0.1595, 0.1327,
        0.1287, 0.2931, 0.5275, 0.1577, 0.1071, 0.3399, 0.1286, 0.4466, 0.3137,
        0.2566, 0.4444], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([799, 658, 800, 492, 489, 863, 897, 602, 631, 636, 488, 338, 604, 664,
        455, 636, 387, 473, 516, 388], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -1-----------
Real SNR = tensor([ 1.4983, -6.4671,  1.2876,  0.2108, -2.8308,  1.5384, -4.6847, -6.3162,
         0.2651, -2.8145, -2.8392,  2.0791, -4.9410, -0.3981,  0.8642,  1.5726,
        -4.6534, -5.1316, -4.6137, -0.6766], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.8948e+00-2.5811e-07j, 3.4473e+01-3.9403e-07j, 4.7875e+01-4.6782e-07j,
        1.1135e+02-1.6444e-06j, 1.5879e+00-5.3644e-07j, 6.6722e+01+7.3061e-07j,
        7.2822e+00+3.5763e-07j, 1.8653e+02-1.0484e-05j, 4.8159e+01-4.3149e-07j,
        2.4447e+01-3.8147e-06j, 1.4533e+02-2.0365e-06j, 6.3230e+02-9.4543e-06j,
        4.1557e+00-1.3411e-06j, 4.9694e+00+4.1062e-07j, 3.6152e-01-2.9847e-05j,
        2.6456e+01+6.2302e-07j, 5.3187e+01+6.2394e-07j, 3.2770e+00-1.0861e-06j,
        4.5968e+01-1.1282e-06j, 2.8194e+02-3.7942e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(86.562744140625-3.1986357953428524e-06j)
torch.linalg.det(H.mH@H) = tensor([ 3.2698+1.8832e-08j,  0.0895-2.2552e-09j,  2.8958+1.3825e-07j,
         6.7136-4.0135e-08j,  0.2000+4.4703e-08j,  4.2457-5.7466e-08j,
         0.8075-1.0301e-08j,  0.0826-0.0000e+00j,  6.3575+9.7380e-08j,
         0.4158-3.1640e-08j,  3.2134-1.2369e-08j,  1.6688-4.1326e-08j,
         0.4915+3.6142e-09j,  3.2589+1.5278e-07j, 10.8184-1.9597e-07j,
         5.2722+4.7574e-08j,  0.0611-5.7742e-08j,  0.3208-7.0759e-09j,
         0.1892+6.3068e-09j,  3.1898-6.5332e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6781017780303955-6.084258652450103e-10j)
SINR torch.Size([20]) = tensor([ -3.6847, -11.0453,  -4.7168,  -1.6306, -12.1258,  -3.2979,  -5.3481,
        -13.4476,  -0.2192, -10.1400,  -1.8358,  -8.3993,  -7.1497,  -2.7696,
         -0.7096,  -2.1038, -16.7581,  -8.3531, -10.8790,  -2.0444],
       device='cuda:0')
SINR mean = -6.332923412322998
E[H^H] = 1e-07
E_MSE (Error Power) = 7.371484279632568
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2998, 0.0729, 0.2524, 0.4072, 0.0578, 0.3188, 0.2259, 0.0433, 0.4874,
        0.0883, 0.3959, 0.1263, 0.1616, 0.3458, 0.4592, 0.3812, 0.0207, 0.1275,
        0.0755, 0.3844], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([483, 717, 519, 411, 747, 470, 540, 782, 362, 691, 419, 639, 600, 451,
        379, 428, 863, 638, 712, 426], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 0-----------
Real SNR = tensor([-0.7488,  2.0453,  2.1895, -2.4682,  0.2868, -1.5268,  0.0840, -1.5333,
        -2.2109,  0.1451, -2.2138, -1.5695,  2.4545, -3.2593, -1.2503, -1.5336,
         2.8943, -0.4096, -1.3438, -0.6871], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([137.1547+1.7085e-06j,  15.8871+2.4444e-07j,  28.6191+2.7458e-07j,
        103.0816+1.2870e-07j,  58.5291+5.5249e-07j,  42.3812-3.5057e-07j,
          9.8031-3.1204e-07j,  63.7765-2.8610e-06j,  87.2102-6.3491e-07j,
        114.3282+2.4765e-06j,  37.2415-1.9073e-06j,  24.6642+2.9640e-06j,
          2.0095+3.2679e-06j,  35.5837+1.4658e-07j,  76.1066+6.2001e-07j,
        202.7833-2.6986e-06j,  28.1083+4.9264e-08j,  14.0290-0.0000e+00j,
        301.8532-2.1397e-07j, 178.3977+1.7362e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(78.07740020751953+2.5953951876545034e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.7624-2.0876e-08j,  1.7288-9.2800e-08j,  4.0654+1.5767e-08j,
         2.7877-2.8033e-08j,  2.1817+7.0576e-08j,  3.8413-1.4290e-08j,
         1.7967-1.3979e-08j,  1.5218-1.4901e-07j,  0.8839+4.5827e-09j,
         0.3317-1.3411e-07j,  0.2489-6.5889e-09j,  0.0576-5.1797e-09j,
        12.3770-2.1711e-07j,  0.1706+7.4506e-08j,  4.6805+1.5362e-07j,
         5.3941+1.7858e-07j, 11.2092+2.0150e-08j,  5.2578+6.1316e-08j,
         0.2832-5.9605e-08j,  3.7664+2.8677e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.1673316955566406-6.6905410101014695e-09j)
SINR torch.Size([20]) = tensor([ -6.1018,  -5.0990,  -2.4372,  -1.5641,  -3.7582,  -1.2327,  -4.4596,
         -5.0446,  -4.3660, -10.1957,  -8.6023, -18.9113,   1.8220, -11.7394,
         -1.8977,  -0.4629,   1.3797,  -0.2608, -11.5729,  -1.3133],
       device='cuda:0')
SINR mean = -4.790884494781494
E[H^H] = 1e-07
E_MSE (Error Power) = 6.975646495819092
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1970, 0.2361, 0.3633, 0.4109, 0.2962, 0.4295, 0.2637, 0.2384, 0.2679,
        0.0873, 0.1212, 0.0127, 0.6034, 0.0628, 0.3925, 0.4734, 0.5788, 0.4850,
        0.0651, 0.4250], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([565, 532, 440, 409, 486, 397, 510, 530, 507, 693, 645, 911, 293, 736,
        421, 370, 307, 363, 732, 400], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 1-----------
Real SNR = tensor([-2.4282, -3.0952, -0.6209,  4.0075,  2.9993,  3.1106, -2.7639,  2.1890,
         0.8489, -0.5413,  0.3243, -4.3552,  1.9416,  0.0113, -0.8108, -4.0036,
         4.1906, -2.2350,  2.7713, -2.3083], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  9.8474+5.2927e-07j,  18.9549-1.8333e-07j,  14.7667-0.0000e+00j,
          5.0711+1.7134e-07j,  14.8543+3.5763e-07j,  35.4983+2.3857e-07j,
          5.2796-1.1695e-08j,   2.5348+2.0390e-08j,   0.9322+8.9407e-08j,
         84.4069+1.2318e-06j,  70.7860-2.0336e-06j, 110.6513-6.3935e-07j,
         31.5079+2.6540e-08j,   3.9928-2.6421e-06j,   0.5852+2.9802e-08j,
          8.1091+4.9222e-07j,  43.0911-2.8983e-07j,  51.5234-8.3909e-07j,
         17.3759-5.1982e-07j,   0.1254-1.4807e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(26.494714736938477-1.9933661121740442e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.2516-2.9656e-09j,  0.0606+4.6566e-10j,  0.4293+5.1397e-09j,
         5.9236-1.3583e-07j,  5.5585+1.1921e-07j,  0.0767-7.4133e-07j,
         0.3838-7.4128e-10j,  4.6370-1.2533e-07j,  3.3406-8.3579e-08j,
         1.8966-8.4795e-09j,  0.8769+7.7681e-09j,  0.4450+2.6662e-09j,
        19.2768-1.4481e-07j,  0.6554-5.3365e-10j,  0.0777-3.9211e-11j,
         1.3318-1.0157e-08j,  5.0027-9.3923e-08j,  1.0073+1.0976e-08j,
         1.2128+1.2252e-07j,  0.2225-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.633361577987671-5.4693693130047905e-08j)
SINR torch.Size([20]) = tensor([ -9.1579, -15.4304,  -6.8315,  -0.2155,  -0.3763, -20.3576,  -7.0398,
          0.2811,  -0.4875,  -1.7224,  -4.8277,  -4.8260,   4.1399,  -5.8276,
        -13.5619,  -2.2755,  -2.3750,  -3.1985,  -6.8303,  -9.2386],
       device='cuda:0')
SINR mean = -5.507943153381348
E[H^H] = 1e-07
E_MSE (Error Power) = 10.14884090423584
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1083, 0.0278, 0.1718, 0.4876, 0.4784, 0.0091, 0.1651, 0.5162, 0.4720,
        0.4021, 0.2476, 0.2476, 0.7218, 0.2072, 0.0422, 0.3719, 0.3666, 0.3238,
        0.1718, 0.1065], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([662, 832, 589, 362, 367, 941, 596, 345, 371, 415, 523, 523, 221, 556,
        785, 434, 438, 466, 589, 665], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 2-----------
Real SNR = tensor([-0.6244, -1.3492, -0.2260,  1.9673,  5.8720, -2.6636,  0.8683,  2.7672,
         6.0342, -2.4994,  0.4573, -1.6218, -0.7074, -0.5114,  2.6396,  0.8916,
         2.4170, -1.7552, -0.0831,  1.5194], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.9415e+00+4.9415e-08j, 3.8236e+01-6.2522e-07j, 4.7526e-01-6.7251e-07j,
        1.8035e+00-3.1316e-07j, 1.7194e+02-2.9722e-06j, 4.1507e+01-3.8147e-06j,
        1.4373e+00-7.4772e-08j, 3.2799e+00+1.7387e-07j, 9.1708e+01-1.5510e-07j,
        1.6991e+01+3.0053e-07j, 4.6384e+01+5.6142e-07j, 4.3631e+01-1.9073e-06j,
        9.3145e+01+2.6160e-06j, 3.6085e+00+9.5367e-07j, 4.3213e-02+1.1176e-08j,
        1.2586e+02+1.8220e-06j, 1.3343e+01-1.0767e-07j, 2.5137e+00+8.5960e-09j,
        3.8956e+00-2.3842e-07j, 4.0328e+01-5.0490e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(37.30356979370117-4.716726493825263e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.1681-2.9802e-08j,  0.3657-1.4901e-08j,  1.3480-3.1635e-08j,
         3.5979-5.7216e-08j, 22.2401+3.5411e-08j,  0.3245+4.5485e-09j,
         0.9841+1.1524e-08j,  1.4910-2.5190e-08j,  8.8013-2.0149e-07j,
         0.3704+1.3411e-07j,  3.7025+2.1549e-08j,  0.6865+7.4027e-09j,
         2.4008-1.9718e-08j,  0.4112+3.4093e-08j,  1.8832+2.0378e-07j,
         0.4450-7.7123e-09j,  3.1402-7.2722e-08j,  0.0740+2.3923e-11j,
         0.4850-0.0000e+00j,  0.1937-3.5774e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6556508541107178-4.1520423210705815e-10j)
SINR torch.Size([20]) = tensor([-10.0262,  -6.6783,  -1.9082,   0.1550,   4.4552,  -5.1891,  -3.3070,
         -2.7934,   2.3912,  -8.6879,   1.0120,  -3.9983,   0.1707,  -5.7609,
         -3.0644,  -6.9106,  -1.0261, -12.2932,  -9.2106,  -9.8769],
       device='cuda:0')
SINR mean = -4.12734842300415
E[H^H] = 1e-07
E_MSE (Error Power) = 4.010510444641113
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0904, 0.1769, 0.3919, 0.5089, 0.7361, 0.2324, 0.3183, 0.3445, 0.6343,
        0.1192, 0.5580, 0.2848, 0.5098, 0.2097, 0.3306, 0.1692, 0.4412, 0.0557,
        0.1071, 0.0933], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([688, 584, 421, 349, 212, 535, 470, 452, 274, 648, 320, 494, 349, 554,
        462, 592, 390, 752, 664, 684], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 3-----------
Real SNR = tensor([-1.8053,  4.3567, -2.8803, -3.3331,  2.0880, -2.2853,  0.3111, -1.4835,
         3.9809, -0.5016,  1.9602,  2.6682, -0.4449,  1.7311,  3.0553,  3.0318,
         1.8637,  6.1293,  5.9401,  2.4958], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.3469+1.9156e-07j, 25.8592+6.6878e-07j, 16.4590-1.4749e-07j,
        13.3268-1.1474e-07j, 13.1041-9.6789e-07j, 14.9778+2.0254e-07j,
         0.3685+5.4110e-07j, 20.5882-3.6721e-07j, 25.3415+9.3115e-08j,
         8.7425+7.1000e-07j,  3.3637+3.5763e-07j,  1.6343-8.5030e-07j,
         7.1920-3.0196e-07j,  1.2682+5.9605e-08j,  9.8373+1.4397e-07j,
         1.4023+1.7001e-08j, 35.2399+6.9314e-07j, 95.0345-6.6070e-08j,
        62.5814-1.4868e-06j, 10.4324+4.6767e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(18.455020904541016-2.8864027612485188e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.9306-3.4081e-09j,  2.9670-1.6694e-07j,  0.0314+3.2596e-09j,
         0.3052+1.5682e-08j,  0.2170+1.0346e-08j,  0.0551-2.8929e-09j,
         1.8914-3.2440e-08j,  0.0344+4.0572e-09j,  4.3266+1.0615e-07j,
         0.3895+7.4506e-09j,  3.5850+5.5637e-08j,  2.8368+2.5073e-09j,
         2.1471-0.0000e+00j,  3.2226+3.8423e-08j,  0.9544-5.9605e-08j,
         2.0519-2.3664e-08j,  1.4836+8.4779e-10j, 12.1959+8.3447e-07j,
         4.0970-3.4177e-08j,  3.9096-3.9715e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3816049098968506+3.5799168074390764e-08j)
SINR torch.Size([20]) = tensor([ -0.9063,   0.5730, -13.7696,  -3.4877,  -9.3826, -10.0147,   0.5223,
        -12.0715,   1.7267,  -4.3775,   2.3216,   1.2479,  -0.4390,   1.4945,
         -4.1148,   0.1665,  -0.5943,   3.6142,   0.0140,   2.8180],
       device='cuda:0')
SINR mean = -2.232966661453247
E[H^H] = 1e-07
E_MSE (Error Power) = 3.5526814460754395
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4480, 0.5329, 0.0403, 0.3094, 0.1034, 0.0906, 0.5300, 0.0584, 0.5981,
        0.2674, 0.6305, 0.5713, 0.4748, 0.5852, 0.2794, 0.5096, 0.4658, 0.6968,
        0.5008, 0.6568], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([386, 335, 790, 476, 669, 688, 336, 746, 296, 507, 277, 312, 370, 304,
        498, 349, 375, 236, 354, 261], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 4-----------
Real SNR = tensor([ 2.5451,  5.9731, -1.2128, -2.4032,  4.3031, -0.4824,  2.0610,  3.7014,
        -2.5552,  3.3069,  6.3410,  0.0110,  2.5813,  1.2270,  7.7466,  0.0552,
         4.5244,  5.1339,  0.0353,  4.6273], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.0780e+02+5.2049e-07j, 1.7752e+01+9.3046e-07j, 3.9522e+00+2.3842e-07j,
        1.1440e+01-8.6601e-08j, 2.8396e+01-5.5998e-07j, 4.4229e+01+2.3026e-08j,
        6.0708e+00-4.5074e-07j, 2.6106e+00+2.5137e-07j, 1.1335e+01+3.0972e-07j,
        2.0710e+00+3.5683e-09j, 1.1305e+02-2.9665e-06j, 2.4544e+00-5.9605e-07j,
        1.9978e+01+4.2701e-07j, 8.6290e-02+8.5461e-08j, 7.4798e+01+3.8147e-06j,
        9.5712e+00-4.1147e-08j, 1.9304e+01-9.5367e-07j, 1.0951e+00+5.9605e-08j,
        4.7043e+00-0.0000e+00j, 6.4195e+01-4.4991e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(27.24436378479004+2.7962485660282255e-08j)
torch.linalg.det(H.mH@H) = tensor([4.3827-1.2108e-08j, 1.0245-1.1846e-07j, 0.0665+9.3132e-10j,
        0.3067+6.0786e-09j, 4.6686+1.3879e-09j, 0.2954-2.9802e-08j,
        0.1251-2.5589e-08j, 2.3680+1.0038e-08j, 0.1114-7.4506e-09j,
        0.4712-2.6822e-07j, 4.2372-1.5695e-07j, 0.4130+6.1997e-09j,
        0.8493+6.6328e-08j, 1.1065-1.0225e-08j, 1.4061+1.1921e-07j,
        0.8789-1.3554e-08j, 3.5748-2.3842e-07j, 1.1360-3.1462e-09j,
        0.3933-3.8020e-08j, 1.6846-5.4382e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4749863147735596-3.83076717014319e-08j)
SINR torch.Size([20]) = tensor([ 2.6245, -5.1853, -9.9308, -2.9341,  2.6172, -4.4473, -9.6563,  1.7745,
        -8.1840, -6.0468,  0.5811, -4.5976, -1.2494,  0.4027, -4.9739, -1.3836,
         1.3018, -3.6250, -4.0690, -0.9504], device='cuda:0')
SINR mean = -2.8965914249420166
E[H^H] = 1e-07
E_MSE (Error Power) = 2.61326265335083
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6466, 0.2326, 0.0922, 0.3372, 0.6463, 0.2642, 0.0977, 0.6008, 0.1319,
        0.1990, 0.5334, 0.2576, 0.4286, 0.5232, 0.2414, 0.4210, 0.5744, 0.3027,
        0.2815, 0.4455], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([267, 535, 685, 457, 267, 510, 677, 294, 632, 564, 334, 515, 398, 341,
        528, 403, 310, 481, 497, 387], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 5-----------
Real SNR = tensor([ 0.8207,  5.4151,  7.1302,  0.3929,  4.4131,  1.7481,  0.7818,  4.5743,
         4.8692,  8.7868, -1.6463,  0.2107, -2.3761,  4.1492,  3.1915,  6.8169,
         7.3115,  8.0912, -0.0458,  3.0105], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.5362+2.6077e-08j,  1.1927-7.2742e-08j, 14.7460-1.0295e-07j,
         7.9112-9.8258e-08j, 13.7706+2.7217e-07j,  5.8118-1.7881e-07j,
         4.1313+3.5763e-07j,  2.8795+3.4013e-07j,  5.2654-3.8404e-07j,
        18.4374-0.0000e+00j,  0.4072-1.3152e-07j,  1.0279+5.5879e-08j,
         5.9527+1.3165e-07j,  5.3769+4.8948e-08j,  3.7842+7.9481e-07j,
        72.2005-1.5236e-06j,  1.5883+3.5572e-08j, 33.6243-2.7068e-07j,
         9.8172-8.9740e-08j,  1.0136-9.8348e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(10.573746681213379-8.864957123932982e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1874+1.4901e-08j,  0.8314-5.1113e-08j,  2.4154+1.7743e-08j,
         0.2548-0.0000e+00j,  2.4516-2.5480e-08j,  0.9448+7.4506e-09j,
         1.0069-1.1695e-08j,  0.7163-5.9605e-08j,  0.9872-1.1776e-07j,
        18.9862+1.3639e-07j,  0.1802+1.9267e-09j,  0.0435+8.1956e-08j,
         0.1943+2.2212e-09j,  0.1886+7.0781e-08j,  0.1127+6.8042e-09j,
         5.2021+1.4964e-07j,  4.6787-7.3747e-08j,  4.5034-2.8242e-08j,
         1.1693-7.3649e-09j,  0.0865+3.6124e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2570559978485107+5.920780754564703e-09j)
SINR torch.Size([20]) = tensor([ -6.7074,  -2.4633,  -0.0888,  -3.9600,   2.5172,  -0.5280,   1.4877,
         -3.6569,  -0.8324,   7.1089,  -3.8010, -14.8494,  -2.0608,  -8.9558,
         -8.0180,   3.5879,   3.7330,   3.7513,   1.1181,  -9.7228],
       device='cuda:0')
SINR mean = -2.117023229598999
E[H^H] = 1e-07
E_MSE (Error Power) = 3.5028324127197266
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1759, 0.3619, 0.4949, 0.2866, 0.6410, 0.4696, 0.5848, 0.3011, 0.4522,
        0.8371, 0.2942, 0.0317, 0.3835, 0.1128, 0.1363, 0.6955, 0.7026, 0.7034,
        0.5640, 0.0963], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([585, 441, 357, 493, 270, 373, 304, 482, 383, 144, 487, 817, 426, 656,
        627, 237, 233, 232, 316, 679], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 6-----------
Real SNR = tensor([3.5484, 6.0014, 0.9732, 2.3908, 4.4313, 5.2909, 7.5276, 3.2047, 5.1920,
        7.3991, 3.2714, 3.4864, 2.2551, 7.3475, 7.5909, 5.3882, 3.7472, 1.8145,
        2.6523, 5.3902], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1069-9.6010e-08j,  4.7746-0.0000e+00j,  0.3073-1.7772e-08j,
         9.7295-2.8610e-06j,  1.4378+3.7253e-09j,  6.2705+4.9944e-08j,
         8.5306-2.3842e-07j,  2.1146-4.2137e-08j,  6.2154+9.5367e-07j,
         6.7414+9.0230e-08j,  3.7144+4.6552e-08j,  0.9646+1.8696e-08j,
        16.6509+8.5305e-08j, 10.4014+3.7800e-08j,  9.1907+6.3701e-08j,
         1.0904-6.4247e-08j, 16.8656+2.4608e-07j,  2.0802+1.7881e-07j,
         3.5297+3.5763e-07j,  1.8166-5.6110e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.626662254333496-6.217833714572407e-08j)
torch.linalg.det(H.mH@H) = tensor([1.2112e+00-7.6342e-09j, 9.3373e-01+2.9802e-08j, 4.9777e-01-7.6779e-10j,
        1.0835e+00-7.7688e-08j, 2.7185e+00+1.8323e-08j, 4.7076e-01-4.0862e-08j,
        9.1250e+00-2.6487e-08j, 1.5284e+00-1.1836e-08j, 2.9064e+00-9.2242e-09j,
        2.5792e-02+5.4963e-08j, 1.0522e+00+5.9605e-08j, 1.3236e+00-5.7188e-08j,
        7.1018e-01-5.9605e-08j, 7.6217e-01-5.9605e-08j, 2.4513e+00-5.6200e-08j,
        8.5045e+00-3.1101e-07j, 9.1752e-04-1.3298e-08j, 9.0609e-01+4.6955e-09j,
        3.3994e-01-1.4901e-08j, 9.5234e-01-1.4776e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8752073049545288-2.9684589009093543e-08j)
SINR torch.Size([20]) = tensor([  3.0705,  -0.9576,  -0.1583,   0.1871,   3.6026,  -3.0216,   6.4500,
          3.6095,   3.7385, -17.3992,   0.6561,   1.0282,  -0.2194,  -2.0472,
          2.5746,   5.7744, -28.7043,   2.0746,  -1.9206,   0.6734],
       device='cuda:0')
SINR mean = -1.0494307279586792
E[H^H] = 1e-07
E_MSE (Error Power) = 34.8806266784668
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6697, 0.4451, 0.4909, 0.5108, 0.6963, 0.3328, 0.8154, 0.6966, 0.7028,
        0.0179, 0.5377, 0.5589, 0.4874, 0.3843, 0.6440, 0.7908, 0.0013, 0.6172,
        0.3912, 0.5387], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 253,  388,  360,  348,  237,  460,  159,  237,  233,  878,  332,  319,
         362,  426,  269,  176, 1000,  285,  422,  331], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 7-----------
Real SNR = tensor([ 7.7072,  8.4708,  1.9461,  7.8856,  6.2545,  8.5939,  4.1255,  6.4464,
        10.9107,  8.0399,  2.2088,  3.3987,  4.8008,  6.3067,  5.3620,  6.6655,
         7.9661,  8.7499,  4.7785,  9.0499], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.9122+5.9605e-07j,  7.4290+1.8404e-07j,  0.1604+9.3257e-10j,
         0.2922-9.6433e-09j,  0.1488-9.3132e-09j, 13.2276-9.6730e-07j,
         1.2512-5.9605e-08j,  1.3198+1.8218e-08j, 10.8314+3.2793e-07j,
         3.4329-2.8800e-08j,  0.5298-5.6682e-08j,  0.8344+2.9065e-08j,
         0.7853+5.9605e-08j, 12.4817-2.4938e-07j, 19.0251+3.7971e-07j,
        13.9265+1.9073e-06j, 31.0052+2.8369e-07j, 18.0631+1.4442e-06j,
         3.0747+3.7253e-08j,  6.9033-2.4319e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.581729412078857+1.8220630693122075e-07j)
torch.linalg.det(H.mH@H) = tensor([2.0711+5.9605e-08j, 0.8737+5.8911e-08j, 0.0948+1.3596e-08j,
        0.8216-7.9693e-08j, 1.5572-1.1921e-07j, 1.8137-2.9802e-08j,
        0.7589+5.2245e-09j, 0.4830+6.5510e-09j, 0.4020-7.5953e-08j,
        2.2597-2.0542e-07j, 0.1671-2.1756e-09j, 1.1592+1.9671e-08j,
        1.7503-6.7068e-08j, 0.0259-3.4682e-09j, 2.8403-1.8254e-08j,
        1.0167-0.0000e+00j, 4.2767-3.3531e-08j, 8.0790-9.1273e-08j,
        3.2442-1.6900e-08j, 7.8678-1.8185e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.078139066696167-3.8051606310318675e-08j)
SINR torch.Size([20]) = tensor([  1.6863,  -0.7927,  -6.7305,  -0.3033,   2.0059,   0.5468,   2.5309,
         -1.8533,  -4.6593,   3.4936,  -2.1337,   1.8160,   3.1193, -14.2362,
          4.6476,   0.3196,   5.5013,   7.0265,   4.7333,   7.3321],
       device='cuda:0')
SINR mean = 0.7025091052055359
E[H^H] = 1e-07
E_MSE (Error Power) = 2.1934964656829834
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5959, 0.4545, 0.1751, 0.4825, 0.6135, 0.5314, 0.6417, 0.3949, 0.2549,
        0.6909, 0.3796, 0.6030, 0.6722, 0.0363, 0.7446, 0.5184, 0.7802, 0.8345,
        0.7484, 0.8440], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([297, 382, 586, 365, 287, 336, 270, 419, 517, 240, 429, 293, 251, 802,
        206, 343, 183, 146, 204, 139], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 8-----------
Real SNR = tensor([ 8.3396,  8.1413,  9.0232,  7.8774,  6.1298, 10.8101,  6.1859,  6.0474,
         2.7261,  5.3554,  8.6419,  4.7362,  6.4830,  1.3548,  5.7238,  8.4863,
         4.9537,  6.0179, -1.0811,  0.8447], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.1264-5.8913e-07j,  5.1291+4.6660e-08j,  3.5595+7.4506e-09j,
         1.0697+8.8555e-09j,  0.3438-5.5158e-09j,  8.3123-1.4690e-08j,
         3.8283+3.5763e-07j,  3.3586+2.5449e-08j,  1.2051-2.0862e-07j,
         0.6092-3.1665e-08j, 20.9909-2.3368e-07j,  2.1326+9.4949e-09j,
         1.9328-2.5480e-08j,  0.6251-8.7198e-09j,  0.1320+8.8891e-08j,
         3.5767-1.5834e-08j,  8.5282+9.1296e-08j,  0.6868+7.4506e-08j,
         0.1049-1.9586e-10j,  0.1699-1.8626e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.6211049556732178-2.1257767102156322e-08j)
torch.linalg.det(H.mH@H) = tensor([7.4297+1.5755e-07j, 1.7632+4.7057e-08j, 2.1545-0.0000e+00j,
        2.4518+2.5621e-08j, 0.1951-1.5332e-07j, 1.8175-5.1417e-09j,
        0.8265-5.9605e-08j, 0.2079-2.3461e-08j, 1.0076-1.2926e-08j,
        0.9995-8.6165e-09j, 2.5174+1.7881e-07j, 0.0882+2.7642e-08j,
        0.2931-0.0000e+00j, 0.2648+1.7567e-09j, 0.0340+5.0826e-09j,
        4.0150+1.1921e-07j, 0.3169-0.0000e+00j, 3.0517+3.3085e-08j,
        0.0911-1.4194e-09j, 0.0482-3.4023e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4786771535873413+1.6396139557173228e-08j)
SINR torch.Size([20]) = tensor([  8.0832,   3.8852,   2.9967,   4.8962,  -4.9794,   3.0976,   0.4373,
         -3.4428,   4.1257,   2.8420,   3.5371,  -7.2893,  -0.3587,   0.5794,
        -10.3679,   5.8731,  -0.9606,   7.5265,  -2.0402,  -4.5548],
       device='cuda:0')
SINR mean = 0.6943156123161316
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5420310497283936
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8654, 0.7098, 0.6660, 0.7554, 0.2411, 0.6711, 0.5252, 0.3116, 0.7211,
        0.6580, 0.6931, 0.1573, 0.4794, 0.5333, 0.0841, 0.7945, 0.4449, 0.8498,
        0.3847, 0.2595], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([123, 228, 255, 199, 528, 252, 339, 475, 221, 260, 239, 604, 367, 334,
        698, 174, 388, 135, 426, 513], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 9-----------
Real SNR = tensor([ 4.2088,  5.7582,  8.6929, 10.0079,  5.0496, 11.7560,  9.4940,  3.2906,
        10.4264,  3.5295,  8.8623,  6.8171,  9.1214,  6.3384,  6.7400,  2.8627,
         7.2147,  9.1574, 11.0836,  6.0557], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.5088+9.6509e-08j,  7.0771-5.5961e-07j,  3.8729+3.5763e-07j,
         6.0881-3.4418e-08j,  2.9395+3.7652e-08j,  7.8707-1.5036e-07j,
         1.8026+9.2708e-09j,  0.6253-9.3132e-09j,  7.0215+1.5328e-07j,
         0.4753-5.4164e-09j,  0.6053-2.0562e-09j,  0.9644-1.1288e-08j,
        24.8549+1.9585e-07j,  1.0930+7.4506e-08j,  2.6326+2.6353e-08j,
         0.0320-8.3819e-09j, 11.0268-2.8003e-07j,  4.9521+4.1870e-07j,
         3.9462+1.8309e-08j,  1.6521+9.1990e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.502066612243652+2.0958616175903444e-08j)
torch.linalg.det(H.mH@H) = tensor([0.2186-4.6590e-10j, 0.2360-4.3878e-09j, 3.2082+1.5366e-08j,
        4.9720-9.4401e-08j, 1.9204-1.7986e-08j, 3.3587+1.4867e-07j,
        1.4588+2.3303e-08j, 0.0160+1.0245e-08j, 0.3809-3.8599e-09j,
        0.0399-1.2365e-09j, 1.4357-4.8798e-08j, 0.7395-8.9407e-08j,
        7.8716+4.4166e-08j, 0.2480-2.1025e-08j, 1.8164+3.0983e-10j,
        0.2812-1.4901e-08j, 3.2246-1.9448e-08j, 0.1640-4.3727e-08j,
        4.7965+1.5076e-07j, 1.6823+8.0190e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9034651517868042+1.698638452118928e-09j)
SINR torch.Size([20]) = tensor([ 1.1459,  0.1057,  7.9045,  8.7654,  6.4491,  5.6890,  4.0148, -8.8104,
        -2.4294, -4.2371,  4.1906,  1.8145,  9.4347, -1.8502,  6.4857, -0.3647,
         7.6304, -5.3203,  7.1788,  6.9782], device='cuda:0')
SINR mean = 2.7387523651123047
E[H^H] = 1e-07
E_MSE (Error Power) = 1.0947986841201782
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5656, 0.5061, 0.8606, 0.8827, 0.8153, 0.7875, 0.7159, 0.1162, 0.3637,
        0.2738, 0.7241, 0.6030, 0.8977, 0.3951, 0.8166, 0.4790, 0.8528, 0.2271,
        0.8393, 0.8330], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([315, 351, 127, 110, 159, 178, 224, 652, 439, 502, 219, 293,  98, 419,
        158, 367, 132, 539, 142, 147], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/ (starting from index 80)

全 100 枚の画像の処理が完了しました。
Your samples are ready and waiting four you here: 
outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate 
Enjoy.
