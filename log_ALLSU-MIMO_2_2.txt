Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
合計 100 枚の画像をロードしました。20 枚ずつのチャンクで処理します。

--- 処理中: 画像 1 から 20 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 0)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.7532, 0.6074, 0.6583, 0.7701, 0.8240, 0.5942, 0.6361, 0.7516, 0.5557,
        0.6154, 0.4440, 0.5926, 0.5110, 0.4479, 0.4735, 0.6824, 0.6127, 1.1112,
        0.5368, 0.5905], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-8.3354, -3.6795, -5.8276, -9.8171, -9.1116, -3.8354, -8.7865, -5.8987,
        -2.9036, -4.7343, -6.1608, -3.9574, -4.6276, -5.2158, -5.8651, -4.8480,
        -5.9813, -6.4375, -4.6740, -5.8289], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.9114e+01+8.5702e-07j, 5.5847e+00-7.7621e-07j, 3.4075e+02+1.1601e-05j,
        9.6572e+01-7.6294e-06j, 4.5211e+02-1.5259e-05j, 9.8013e+00+4.2525e-05j,
        2.9203e+02+8.5925e-06j, 3.8191e+02+3.8147e-06j, 1.9457e-01-1.0145e-05j,
        3.2784e+02+4.5776e-05j, 4.7558e+02-3.2972e-05j, 1.2807e+03+2.0387e-05j,
        2.6103e+02+2.2888e-05j, 2.6359e+02+1.5259e-05j, 1.2705e+02-1.0402e-06j,
        1.8312e+03-1.5259e-05j, 1.0341e+02-3.8147e-05j, 3.5101e+01-8.8789e-07j,
        6.3204e+02+2.7678e-06j, 1.0281e+03-8.3473e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(398.68780517578125+2.2002939203957794e-06j)
torch.linalg.det(H.mH@H) = tensor([1.7818e+00+4.8412e-08j, 3.8992e+00+5.2417e-08j, 1.9349e+00-0.0000e+00j,
        8.2664e-01+4.3214e-08j, 8.1156e-01+4.1910e-08j, 1.7243e+00-1.5559e-08j,
        1.8201e-01+1.1176e-07j, 2.8706e-03+1.0039e-09j, 5.2598e-03-8.7118e-08j,
        4.7008e+00-2.2428e-08j, 1.1996e+00-1.5813e-08j, 6.8879e+00+5.2739e-08j,
        1.5728e-01-7.9587e-08j, 3.7704e+00+7.0908e-09j, 2.6912e+00-2.8908e-08j,
        4.9542e+00+3.3677e-09j, 1.3770e+00+1.1921e-07j, 1.4478e+00-7.5442e-09j,
        3.0513e+00+3.1861e-08j, 1.2138e+00-1.5955e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.131006956100464+1.2003517291248045e-08j)
SINR torch.Size([20]) = tensor([ -8.1062, -11.6741,  -1.9663,  -5.1096,  -2.3956, -15.2646,  -3.3929,
         -3.3586, -31.0166,  -0.9794,  -1.8065,   0.2881,  -1.4310,  -2.6411,
         -2.8373,  -2.0319,  -3.3513,  -6.4353,   0.1745,  -0.5531],
       device='cuda:0')
SINR mean = -5.194442272186279
E[H^H] = 1e-07
E_MSE (Error Power) = 63.239540100097656
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1339, 0.0637, 0.3887, 0.2357, 0.3655, 0.0289, 0.3141, 0.3158, 0.0008,
        0.4439, 0.3975, 0.5166, 0.4184, 0.3525, 0.3422, 0.3851, 0.3161, 0.1852,
        0.5100, 0.4682], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 630,  735,  423,  532,  438,  828,  473,  472, 1000,  388,  418,  344,
         404,  447,  454,  425,  472,  576,  348,  374], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -4-----------
Real SNR = tensor([ -5.6886,  -5.7863,  -2.6912,  -4.1148, -14.0915,  -7.8174,  -3.1873,
         -1.1909,  -2.8405,  -4.3736,  -7.8247,  -5.1086,  -6.1204,  -7.2653,
         -1.3065,  -3.4264,  -4.4217,  -2.3073,  -4.4281,  -3.3908],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 43.8695+5.1629e-07j, 340.0705+8.4269e-07j, 641.1678+3.8147e-06j,
         63.5864-0.0000e+00j, 386.3254+6.7645e-07j,  15.0007-2.8610e-06j,
        543.4973+2.5254e-06j, 283.0444-1.5038e-05j, 237.5078+2.1863e-06j,
        121.2263-1.7194e-06j,  63.1909-3.7249e-06j,  91.5123-1.0484e-05j,
        108.9985-2.7974e-07j, 474.2570-9.7037e-07j,  62.3717+3.3102e-07j,
        122.5710-2.3030e-06j, 174.4608+1.4106e-06j, 243.0970-1.3577e-05j,
         58.2066+1.4305e-05j,  33.8985-1.3968e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(205.3930206298828-1.915846723932191e-06j)
torch.linalg.det(H.mH@H) = tensor([0.4378+6.6493e-08j, 0.9965+1.1921e-07j, 0.1276+1.6306e-07j,
        0.1207+8.5682e-08j, 0.0243-0.0000e+00j, 1.1533+9.3454e-09j,
        2.4061-2.6494e-07j, 3.6219+1.0476e-07j, 3.2761-9.2697e-08j,
        1.2644+2.5538e-08j, 0.4285-5.4321e-10j, 3.3353-5.0696e-08j,
        0.6216+3.1264e-08j, 1.1220+1.2095e-08j, 4.4773-7.5063e-08j,
        1.5582-5.8964e-09j, 3.7474+5.0286e-08j, 0.0754-5.9580e-08j,
        3.2425+6.0124e-08j, 3.7164+2.3625e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.787655234336853+2.0734667316446576e-08j)
SINR torch.Size([20]) = tensor([ -3.4263,  -0.7751,  -0.0121,  -3.1136,  -1.0227, -10.4279,   0.3373,
          0.6006,  -4.1070,  -2.7100,  -3.9243,  -5.6499,  -3.0968,  -1.5721,
         -4.8484,  -2.5948,  -2.2879,  -3.7013,  -6.8873, -10.9902],
       device='cuda:0')
SINR mean = -3.510483503341675
E[H^H] = 1e-07
E_MSE (Error Power) = 3.1308090686798096
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3124, 0.4555, 0.4993, 0.3281, 0.4414, 0.0831, 0.5194, 0.5345, 0.2798,
        0.3489, 0.2883, 0.2140, 0.3289, 0.4105, 0.2467, 0.3549, 0.3713, 0.2990,
        0.1700, 0.0737], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([474, 381, 355, 463, 390, 700, 343, 334, 498, 449, 492, 550, 463, 409,
        523, 445, 434, 484, 591, 716], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -3-----------
Real SNR = tensor([-4.2457,  0.7959, -4.7255, -5.8931,  2.4755, -6.8185, -3.8779, -4.5710,
        -5.6812, -5.2366, -5.4037, -7.1486, -1.8075, -3.8867, -4.6705, -7.8949,
        -3.0137,  1.0065, -5.4609, -5.6448], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 28.0479+1.2511e-05j, 138.9290-1.9975e-05j,  49.3912-0.0000e+00j,
         21.4443+9.5367e-07j,  36.1876-2.8248e-06j,   6.9520-0.0000e+00j,
         44.2257+1.6653e-06j,   6.9703+4.7684e-07j,  66.8957-0.0000e+00j,
        695.4510+1.0585e-05j, 484.0005+1.0351e-05j, 331.2479+2.4772e-06j,
         14.3818+7.1526e-07j, 202.7245-5.2869e-06j, 104.1100-1.2113e-05j,
         86.6753+2.1480e-06j, 209.6903-4.3867e-06j, 610.8416-5.3501e-06j,
        613.2377-6.1613e-06j, 274.0890-2.2898e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(201.274658203125-8.252356451521337e-07j)
torch.linalg.det(H.mH@H) = tensor([1.6147-5.9605e-08j, 6.1202-6.5063e-08j, 1.6418-1.2961e-09j,
        0.3584-8.4897e-09j, 6.2234-3.7191e-07j, 0.1575-2.2352e-08j,
        2.3012+3.1377e-09j, 0.6317-0.0000e+00j, 0.3853-1.7204e-09j,
        0.4241-1.1921e-07j, 0.5075-0.0000e+00j, 0.1491+2.6361e-09j,
        4.0127+1.2299e-09j, 0.8632-2.9802e-08j, 0.4498-1.9332e-09j,
        0.2703-1.8748e-09j, 4.0630+1.7121e-09j, 1.5272+6.7347e-07j,
        0.0912-1.0349e-08j, 0.8200+7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.630609393119812-1.9878854118360323e-10j)
SINR torch.Size([20]) = tensor([-6.2651, -3.2904, -2.5965, -3.0399, -6.8431, -5.5806, -4.9415, -8.5398,
        -2.8734, -0.1799,  0.1152, -0.1697, -6.2603, -0.7045, -3.4750, -2.6059,
        -2.5529,  2.5176, -0.1570, -0.5276], device='cuda:0')
SINR mean = -2.8985161781311035
E[H^H] = 1e-07
E_MSE (Error Power) = 2.561936140060425
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1911, 0.3192, 0.3548, 0.3318, 0.1714, 0.2167, 0.2427, 0.1228, 0.3404,
        0.4896, 0.5066, 0.4902, 0.1913, 0.4595, 0.3100, 0.3543, 0.3571, 0.6410,
        0.4910, 0.4697], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([571, 470, 445, 461, 590, 548, 527, 643, 455, 361, 350, 360, 571, 379,
        476, 446, 444, 270, 360, 373], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -2-----------
Real SNR = tensor([-4.3863, -3.7504, -4.5176, -0.5279, -3.3354, -8.4543, -1.4511, -8.0397,
        -1.3489, -2.5479, -4.6396, -6.9008, -2.5420, -4.2210, -6.3522, -1.2193,
         0.1180, -1.8257, -3.3040, -1.0394], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 16.6822+8.7959e-07j, 130.0548+7.3136e-07j,   6.3708+1.3660e-08j,
        299.3530+1.5404e-06j, 400.7053-5.5070e-06j,  25.3615+2.5276e-08j,
        103.8701-8.5705e-07j,  11.1124-0.0000e+00j,  20.2239+1.3874e-06j,
        282.6145+9.9202e-06j,  57.2585-3.5568e-07j,  16.6888+4.1644e-07j,
        487.6601+8.8005e-06j,  11.2254+4.9988e-07j,   7.0159+1.1443e-05j,
        152.1711-1.3127e-06j,   4.5280+9.5588e-09j, 205.4008+3.9864e-07j,
        297.6756-4.4529e-06j,   9.8310+1.9073e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(127.2901840209961+1.2743936395054334e-06j)
torch.linalg.det(H.mH@H) = tensor([ 2.4474-4.4597e-09j,  2.8057+3.0710e-08j,  0.3768+7.2779e-09j,
        15.6010-2.4360e-07j,  6.3688+8.4158e-08j,  0.1764-2.0916e-09j,
         0.1201-1.0597e-07j,  0.0472+4.6566e-10j,  0.5507+2.7462e-08j,
         5.7626+1.2059e-07j,  0.6321+1.1582e-09j,  0.1767+3.7253e-09j,
         0.4884+1.5334e-07j,  1.4315-1.1921e-07j,  0.1063+4.0978e-08j,
         0.2061+3.5796e-08j,  5.2575+1.6846e-07j,  4.2262+8.7666e-09j,
         0.9522+1.3411e-07j,  6.2880-1.4799e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.701082706451416+9.683191137810354e-09j)
SINR torch.Size([20]) = tensor([ -5.3175,  -1.1473,  -6.3533,   0.8672,   1.3080,  -1.5985,  -0.0139,
         -5.5602,  -5.6965,   1.6615,  -1.8071,  -3.8306,   0.7183,  -5.9609,
        -13.7430,   0.1670, -10.8761,   0.7194,  -0.9979,  -8.1164],
       device='cuda:0')
SINR mean = -3.278895616531372
E[H^H] = 1e-07
E_MSE (Error Power) = 3.6737468242645264
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2272, 0.4343, 0.1880, 0.5498, 0.5747, 0.4090, 0.4992, 0.2175, 0.2122,
        0.5945, 0.3975, 0.2928, 0.5413, 0.2022, 0.0405, 0.5096, 0.0756, 0.5413,
        0.4428, 0.1337], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([539, 394, 574, 325, 310, 410, 355, 547, 552, 298, 418, 488, 330, 561,
        790, 349, 712, 330, 389, 630], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -1-----------
Real SNR = tensor([-5.5198, -2.8319, -8.1449,  0.3025, -2.7021, -2.5317,  0.2286, -2.8310,
        -1.6765, -1.1641, -6.0816,  2.4571, -0.7545, -1.3600, -3.7114, -0.8370,
        -1.3846,  1.2994, -1.5863, -4.0895], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 13.1723+4.7684e-07j,  16.4661+1.3952e-08j,   8.6085+2.5640e-07j,
        359.7491+2.6303e-06j, 441.5668-7.2004e-07j,   1.6706-9.3120e-07j,
          4.0280+5.9605e-08j,  70.6073+7.6294e-06j,  13.0064+2.5333e-07j,
        106.3959+8.8778e-07j, 154.0276-2.4129e-08j,  12.3449-3.1634e-07j,
         49.9364-1.9073e-06j,  99.1810+1.2610e-06j, 244.2974+3.7507e-07j,
         76.7042-9.8229e-07j, 186.4901+8.9377e-06j, 103.4885+1.6096e-07j,
         46.2731-1.5955e-07j, 134.1396-5.9853e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(107.1076889038086+8.651460348119144e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1024+2.8561e-08j, 0.9387+8.9407e-08j, 0.0940+2.0986e-08j,
        3.9615-6.6204e-08j, 0.4759-2.9802e-08j, 1.0583+2.6148e-08j,
        0.4840+8.7102e-08j, 2.2430-7.8750e-08j, 3.4521-1.4679e-08j,
        2.7499+5.9605e-08j, 0.0149+1.7195e-08j, 0.0658+1.1077e-07j,
        0.6937+8.9407e-08j, 2.8342+7.1030e-08j, 0.8445+3.9635e-08j,
        0.9704+8.9407e-08j, 3.7156-4.6712e-08j, 0.5097+3.1292e-07j,
        4.4498+2.9802e-07j, 0.2280-2.2352e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4943205118179321+5.408537262496793e-08j)
SINR torch.Size([20]) = tensor([ -7.3422,  -2.8749,  -3.8521,   1.6549,  -1.0885, -13.2426,  -7.9393,
         -0.6866,  -4.4790,  -1.4619,  -0.5549,  -8.7586,  -1.4454,   0.8253,
          0.0686,  -0.4031,  -1.4705,   0.8966,  -2.8933,  -1.2230],
       device='cuda:0')
SINR mean = -2.813520908355713
E[H^H] = 1e-07
E_MSE (Error Power) = 3.1440300941467285
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1557, 0.3403, 0.2917, 0.5941, 0.4377, 0.0453, 0.1385, 0.4606, 0.2628,
        0.4166, 0.4681, 0.1175, 0.4176, 0.5474, 0.5040, 0.4768, 0.4162, 0.5514,
        0.3393, 0.4301], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([606, 455, 489, 298, 392, 777, 625, 378, 511, 405, 374, 650, 405, 326,
        352, 368, 406, 324, 456, 397], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 0-----------
Real SNR = tensor([-1.6223e+00, -4.6617e+00,  1.1244e+00, -2.2727e+00, -4.4934e+00,
         2.3890e-01, -1.1840e+00, -2.3366e+00,  3.0695e-03, -1.2568e+00,
        -6.0981e-01, -4.2729e+00,  4.0537e+00, -3.9374e+00, -4.1988e-01,
        -2.3752e+00, -1.6660e+00, -7.6938e+00, -1.9883e+00, -3.1913e+00],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 30.7783+8.7824e-07j,  98.8862-6.0973e-07j, 131.1534-4.5464e-07j,
         45.5849-3.8147e-06j,  35.2478+1.1134e-07j,  70.7153+3.8147e-06j,
          5.5174-4.8429e-08j,   1.4862-5.4238e-07j,  43.3274+8.4152e-07j,
         52.8211-1.9073e-06j,  14.8052+1.2059e-06j,  31.2657+1.4159e-06j,
         22.9210+7.1526e-07j,   1.4186+1.4529e-07j,  25.3391+2.8610e-06j,
        106.6614+2.1108e-06j,  81.4542-1.5937e-06j,  11.7066+4.7684e-06j,
          5.0504-2.1916e-07j,   5.9521+1.1927e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(41.1046257019043+5.435496177597088e-07j)
torch.linalg.det(H.mH@H) = tensor([ 2.3140-4.2284e-08j,  0.6174+1.4901e-08j,  6.2092+1.3373e-07j,
         1.8328+1.0740e-08j,  0.4039-3.6887e-09j,  2.3409+9.9275e-08j,
         0.3723-0.0000e+00j,  1.8986-6.8160e-09j,  1.3358-2.9201e-08j,
         0.2384-3.9029e-08j,  1.9445+4.9473e-09j,  0.6901-5.9605e-08j,
        17.5164-8.8671e-08j,  0.0586+1.8626e-08j,  0.5367-3.8142e-08j,
         1.8092-7.6127e-08j,  0.2140-8.9669e-09j,  0.2695-2.9749e-09j,
         1.8282-2.0303e-09j,  1.3299-1.5543e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1880288124084473-6.542666852737966e-09j)
SINR torch.Size([20]) = tensor([  0.9017,  -1.3636,   0.3285,  -2.2383,  -1.7632,  -1.4449,  -5.1687,
        -12.1518,  -2.0672,  -1.0585,  -3.9963,  -2.9132,  -1.8049, -10.6302,
         -4.8421,   1.6636,  -1.3744,  -2.9864,  -4.0149,  -7.2095],
       device='cuda:0')
SINR mean = -3.2067246437072754
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0476887226104736
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5517, 0.4221, 0.5189, 0.3739, 0.3999, 0.4176, 0.2332, 0.0574, 0.3832,
        0.4394, 0.2849, 0.3383, 0.3976, 0.0796, 0.2470, 0.5946, 0.4215, 0.3346,
        0.2840, 0.1598], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([324, 402, 343, 433, 416, 405, 534, 748, 427, 391, 494, 456, 417, 705,
        523, 298, 402, 459, 495, 602], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 1-----------
Real SNR = tensor([-2.4287,  0.0053, -0.0748, -3.2615, -0.9045, -0.6799,  1.3546, -2.1530,
         1.3335, -0.3343, -1.3475,  2.3496, -2.9141, -2.9949, -3.2356, -0.5041,
        -4.8219, -3.9463, -3.0230,  0.0589], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([21.7771+9.5367e-07j,  3.1985+1.0398e-07j,  9.7867+2.7555e-08j,
         4.7597+7.4492e-09j, 10.7334-9.5367e-07j, 77.2615-7.6294e-06j,
        64.8481-9.5367e-06j,  1.6387+1.4901e-08j, 17.5392+1.0134e-06j,
         3.4259-7.7707e-08j,  9.4792-1.6689e-06j, 38.4495-1.1246e-06j,
         9.1895-3.3604e-07j, 15.2798+9.5367e-07j, 10.1920-2.7740e-06j,
        19.8548+2.8610e-06j,  0.5305-2.2352e-07j, 20.1148+2.5979e-08j,
         2.5096-5.9605e-08j,  0.6000-1.1346e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(17.05841827392578-9.217006891049095e-07j)
torch.linalg.det(H.mH@H) = tensor([0.7235-2.7507e-09j, 0.8231-2.9802e-08j, 0.9661-3.2579e-08j,
        0.2935+1.8626e-08j, 1.5601+1.8236e-08j, 0.4206+1.7266e-08j,
        3.2637-1.0339e-07j, 0.4698-7.8663e-10j, 4.0685-1.0440e-08j,
        2.2966-2.9672e-08j, 0.2067+1.3039e-08j, 5.8720+1.0126e-07j,
        0.7094-3.3060e-10j, 0.0163+1.1176e-08j, 1.0293-1.9249e-08j,
        3.6346-2.3842e-07j, 0.0179-1.1176e-08j, 1.0998+8.3116e-09j,
        0.9553+7.5711e-09j, 0.1981-8.4696e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4312411546707153-1.457937770510398e-08j)
SINR torch.Size([20]) = tensor([ -1.9783,  -7.3199,  -3.3571,  -4.3215,  -2.1041,  -2.2828,  -0.7697,
         -6.9297,  -5.1743,  -4.1840,  -4.5116,  -3.2211,  -2.1500,  -4.4519,
         -3.7140,  -2.0899,  -8.4646,   0.5732,  -3.9849, -10.2161],
       device='cuda:0')
SINR mean = -4.032618999481201
E[H^H] = 1e-07
E_MSE (Error Power) = 3.114179849624634
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3880, 0.1564, 0.3158, 0.2699, 0.3812, 0.3715, 0.4558, 0.1686, 0.2330,
        0.2762, 0.2614, 0.3226, 0.3787, 0.2640, 0.2983, 0.3820, 0.1247, 0.5329,
        0.2855, 0.0869], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([424, 605, 472, 505, 428, 434, 381, 593, 534, 501, 512, 467, 430, 510,
        484, 427, 641, 335, 494, 693], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 2-----------
Real SNR = tensor([ 3.3516, -0.9511,  4.7416,  1.4884, -0.0480, -0.1003,  1.3950,  2.0391,
        -1.0604,  3.0725, -1.3242,  1.2518,  1.6672, -0.2268,  5.4854, -4.1836,
         3.2151, -2.5719, -0.3165, -0.4211], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 34.9010-5.3534e-07j,   1.8266-1.1921e-07j,  58.8963-1.4842e-06j,
         11.9713-5.5145e-07j,   0.7178-2.2573e-07j,   6.0950-3.5612e-09j,
          9.8839-2.5908e-07j,  15.2180-2.2874e-07j,  48.1937+9.7160e-07j,
          1.1190+1.2666e-06j,   6.5749-0.0000e+00j,  16.7676-2.3606e-07j,
         13.1902-5.4729e-08j,  13.0494+9.9591e-09j, 103.9861+1.3622e-06j,
          7.0532+1.6187e-07j,  26.8005-1.0437e-07j,   4.4290+2.5948e-08j,
          2.9843+1.2519e-07j,  26.7062+2.3592e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(20.5181941986084+7.2251395977218635e-09j)
torch.linalg.det(H.mH@H) = tensor([5.5346-1.0777e-07j, 0.1981-0.0000e+00j, 3.5384+2.3928e-08j,
        4.6591-8.5922e-08j, 3.5267+9.3894e-08j, 1.1192+7.2818e-08j,
        0.1193+8.1956e-08j, 1.3647+1.0721e-08j, 0.2344+2.2352e-08j,
        0.9564+2.9802e-08j, 0.8296+9.5310e-09j, 3.8218+2.5294e-08j,
        1.5406-4.9579e-08j, 1.1002+1.0620e-09j, 7.2256-5.2847e-08j,
        0.2122+1.3551e-10j, 5.0103+1.0332e-07j, 0.1146+3.7253e-09j,
        1.2630+1.1921e-07j, 0.4043+3.6530e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.138653039932251+1.6908137112636723e-08j)
SINR torch.Size([20]) = tensor([  0.5987,  -4.9500,   2.7601,  -3.3488, -14.4458,  -1.8391,  -5.2700,
         -6.2793,   1.0911, -13.1836,  -4.0558,  -3.5773,   0.6810,  -2.9664,
         -0.9415,  -1.1392,  -1.2494,  -4.6047,  -6.8337,  -1.6209],
       device='cuda:0')
SINR mean = -3.5587189197540283
E[H^H] = 1e-07
E_MSE (Error Power) = 4.1929473876953125
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5344, 0.2424, 0.6537, 0.3162, 0.0347, 0.3957, 0.2291, 0.1906, 0.5625,
        0.0458, 0.2821, 0.3050, 0.5391, 0.3356, 0.4460, 0.4348, 0.4286, 0.2573,
        0.1717, 0.4078], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([334, 527, 263, 472, 807, 419, 538, 571, 317, 775, 496, 480, 331, 458,
        387, 394, 398, 515, 589, 411], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 3-----------
Real SNR = tensor([ 1.3929,  1.3079,  2.2935, -0.7098, -0.4045,  2.0676,  1.7052,  4.0587,
        -0.2789, -3.3707,  3.6968,  4.4018,  0.2994,  1.6733,  2.9600,  3.0303,
         2.2503,  1.4590,  3.9415,  1.7104], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.3988-1.8984e-08j,  7.7315+4.2174e-07j,  7.6374-9.5367e-07j,
        22.5139+5.9310e-07j,  3.7686+8.3447e-07j, 13.8136-1.9844e-07j,
         0.8023-0.0000e+00j, 13.9843-2.6016e-07j,  6.1315-0.0000e+00j,
         1.6882+5.9605e-08j,  7.9211-0.0000e+00j, 39.1449-1.6052e-06j,
        50.4969+9.6182e-07j, 13.9615-1.9073e-06j,  0.4945-3.1292e-07j,
        24.1390-1.8074e-07j, 28.3667-2.9077e-07j,  6.5526-3.5491e-07j,
        46.8439+3.8147e-06j,  5.3599-5.0845e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(15.187545776367188+2.985913383213301e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.0721+1.6115e-09j,  0.1142+7.3099e-09j,  2.2271+1.1444e-07j,
         0.1090+1.9148e-08j,  2.6050+2.3842e-07j,  3.1616-3.6720e-08j,
         1.4471-2.2870e-07j,  6.8225+5.0242e-08j,  0.3133-2.9802e-08j,
         0.0785-4.8120e-09j,  2.3229+2.5891e-09j, 10.3920+3.4169e-08j,
         1.0094+2.8236e-08j,  2.9418-0.0000e+00j,  0.3190+1.9393e-08j,
         1.6635-5.9605e-08j,  0.5076-2.5991e-08j,  1.4226+1.1656e-08j,
         6.1512+3.6365e-08j,  0.9655-4.5652e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.23229718208313+8.668934015076957e-09j)
SINR torch.Size([20]) = tensor([ -6.4997,  -2.8158,  -3.3914,   0.1667,  -6.3518,  -1.0960, -11.6545,
         -3.3663,  -4.3431,  -4.3622,  -7.1627,   2.8734,   1.2516,  -1.9185,
        -12.1947,  -1.4406,  -0.9823,  -1.2019,   3.1243,  -1.7380],
       device='cuda:0')
SINR mean = -3.1551706790924072
E[H^H] = 1e-07
E_MSE (Error Power) = 3.755253553390503
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1829, 0.3434, 0.3141, 0.5096, 0.1881, 0.4372, 0.0640, 0.3154, 0.2689,
        0.2681, 0.1612, 0.6596, 0.5716, 0.3913, 0.0569, 0.4178, 0.4437, 0.4312,
        0.6725, 0.4013], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([579, 453, 473, 349, 574, 393, 734, 472, 506, 507, 600, 259, 312, 421,
        749, 405, 389, 396, 251, 415], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 4-----------
Real SNR = tensor([ 5.8461,  5.4262,  3.5191,  5.2080,  4.8427,  1.9951,  1.3778,  3.2739,
         3.9347,  2.0905,  4.5758,  0.5559, -2.6448,  2.5943,  4.9281,  3.8198,
        -1.9543,  3.4001, -0.3562,  2.8588], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 9.4531-2.2096e-07j,  2.1614+1.4901e-07j, 11.5817-1.7780e-08j,
         0.4312-6.3137e-08j,  3.2253-0.0000e+00j, 28.6992+3.4021e-07j,
         3.2304-3.0843e-08j,  8.4781+5.7824e-07j,  0.1195-9.6858e-08j,
        10.8009-1.2337e-07j, 23.5030-1.5309e-07j, 27.4122+9.4825e-08j,
         2.0140+1.2160e-07j, 10.1704-4.9039e-07j, 20.9653-2.9021e-07j,
         0.5551-2.2302e-08j,  2.8366-2.3440e-08j,  6.1958-6.2591e-07j,
         0.8033+6.7055e-08j, 13.4535+5.1817e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(9.304503440856934-3.7776377581622e-08j)
torch.linalg.det(H.mH@H) = tensor([1.4263+5.3213e-09j, 4.8905-3.0147e-07j, 0.5502+3.8270e-08j,
        2.2780+5.0906e-11j, 9.5226-9.2107e-08j, 1.2592+8.7259e-08j,
        0.5617+8.7914e-09j, 3.2585+5.4022e-08j, 1.3836+1.9521e-08j,
        0.8747+1.1921e-07j, 3.1698+2.4486e-08j, 0.8550+5.9605e-08j,
        0.0141-1.1667e-13j, 1.0698+4.9672e-08j, 0.3877-1.2293e-07j,
        0.5210+5.7693e-09j, 0.1325-0.0000e+00j, 2.0848+9.3110e-08j,
        0.3434-5.7626e-09j, 1.0834+2.2352e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7833318710327148+3.258136205275264e-09j)
SINR torch.Size([20]) = tensor([  1.9692,  -6.0390,  -0.9759,  -9.9543,  -9.1196,   1.5574,  -3.7142,
         -4.7798, -17.6466,  -1.1730,   1.2855,   1.9355,  -5.1740,   0.2280,
          1.1081,  -7.9776,  -3.4169,  -2.8681,  -7.5804,  -1.7143],
       device='cuda:0')
SINR mean = -3.7025039196014404
E[H^H] = 1e-07
E_MSE (Error Power) = 6.612005710601807
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6115, 0.1993, 0.4441, 0.0918, 0.1091, 0.5887, 0.2983, 0.2496, 0.0169,
        0.4329, 0.5735, 0.6096, 0.2330, 0.5131, 0.5634, 0.1374, 0.3129, 0.3406,
        0.1486, 0.4026], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([288, 563, 388, 686, 661, 302, 484, 521, 883, 395, 311, 289, 534, 347,
        317, 626, 474, 455, 613, 414], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 5-----------
Real SNR = tensor([ 1.1324,  4.2851,  4.0545,  5.2666,  6.0318,  5.4777, -0.2438, -0.5990,
         4.1053,  8.1847,  0.0169,  2.6290,  6.6771,  5.8270,  4.2862,  4.8071,
         1.1109,  5.3712,  0.3165,  2.8815], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.8327-5.1112e-08j, 12.7739+2.8981e-07j,  0.1666-1.1455e-07j,
         1.6486-6.5218e-08j,  1.0405+2.1620e-08j, 16.9242-8.0005e-08j,
         1.4416+2.9192e-08j,  3.8524-1.4114e-07j,  0.1309+6.5760e-09j,
        15.2065+1.8253e-07j, 17.7722+1.2606e-07j,  0.6293-8.1092e-07j,
         9.0119+7.9996e-07j, 11.0191+1.5854e-07j, 18.8514+2.0551e-07j,
         6.2202-2.4282e-08j,  4.5194+4.7703e-08j,  2.5306-0.0000e+00j,
         1.1353-2.5424e-07j,  2.5374+1.2856e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.562228679656982+2.2729784276975806e-08j)
torch.linalg.det(H.mH@H) = tensor([5.1273e-01-0.0000e+00j, 1.7838e+00-3.1718e-08j, 1.0968e-03-8.5129e-10j,
        6.6336e-01+8.9775e-08j, 1.9680e+00+6.7549e-10j, 2.7437e+00+2.9267e-08j,
        7.3490e-03-9.3132e-10j, 7.9913e-02-1.8747e-09j, 2.0860e+00-2.6279e-08j,
        1.0558e+01-7.8633e-09j, 2.3937e-01+7.1151e-09j, 3.0208e+00-8.9407e-08j,
        3.5555e+00+5.0444e-08j, 1.3204e+00-1.1921e-07j, 3.4044e+00+3.5751e-08j,
        3.9244e+00-2.6472e-07j, 1.2300e-01+1.0803e-07j, 2.2196e+00-0.0000e+00j,
        1.8519e-01+2.2244e-09j, 2.4945e-01+1.5187e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.93231999874115-1.021902829023702e-08j)
SINR torch.Size([20]) = tensor([ -1.5540,  -0.2890, -16.0789,  -5.7911,  -3.3460,   1.8403,  -1.5269,
         -1.2027, -15.9076,   3.0604,   0.5453, -11.5713,  -1.2129,  -0.2782,
         -0.7281,   0.5335,  -0.8060,  -2.1074,  -4.6615,  -0.8818],
       device='cuda:0')
SINR mean = -3.0982022285461426
E[H^H] = 1e-07
E_MSE (Error Power) = 5.844001770019531
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4115, 0.4834, 0.0241, 0.2086, 0.3164, 0.6044, 0.4130, 0.4312, 0.0250,
        0.6692, 0.5313, 0.0651, 0.4306, 0.4840, 0.4582, 0.5307, 0.4537, 0.3810,
        0.2548, 0.4494], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([409, 364, 847, 555, 472, 292, 408, 396, 843, 253, 336, 732, 397, 364,
        380, 336, 382, 428, 517, 385], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 6-----------
Real SNR = tensor([6.3936, 4.2572, 5.8127, 5.0518, 3.3891, 5.2965, 4.9804, 4.5025, 3.8049,
        5.3812, 7.1467, 1.8088, 6.0906, 1.8580, 5.0414, 2.3635, 2.3736, 0.7378,
        1.0204, 3.8352], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.2116e-01+2.9802e-08j, 4.5465e+00-4.1803e-07j, 6.7328e+00+9.4993e-08j,
        2.2941e+00+1.1087e-07j, 4.1014e+00+5.9605e-07j, 5.0146e+00+2.5885e-07j,
        1.0804e+01+1.7009e-07j, 1.8533e+01+7.9254e-08j, 9.6155e+00-3.6058e-08j,
        5.3204e+01+8.1148e-07j, 1.0559e+00-8.9407e-08j, 1.0089e+00-4.7931e-08j,
        2.0589e+00-6.4495e-09j, 1.1028e+01-4.6423e-08j, 2.0030e-02-6.4913e-07j,
        1.8895e+00+3.3272e-08j, 1.4551e+00-1.5868e-08j, 2.7730e+00-5.2665e-08j,
        1.3002e-01+5.4948e-08j, 1.0098e+00-5.5879e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.889752388000488+4.1088377145115373e-08j)
torch.linalg.det(H.mH@H) = tensor([1.6386e+00-1.7881e-07j, 1.8312e-01-2.2656e-09j, 4.9001e+00+1.1063e-07j,
        4.1137e-01-6.3366e-08j, 3.4074e-03-2.8594e-08j, 4.1735e-01+4.4751e-08j,
        1.1909e+00-0.0000e+00j, 2.3949e-01+5.0836e-08j, 4.3775e-01+1.4381e-08j,
        2.6837e-01-2.9802e-08j, 5.9208e+00+1.1243e-08j, 9.2118e-01-5.9710e-08j,
        2.1273e+00+4.5970e-08j, 1.4841e-01+1.0033e-08j, 3.2185e+00-1.8263e-08j,
        1.0954e+00+4.7087e-09j, 1.0833e-01-1.6871e-08j, 1.2630e-01-1.7136e-07j,
        5.2054e-01+7.0708e-09j, 1.2164e+00-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.254679560661316-1.3471082915827992e-08j)
SINR torch.Size([20]) = tensor([ -5.9275,  -0.1996,   0.2578,  -4.7205,  -1.0510,  -2.4561,   2.7850,
         -0.8045,   1.7786,   0.9630,  -7.5879,  -1.7927,   2.7167,   2.8454,
        -29.5497,  -0.2690,  -2.4475,  -1.1785, -13.6345,  -5.1973],
       device='cuda:0')
SINR mean = -3.273487091064453
E[H^H] = 1e-07
E_MSE (Error Power) = 44.40655517578125
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2035, 0.4885, 0.5148, 0.2522, 0.4398, 0.3623, 0.6550, 0.4538, 0.6010,
        0.5552, 0.1484, 0.3982, 0.6515, 0.6582, 0.0011, 0.4845, 0.3627, 0.4326,
        0.0415, 0.2321], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 560,  361,  346,  519,  391,  440,  262,  382,  294,  321,  614,  417,
         264,  260, 1000,  364,  440,  395,  787,  535], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 7-----------
Real SNR = tensor([4.6455, 8.0169, 5.4646, 7.2774, 5.2208, 6.7896, 7.6115, 9.3326, 2.3978,
        3.1741, 4.3629, 2.2995, 1.3709, 9.0667, 6.0195, 4.1910, 7.6363, 6.2175,
        9.1019, 6.9378], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.5669+1.4901e-08j,  1.9577+2.2630e-08j,  2.5214+2.2352e-08j,
         1.2489+4.0178e-08j,  0.5997+7.4506e-09j, 16.2086+3.3496e-08j,
        49.9463+1.2608e-06j,  3.1313+4.7684e-07j,  3.3852+2.4179e-08j,
         3.0326+4.5521e-08j,  1.0791+2.8932e-09j,  7.1793+7.4038e-08j,
         1.2120-0.0000e+00j,  3.3105-2.8789e-08j,  0.1807-3.7253e-08j,
         8.3376+3.1536e-08j,  8.5805-4.5912e-08j,  2.7177+2.3334e-08j,
         0.2511+1.6100e-07j, 24.1099-5.7876e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.077842712402344+7.752238673219836e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0697+3.2596e-09j, 1.6901-2.1152e-08j, 1.6132-1.7506e-08j,
        1.1635-2.1407e-08j, 1.9035+1.1480e-08j, 0.2118+8.6440e-09j,
        5.3717+1.2574e-07j, 3.9567+1.1921e-07j, 0.2772-1.8626e-09j,
        0.7682-7.8030e-10j, 0.3377-1.4901e-08j, 0.5500-5.1423e-09j,
        0.1191+8.6122e-10j, 0.8100+1.6346e-07j, 1.2714+6.4640e-09j,
        1.5623-5.5129e-09j, 5.7992+4.9837e-08j, 0.8762-2.4137e-08j,
        1.3734+1.3622e-08j, 3.1569-2.3842e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.64409601688385+7.58771001585501e-09j)
SINR torch.Size([20]) = tensor([-2.3806, -3.0157, -5.6960, -6.0310, -5.8689,  0.7302,  3.5232, -4.6365,
        -2.8003,  3.0243, -3.3923,  2.9392, -3.2181,  0.7068, -9.8330,  0.0809,
         2.9713,  1.4960, -9.0162,  4.5645], device='cuda:0')
SINR mean = -1.7926067113876343
E[H^H] = 1e-07
E_MSE (Error Power) = 2.3326852321624756
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3663, 0.3331, 0.2122, 0.1996, 0.2056, 0.5419, 0.6924, 0.2559, 0.3442,
        0.6674, 0.3141, 0.6630, 0.3228, 0.5406, 0.0941, 0.5047, 0.6647, 0.5853,
        0.1114, 0.7410], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([438, 460, 552, 563, 558, 329, 239, 516, 452, 254, 473, 257, 467, 330,
        682, 352, 256, 304, 658, 209], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 8-----------
Real SNR = tensor([ 9.8075,  5.5825,  6.6182,  8.5350,  5.1227, 11.6055,  6.6019,  6.8943,
        10.6025,  7.3618,  7.4815,  8.1008,  4.9000,  3.3830,  5.0221,  6.5702,
         8.5271,  3.0667,  6.5539,  8.4548], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 9.7660+6.3597e-07j,  1.2690+4.4703e-08j,  0.2845+2.0313e-08j,
         2.2832+3.2783e-07j,  2.5876-3.0325e-08j, 15.8943+1.7761e-07j,
         0.2123+8.1956e-08j,  6.9201+6.6740e-09j, 10.1345+2.5830e-07j,
         2.0262-1.1921e-07j, 18.8848+1.0765e-07j,  0.1384+3.1404e-08j,
         6.5555-3.3593e-08j,  3.6323+3.9550e-08j,  5.6226+3.4152e-08j,
         1.4743+2.1307e-08j, 13.6026-9.4385e-09j,  3.2840-8.1547e-08j,
         2.2213-1.4035e-07j,  7.3834-1.1553e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.708833694458008+6.287063314402985e-08j)
torch.linalg.det(H.mH@H) = tensor([0.7893-4.4703e-07j, 0.3267-3.1675e-08j, 0.1261+4.7608e-09j,
        5.3214+1.1921e-07j, 1.7864-2.0681e-08j, 7.9214-2.9251e-07j,
        0.4331-3.0696e-08j, 2.6691-1.0346e-09j, 7.1695+5.4336e-08j,
        1.4241+2.9802e-08j, 1.8699-4.4882e-08j, 0.9511-1.7657e-08j,
        0.4439+7.6130e-08j, 0.2910-1.7427e-09j, 0.0746+4.2535e-08j,
        0.3584-5.6384e-09j, 3.2209-2.3842e-07j, 0.9267-4.9111e-08j,
        0.6358+3.6329e-08j, 5.1371-1.5912e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0938363075256348-4.885466253767845e-08j)
SINR torch.Size([20]) = tensor([  1.8746,  -1.4968,  -4.4059,  -7.0028,  -3.9600,  -0.5676,  -7.0482,
          4.8848,   4.6647,  -1.3486,   3.7877, -13.4421,   1.4078,   1.7377,
          2.6655,  -0.1984,   2.9940,   3.4117,   2.0616,   0.9118],
       device='cuda:0')
SINR mean = -0.45340996980667114
E[H^H] = 1e-07
E_MSE (Error Power) = 2.9300713539123535
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6063, 0.4147, 0.2661, 0.1662, 0.2866, 0.4674, 0.1648, 0.7549, 0.7454,
        0.4230, 0.7052, 0.0433, 0.5803, 0.5987, 0.6488, 0.4886, 0.6658, 0.6869,
        0.6165, 0.5523], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([291, 407, 508, 595, 493, 374, 596, 200, 206, 401, 231, 782, 307, 296,
        266, 361, 255, 242, 285, 323], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 9-----------
Real SNR = tensor([ 7.6007,  4.1093,  6.6993,  8.9556,  4.8182,  3.3865,  5.7123, 12.0950,
        11.7916,  5.4086, 11.8230,  7.0392,  8.8506, 10.9436,  7.3592,  5.5601,
         4.3212,  4.6865, 10.9099,  4.5674], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.4724e-01-1.8358e-09j, 1.7711e-01+1.8626e-08j, 1.9767e+00+2.0862e-07j,
        3.4268e+00+7.0749e-08j, 4.4961e+00+1.1921e-07j, 2.4613e-01-8.1414e-09j,
        9.0990e-03+8.5177e-09j, 4.9978e+00-7.8732e-09j, 1.4220e+01-2.4445e-07j,
        3.3284e-01+5.2124e-08j, 1.0882e+00+1.3411e-07j, 1.2166e+00+2.9802e-08j,
        1.6370e+00+4.1723e-07j, 1.4679e+01+4.5170e-07j, 3.4437e+00+7.3428e-08j,
        2.2305e+00-1.1921e-07j, 1.4245e-02+4.2679e-08j, 5.6851e+00-1.5053e-07j,
        2.9667e+00+1.0956e-07j, 1.6546e-01-2.3156e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.1728105545043945+5.905787503479587e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.7803-4.0042e-08j,  0.3190-7.0416e-09j,  0.1368+1.0704e-08j,
         0.8923+4.1968e-08j,  3.6848-7.4251e-09j,  0.0531+1.8626e-09j,
         0.1730+6.1127e-09j, 12.2775+1.5176e-07j, 12.7531+1.7818e-07j,
         0.3315-7.7964e-08j,  8.0964+4.3894e-07j,  2.1734-1.9930e-08j,
         0.4847-1.3411e-07j,  4.4206-1.1921e-07j,  1.2190-3.6506e-08j,
         1.5416-5.2854e-09j,  0.6514-6.7701e-09j,  1.4857-6.8267e-08j,
         2.6192-1.0160e-07j,  0.2791+4.2107e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7686352729797363+1.0479605627722322e-08j)
SINR torch.Size([20]) = tensor([ -4.7022,  -9.1512,  -2.7398,   1.2923,   2.2157,  -6.7811, -19.2708,
          0.0549,   4.0326,  -4.8046,  -7.0591,  -0.9876,  -3.8411,   3.9778,
         -2.9416,   1.7658, -21.3929,   4.2734,   1.1080,  -8.9592],
       device='cuda:0')
SINR mean = -3.6955392360687256
E[H^H] = 1e-07
E_MSE (Error Power) = 13.094520568847656
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2530, 0.1084, 0.3473, 0.5738, 0.6249, 0.1734, 0.0117, 0.5032, 0.7168,
        0.2486, 0.1645, 0.4434, 0.2923, 0.7142, 0.3369, 0.6003, 0.0072, 0.7279,
        0.5634, 0.1128], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([518, 662, 450, 310, 280, 588, 919, 352, 224, 522, 597, 389, 489, 226,
        457, 295, 962, 217, 317, 656], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 10-----------
Real SNR = tensor([ 8.5445,  6.8516, 12.3598, 11.9253,  3.4038,  9.9099,  6.1481,  8.7835,
        12.9863,  6.1367,  5.5966,  3.7177, 10.0083,  8.7458,  7.5054,  9.7578,
         8.8845,  4.9585,  8.8586,  6.0112], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.7970+4.8182e-08j,  3.4948+3.5686e-08j,  1.7840-1.1962e-07j,
        20.0223+3.2326e-07j,  3.5990-1.0654e-07j,  0.9137-5.4357e-09j,
         0.5884+9.3132e-09j,  0.1846-1.4901e-08j, 11.9716-1.6287e-08j,
         1.6873+1.1921e-07j,  0.0865-9.6434e-10j,  0.5525+8.9407e-08j,
         8.3501-7.6515e-08j,  0.0505-1.0749e-08j,  0.4625-1.3411e-07j,
         7.2842+2.3842e-07j,  5.9022+4.5386e-08j,  5.1442+1.4901e-08j,
         4.9733-3.0484e-08j,  2.8735+4.3510e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.336103916168213+2.062503590138931e-08j)
torch.linalg.det(H.mH@H) = tensor([ 2.2370-1.0795e-08j,  1.6378-1.1406e-09j,  0.6140-1.1807e-07j,
         8.7622-1.5119e-07j,  0.0343+4.7899e-09j,  0.3115-2.2862e-07j,
         0.9638+9.4688e-09j,  0.0301-9.3132e-10j, 12.8794+5.6102e-08j,
         0.3208-3.4978e-09j,  0.4842+6.8394e-09j,  0.1611+7.4506e-09j,
         4.2287+5.1113e-08j,  1.4923+3.6509e-08j,  0.4506-7.4506e-08j,
         2.0545-2.9633e-08j,  0.4308-3.2329e-08j,  0.4615+2.9802e-08j,
         0.7690+6.5990e-08j,  0.3831+7.4213e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9353350400924683-1.876113131515922e-08j)
SINR torch.Size([20]) = tensor([  4.7850,   4.4010,   0.2506,   7.6942,   2.9429,  -2.8699,  -3.2861,
         -4.1685,   4.1013,   0.6919,  -6.6271,  -0.9440,   6.6946, -12.7053,
         -3.7177,   5.9706,   2.9583,   1.5927,   4.8990,   2.0150],
       device='cuda:0')
SINR mean = 0.7339356541633606
E[H^H] = 1e-07
E_MSE (Error Power) = 1.9466866254806519
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7506, 0.7337, 0.5144, 0.8547, 0.6632, 0.3406, 0.3194, 0.2769, 0.7200,
        0.5397, 0.1786, 0.4459, 0.8237, 0.0509, 0.2982, 0.7982, 0.6640, 0.5907,
        0.7555, 0.6140], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([202, 213, 346, 131, 257, 455, 469, 500, 222, 331, 583, 387, 153, 763,
        484, 171, 256, 300, 199, 287], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 11-----------
Real SNR = tensor([ 8.2864, 13.6453,  9.3670,  9.5650,  5.4742,  9.2995, 11.3519, 13.8303,
        12.1348, 12.2066,  9.8734,  5.2599, 15.2277, 12.6158,  6.9144,  7.2683,
        10.9856,  7.1994, 14.5466, 10.4655], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.5436e-01+2.8207e-08j, 3.0055e+00+6.1166e-08j, 6.8088e-01+2.7351e-08j,
        3.9901e-02+9.3132e-09j, 5.4662e-01+1.7695e-08j, 1.7763e+00+1.9640e-08j,
        3.4961e-01+8.8185e-09j, 1.7234e+01-9.9259e-08j, 2.2562e+00-5.8224e-09j,
        2.7511e+00-2.9802e-08j, 2.8561e-01+3.7895e-08j, 1.7105e+00+1.4604e-08j,
        6.0387e+01-3.8147e-06j, 1.5834e+00+1.7881e-07j, 3.4781e-01+8.9407e-08j,
        4.3656e+00-1.3151e-08j, 2.2376e+00+1.3442e-09j, 4.2329e+00-8.3447e-07j,
        9.3211e+00-7.9330e-08j, 2.4086e+00+1.2067e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.813694000244141-2.18510294303087e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.6545+3.8717e-09j,  3.4069-1.4392e-07j,  1.7956-4.2976e-08j,
         0.4256+4.4703e-08j,  0.9012+1.0299e-08j,  0.9462+1.1658e-08j,
         0.3860+1.4583e-08j,  7.8714-2.1556e-08j,  3.9545-1.6726e-08j,
         0.7372+4.4703e-08j,  0.8051+3.6421e-08j,  0.6196-1.7728e-08j,
        33.6643-5.8885e-08j,  3.5074+8.7272e-08j,  0.0546+2.2352e-08j,
         1.7538+1.9310e-08j,  5.6314+1.7194e-07j,  4.8938-3.5938e-08j,
         2.3891+2.9896e-08j,  0.6361-1.2921e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.751720905303955+7.318068817596668e-09j)
SINR torch.Size([20]) = tensor([ 0.9019,  4.1140, -4.0809, -9.7376, -1.1680,  2.9030, -3.8558,  9.4016,
         4.4170,  2.9728, -3.0472,  2.1650, 11.3727,  0.3857, -2.3940,  7.5869,
         3.0762,  6.4747,  7.4621,  6.2854], device='cuda:0')
SINR mean = 2.261767864227295
E[H^H] = 1e-07
E_MSE (Error Power) = 1.3018653392791748
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5517, 0.7206, 0.2810, 0.0960, 0.4332, 0.6612, 0.2916, 0.8970, 0.7344,
        0.6647, 0.3314, 0.6221, 0.9321, 0.5222, 0.3656, 0.8516, 0.6700, 0.8162,
        0.8479, 0.8096], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([324, 222, 497, 679, 395, 258, 489,  98, 213, 256, 461, 282,  68, 341,
        438, 133, 253, 159, 136, 163], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 12-----------
Real SNR = tensor([11.2660,  7.7732, 11.6316, 10.6107, 12.1987, 11.1592, 11.1221,  5.6582,
        14.5346, 14.4584, 11.2056, 13.7423, 12.8941, 12.5214, 14.9269,  7.9475,
        10.3296, 14.5139, 10.3604, 10.6948], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.5120+8.0588e-08j,  0.7260-4.5153e-09j,  2.1708-4.3184e-08j,
         2.5067+8.4953e-09j,  6.1849-2.5807e-08j,  2.4279-2.3842e-07j,
         3.5262-5.8406e-08j,  1.2560-1.2297e-10j,  6.2546+5.9605e-08j,
         8.9368+2.3842e-07j,  5.5652-1.9358e-07j,  5.7170+9.0233e-09j,
         2.9282+1.2197e-07j,  0.3659-1.6391e-07j, 12.9615+3.5028e-08j,
         0.0385+2.4214e-08j,  3.6857-3.3614e-08j,  9.7480+7.8530e-08j,
         1.8413-0.0000e+00j,  0.1109-1.2480e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.9231998920440674-1.1524676324370375e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.9747-2.6136e-08j,  0.0948-5.8797e-10j,  1.9255+6.2085e-08j,
         0.6390-1.7521e-08j,  5.9321-1.6829e-07j,  0.7729+4.4703e-08j,
         0.0563+1.3918e-08j,  0.5664-2.9142e-09j,  5.3118-1.1921e-07j,
         5.0666-0.0000e+00j,  1.3003-3.0746e-08j, 11.4227+1.2001e-07j,
         0.1194+1.4542e-08j,  3.3905+8.0375e-08j,  4.0298+7.2448e-08j,
         0.1348+7.4506e-09j,  1.4215-5.9605e-08j,  5.9887+6.1914e-08j,
         0.2642-8.9407e-08j,  1.7690-2.4655e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.5590617656707764-1.97169081062043e-09j)
SINR torch.Size([20]) = tensor([  4.1582,  -1.2531,   1.8129,   3.7573,   7.1084,   4.4709,   3.7338,
          3.4990,   6.1173,   7.8187,   4.6572,   6.6891,   3.5734,  -9.6294,
          1.7182, -10.5001,   2.5218,   8.3225,   3.1351, -11.7474],
       device='cuda:0')
SINR mean = 1.9981895685195923
E[H^H] = 1e-07
E_MSE (Error Power) = 2.247779607772827
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7226, 0.4284, 0.6029, 0.7037, 0.8371, 0.7368, 0.7026, 0.6912, 0.8035,
        0.8582, 0.7450, 0.8235, 0.6948, 0.0982, 0.5976, 0.0818, 0.6412, 0.8717,
        0.6730, 0.0627], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([220, 398, 293, 232, 144, 211, 233, 240, 167, 128, 206, 154, 238, 676,
        296, 702, 270, 118, 251, 737], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 13-----------
Real SNR = tensor([ 6.8755, 10.1146, 14.2243, 10.0318, 10.9148,  5.8356, 11.4232, 12.7545,
        10.2588, 14.0950, 11.5647, 11.7927, 14.6466, 12.8792, 12.1614, 14.0802,
         9.2538,  3.6956,  8.0580, 12.3094], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.0958e-02-3.5390e-08j, 5.4911e-01+2.9802e-08j, 6.5731e-01+2.3348e-09j,
        1.6515e+00+1.4901e-08j, 5.7936e+00-2.3842e-07j, 1.3597e-01+2.4214e-08j,
        2.8648e+00-2.5031e-08j, 4.8663e+00+1.2392e-07j, 1.0301e-01-9.3132e-10j,
        2.3848e+00+1.8979e-08j, 2.3237e+00-1.5659e-08j, 1.3483e+00+1.7881e-07j,
        2.2628e+00-5.6631e-08j, 3.9783e+00-5.5230e-08j, 3.5411e+00-1.4877e-07j,
        9.5108e-01-2.3828e-08j, 6.1596e-01+5.9605e-08j, 2.6034e-03+6.1546e-10j,
        4.6265e-01-1.3792e-08j, 3.3095e+00-3.1933e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8931658267974854-9.621159868800078e-09j)
torch.linalg.det(H.mH@H) = tensor([0.2587+1.2654e-08j, 0.7750+2.9802e-08j, 2.7579-2.4987e-08j,
        1.1780-1.4901e-08j, 2.5935+2.3842e-07j, 0.1294-1.5956e-09j,
        1.8994+1.0742e-08j, 2.0117-7.3652e-09j, 0.1732+3.3528e-08j,
        0.0289+1.4798e-09j, 1.3863+4.8063e-09j, 2.4510+3.3943e-09j,
        2.4387+4.2491e-08j, 3.6763-4.7704e-08j, 0.9144-5.9605e-08j,
        2.0563-1.8080e-09j, 0.4165-5.2299e-08j, 0.0090-0.0000e+00j,
        0.3213+7.4506e-09j, 2.7696+1.0124e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.412249207496643+1.3787053276814731e-08j)
SINR torch.Size([20]) = tensor([ -8.9894,  -2.0946,   1.0858,   2.9690,   1.3943,  -0.3187,   7.2582,
          5.7304,  -3.8871,   0.0338,   6.0656,  -1.2009,   5.4370,   6.8399,
          3.7851,   0.9979,   2.4239, -13.7196,  -0.6004,   4.6576],
       device='cuda:0')
SINR mean = 0.8933901190757751
E[H^H] = 1e-07
E_MSE (Error Power) = 2.7127017974853516
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1121, 0.3817, 0.5622, 0.6645, 0.5796, 0.4817, 0.8417, 0.7891, 0.2901,
        0.5019, 0.8017, 0.4313, 0.7776, 0.8285, 0.7051, 0.5572, 0.6360, 0.0407,
        0.4655, 0.7451], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([657, 428, 317, 256, 307, 365, 141, 177, 490, 353, 169, 396, 185, 150,
        231, 320, 273, 789, 375, 206], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 14-----------
Real SNR = tensor([14.0950, 15.8112, 11.3412, 14.1919,  7.9104, 16.4421, 11.6973,  6.8548,
        12.5851, 13.4151,  8.1075, 16.6576, 15.7307, 13.2991, 14.9180, 11.3792,
        13.9345, 17.2455, 14.5955, 12.5379], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.8043-2.0724e-07j, 2.1588-1.0431e-07j, 0.6490-5.9605e-08j,
        5.2784+1.7245e-07j, 0.0177+9.3132e-10j, 8.1427+2.7137e-07j,
        0.0460+9.3132e-08j, 0.7868-1.6688e-09j, 0.8633-1.7881e-07j,
        8.3546-2.6965e-07j, 0.1747-1.1058e-09j, 5.8026-2.2536e-07j,
        2.6842-4.7479e-08j, 0.0409-4.8278e-08j, 5.9065+7.2010e-08j,
        2.6036+6.1334e-08j, 0.4471+1.3334e-08j, 1.6094-1.3201e-08j,
        4.0376+1.1227e-07j, 2.1793-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.9293839931488037-2.097462470374012e-08j)
torch.linalg.det(H.mH@H) = tensor([5.1874+4.4012e-07j, 2.9435+2.3842e-07j, 0.3186-1.4901e-08j,
        3.2398+5.8245e-08j, 0.0445+6.9849e-10j, 3.0241-2.7960e-09j,
        0.4316-7.4506e-08j, 0.0914-1.8626e-09j, 1.2845+7.6121e-09j,
        3.2776+2.5111e-08j, 0.2707-5.4456e-10j, 4.1178+8.3708e-08j,
        0.4817-4.2195e-08j, 0.1210-2.2352e-08j, 4.2056-4.9088e-08j,
        0.6357-5.8067e-09j, 1.7411+6.3519e-08j, 4.0247+3.3061e-07j,
        1.5094-3.6386e-09j, 1.4051-3.6200e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9177982807159424+4.970767619738581e-08j)
SINR torch.Size([20]) = tensor([  7.6897,   0.8099,   4.3564,   8.7161,  -9.0626,   6.1529, -12.3830,
          1.6703,  -2.5144,   7.6459,  -0.7108,   5.8101,   2.3254, -11.2637,
          8.9205,   5.7966,  -0.6181,   4.7562,   7.9663,   5.3209],
       device='cuda:0')
SINR mean = 2.069223165512085
E[H^H] = 1e-07
E_MSE (Error Power) = 2.314087152481079
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8545, 0.5465, 0.7317, 0.8815, 0.1104, 0.8048, 0.0546, 0.5950, 0.3592,
        0.8533, 0.4592, 0.7921, 0.6308, 0.0696, 0.8864, 0.7916, 0.4645, 0.7494,
        0.8623, 0.7730], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([131, 327, 215, 111, 659, 167, 754, 298, 442, 132, 379, 175, 276, 723,
        107, 175, 376, 203, 125, 188], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 15-----------
Real SNR = tensor([15.4366,  8.6311, 14.1944, 14.6844, 16.0506, 15.1221, 15.0935, 13.7475,
        15.6257, 17.1478, 10.9565, 11.8710, 16.8353, 11.8407, 13.7084,  9.7513,
        14.4083, 10.2988,  9.0175, 12.7618], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.2959-1.1149e-07j, 0.3370-9.0965e-11j, 2.0782-3.5387e-08j,
        3.5950+1.1903e-07j, 2.6406-9.7959e-09j, 6.8735+8.4538e-08j,
        0.2387+2.0685e-08j, 1.3945+2.2085e-08j, 1.1525-1.5942e-07j,
        8.4807-3.5114e-08j, 0.6165+6.1150e-09j, 1.6558-6.9447e-09j,
        9.4930+2.2579e-07j, 2.4947+5.9605e-08j, 1.6304-5.0918e-08j,
        0.6079-1.7066e-09j, 4.9102+7.6999e-08j, 1.2655-7.3857e-09j,
        0.5013+8.9318e-09j, 1.9767+6.7225e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.7119266986846924+1.0612198231285674e-08j)
torch.linalg.det(H.mH@H) = tensor([ 3.7188+2.1653e-07j,  0.2480+3.4263e-09j,  1.1787+2.4767e-08j,
         5.8356+2.2523e-08j,  2.7411-5.0907e-08j,  3.9409-9.2898e-08j,
         0.1149-1.1334e-08j,  1.0778+7.7033e-10j,  3.8254+2.0744e-08j,
        10.2295-6.9845e-08j,  0.0895-0.0000e+00j,  1.8244+8.4359e-09j,
         8.4151-2.6676e-07j,  0.9182+1.4901e-08j,  2.2770+1.7003e-08j,
         0.2474-1.8041e-08j,  4.3111-8.7551e-08j,  1.1545+1.4900e-08j,
         0.1603-4.3933e-09j,  1.2371-1.0638e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6772677898406982-1.3418204325432725e-08j)
SINR torch.Size([20]) = tensor([ 4.4826,  2.3924,  5.5888,  5.6762, 10.5774, 10.0201, -0.2974,  4.7894,
        -0.8355,  9.7903,  4.5351, 10.9849,  7.7408,  5.4306,  3.3930, -1.1102,
         5.8597,  3.2076,  5.5494,  9.8497], device='cuda:0')
SINR mean = 5.381251335144043
E[H^H] = 1e-07
E_MSE (Error Power) = 0.42848968505859375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7373, 0.6343, 0.7836, 0.7870, 0.9195, 0.9095, 0.4829, 0.7508, 0.4521,
        0.9050, 0.7397, 0.9262, 0.8560, 0.7774, 0.6860, 0.4364, 0.7940, 0.6767,
        0.7821, 0.9062], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([211, 274, 181, 179,  79,  88, 365, 202, 383,  92, 210,  74, 130, 185,
        243, 393, 174, 249, 182,  91], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 16-----------
Real SNR = tensor([14.7874, 17.2147, 16.3818, 12.5937, 13.6802, 16.8407, 14.3156, 13.3418,
        13.9370, 14.6799, 15.3833, 18.1950, 12.9045, 12.4350, 14.7274, 16.9607,
        15.0733, 10.5266,  9.2221, 12.5010], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.9660+6.1370e-08j,  0.7382-7.1633e-08j,  2.5037-8.6406e-08j,
         0.3000-1.2825e-09j,  1.9452+2.0295e-07j,  1.0494-7.4506e-08j,
         0.5274-1.6802e-08j,  0.2371+6.6573e-09j,  0.6539+9.8206e-09j,
         2.9871-1.3954e-08j,  0.7587+6.2491e-08j,  1.8272+2.9802e-08j,
         0.2334+1.6051e-08j,  2.1967+6.9704e-09j,  1.2309+4.0808e-08j,
        12.4070-1.7662e-07j,  0.7950+8.9407e-08j,  0.0882-6.3330e-08j,
         0.2570+8.8271e-10j,  0.4858-3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.60939621925354+9.477130191726246e-10j)
torch.linalg.det(H.mH@H) = tensor([0.6993+1.0325e-08j, 1.0511+3.9356e-08j, 1.1419+2.1232e-08j,
        0.3968-7.3256e-08j, 0.2652+1.7740e-08j, 5.7380+5.7787e-08j,
        0.8226+2.3776e-09j, 0.1301-0.0000e+00j, 0.7738+8.2254e-09j,
        0.6126-2.6364e-08j, 0.3652-3.4458e-09j, 3.5984+7.4506e-09j,
        0.2040-1.8484e-09j, 0.5400-8.7577e-09j, 0.9124-0.0000e+00j,
        9.7456+1.3876e-07j, 0.5827+1.4901e-08j, 0.3690-3.7523e-09j,
        0.0975+4.7421e-10j, 0.2152-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4130642414093018+1.0060063004857511e-08j)
SINR torch.Size([20]) = tensor([  4.9452,   4.0950,   4.3471,   2.2129,   5.7557,  -5.2499,   6.3483,
         -6.3993,   4.3156,   6.6728,   3.2417,   5.0054,   2.9217,   6.2883,
          3.4473,  11.4540,   3.9146, -11.5000,   1.2528,   2.6658],
       device='cuda:0')
SINR mean = 2.78674578666687
E[H^H] = 1e-07
E_MSE (Error Power) = 1.4569240808486938
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7574, 0.7197, 0.7312, 0.6247, 0.7901, 0.2299, 0.8118, 0.1864, 0.7298,
        0.8229, 0.6784, 0.7600, 0.6621, 0.8097, 0.6886, 0.9332, 0.7112, 0.0661,
        0.5716, 0.6488], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([198, 222, 215, 280, 177, 537, 162, 575, 216, 154, 248, 196, 258, 163,
        241,  67, 227, 730, 312, 266], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 17-----------
Real SNR = tensor([16.5978, 12.9367, 16.4939, 15.7751, 14.2478, 17.1444, 16.2323, 17.3920,
        16.1860, 17.1864, 15.6149, 16.3228, 10.4270, 14.5261, 19.4639, 15.2595,
        13.4621, 12.1226, 17.6304, 17.1266], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.9676-1.0346e-07j, 1.3069+5.6712e-09j, 0.9991-8.6404e-09j,
        1.8938-8.0724e-09j, 1.4288-2.6400e-08j, 7.5501-9.1286e-08j,
        3.8178+5.0842e-08j, 2.6356+1.7466e-08j, 0.1975-1.1176e-07j,
        0.2641+3.3646e-08j, 1.0417+6.1416e-08j, 1.0612-3.8797e-08j,
        0.1393+4.4755e-09j, 1.1846+1.4901e-08j, 1.3234-7.2215e-09j,
        4.2524+2.8880e-07j, 0.4487-1.4752e-08j, 5.3499+1.8633e-08j,
        1.5756-1.9959e-08j, 2.9761-3.9598e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.220712900161743+1.2952654504516659e-09j)
torch.linalg.det(H.mH@H) = tensor([1.4905+4.6570e-08j, 0.9340+6.9356e-09j, 0.7746+1.0977e-08j,
        1.7089+3.2809e-09j, 0.9727+3.3767e-08j, 6.4173-6.9253e-08j,
        4.4019-2.6051e-08j, 2.1632+3.9921e-08j, 0.5417+1.4901e-07j,
        0.6614-1.3547e-07j, 0.5117-0.0000e+00j, 0.9029-1.5506e-08j,
        0.1872-2.9040e-09j, 0.4003-2.9802e-08j, 2.0239+3.1836e-08j,
        3.9615+1.6344e-07j, 0.4085-3.7221e-09j, 1.9996-9.8919e-09j,
        2.8698+1.2237e-08j, 2.8805-3.6037e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8106087446212769+8.466947143404013e-09j)
SINR torch.Size([20]) = tensor([ 6.6489,  6.8145,  8.7534,  6.4152,  9.1001, 12.4638, 12.1587, 10.4710,
         0.4128,  0.6653,  7.5217,  5.5493,  2.5489,  3.6138,  6.0239,  9.2851,
         4.5439,  9.4282,  3.8976, 12.0457], device='cuda:0')
SINR mean = 6.918080806732178
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2968168258666992
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8221, 0.8277, 0.8824, 0.8141, 0.8905, 0.9463, 0.9427, 0.9177, 0.5237,
        0.5382, 0.8497, 0.7821, 0.6427, 0.6968, 0.8001, 0.8945, 0.7401, 0.8976,
        0.7104, 0.9412], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([154, 151, 110, 160, 104,  55,  59,  81, 340, 332, 135, 182, 269, 236,
        170, 100, 209,  98, 228,  60], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 18-----------
Real SNR = tensor([18.7962, 13.1832, 21.2940, 19.7685, 12.9388, 17.0672, 13.7890, 14.8583,
        21.9322, 17.1056, 16.2380, 13.8019, 16.6602, 15.8652, 17.1339, 14.3931,
        12.6165, 12.7326, 19.9874, 17.4682], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.5616e-02-1.2127e-07j, 1.1604e+00+5.5536e-09j, 4.3029e+00-2.2352e-07j,
        1.1242e+00-7.3625e-08j, 1.0137e-02+9.7418e-10j, 1.4884e+00+1.0235e-07j,
        6.1884e-01-7.6211e-09j, 4.8351e-01-1.8626e-08j, 1.6572e+01+4.9258e-07j,
        2.0665e+00-5.9605e-08j, 1.4953e+00-8.3240e-09j, 1.2106e-03-1.0245e-08j,
        1.6274e+00-1.7534e-08j, 1.5429e+00-5.3904e-08j, 2.4439e-01-3.8081e-09j,
        1.7144e-01+1.3782e-08j, 4.2000e-03+8.7297e-09j, 2.9077e+00-4.1458e-08j,
        1.1652e+00+1.3074e-08j, 3.7150e-01+5.1208e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.871712327003479+1.3102834095501947e-10j)
torch.linalg.det(H.mH@H) = tensor([2.3532e-01+3.1475e-07j, 6.5869e-01-2.1002e-09j, 3.7473e+00+2.8795e-07j,
        2.6325e+00-6.8026e-07j, 4.4886e-02+2.7405e-09j, 7.9878e-01+6.6508e-09j,
        3.7661e-02-3.3528e-08j, 6.7698e-01-3.9658e-09j, 1.7700e+01+1.2784e-07j,
        1.5220e+00-1.1921e-07j, 7.2839e-01+2.0205e-10j, 8.4533e-02+1.1176e-08j,
        2.0541e+00+8.2631e-09j, 9.8754e-01+1.4500e-08j, 5.3425e-03-1.5023e-08j,
        6.5603e-02-9.9231e-09j, 4.3370e-02-4.8284e-09j, 2.8053e+00+1.2611e-08j,
        1.3526e+00-4.3987e-09j, 5.2087e-01-6.3478e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8350838422775269-7.501270715692954e-09j)
SINR torch.Size([20]) = tensor([ -9.8079,   7.9836,   7.6083,   1.1871,  -4.3608,   9.1695,   3.4747,
          1.6392,  15.6002,  12.7498,   6.1395, -19.9658,   9.7386,   6.7921,
          3.3369,   3.3297,  -9.6375,  11.4510,   6.1822,   1.7054],
       device='cuda:0')
SINR mean = 3.2157700061798096
E[H^H] = 1e-07
E_MSE (Error Power) = 6.323948383331299
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0946, 0.8627, 0.8522, 0.5679, 0.2681, 0.8920, 0.6900, 0.5933, 0.9732,
        0.9496, 0.8043, 0.0100, 0.9040, 0.8269, 0.6832, 0.6828, 0.0980, 0.9332,
        0.8059, 0.5969], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([682, 125, 133, 314, 507, 102, 241, 299,  29,  52, 167, 933,  93, 151,
        245, 245, 676,  67, 166, 297], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 19-----------
Real SNR = tensor([18.7203, 16.3862, 13.5466, 17.3372, 23.2449, 16.4370, 20.4527, 22.7676,
        21.5429, 14.3215, 14.8612, 20.2677, 10.8485, 18.8465, 18.4797, 20.8727,
        19.2594, 15.2377, 19.5173, 18.0695], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.3147+6.3959e-09j, 1.4865-0.0000e+00j, 0.4015+6.4057e-09j,
        0.1735+5.9860e-08j, 1.9112+3.2930e-07j, 0.5188-2.4110e-08j,
        5.9876-1.1003e-07j, 2.3191-3.9447e-08j, 6.1305+1.3750e-07j,
        0.6138+3.2340e-09j, 0.3551-0.0000e+00j, 4.2039+1.7799e-08j,
        0.1167-7.4506e-09j, 3.7488-1.1921e-07j, 1.5750+2.8895e-08j,
        1.4036-4.4922e-08j, 4.4798-5.4418e-08j, 2.5078+2.6524e-08j,
        1.0748+3.5868e-10j, 2.1097-8.2363e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1716103553771973+1.0422360752215809e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0492+1.7134e-08j, 1.2258+5.9605e-08j, 0.3267-3.9650e-09j,
        0.0757+2.1987e-08j, 1.6115-1.2956e-07j, 0.2388+1.9453e-08j,
        4.2230-3.8583e-08j, 2.0658+4.8388e-08j, 4.1031-2.8726e-08j,
        0.2495-9.2566e-09j, 0.0845+1.1176e-08j, 4.9094-4.5181e-08j,
        0.0637-5.5879e-09j, 2.2432+3.5763e-07j, 2.1309-3.6997e-08j,
        2.6461-7.1274e-08j, 2.8147-1.2521e-07j, 2.3930-1.9211e-08j,
        0.7208-1.7919e-08j, 2.0503-1.3173e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.76128351688385-6.391550844142557e-09j)
SINR torch.Size([20]) = tensor([ 8.8734,  7.8533,  8.0634,  0.8870,  9.8058,  7.2998, 14.7110, 11.6887,
        13.0168, 11.2597,  5.1416, 10.6335,  2.9687, 10.2843, 10.4220,  4.1324,
         8.4923, 14.0374,  9.8024, 10.6955], device='cuda:0')
SINR mean = 9.003447532653809
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2167203426361084
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8853, 0.8592, 0.8649, 0.5509, 0.9053, 0.8430, 0.9673, 0.9365, 0.9524,
        0.9304, 0.7656, 0.9204, 0.6645, 0.9144, 0.9168, 0.7214, 0.8760, 0.9620,
        0.9053, 0.9215], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([108, 128, 123, 324,  91, 140,  35,  64,  50,  70, 193,  79, 256,  84,
         82, 221, 115,  40,  91,  78], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 20-----------
Real SNR = tensor([15.5214, 18.5892, 19.2177, 16.9962, 18.8000, 20.3609, 23.6558, 22.6744,
        21.1614, 18.0353, 19.5090, 19.9957, 18.6498, 14.6683, 15.8696, 21.9524,
        21.3638, 19.5494, 19.4372, 16.2808], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2471+7.0781e-08j,  3.3209-1.0129e-07j,  1.1135+7.4506e-08j,
         0.6894+1.6878e-09j,  1.5974-2.3842e-07j,  0.7080-2.2352e-06j,
         9.7273+1.5188e-07j, 21.0861-4.9278e-07j,  2.3793-1.2589e-08j,
         0.1362-1.6323e-08j,  0.5521-1.4901e-07j,  1.5906-4.7555e-08j,
         1.4372-6.8067e-09j,  0.1730-2.9861e-09j,  0.4186+4.6615e-09j,
         6.9700-1.4008e-08j,  3.2694-3.5037e-08j,  2.2268+2.9548e-08j,
         3.1939+2.7992e-08j,  1.3558+1.0300e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.1096293926239014-1.4903116607456468e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.4091-3.7253e-08j,  2.6226+3.0211e-08j,  1.4183+1.1921e-07j,
         1.3641+5.5937e-08j,  0.7786+4.1723e-07j,  0.2143-6.9290e-07j,
         4.1071+2.7300e-07j, 17.5386+3.6100e-07j,  2.7304+6.3069e-08j,
         0.1793-8.1161e-09j,  0.6679-0.0000e+00j,  1.7112-5.6213e-08j,
         1.2742+3.7765e-09j,  0.4222+3.6268e-09j,  0.5317+9.2454e-10j,
         6.3568-5.5671e-08j,  2.5651+3.3307e-08j,  1.7619-1.1313e-08j,
         1.3517+7.4695e-09j,  1.0484+4.7214e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.452674150466919+2.7725263862521388e-08j)
SINR torch.Size([20]) = tensor([ 0.8412, 12.9274,  8.7135,  6.2747,  4.2825,  5.5699, 10.1667, 17.8772,
        11.4869,  3.5643,  3.9435, 10.1970, 11.0935,  0.9488,  3.5387, 14.8171,
         9.6612, 13.3930, 10.8083,  9.5455], device='cuda:0')
SINR mean = 8.482539176940918
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2657461166381836
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5483, 0.9515, 0.8815, 0.8092, 0.7283, 0.7829, 0.9122, 0.9840, 0.9337,
        0.6944, 0.7126, 0.9128, 0.9279, 0.5544, 0.6931, 0.9681, 0.9024, 0.9562,
        0.9233, 0.9001], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([326,  51, 111, 164, 217, 181,  86,  18,  67, 238, 227,  85,  72, 322,
        239,  34,  94,  46,  76,  96], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 21-----------
Real SNR = tensor([21.9874, 20.1806, 19.9343, 20.2714,  9.5218, 22.3382, 19.8031, 18.8686,
        23.3038, 19.0699, 21.8429, 16.6130, 15.7910, 18.9927, 23.7322, 17.8325,
        19.7676, 15.8303, 18.1689, 15.4262], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.5794-9.5367e-07j, 2.9428-1.4873e-07j, 0.1597+2.2597e-08j,
        2.0850-1.5353e-08j, 0.0733-1.0194e-09j, 4.0483-0.0000e+00j,
        2.4068-9.2985e-09j, 0.2722+6.9386e-09j, 8.4463+1.5266e-10j,
        1.1771+4.9026e-08j, 0.0673-1.9420e-09j, 0.5238-5.9605e-08j,
        0.3092-1.4936e-08j, 0.5965-5.9605e-08j, 3.4232+8.6233e-08j,
        0.3031+2.2352e-08j, 0.7248+1.4901e-07j, 1.1897+3.2680e-09j,
        1.4025+3.3069e-09j, 0.3129+4.3947e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8521873950958252-4.584432744536571e-08j)
torch.linalg.det(H.mH@H) = tensor([12.2625+4.0490e-08j,  1.9590+6.7610e-08j,  0.1428-4.3696e-08j,
         1.8406+3.3006e-08j,  0.0235+3.7792e-10j,  3.1030+1.4901e-08j,
         1.3016-5.2592e-08j,  0.5339+2.4961e-08j,  7.1981+1.9859e-09j,
         0.5185+6.0538e-08j,  0.3578+2.5824e-08j,  0.6969-5.9605e-08j,
         0.2153-1.5002e-08j,  0.6732-2.9802e-08j,  5.4244+3.7368e-09j,
         0.3812-4.4703e-08j,  0.6109+4.4703e-08j,  0.7274+6.9512e-09j,
         1.3447+1.1956e-08j,  0.2774+1.1083e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9796380996704102+4.63739935341323e-09j)
SINR torch.Size([20]) = tensor([ 8.5625, 12.2021,  0.1698,  8.4375,  7.7175, 13.6454, 13.2666,  5.5409,
        18.5730, 12.8305, -2.5813,  8.5652,  9.4310, 11.4076,  9.6527,  7.6121,
         4.0333, 13.5633, 12.9796,  8.3537], device='cuda:0')
SINR mean = 9.198153495788574
E[H^H] = 1e-07
E_MSE (Error Power) = 0.26927217841148376
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8778, 0.9432, 0.5098, 0.8747, 0.8553, 0.9586, 0.9550, 0.7817, 0.9863,
        0.9505, 0.3556, 0.8778, 0.8977, 0.9326, 0.9023, 0.8523, 0.7168, 0.9578,
        0.9521, 0.8725], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([114,  58, 349, 116, 131,  44,  47, 182,  15,  52, 445, 113,  98,  68,
         94, 133, 224,  44,  50, 118], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 22-----------
Real SNR = tensor([20.3356, 21.6789, 16.7994, 21.8756, 15.3754, 22.2997, 21.7458, 18.9883,
        24.5482, 16.2115, 21.8434, 21.9472, 17.9255, 22.6285, 23.3442, 20.6216,
        23.1313, 16.2418, 25.0882, 13.1963], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.5709+5.7691e-08j, 1.8238+2.8072e-08j, 0.7551+1.0497e-08j,
        2.0011+8.1150e-09j, 0.1704-7.4506e-09j, 3.9018-1.1921e-07j,
        2.2779-5.5463e-08j, 0.2931-7.9244e-09j, 8.2812-1.4813e-09j,
        0.3902-7.5469e-09j, 4.5847+2.8706e-08j, 1.3254-1.4901e-08j,
        0.2562+2.3159e-08j, 1.8643+1.2131e-08j, 1.7301+4.7413e-08j,
        1.6039+1.5881e-08j, 4.8146+3.5763e-07j, 0.6656+9.7851e-10j,
        2.9672+8.8455e-08j, 0.0109+3.8134e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.014421224594116+2.3256513159708447e-08j)
torch.linalg.det(H.mH@H) = tensor([0.3465-7.6717e-09j, 2.3194+9.6210e-08j, 0.1888-0.0000e+00j,
        2.0137-3.0970e-08j, 0.0227-9.3132e-10j, 3.9156+1.1921e-07j,
        1.4550+4.4703e-08j, 0.3236-1.6442e-08j, 5.8872-1.0766e-07j,
        0.3501-8.3783e-11j, 3.1824-6.4997e-08j, 2.2758-7.2016e-09j,
        0.3310+1.4644e-08j, 2.0720-9.7586e-08j, 1.4629+1.0562e-07j,
        0.8765-1.2173e-08j, 5.2867+4.7684e-07j, 0.4981+6.5797e-09j,
        3.3012+8.8753e-08j, 0.0466+2.6681e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8077900409698486+3.035544793306144e-08j)
SINR torch.Size([20]) = tensor([ 7.8086,  9.1639,  6.8191, 15.0871,  2.6490, 18.1430, 11.5968,  8.6277,
        15.7359, 11.4693, 12.0068, 10.1163,  7.4068, 10.8768, 12.4761, 13.9814,
        13.7806, 14.2445, 12.5310,  0.2494], device='cuda:0')
SINR mean = 10.738515853881836
E[H^H] = 1e-07
E_MSE (Error Power) = 0.15941618382930756
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8579, 0.8919, 0.8278, 0.9699, 0.6479, 0.9849, 0.9352, 0.8794, 0.9740,
        0.9334, 0.9407, 0.9113, 0.8463, 0.9245, 0.9465, 0.9616, 0.9598, 0.9637,
        0.9471, 0.5144], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([129, 102, 151,  32, 266,  17,  66, 112,  28,  67,  61,  86, 137,  75,
         55,  41,  43,  39,  55, 346], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 23-----------
Real SNR = tensor([17.4334, 20.0781, 19.9183, 27.8347, 22.8852, 22.5204, 22.9068, 21.1752,
        23.3090, 21.0092, 25.1404, 21.5213, 20.2490, 23.6202, 21.8153, 16.3213,
        23.0798, 16.1204, 22.5755, 19.3116], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.4021+2.8434e-09j, 0.2512-9.6858e-08j, 0.7296-3.7115e-09j,
        4.7270+1.6413e-07j, 4.1343+6.3590e-08j, 0.9537+2.7940e-08j,
        2.3641+4.1745e-08j, 0.3862-9.3821e-08j, 1.9027-1.7881e-07j,
        1.1360-2.1504e-08j, 8.2481-1.0987e-07j, 0.8320+1.7194e-08j,
        1.3532+1.2909e-08j, 1.0618+6.8412e-08j, 5.8802-6.4298e-08j,
        0.0364+7.4506e-09j, 2.4478-1.0694e-07j, 0.2917-6.1322e-10j,
        0.1498+3.4881e-08j, 0.3047+4.8722e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8796299695968628-9.330730854628655e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.4883+1.1015e-08j,  0.3926+4.4703e-08j,  0.6775+3.5159e-08j,
         4.8095-2.9512e-08j,  4.2849+3.4362e-08j,  0.8725-1.4901e-08j,
         2.2320+4.2944e-08j,  0.4009+5.1342e-08j,  0.9260+2.9802e-08j,
         1.2402+8.8213e-09j, 10.3297+2.4497e-07j,  1.1383+5.0338e-08j,
         0.4357+1.4043e-09j,  1.4395+3.2199e-08j,  5.3081+1.0435e-07j,
         0.1572+3.7253e-08j,  2.1722+1.0629e-07j,  0.2856-2.1835e-09j,
         0.3213+2.4549e-08j,  0.3043-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9108219146728516+4.064547098892035e-08j)
SINR torch.Size([20]) = tensor([13.7555,  6.9394, 13.4618, 12.9827, 14.4238, 13.3177, 12.5374,  6.6833,
         9.7746, 13.0423, 16.2116, 11.9246, 11.2418, 14.0515, 16.7157, -3.9379,
        16.1266, 13.2667, -2.4168, 10.1848], device='cuda:0')
SINR mean = 11.014361381530762
E[H^H] = 1e-07
E_MSE (Error Power) = 0.28658467531204224
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9596, 0.8317, 0.9569, 0.9521, 0.9651, 0.9555, 0.9472, 0.8233, 0.9047,
        0.9527, 0.9766, 0.9397, 0.9301, 0.9621, 0.9791, 0.2877, 0.9762, 0.9550,
        0.3644, 0.9125], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 43, 148,  45,  50,  37,  47,  55, 154,  92,  49,  25,  62,  70,  40,
         23, 492,  26,  47, 439,  85], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 24-----------
Real SNR = tensor([20.5075, 22.9119, 18.8463, 18.3308, 24.8924, 21.8528, 24.2655, 25.4509,
        27.4190, 24.7448, 21.2245, 22.3292, 22.6343, 25.8510, 16.4301, 23.0611,
        20.6892, 17.9693, 24.7354, 20.3948], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.6326+3.8461e-09j,  1.6564-4.2398e-08j,  0.1944+4.2764e-09j,
         0.1501-3.9034e-09j,  0.6081+1.8227e-08j,  1.5231+1.3883e-08j,
         2.0660-6.4097e-09j,  4.7478+7.3957e-08j, 22.2534+3.5475e-07j,
         2.0004+5.2223e-08j,  0.5182+2.9802e-08j,  0.2518-2.9802e-08j,
         1.1462+3.1754e-08j,  5.6307-2.4520e-08j,  0.1888-1.8171e-09j,
         0.6593+3.4728e-09j,  0.4278+8.8476e-09j,  0.4493-1.0665e-08j,
         2.1669+3.6444e-08j,  0.4145-7.8255e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.3842923641204834+2.5207262055459978e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.7424+3.8927e-09j,  2.4183-5.6198e-10j,  0.1751-6.8623e-09j,
         0.1144+2.9009e-09j,  0.5890+1.1410e-08j,  1.3306-4.9514e-08j,
         1.7426-4.5606e-08j,  4.2582-9.9241e-08j, 21.7811-1.9539e-07j,
         1.7016+3.4777e-08j,  0.6383+2.9802e-08j,  0.4166+7.4506e-09j,
         1.5856+1.9746e-08j,  5.4109-8.4255e-08j,  0.1024+2.9060e-09j,
         0.5121-2.9632e-07j,  0.6283+5.9605e-08j,  0.6950-1.4201e-09j,
         1.7294-2.2119e-07j,  0.4414-5.8223e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.350663423538208-4.1422818952696616e-08j)
SINR torch.Size([20]) = tensor([11.7969, 11.2474,  8.6009,  7.0949, 11.1844, 17.2475, 14.4438, 14.9654,
        19.1136, 15.9985,  8.8795,  5.7972, 14.8769, 18.2629,  7.0044, 14.0015,
         8.6958, 10.4274, 14.1186,  8.4968], device='cuda:0')
SINR mean = 12.112715721130371
E[H^H] = 1e-07
E_MSE (Error Power) = 0.09756972640752792
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9380, 0.9302, 0.8787, 0.8367, 0.9293, 0.9815, 0.9653, 0.9691, 0.9879,
        0.9755, 0.8854, 0.7916, 0.9685, 0.9853, 0.8338, 0.9617, 0.8810, 0.9169,
        0.9627, 0.8761], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 63,  70, 113, 144,  71,  20,  37,  33,  13,  27, 108, 175,  34,  16,
        146,  41, 111,  82,  40, 115], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 25-----------
Real SNR = tensor([26.9579, 28.7000, 21.8882, 24.9506, 20.1125, 22.7860, 26.8321, 22.3397,
        25.0235, 25.7544, 24.5961, 23.6095, 23.6095, 23.4956, 23.0069, 22.6275,
        17.4491, 17.2001, 22.2316, 23.4468], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.8021+1.0134e-07j, 2.1166+4.5428e-08j, 1.0167+8.1264e-09j,
        6.7114-8.3258e-08j, 0.0881+6.4850e-09j, 1.1773+4.8005e-09j,
        5.1402-5.3296e-08j, 0.2966-4.4703e-08j, 0.9378-8.9407e-08j,
        8.2767+1.2098e-07j, 3.8046-3.0117e-08j, 0.3765+1.2554e-07j,
        0.1577+1.2461e-08j, 0.4049+5.8946e-09j, 1.1935-0.0000e+00j,
        0.9298+5.9605e-08j, 0.1363+3.9007e-09j, 0.2694+3.6432e-08j,
        0.0849+1.9770e-09j, 2.3073+3.1706e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.9614177942276+1.1768159779990128e-08j)
torch.linalg.det(H.mH@H) = tensor([4.9077-1.4143e-07j, 1.9489-1.2241e-07j, 0.9615-2.1592e-09j,
        6.6737+1.4750e-07j, 0.1314+7.0363e-09j, 1.0760+8.9432e-09j,
        3.7649-3.6775e-08j, 0.3838-2.9802e-08j, 0.8040-5.9605e-08j,
        7.3750+9.7206e-08j, 3.3863-2.7899e-08j, 0.2813-2.6392e-10j,
        0.4508+5.9546e-10j, 0.4231-4.1534e-10j, 0.8793-7.4506e-09j,
        0.9745+5.9605e-08j, 0.1706+4.3885e-09j, 0.0885-3.7253e-09j,
        0.0813-1.1630e-09j, 2.0510+1.7017e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8406832218170166-4.54028015184349e-09j)
SINR torch.Size([20]) = tensor([14.7633, 12.8169, 14.5216, 19.1507,  5.4860, 16.2092, 20.4283,  7.9593,
        15.2876, 18.8694, 19.4554,  8.9010,  5.7834, 15.1166, 13.3464, 13.5442,
         7.9354,  7.5883,  6.6961, 16.8354], device='cuda:0')
SINR mean = 13.034738540649414
E[H^H] = 1e-07
E_MSE (Error Power) = 0.09432826936244965
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9677, 0.9503, 0.9659, 0.9880, 0.7796, 0.9766, 0.9910, 0.8621, 0.9713,
        0.9872, 0.9888, 0.8859, 0.7911, 0.9701, 0.9558, 0.9577, 0.8614, 0.8516,
        0.8237, 0.9797], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 35,  52,  37,  13, 184,  25,  10, 125,  31,  14,  12, 107, 176,  32,
         46,  45, 126, 133, 153,  22], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 26-----------
Real SNR = tensor([21.8496, 25.2939, 24.8267, 24.4124, 26.6443, 28.6467, 23.6294, 24.0860,
        24.8923, 26.3545, 27.3471, 22.7879, 21.9623, 26.6060, 21.8441, 25.3912,
        21.8171, 26.4544, 26.0594, 24.8074], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.4586+5.2967e-09j, 0.8958+1.9510e-09j, 0.9743-1.4901e-08j,
        1.1821-1.0117e-08j, 1.2411+1.3017e-07j, 7.7960-7.8549e-08j,
        0.1730+1.5488e-08j, 1.5990+2.5984e-09j, 1.4662-0.0000e+00j,
        8.7951+1.8106e-08j, 1.7415+2.9802e-07j, 0.7949-9.0729e-08j,
        0.4211-1.5685e-08j, 6.3397-1.2700e-08j, 0.1971+7.4506e-09j,
        1.3787-1.7462e-08j, 0.1571-0.0000e+00j, 3.5597+1.9855e-07j,
        0.7398-2.9646e-09j, 1.4737+6.4418e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.0692145824432373+2.204840043873446e-08j)
torch.linalg.det(H.mH@H) = tensor([0.5638-2.2062e-08j, 1.0521-8.2254e-08j, 1.0384-2.2352e-08j,
        0.8908-3.3033e-09j, 0.8554+1.4884e-07j, 8.1145+2.6544e-07j,
        0.1168-3.1414e-10j, 1.2950-6.7996e-09j, 1.2286-1.1921e-07j,
        8.9328+1.6791e-09j, 1.4080-5.9605e-08j, 0.9533-6.3571e-08j,
        0.4232+5.2149e-09j, 5.1089-6.9720e-09j, 0.1257-0.0000e+00j,
        1.2743+1.8654e-08j, 0.0954+7.4506e-09j, 3.0245-4.7256e-07j,
        0.6612-7.2003e-11j, 1.4064-1.9814e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9284557104110718-2.1580452980174414e-08j)
SINR torch.Size([20]) = tensor([12.5582, 10.3804, 17.0212, 17.7031, 10.9579, 20.9850,  4.6645, 13.8298,
        14.4961, 21.1416, 14.5930, 12.9930, 15.6380, 22.0108, 10.6893, 16.3824,
         9.1437, 19.1223, 14.0512, 17.9125], device='cuda:0')
SINR mean = 14.813699722290039
E[H^H] = 1e-07
E_MSE (Error Power) = 0.07004076987504959
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9474, 0.9161, 0.9805, 0.9833, 0.9257, 0.9921, 0.7454, 0.9602, 0.9657,
        0.9924, 0.9664, 0.9522, 0.9734, 0.9937, 0.9214, 0.9775, 0.8914, 0.9879,
        0.9621, 0.9841], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 54,  82,  21,  18,  74,   9, 206,  42,  37,   8,  36,  50,  29,   7,
         78,  25, 103,  13,  40,  18], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 27-----------
Real SNR = tensor([23.4993, 23.9924, 23.3010, 25.7902, 26.7280, 27.9269, 21.0203, 28.0286,
        23.0641, 27.7331, 21.7073, 22.4249, 27.7533, 26.1785, 27.1356, 27.1661,
        26.8039, 25.0814, 24.8922, 24.0282], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.0349+2.4450e-08j, 0.6790-4.9140e-09j, 0.3972-1.5795e-09j,
        0.2149+1.2293e-07j, 2.4981+1.9890e-07j, 6.2690-7.3058e-08j,
        0.4707+8.6875e-09j, 0.7637+1.5391e-08j, 0.1574-3.7253e-09j,
        4.9485-1.2805e-07j, 0.3151-1.1974e-09j, 0.3707-0.0000e+00j,
        3.1983+6.3997e-09j, 0.1375+1.4901e-08j, 2.0401-2.5214e-08j,
        1.4780+1.5521e-08j, 3.1500+8.1501e-08j, 0.9529+1.3934e-07j,
        1.3725-4.5555e-08j, 0.4631+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4955850839614868+1.7981619748752564e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0699+4.0194e-09j, 0.8267+4.3585e-09j, 0.4898+2.1089e-08j,
        0.1172-6.1467e-08j, 2.2081-4.1807e-08j, 5.6484+3.9341e-08j,
        0.5590-8.2023e-10j, 1.1508+1.1497e-08j, 0.1585+3.7253e-09j,
        4.7201+1.3137e-08j, 0.2581+3.4203e-09j, 0.2395+2.2352e-08j,
        3.5241+2.9399e-08j, 0.3108-7.4506e-09j, 1.5667-2.3279e-08j,
        1.3354+1.8194e-08j, 3.4707-9.7858e-09j, 0.9841+4.9039e-08j,
        1.8462+1.5709e-08j, 0.4973+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.49907648563385+6.0236344801012365e-09j)
SINR torch.Size([20]) = tensor([ 0.8951, 15.1801, 16.6654,  5.7070, 19.5559, 19.1996, 15.3051, 12.4174,
        12.6129, 18.6627, 12.7705, 10.7598, 18.2706,  7.5261, 18.0660, 19.0365,
        17.6677, 10.7631, 14.8894, 17.5275], device='cuda:0')
SINR mean = 14.173922538757324
E[H^H] = 1e-07
E_MSE (Error Power) = 0.11055827140808105
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5513, 0.9706, 0.9789, 0.7882, 0.9890, 0.9881, 0.9714, 0.9458, 0.9481,
        0.9866, 0.9498, 0.9226, 0.9853, 0.8498, 0.9846, 0.9877, 0.9832, 0.9226,
        0.9686, 0.9826], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([324,  32,  23, 178,  12,  13,  31,  56,  54,  15,  52,  77,  16, 135,
         17,  14,  18,  77,  34,  19], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 28-----------
Real SNR = tensor([25.1116, 26.7503, 26.7641, 29.2257, 23.4941, 23.6596, 26.0606, 19.3629,
        26.9357, 24.3993, 22.0038, 30.1462, 26.7667, 27.9789, 24.6213, 25.1932,
        28.8898, 27.5646, 27.5772, 28.1928], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1507+9.7255e-09j, 0.7213-1.0587e-08j, 1.1075-3.7020e-08j,
        4.5191-5.3020e-09j, 0.3672+2.7113e-09j, 0.1509-3.7253e-09j,
        1.1412-6.9152e-08j, 0.0538-3.7253e-09j, 3.3652-9.5835e-08j,
        1.4478+1.5867e-08j, 0.0554+3.2442e-09j, 7.9560+2.2089e-08j,
        1.6872-1.1877e-10j, 1.3045-3.1317e-07j, 0.9154-7.4506e-09j,
        0.4268-2.2352e-08j, 2.4613+1.6243e-08j, 4.3736+2.6758e-08j,
        0.5544-8.9317e-09j, 0.2045+1.5319e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.69818913936615-2.327075598884676e-08j)
torch.linalg.det(H.mH@H) = tensor([1.1022-3.7320e-09j, 0.9418+2.0668e-08j, 1.5450+5.9605e-08j,
        3.9240-4.2552e-08j, 0.2561+4.4744e-09j, 0.1808-0.0000e+00j,
        1.4321-3.9036e-08j, 0.0526+3.7253e-09j, 3.1129+5.1870e-08j,
        1.2644-5.8852e-09j, 0.0710-1.1271e-08j, 8.5852+1.4378e-07j,
        1.7544-9.6803e-09j, 0.9637+2.3747e-08j, 0.7892-1.4901e-08j,
        0.5127-2.2352e-08j, 3.3089-6.6437e-08j, 4.1768-3.8857e-08j,
        0.6280+8.9148e-09j, 0.1093+2.5080e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7355574369430542+4.358015281979988e-09j)
SINR torch.Size([20]) = tensor([20.1916, 14.5110, 11.1088, 20.2465, 11.5056, 12.0896, 17.4291,  5.8213,
        23.1753, 18.8200,  8.9161, 24.1256, 16.9613, 15.5367, 16.9093,  9.1717,
        18.1622, 25.1120, 13.6035,  6.8958], device='cuda:0')
SINR mean = 15.514656066894531
E[H^H] = 1e-07
E_MSE (Error Power) = 0.05994820222258568
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9905, 0.9658, 0.9281, 0.9906, 0.9340, 0.9418, 0.9822, 0.7926, 0.9952,
        0.9870, 0.8863, 0.9961, 0.9803, 0.9728, 0.9800, 0.8921, 0.9850, 0.9969,
        0.9582, 0.8303], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 10,  37,  72,  10,  67,  60,  19, 175,   5,  14, 107,   4,  22,  29,
         22, 102,  17,   3,  44, 149], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 29-----------
Real SNR = tensor([30.0193, 24.7676, 27.4565, 26.6815, 26.8050, 26.4991, 32.1355, 20.5389,
        27.9429, 28.4739, 29.1537, 25.7869, 25.9245, 28.3697, 29.8401, 27.0941,
        29.4734, 20.5815, 31.3688, 27.3523], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1324e+01+8.5291e-08j, 1.5801e-01-6.1744e-09j, 2.0068e-01-5.2154e-08j,
        1.5399e+00+1.0710e-08j, 5.8169e-01+1.3485e-08j, 1.3227e+00-7.7110e-09j,
        4.4261e+00-7.9676e-08j, 2.4725e-03-2.2119e-09j, 4.2293e-01-1.5941e-08j,
        3.8217e+00+4.9686e-08j, 9.9418e-01-1.1921e-07j, 2.4869e-02-1.2107e-08j,
        2.2404e-01+5.1394e-10j, 3.0264e+00-6.0566e-08j, 9.1545e+00-3.6059e-08j,
        1.5531e+00+1.2411e-08j, 2.1965e-02-1.5619e-08j, 3.4089e-01+7.3052e-10j,
        1.9490e+00-6.8642e-08j, 3.5692e-01+1.7348e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.0722997188568115-1.5075370285444478e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0873e+01+2.3408e-07j, 2.1824e-01-7.0175e-09j, 4.2200e-01-8.9407e-08j,
        1.4177e+00-9.9510e-09j, 6.6048e-01+2.4075e-08j, 1.5287e+00+1.3997e-08j,
        3.1265e+00-1.1256e-08j, 4.6011e-03+8.1491e-10j, 4.0367e-01+1.5847e-09j,
        3.8414e+00+5.2169e-08j, 1.2921e+00-1.7881e-07j, 3.0790e-02+1.8626e-09j,
        1.4537e-01-1.0332e-09j, 2.8297e+00+7.1348e-08j, 9.6229e+00-7.6067e-08j,
        1.6222e+00-3.5403e-09j, 9.0225e-03+5.4551e-08j, 3.7413e-01-1.2260e-08j,
        2.2202e+00-4.2298e-08j, 3.7600e-01-8.7244e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.050928831100464+7.058062467812931e-10j)
SINR torch.Size([20]) = tensor([23.3149, 13.7995,  6.2111, 18.4259, 17.6881, 20.9002, 12.8254,  1.5159,
        15.5005, 22.7026, 16.3165,  6.4966, 13.6915, 24.3129, 24.1176, 22.7032,
         2.2973, 20.1053, 15.2863, 13.1419], device='cuda:0')
SINR mean = 15.567660331726074
E[H^H] = 1e-07
E_MSE (Error Power) = 0.11865025013685226
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9954, 0.9600, 0.8069, 0.9858, 0.9833, 0.9919, 0.9504, 0.5864, 0.9726,
        0.9947, 0.9772, 0.8170, 0.9590, 0.9963, 0.9961, 0.9947, 0.6292, 0.9903,
        0.9712, 0.9537], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  5,  42, 165,  16,  18,   9,  52, 303,  30,   6,  25, 158,  43,   4,
          4,   6, 277,  11,  31,  48], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)

--- 処理中: 画像 21 から 40 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 20)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5159, 0.4950, 0.6478, 0.5684, 0.4895, 0.5508, 0.6202, 0.6527, 0.5857,
        0.6284, 0.7064, 0.7388, 0.7715, 0.6258, 0.9953, 0.6690, 0.7055, 0.8390,
        0.6214, 0.6514], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -4.5434,  -5.8157,  -9.5211,  -8.2938,  -6.5050, -10.9425,  -4.1650,
         -8.4248,  -6.4799,  -7.9696,  -7.5062,  -6.2328,  -7.8003,  -2.2371,
         -9.0905,  -7.8531,  -8.2156,  -4.7489,  -7.9487,  -6.2208],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 392.3659+4.8979e-06j,  346.6402-4.6660e-07j,   58.4381+7.3049e-06j,
         470.8420+1.2367e-06j,   11.5433+3.9342e-08j,  187.7372-3.0006e-06j,
         158.1708-6.6526e-07j,    5.9499-7.1526e-07j,   78.2340+2.9472e-08j,
         547.3923+3.9035e-06j,  342.7355-6.4267e-06j,   25.7426-4.1425e-06j,
         379.7834-1.0882e-05j,  500.8045-2.0062e-06j, 2041.3341+1.7955e-05j,
         810.1747+2.5525e-05j,   59.6573+8.8450e-07j, 1666.8073-6.8053e-06j,
          41.5799+1.5755e-06j,  109.1157-2.3747e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(411.75244140625+1.2933799098391319e-06j)
torch.linalg.det(H.mH@H) = tensor([6.5399+2.7864e-08j, 1.0995-1.0020e-08j, 0.1696+2.9802e-08j,
        0.1292-0.0000e+00j, 0.6107-1.4901e-07j, 0.3698-8.8490e-09j,
        4.9747-1.6291e-08j, 0.2605-1.1874e-08j, 1.7286+2.9802e-08j,
        0.7133+9.7871e-09j, 0.3853-4.6684e-08j, 1.0747+8.7692e-08j,
        1.7895+1.8813e-09j, 3.4624-2.9802e-07j, 0.3803+3.1708e-08j,
        0.3980-5.3559e-09j, 0.4610-5.1223e-09j, 0.2788-2.4177e-09j,
        0.7252-0.0000e+00j, 0.6590-1.7462e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3105100393295288-1.6842944816630734e-08j)
SINR torch.Size([20]) = tensor([ -2.8367,  -1.8996,  -6.2546,  -0.7318,  -6.4348,  -2.5058,  -4.0924,
        -11.0068,  -2.5197,  -1.8786,  -2.2720,  -9.4970,  -2.0389,  -0.8897,
         -1.4038,  -1.3996,  -3.6248,  -2.3426,  -4.4443,  -1.6500],
       device='cuda:0')
SINR mean = -3.4861836433410645
E[H^H] = 1e-07
E_MSE (Error Power) = 2.9867162704467773
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3423, 0.3924, 0.1915, 0.4580, 0.1852, 0.3596, 0.2804, 0.0735, 0.3589,
        0.3935, 0.3721, 0.1009, 0.3847, 0.4490, 0.4199, 0.4201, 0.3027, 0.3683,
        0.2644, 0.4061], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([454, 421, 571, 380, 576, 442, 497, 716, 443, 420, 434, 672, 426, 385,
        403, 403, 481, 436, 510, 412], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -4-----------
Real SNR = tensor([-9.1556, -9.6150, -4.5208, -4.4667, -6.0389, -4.4298, -2.8776, -6.2288,
        -3.4417, -5.9195, -2.6543, -1.3967, -5.7904, -6.9012, -6.4948, -5.0617,
        -6.8492, -7.0872, -5.6609, -8.0608], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([560.6770-2.7465e-06j,   4.8985-2.6226e-06j,  14.3913-9.7823e-08j,
        856.5035+9.0096e-06j, 149.5744+3.6972e-06j, 991.0042-3.1538e-06j,
        136.1602+5.7220e-06j, 466.2256-7.2877e-06j, 258.6246+1.5259e-05j,
         35.2823+1.8617e-07j,  58.8031-2.1336e-06j,   3.2433-1.2020e-06j,
        265.5080-3.7647e-07j,  79.7002+7.6294e-06j, 488.8424-1.1053e-05j,
         83.7392+2.4510e-06j,  13.1133+9.8074e-07j,  44.4375-1.6229e-06j,
        548.7305+1.5259e-05j,  28.2513-2.8610e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(254.38552856445312+1.2518015637397184e-06j)
torch.linalg.det(H.mH@H) = tensor([0.0367+1.3970e-08j, 0.1303-5.7984e-10j, 2.0298+1.5848e-08j,
        2.3197+4.5765e-08j, 2.8378-5.6051e-08j, 0.8656-2.3059e-08j,
        2.8210-0.0000e+00j, 0.8082+1.5460e-07j, 5.5787+4.7432e-09j,
        0.9053+2.9802e-08j, 4.1896+4.6299e-08j, 2.1078+4.3126e-08j,
        1.3382-1.1530e-08j, 0.4474+9.0867e-09j, 1.3783+8.3903e-10j,
        1.4357+2.5487e-08j, 1.0894+2.0866e-08j, 0.7898-7.4506e-08j,
        1.5186-6.5119e-08j, 0.8482-4.4660e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6737984418869019+8.756003921917e-09j)
SINR torch.Size([20]) = tensor([ -1.2198,  -9.4273,  -4.0476,  -0.1378,  -0.3589,   0.0307,  -4.0489,
         -0.9537,  -1.8782,  -6.6050,  -3.3260, -12.7945,  -0.6653,  -5.0927,
         -0.9127,  -3.2977,  -8.7369,  -4.0222,  -0.0438,  -4.7838],
       device='cuda:0')
SINR mean = -3.6161060333251953
E[H^H] = 1e-07
E_MSE (Error Power) = 3.500983476638794
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4302, 0.1024, 0.2825, 0.4921, 0.4793, 0.5018, 0.2825, 0.4453, 0.3935,
        0.1793, 0.3174, 0.0499, 0.4618, 0.2364, 0.4477, 0.3188, 0.1180, 0.2837,
        0.4975, 0.2495], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([397, 670, 496, 359, 367, 353, 496, 388, 420, 582, 471, 765, 378, 532,
        386, 470, 649, 495, 356, 521], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -3-----------
Real SNR = tensor([-2.5815, -9.7630, -5.7566, -1.8495, -7.5098, -3.0209, -4.9976, -0.9230,
        -6.2123, -3.7954, -2.1536, -3.9534, -4.9395, -7.8813, -5.7904, -3.0686,
         0.8909, -3.3576, -4.8593, -4.1343], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  1.2734-3.5167e-06j,   3.7715+7.0730e-06j, 425.3284-1.0057e-06j,
        748.2745-3.8919e-06j,   6.3916-2.3842e-07j, 125.4885-1.3690e-06j,
        759.7192-8.8794e-06j,  92.1190+1.4542e-06j,  15.6540-4.1543e-07j,
         52.7893+9.3256e-07j, 180.2767+5.8187e-07j, 166.3671-1.5259e-05j,
          5.1319+9.5367e-07j, 136.7702-2.3697e-07j, 834.8318+1.8021e-05j,
        135.8523+1.9073e-06j, 113.4255+1.9325e-05j,  60.3538+5.0206e-07j,
         95.2231-1.3474e-06j, 127.4603-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(204.32508850097656+7.29538271571073e-07j)
torch.linalg.det(H.mH@H) = tensor([1.0218-8.9407e-08j, 0.0222+7.4506e-09j, 1.0310-1.6282e-08j,
        3.4434+4.7684e-07j, 0.7350+6.5226e-10j, 4.3407+1.2822e-07j,
        0.1002+3.6412e-08j, 0.5332-5.3064e-08j, 1.6109-4.2047e-08j,
        1.8756-5.5456e-08j, 0.7367+1.1823e-07j, 3.3041-1.5336e-08j,
        2.3721+1.2765e-08j, 0.0364+7.8251e-10j, 1.1864+2.2984e-08j,
        1.1284-2.9802e-08j, 2.2368+3.4357e-08j, 2.7234-0.0000e+00j,
        0.1443+2.0511e-08j, 1.7873+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5184826850891113+3.0871031952983685e-08j)
SINR torch.Size([20]) = tensor([-20.4729, -12.3201,  -0.2248,  -1.3989, -10.5867,  -2.5664,  -0.1515,
         -0.8876,  -4.7328,  -2.0165,  -1.6195,  -1.9677,  -7.7432,  -0.9142,
         -0.1105,  -3.2929,  -3.0185,  -3.9228,  -1.5548,  -1.6797],
       device='cuda:0')
SINR mean = -4.059103012084961
E[H^H] = 1e-07
E_MSE (Error Power) = 8.638559341430664
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0089, 0.0554, 0.4871, 0.4202, 0.0803, 0.3564, 0.4913, 0.4491, 0.2517,
        0.3860, 0.4078, 0.3886, 0.1439, 0.4476, 0.4936, 0.3190, 0.3329, 0.2884,
        0.4114, 0.4045], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([944, 752, 362, 403, 704, 444, 360, 385, 519, 425, 411, 423, 619, 386,
        358, 470, 460, 492, 409, 413], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -2-----------
Real SNR = tensor([-5.2583, -5.5510, -3.6426, -1.1114, -5.5807, -4.7710, -1.9795, -7.3894,
        -3.7084, -0.9985, -3.1165, -5.6831, -5.2538, -3.7443,  0.6147,  2.4093,
        -4.3793, -0.7041,  0.4978, -2.2833], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 14.6278-4.0532e-07j, 285.8963-4.2266e-06j,   3.9741+9.5367e-07j,
         72.5592-3.1916e-07j,  32.0806+4.7032e-07j,   0.4126+5.9605e-08j,
        102.6769+4.0763e-07j,   8.4301-6.2072e-07j,  13.6982-1.4305e-06j,
          3.3569-4.6909e-06j, 193.8558+3.0780e-07j,  32.2452+7.2395e-07j,
         91.5968+9.5367e-06j, 113.8046+2.7895e-06j,  87.3198+2.4751e-06j,
        150.1706-0.0000e+00j,   4.9770-2.7300e-06j,  79.5041-4.6245e-06j,
          2.8350-1.7642e-07j,  24.8601-4.0147e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(65.94408416748047-2.757255685992277e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.7537+3.6365e-09j,  0.3669-7.8023e-09j,  1.6040+1.8402e-08j,
         5.6964+3.4588e-08j,  0.5806+1.0576e-08j,  0.9617-2.9802e-08j,
         1.4211-2.2183e-08j,  0.4223-5.5062e-09j,  0.4125+9.5436e-09j,
         5.8810-2.2007e-07j,  1.0006-2.9802e-08j,  0.6855-1.5139e-09j,
         0.7788-2.9802e-08j,  3.2900-3.5763e-07j,  0.7916-6.1263e-09j,
         2.5619-1.9372e-07j,  0.6598+2.8440e-10j,  0.2064-1.0468e-08j,
        15.1753+2.5743e-07j,  5.5105-3.1231e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.43802547454834-3.055902197957039e-08j)
SINR torch.Size([20]) = tensor([ -3.9563,  -0.7955,  -9.6448,  -2.1287,  -2.1359, -18.3278,  -1.8242,
         -5.4694,  -9.4061, -15.2681,   1.6396,  -2.4860,  -3.7026,  -1.2311,
         -0.4303,  -3.5831,  -9.0982,  -0.0490, -11.1167,  -4.2816],
       device='cuda:0')
SINR mean = -5.164791107177734
E[H^H] = 1e-07
E_MSE (Error Power) = 7.918277263641357
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2868, 0.4543, 0.0979, 0.3799, 0.3795, 0.0145, 0.3965, 0.2211, 0.1029,
        0.0289, 0.5933, 0.3607, 0.2989, 0.4296, 0.4753, 0.3047, 0.1096, 0.4972,
        0.0718, 0.2717], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([493, 382, 677, 429, 429, 898, 418, 544, 670, 828, 299, 441, 484, 397,
        369, 480, 660, 356, 719, 504], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -1-----------
Real SNR = tensor([ 2.0499, -3.9468,  2.5784, -6.2190,  0.8305,  0.5678,  0.8229, -1.7802,
        -3.5784, -1.1560, -2.7836,  0.3619, -6.3221, -5.5893, -7.0073, -4.9262,
        -2.6006, -3.5527, -3.4561, -5.0599], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 12.3039+6.2323e-07j,   9.6652+1.7633e-07j,  54.3240-3.1601e-07j,
        178.5606+1.7725e-07j, 119.1811+2.5429e-06j,   4.0599+2.7752e-06j,
          9.1153-1.9073e-06j,  46.6107-5.6023e-07j,  13.3095+2.3842e-06j,
         20.7302-8.4676e-07j,  29.5946-0.0000e+00j,  14.5981+9.3905e-07j,
        170.5902-3.8428e-07j,  29.1986-3.0877e-07j,  87.1701-0.0000e+00j,
          6.0798+3.1289e-07j,  26.2053+1.1921e-06j,  14.2932+2.9802e-08j,
         91.1266-3.8147e-06j,  23.3368-8.4086e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(48.00270080566406+1.0869923983136687e-07j)
torch.linalg.det(H.mH@H) = tensor([2.5809+4.1723e-07j, 0.9639-3.4979e-10j, 3.1634-2.3416e-09j,
        0.4920+1.0083e-08j, 1.6415-1.1133e-08j, 3.0682+1.9517e-07j,
        1.6299+3.8711e-08j, 0.4198+2.9436e-07j, 0.6187-5.3254e-10j,
        1.2995-0.0000e+00j, 1.4524-3.3656e-09j, 0.8041+3.4662e-08j,
        0.0612-9.3132e-09j, 1.2114+1.0411e-08j, 0.1905-2.2352e-08j,
        0.3317-6.9076e-09j, 0.0867+3.4645e-07j, 3.7904-8.9709e-08j,
        2.2563-4.1928e-09j, 0.2393-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3150814771652222+5.984431794558986e-08j)
SINR torch.Size([20]) = tensor([ -8.3661,  -5.1715,  -0.1350,  -0.6088,  -0.0977, -11.6856,  -6.6194,
         -2.3889,  -7.3473,  -2.7857,  -2.1132,  -3.9771,  -1.2561,  -3.6677,
         -2.0362,  -6.2595,  -5.3840,  -1.9920,  -1.3346,  -1.9303],
       device='cuda:0')
SINR mean = -3.7578225135803223
E[H^H] = 1e-07
E_MSE (Error Power) = 3.304753065109253
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1272, 0.2331, 0.4922, 0.4650, 0.4944, 0.0635, 0.1788, 0.3658, 0.1555,
        0.3449, 0.3807, 0.2858, 0.4282, 0.3006, 0.3849, 0.1913, 0.2245, 0.3873,
        0.4238, 0.3907], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([638, 534, 359, 376, 358, 735, 582, 438, 606, 452, 428, 493, 398, 483,
        426, 571, 542, 424, 401, 422], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 0-----------
Real SNR = tensor([-0.0881,  0.7576, -2.1727, -0.2004, -0.0952, -2.2923,  0.3352,  0.2120,
        -4.0579,  0.9618, -2.1541,  0.3641, -1.4936, -1.5474,  1.0916, -2.6883,
         1.2728,  0.2801, -7.7858,  1.7830], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 14.4363-4.1746e-08j,  52.0226+9.0012e-07j,  12.8033+4.7684e-07j,
          8.5483-1.1129e-07j,  27.8854-1.1597e-06j, 122.1401-2.9265e-06j,
          0.5424-4.2094e-08j,  34.4837+5.7220e-06j,  53.6828+4.5543e-07j,
         42.4058-4.3819e-07j,   7.1664+6.0648e-08j, 195.6910-1.9073e-06j,
         13.5986+1.6823e-06j,  14.5159-1.7881e-07j,  15.7889-3.8147e-06j,
          2.5709-2.2352e-08j,   6.0171-3.6797e-08j,  31.0927+6.1513e-08j,
         11.6808-5.8851e-08j,  26.8569+1.9073e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(34.696502685546875+2.638926233089478e-08j)
torch.linalg.det(H.mH@H) = tensor([2.9131+5.9310e-09j, 6.6319-6.2832e-08j, 0.5550+2.0867e-08j,
        1.6593-1.5982e-08j, 0.9222+1.1344e-08j, 0.6182+3.6749e-08j,
        2.4452-1.1057e-09j, 5.3103+2.0593e-08j, 0.6915+2.2957e-08j,
        1.1864-7.3927e-08j, 3.9578+1.1174e-08j, 4.5330+6.2935e-08j,
        1.7156-5.0417e-08j, 0.0235-8.2320e-09j, 4.4043+1.7586e-08j,
        0.3161-2.9802e-08j, 6.8128-1.0296e-07j, 0.7165-2.0862e-07j,
        0.0829-5.5879e-09j, 5.9068+4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.5701229572296143-1.5231252703529208e-08j)
SINR torch.Size([20]) = tensor([ -1.1550,  -1.5738,  -5.1237,  -7.4558,  -2.5503,  -1.4801, -13.3083,
         -1.7634,  -1.4405,  -0.9269,  -6.3081,   0.6010,  -4.3530,  -6.6374,
         -4.8680,  -5.9536,  -3.7964,  -0.5371,  -3.5680,  -3.1686],
       device='cuda:0')
SINR mean = -3.7683379650115967
E[H^H] = 1e-07
E_MSE (Error Power) = 3.4787697792053223
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4339, 0.4104, 0.2351, 0.1523, 0.3573, 0.4156, 0.0446, 0.3999, 0.4178,
        0.4468, 0.1896, 0.5345, 0.2685, 0.1782, 0.2458, 0.2025, 0.2944, 0.4691,
        0.3054, 0.3253], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([395, 409, 533, 609, 444, 406, 778, 416, 405, 387, 572, 334, 506, 583,
        524, 561, 487, 373, 479, 465], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 1-----------
Real SNR = tensor([ 0.5105,  2.5163, -1.3414,  1.6262,  1.2153,  2.5980, -1.5302, -1.6801,
         1.0986, -1.4588, -1.5787, -1.9294, -0.2153,  4.7065, -0.9994, -0.6380,
         3.2242, -0.1424, -1.0045,  0.6116], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 24.3905-2.9774e-07j,  10.3666-0.0000e+00j,  24.3347+1.6689e-06j,
         32.7506+1.0133e-06j,  44.8727-0.0000e+00j, 194.1016-2.1879e-06j,
          5.7540+2.3842e-06j,  15.4231-3.9945e-07j,  17.6057-3.0299e-07j,
        161.1595-2.5284e-06j,   0.4932-9.5153e-08j,  41.5065+3.2325e-08j,
         40.9370-1.9073e-06j,  15.0017-4.7684e-07j,   1.5194-6.2258e-08j,
         10.1538+1.4848e-08j,   3.4410-8.6457e-09j,  65.7749+3.8147e-06j,
          5.6615-3.9339e-06j, 107.2324-1.7968e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(41.1240234375-2.5345977405777376e-07j)
torch.linalg.det(H.mH@H) = tensor([1.1269-1.6903e-08j, 0.8291-2.1111e-07j, 0.6242-0.0000e+00j,
        2.3153-3.5700e-09j, 1.9094-7.2342e-08j, 5.2116+2.7198e-07j,
        0.2423-5.2033e-08j, 1.9536+7.9031e-08j, 2.4961-6.2067e-08j,
        1.2252-1.0958e-08j, 0.6392+8.9407e-08j, 0.3563-1.4901e-08j,
        0.0921+2.9802e-08j, 2.6290-2.9802e-07j, 0.1616-2.8684e-09j,
        1.4658-2.1322e-08j, 0.1920-8.4188e-08j, 0.1243-5.2154e-08j,
        2.3231+2.0344e-08j, 1.6409+2.3527e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.377899408340454-1.9417425889400874e-08j)
SINR torch.Size([20]) = tensor([ -0.2667,  -7.7194,  -3.0528,  -5.1518,  -2.4230,  -0.8316,  -5.2527,
         -2.3899,  -0.5914,   2.0704, -15.3322,  -1.4503,  -2.6031,  -2.7676,
         -6.7660,  -3.9682,  -5.6811,   1.1430, -10.0092,   0.0904],
       device='cuda:0')
SINR mean = -3.6476573944091797
E[H^H] = 1e-07
E_MSE (Error Power) = 4.339390277862549
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4847, 0.1446, 0.3312, 0.2339, 0.3640, 0.4523, 0.2298, 0.3658, 0.4660,
        0.6170, 0.0285, 0.4173, 0.3545, 0.3459, 0.1739, 0.2862, 0.2128, 0.5654,
        0.0907, 0.5052], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([364, 618, 461, 534, 439, 383, 537, 438, 375, 285, 829, 405, 446, 451,
        587, 493, 551, 315, 687, 351], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 2-----------
Real SNR = tensor([  0.5514,   4.5283, -10.9775,  -1.2385,   2.7700,  -1.7926,   1.5147,
         -2.4157,   0.5420,   1.0547,   2.5060,  -0.5737,   0.2944,  -4.9470,
          0.8200,   1.1760,   3.3587,   0.3644,   0.1844,  -2.7268],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  4.9247+4.4558e-08j,   0.9510+3.2783e-07j,   2.6959-5.9605e-07j,
          0.3178+2.1756e-06j,  31.7207-8.7608e-08j,  31.5778-2.8978e-07j,
          0.3916+1.1623e-06j,  10.4179-9.2357e-08j,   9.3647-3.5147e-07j,
         10.8276-8.9636e-07j,  23.0661+9.5367e-07j,  24.2428-0.0000e+00j,
         50.2514-4.9892e-07j,  17.5821+1.4726e-07j,   8.6203-1.4305e-06j,
         11.6427+4.7684e-07j,   3.7884+1.6382e-08j,  40.0729+1.9073e-06j,
          5.0774+2.3842e-07j, 102.2000+1.5573e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(19.48668098449707+1.681417103327476e-07j)
torch.linalg.det(H.mH@H) = tensor([1.4014+7.9888e-09j, 1.3336-2.9248e-08j, 0.0107+4.6566e-10j,
        0.1469-3.7253e-09j, 2.9515-4.5100e-08j, 0.1194-4.1910e-09j,
        1.3965-6.3430e-09j, 0.0668+3.6123e-09j, 0.0412+6.8163e-08j,
        4.9285-4.5242e-08j, 3.2785+1.7881e-07j, 0.0176-1.7928e-08j,
        0.6718-6.0629e-10j, 0.3457+9.7995e-10j, 0.0994+3.7253e-09j,
        1.2222-5.3050e-09j, 1.7243+2.3842e-07j, 2.0771-2.9016e-08j,
        1.5666+1.5718e-08j, 0.4316-5.7602e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.191562533378601+1.6270988112410123e-08j)
SINR torch.Size([20]) = tensor([ -3.6170, -12.0347,  -5.9510, -16.6694,   0.9204,   1.0006, -16.9066,
         -1.7049,  -2.0864,  -6.3358,  -1.6833,  -0.2475,   0.3115,  -2.9628,
         -3.3380,  -4.1217,  -0.6248,  -0.9095,  -5.1730,   1.5473],
       device='cuda:0')
SINR mean = -4.029341220855713
E[H^H] = 1e-07
E_MSE (Error Power) = 8.555381774902344
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3030, 0.0589, 0.2026, 0.0211, 0.5528, 0.5573, 0.0200, 0.4031, 0.3822,
        0.1886, 0.4043, 0.4858, 0.5179, 0.3358, 0.3168, 0.2791, 0.4641, 0.4478,
        0.2331, 0.5881], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([481, 745, 560, 861, 323, 320, 866, 414, 427, 573, 413, 363, 344, 458,
        471, 498, 376, 386, 534, 302], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 3-----------
Real SNR = tensor([ 3.6330,  4.1359,  0.6589,  4.0458, -0.4652, -0.3188,  1.4527,  0.8391,
         1.8042,  1.2243, -0.0254,  1.5053,  1.8082,  4.8961, -5.0387,  3.2944,
         4.3137,  4.7580,  4.6232, -0.8918], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 21.0170+1.7881e-07j,  61.2094+6.9139e-07j,   1.1315+1.5452e-09j,
          5.3907+6.8313e-08j,   2.2241-2.9802e-08j,   4.1234-4.4980e-10j,
         29.6539+3.9337e-07j,  30.4402+5.5763e-08j,   5.8033-1.1076e-07j,
         30.9406-9.4522e-08j,   1.8817+3.1715e-08j,  32.6840+6.2785e-07j,
         40.8500+2.1849e-07j,  50.0856-7.1111e-07j,   8.5370+1.7043e-07j,
         25.8472+1.9224e-07j,   1.1644-1.4901e-08j, 115.0689+4.9726e-07j,
         12.2459+3.1999e-07j,   1.8541+2.0395e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(24.107641220092773+1.2530118453923933e-07j)
torch.linalg.det(H.mH@H) = tensor([1.0544-9.0749e-09j, 0.1358+1.4901e-08j, 0.5013-4.4703e-08j,
        2.7681-4.7138e-08j, 0.1751-5.4017e-08j, 0.2404-2.7095e-08j,
        1.2122-1.0523e-08j, 1.3050+2.8145e-08j, 1.3225-8.5965e-09j,
        1.7742-3.7850e-08j, 0.6596-1.0767e-08j, 4.0699-9.3515e-09j,
        0.9837-9.3485e-10j, 2.9197-4.7684e-07j, 0.4343+4.6419e-09j,
        0.6791+5.0998e-09j, 0.5447+2.9802e-08j, 0.2657-8.9407e-08j,
        9.4471+3.4273e-07j, 0.3347-5.8886e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5413765907287598-2.0078323004213416e-08j)
SINR torch.Size([20]) = tensor([-0.3567, -0.2358, -3.9872, -6.3055, -7.6327, -1.8366,  0.9338, -0.1825,
        -1.8202, -2.5414, -6.9161,  2.0232,  3.0452,  0.4956, -0.3669,  0.0308,
        -9.6925,  1.1916, -3.3990, -3.6025], device='cuda:0')
SINR mean = -2.0577714443206787
E[H^H] = 1e-07
E_MSE (Error Power) = 2.545175313949585
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4795, 0.4864, 0.2853, 0.1897, 0.1471, 0.3958, 0.5535, 0.4895, 0.3967,
        0.3577, 0.1690, 0.6144, 0.6685, 0.5285, 0.4789, 0.5018, 0.0969, 0.5682,
        0.3137, 0.3038], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([367, 363, 494, 572, 615, 419, 322, 361, 418, 443, 592, 286, 254, 337,
        367, 353, 678, 314, 473, 480], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 4-----------
Real SNR = tensor([ 3.4825,  5.3036, -0.1422,  6.1397,  0.4015,  3.9123,  1.3742,  5.0549,
         3.5524,  6.9379,  0.2276,  5.0133,  4.5201,  5.9168,  2.9203, -0.2428,
         5.4649,  0.4535,  2.3267,  2.9502], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.7808+4.7337e-08j, 46.1732-5.9880e-07j, 11.4748-2.5686e-07j,
         0.9775+4.1723e-07j, 16.4839+9.9410e-08j, 10.3983-2.8293e-07j,
        10.5725+1.7758e-07j,  3.5073+5.2108e-07j, 95.2349-6.0189e-07j,
         7.3291-5.8554e-07j,  0.9791+6.7452e-09j, 21.4630+8.0905e-07j,
        16.2764+5.8237e-07j, 10.1281+6.4429e-07j,  2.8949-2.2054e-06j,
        11.5241+6.0251e-08j,  2.3604-6.2585e-07j,  9.1105-1.1086e-07j,
        31.2004-6.9230e-07j,  0.3952-7.4506e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(15.61322021484375-1.3347803928809299e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.9534+1.6362e-08j,  4.8027+4.2112e-07j,  0.1856-3.0771e-08j,
         5.2725+3.0991e-07j,  0.2359-7.5355e-09j,  2.4304-1.2703e-07j,
         0.0553+1.2514e-08j,  5.4044-1.3191e-07j,  0.0207+7.2643e-08j,
        15.8011+2.8823e-07j,  0.4092-4.9799e-09j,  4.1813+5.8106e-08j,
         2.4455-1.7222e-08j,  0.1202+1.7125e-07j,  0.1403-2.6077e-08j,
         0.3758+7.1009e-09j,  3.5918+1.0165e-07j,  0.3615-3.7302e-08j,
         2.1240+7.4540e-08j,  1.9166-1.8768e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.541412115097046+4.814602405645019e-08j)
SINR torch.Size([20]) = tensor([ -3.3227,  -0.2717,   1.3328,  -9.8920,  -0.9946,   1.1058,  -2.6495,
         -4.8287,  -1.8542,  -5.9643,  -8.1705,   1.1776,   1.2382,   1.2072,
         -3.7186,  -2.1758,  -8.0898,  -2.3676,  -2.9094, -14.1383],
       device='cuda:0')
SINR mean = -3.2643063068389893
E[H^H] = 1e-07
E_MSE (Error Power) = 3.9216866493225098
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3175, 0.4844, 0.5761, 0.0930, 0.4430, 0.5633, 0.3520, 0.2475, 0.3949,
        0.2021, 0.1322, 0.5674, 0.5708, 0.5690, 0.2981, 0.3773, 0.1344, 0.3670,
        0.3385, 0.0371], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([471, 364, 309, 684, 389, 317, 447, 523, 419, 561, 632, 314, 312, 313,
        484, 431, 629, 437, 456, 800], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 5-----------
Real SNR = tensor([ 6.9773,  2.7987,  3.2383,  2.4977,  3.1242,  3.4181,  5.8904, -0.5972,
         4.6819,  5.9761,  6.4482,  2.8818,  2.3627,  2.2024,  5.5923,  5.5307,
         4.2788, -1.1053,  3.8661,  3.4891], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.2664-2.3697e-07j,  3.2218-1.7792e-08j, 22.6156+2.1259e-07j,
        17.1309-9.6279e-07j,  9.1666-2.9802e-08j,  8.3190+6.1669e-08j,
        31.1259+6.6757e-06j, 11.5943-8.9079e-07j, 20.6974+6.6485e-07j,
         3.8260+7.1461e-08j, 33.3812+2.7447e-08j,  4.5577-4.0333e-10j,
         1.3684-3.8172e-09j, 15.0504-4.1202e-08j,  5.9687-4.8303e-09j,
         0.0583-1.9558e-07j, 18.2250+1.9688e-07j,  7.1691+1.5851e-09j,
        18.1286+1.6269e-08j,  7.0125+4.5872e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(12.244194030761719+2.7951793413194537e-07j)
torch.linalg.det(H.mH@H) = tensor([2.2558-8.6350e-08j, 1.4361+3.1900e-08j, 1.9411-5.1268e-08j,
        1.0301-2.9844e-08j, 0.2631-7.4657e-08j, 0.0426+2.8292e-08j,
        0.6455+9.6973e-08j, 0.1796+6.5448e-10j, 1.3483-2.3842e-07j,
        1.3241+5.9605e-08j, 1.2507+2.2352e-08j, 0.8736-8.0879e-09j,
        1.5201+1.1090e-08j, 0.8524+2.6216e-09j, 2.7944-2.8781e-08j,
        0.5659+4.5247e-08j, 4.9159+5.4830e-08j, 0.0436-4.3337e-09j,
        3.0921+1.0679e-07j, 1.2950+8.3521e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.383496880531311-2.651845631973515e-09j)
SINR torch.Size([20]) = tensor([-2.0505e+00, -1.4854e+00,  2.3870e+00,  1.9201e+00, -1.0092e+00,
        -3.8551e+00,  9.3216e-01, -2.3694e+00, -1.6895e+00, -8.7578e-01,
         3.0160e+00, -3.0593e+00, -4.7188e-01,  1.0756e+00, -3.2250e-01,
        -2.3315e+01, -1.6301e+00, -1.8090e+00,  3.8909e+00, -2.1578e-02],
       device='cuda:0')
SINR mean = -1.5371496677398682
E[H^H] = 1e-07
E_MSE (Error Power) = 10.215011596679688
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3841, 0.4153, 0.6340, 0.6088, 0.4422, 0.2916, 0.5535, 0.3669, 0.4040,
        0.4498, 0.6670, 0.3308, 0.4729, 0.5616, 0.4814, 0.0046, 0.4073, 0.3973,
        0.7101, 0.4988], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 426,  406,  275,  290,  390,  489,  323,  437,  413,  385,  255,  462,
         371,  318,  366, 1000,  411,  418,  228,  355], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 6-----------
Real SNR = tensor([2.8992, 4.3624, 7.0842, 8.4650, 3.8900, 8.8713, 6.0471, 1.7591, 7.4439,
        7.7727, 9.7700, 3.5089, 2.8355, 0.9757, 3.4591, 6.3322, 8.5464, 5.2749,
        1.0398, 6.5160], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 5.4406-2.0560e-07j,  3.4506-2.4791e-07j,  4.1010+2.7383e-07j,
        14.0589-2.6565e-07j,  1.9175-7.9754e-08j, 23.6872-1.2348e-07j,
         3.6409+2.7136e-08j,  2.2413-1.9727e-08j,  6.0998-1.4305e-06j,
         2.2031+1.6076e-07j,  6.0965+5.3366e-07j,  0.4626-8.9407e-08j,
         1.9427-4.1723e-07j,  0.0596+2.7663e-09j,  8.1794+5.0565e-09j,
         0.1749-2.8249e-08j,  3.4751-5.4071e-08j, 12.6396-9.9834e-08j,
         3.1301-1.1921e-07j,  8.7411-3.1638e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.587131023406982-1.1045322168001803e-07j)
torch.linalg.det(H.mH@H) = tensor([0.2244-4.2226e-08j, 1.2843-1.3485e-08j, 1.0651-8.9407e-08j,
        1.2157+1.4901e-07j, 1.2893+3.6218e-09j, 0.6968-1.2068e-07j,
        1.2730-3.3251e-08j, 0.5878+5.5442e-09j, 0.3040+6.1095e-07j,
        1.0539-3.9804e-09j, 3.3086+1.0051e-06j, 0.0872-1.1176e-08j,
        0.3117+7.4506e-08j, 0.6629-2.6497e-09j, 0.8454+1.7632e-08j,
        0.2407+2.9680e-08j, 5.1711-1.3789e-08j, 5.8608-6.0284e-08j,
        0.4526-3.9483e-09j, 1.1645+2.9802e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3549879789352417+8.996030231855912e-08j)
SINR torch.Size([20]) = tensor([ -1.9425,  -3.5595,  -0.5582,   1.2545,  -3.8774,   3.0445,   0.1288,
         -0.6598,  -2.4255,  -3.4597,  -4.3321,  -8.0466,  -2.0128, -17.4353,
         -0.6672, -12.5362,  -3.5404,   1.2796,  -3.0812,   2.6893],
       device='cuda:0')
SINR mean = -2.986889600753784
E[H^H] = 1e-07
E_MSE (Error Power) = 5.390868663787842
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3900, 0.3058, 0.4679, 0.5717, 0.2905, 0.6684, 0.5074, 0.4621, 0.3639,
        0.3107, 0.2694, 0.1355, 0.3862, 0.0177, 0.4617, 0.0528, 0.3068, 0.5731,
        0.3297, 0.6500], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([422, 479, 374, 312, 490, 254, 350, 377, 439, 475, 506, 628, 425, 878,
        378, 758, 478, 311, 462, 265], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 7-----------
Real SNR = tensor([ 7.0859,  9.4479,  1.9318,  1.2346,  2.8392,  6.0826,  1.7680,  0.1166,
        -2.6386,  2.6491,  5.1675,  6.4521,  8.2971,  2.5374,  6.2294,  4.5980,
         9.8128,  8.1768, 10.4447,  2.2335], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([8.2565e+00-3.9543e-07j, 1.9809e+01+1.4113e-07j, 1.3683e-02-1.5487e-08j,
        2.1263e-01+2.4318e-08j, 1.2568e+00-5.9605e-08j, 5.3264e+00+1.5142e-06j,
        1.4629e+01+2.3141e-07j, 8.4510e-02-4.4798e-07j, 1.5932e+00-1.4865e-08j,
        1.6347e+00-1.6538e-08j, 3.9385e+01+4.3940e-07j, 2.3127e+00-1.4305e-06j,
        8.6918e+00-3.8074e-09j, 5.2119e+00-3.0568e-08j, 3.6014e+00-4.2865e-09j,
        3.3576e+00-2.2264e-07j, 2.2897e+00-3.5338e-08j, 1.7016e+01+7.7922e-07j,
        1.2811e+01-9.5367e-07j, 3.5676e-01-1.1487e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.392502784729004-2.5625302768617075e-08j)
torch.linalg.det(H.mH@H) = tensor([3.1140e+00-1.9451e-08j, 1.0141e+01-4.2717e-07j, 3.9046e-01+3.8522e-09j,
        1.3982e-01-1.8626e-09j, 9.4223e-01-1.4440e-08j, 7.1257e-02+1.4061e-09j,
        4.5362e-01+2.9802e-08j, 1.7678e-01-3.5777e-09j, 8.1808e-03+1.5514e-10j,
        2.9143e-01+7.4506e-08j, 2.0949e+00+2.6937e-08j, 5.0421e-01-1.4901e-07j,
        1.4732e+01+8.2710e-08j, 3.3994e-01+1.0272e-09j, 4.7403e+00+2.9600e-08j,
        6.5252e-01-3.6285e-09j, 4.8350e+00-0.0000e+00j, 3.0640e-01+9.5523e-08j,
        3.5004e+00+3.4531e-08j, 5.6517e-01+1.9513e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3999905586242676-1.1856829296164051e-08j)
SINR torch.Size([20]) = tensor([  2.2363,   3.6244, -21.8876,  -6.9073,  -5.5305,  -7.4151,   0.6993,
        -15.9528,  -1.2008,  -1.0618,   2.4150,  -4.3229,   1.5547,   1.4344,
          3.5810,  -3.8342,  -2.7681,   1.4217,   0.9403,  -2.1451],
       device='cuda:0')
SINR mean = -2.755953073501587
E[H^H] = 1e-07
E_MSE (Error Power) = 11.295676231384277
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6260, 0.6973, 0.0064, 0.1693, 0.2187, 0.1535, 0.5402, 0.0248, 0.4313,
        0.4392, 0.6355, 0.2699, 0.5886, 0.5818, 0.6952, 0.2926, 0.3458, 0.5811,
        0.5539, 0.3790], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([279, 236, 972, 592, 546, 608, 330, 844, 396, 391, 274, 505, 302, 306,
        237, 489, 451, 306, 322, 429], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 8-----------
Real SNR = tensor([ 4.3949,  3.5024,  2.4999,  7.3381,  4.6803,  3.5587,  9.7131,  9.0357,
         9.6707, 10.8023,  7.5882,  3.8984,  9.2874,  8.8660,  9.0401,  8.0017,
         4.5502,  9.9595,  7.3063,  7.9445], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.5433+2.2352e-08j,  8.0939-2.7827e-08j,  5.3578+4.7684e-07j,
         5.0711+1.9957e-08j,  0.7238+2.9802e-08j,  0.9699+1.8302e-09j,
         7.5772-0.0000e+00j,  7.9094+1.2444e-07j,  4.1211-7.2515e-09j,
         1.2934+1.4007e-06j,  5.5701-1.1223e-07j,  1.6699-2.4665e-08j,
         0.0442+1.0610e-07j,  3.7873-1.0821e-07j, 25.5297-9.5367e-07j,
         1.2728-1.9075e-07j,  0.5118+5.0457e-09j, 10.7317-1.1921e-07j,
         0.6452+2.9802e-08j,  2.9882+2.3972e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.720577716827393+3.4851847630079646e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.6884-0.0000e+00j,  0.5092-7.0053e-09j,  0.3918-1.4901e-08j,
         1.7323-2.7549e-08j,  0.4581-2.9802e-08j,  0.1548+7.5724e-09j,
         6.8955-3.5204e-07j,  4.6725-1.0753e-07j,  4.7085-3.3845e-08j,
         0.5933+2.0266e-06j,  2.7632+1.1921e-07j,  0.7790+2.1292e-08j,
         3.7428+2.6992e-07j,  2.7681-6.3636e-09j, 17.8448-5.3444e-08j,
         0.9217-2.9059e-08j,  0.7426-3.3282e-09j,  9.0285+1.3290e-08j,
         1.8607-1.4280e-08j,  5.2982+1.6507e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.3277008533477783+8.975954557399746e-08j)
SINR torch.Size([20]) = tensor([ -3.6936,   3.0492,   2.9376,  -0.7060,  -7.0081,  -1.4473,   5.0522,
          3.8278,   0.9001,  -7.0183,  -0.9919,  -1.4916, -19.4882,   1.5536,
          4.4046,  -1.5318,  -6.7590,   1.3878,  -6.7935,   1.0155],
       device='cuda:0')
SINR mean = -1.6400495767593384
E[H^H] = 1e-07
E_MSE (Error Power) = 8.464030265808105
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2993, 0.6687, 0.6629, 0.4594, 0.1661, 0.4174, 0.7619, 0.7071, 0.5516,
        0.1658, 0.4431, 0.4150, 0.0111, 0.5885, 0.7338, 0.4127, 0.1742, 0.5792,
        0.1730, 0.5582], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([484, 254, 257, 379, 595, 405, 195, 230, 324, 595, 389, 406, 923, 302,
        213, 408, 587, 307, 588, 320], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 9-----------
Real SNR = tensor([ 6.6156,  4.4509,  8.2843,  2.2885,  7.7463,  8.4484,  9.2447,  3.7288,
         5.3348,  2.9035, 11.8706,  5.9948, 10.4022,  5.9267,  8.9112,  7.3985,
         8.1258,  6.8172,  3.8544, 12.0847], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.5800-2.9802e-08j,  3.5118+8.4649e-08j,  3.2323+5.9818e-08j,
         0.1937+5.7668e-09j,  0.4711-1.9372e-07j,  4.4931-2.4290e-08j,
         5.7364-1.9985e-07j,  2.3571-3.6542e-08j,  0.5001-7.9072e-10j,
         3.3109+1.7199e-07j,  3.2577-3.4853e-07j, 14.7148+2.8680e-07j,
         0.4857+5.1151e-08j,  0.9844-2.9802e-08j,  3.3437-1.1054e-07j,
         0.3143+4.9025e-09j,  0.3351+2.9673e-08j,  0.0503+5.4017e-08j,
         0.7048-0.0000e+00j, 10.3664-2.3742e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.9472062587738037-2.3125464210238533e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.6308+1.3017e-08j,  0.4827-8.8504e-09j,  1.7441-8.8003e-08j,
         0.2662-4.1930e-09j,  0.1158+1.8889e-09j,  1.3821-0.0000e+00j,
         3.9353+1.3973e-08j,  0.0902-9.4010e-09j,  0.2948-3.8862e-09j,
         0.5430-7.3587e-10j,  0.7468+1.1589e-07j,  0.7448-1.0329e-08j,
         0.6919+4.4790e-08j,  0.4326-7.9523e-09j,  4.3629-0.0000e+00j,
         0.5319+2.5516e-08j,  1.0774+4.0080e-09j,  0.0340-3.1812e-10j,
         0.0910-0.0000e+00j, 21.3302-3.1894e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.976425051689148-1.167598373541523e-08j)
SINR torch.Size([20]) = tensor([ -1.8956,   2.7773,   0.8543,  -6.8165,  -4.3060,   3.7171,   1.2370,
         -0.6961,  -1.8062,   2.5528,  -3.6176,   1.8718,  -6.4406,  -2.9567,
          2.5651,  -5.9562,  -3.2185, -11.3751,  -0.7251,   3.4656],
       device='cuda:0')
SINR mean = -1.5384594202041626
E[H^H] = 1e-07
E_MSE (Error Power) = 2.502833604812622
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3926, 0.6546, 0.5490, 0.1723, 0.2706, 0.7018, 0.5707, 0.4600, 0.3975,
        0.6429, 0.3030, 0.6061, 0.1850, 0.3361, 0.6435, 0.2024, 0.3228, 0.0679,
        0.4584, 0.6895], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([421, 262, 325, 589, 505, 233, 312, 379, 418, 269, 481, 291, 577, 458,
        269, 561, 467, 726, 380, 241], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 10-----------
Real SNR = tensor([ 5.8448,  8.3181,  9.8040,  7.2454,  7.3717,  8.2398,  8.1489,  7.7601,
        11.7283,  5.5659,  7.5350,  7.6759, 10.8517,  6.7760, 13.3201,  0.0949,
         8.0181,  8.1059,  8.9099,  6.8217], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.6039-3.2946e-08j, 1.8675-7.0865e-08j, 2.8612+5.9605e-08j,
        9.4825-6.3693e-08j, 0.9717+2.9119e-08j, 0.9172+7.4913e-07j,
        0.4977-3.9544e-09j, 0.1320+3.7229e-09j, 6.1942-1.1116e-07j,
        4.0241+1.3023e-08j, 0.0704+7.4506e-08j, 1.4200-7.5278e-08j,
        6.6698-2.8757e-08j, 1.3765-1.7881e-07j, 8.5667-1.3688e-07j,
        0.0438+3.7253e-09j, 0.7282+2.9802e-08j, 7.1687+1.6760e-08j,
        0.8474+1.1921e-07j, 1.8031-3.7565e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8123462200164795+1.79342460882026e-08j)
torch.linalg.det(H.mH@H) = tensor([0.5055-1.4145e-08j, 0.0542-1.2908e-08j, 0.0920+1.3411e-07j,
        1.3807+1.1397e-08j, 0.5085-4.5789e-09j, 0.5802+3.3460e-08j,
        0.5465-3.1862e-09j, 0.8997-3.1335e-08j, 5.8616-5.1476e-08j,
        0.1139+1.2556e-08j, 1.2356+1.1685e-08j, 1.0867-2.2352e-08j,
        2.2105+4.5680e-08j, 1.0640-0.0000e+00j, 7.1327+2.3842e-07j,
        0.0615-4.1323e-10j, 0.9719+2.1901e-08j, 1.2363-1.2261e-08j,
        2.1707-0.0000e+00j, 0.2900+5.6374e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4001346826553345+1.810949790126415e-08j)
SINR torch.Size([20]) = tensor([  0.6608,  -1.5280,   1.4307,   3.7982,   1.4428,  -5.3381,  -4.5831,
         -8.4922,   2.2689,   2.1616, -14.4078,   0.4478,   8.4366,   2.8223,
          6.5450,  -6.3600,  -1.8242,   3.2312,  -6.7835,   3.6409],
       device='cuda:0')
SINR mean = -0.6215149760246277
E[H^H] = 1e-07
E_MSE (Error Power) = 3.218229293823242
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5380, 0.4129, 0.5816, 0.7057, 0.5823, 0.2263, 0.2582, 0.1240, 0.6277,
        0.6219, 0.0350, 0.5258, 0.8746, 0.6570, 0.8186, 0.1878, 0.3965, 0.6779,
        0.1734, 0.6981], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([332, 408, 306, 231, 305, 540, 514, 642, 278, 282, 806, 339, 116, 261,
        157, 574, 418, 248, 588, 236], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 11-----------
Real SNR = tensor([ 7.4599,  7.0978,  9.2581,  6.8110,  7.1964, 11.0960, 10.7661, 11.5282,
         7.9877,  7.6589,  7.7061,  8.3401,  8.5213, 11.3437, 11.5622,  7.0214,
        13.8577, 12.3125, 12.9003,  6.6427], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.6058-7.9205e-08j,  0.3363+2.9802e-08j,  0.1039+3.5537e-08j,
         0.2833+2.1615e-08j,  0.6819-2.9802e-08j,  6.4312+2.3948e-07j,
         0.2327-2.5174e-10j, 13.7168+3.0830e-08j,  1.4436+1.1921e-07j,
         2.9814+9.8779e-09j,  0.9676-2.0835e-08j,  0.6513-7.4506e-09j,
         0.7242-7.9138e-09j,  3.6577-1.5588e-07j,  4.4546-1.6661e-08j,
         1.0613+9.3510e-11j,  3.3483+2.9802e-07j,  3.2948-2.7987e-08j,
         0.5445-9.1532e-08j,  0.0247-5.1223e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.277301788330078+1.7091821291614906e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6199-2.9802e-08j, 0.0401+1.2747e-08j, 0.5347+6.3115e-08j,
        0.4188-3.0871e-09j, 0.0950+1.5589e-08j, 1.1934+9.2997e-09j,
        0.3306-1.2861e-08j, 6.3251+1.5754e-08j, 1.0991-1.5435e-09j,
        1.7625-1.1239e-08j, 0.0455-3.5368e-08j, 1.0293-5.9605e-08j,
        0.9784-3.7813e-09j, 2.0265-1.1921e-07j, 7.2140+1.3897e-07j,
        0.8341+2.0801e-09j, 2.3538+1.1921e-07j, 2.3064-3.6332e-07j,
        0.1152-1.8820e-07j, 1.0423-2.1969e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5182316303253174-2.2673029675956968e-08j)
SINR torch.Size([20]) = tensor([ -3.2073,  -3.7767,  -8.6732,  -2.4264,   2.1288,   3.3454,  -8.9354,
          5.1264,   1.4889,   7.2767,  -0.0550,  -3.2398,   1.8298,   4.3935,
          8.2062,   0.8845,   3.9203,   5.5908,  -1.6737, -14.3967],
       device='cuda:0')
SINR mean = -0.10965242236852646
E[H^H] = 1e-07
E_MSE (Error Power) = 3.312318801879883
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3233, 0.2953, 0.1195, 0.3639, 0.6201, 0.6836, 0.1133, 0.7650, 0.5849,
        0.8423, 0.4968, 0.3217, 0.6038, 0.7333, 0.8687, 0.5507, 0.7115, 0.7837,
        0.4048, 0.0351], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([467, 487, 647, 439, 283, 245, 655, 193, 304, 140, 356, 468, 293, 214,
        120, 324, 227, 181, 413, 806], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 12-----------
Real SNR = tensor([12.3637, 12.5874, 10.1167, 16.5828, 15.1953, 15.5418,  7.5965,  6.2557,
        10.3476, 12.4764,  7.9438, 13.6156,  9.0580,  7.2631,  5.6303,  9.4876,
        14.5431, 11.4234,  8.6160, 11.3571], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.7966+3.2570e-08j,  0.8058-1.2316e-07j,  0.7774+7.6504e-09j,
        12.4246+4.3419e-08j,  9.9467-3.0812e-07j,  6.8216+3.6342e-07j,
         1.3501+1.8064e-08j,  2.6477+2.5976e-08j,  2.5711+1.4910e-08j,
         9.3463-8.1447e-08j,  1.0810-3.4160e-08j,  8.4010+4.7684e-07j,
         1.4657-1.4901e-08j,  0.1668+2.2352e-08j,  0.2149+3.7253e-08j,
         0.1881-8.8632e-08j, 12.8768-1.4305e-06j,  7.8365+1.7023e-07j,
         0.7385+7.4506e-08j,  0.7282-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.109269618988037-3.968717621205542e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.6390+6.7297e-09j,  0.9959-3.2355e-08j,  0.4361-4.6566e-09j,
        28.6257+1.4379e-07j,  7.5179-5.0664e-08j,  9.9398+3.4879e-07j,
         0.0416+5.0291e-08j,  0.4040-2.7214e-10j,  1.1989-9.6891e-09j,
         2.9712+2.7147e-08j,  1.5052-2.9413e-08j,  7.1572-2.3842e-07j,
         0.2510-7.4506e-09j,  0.2369-0.0000e+00j,  0.4820-3.5678e-09j,
         1.9366+5.4202e-08j,  8.3393-2.3842e-07j,  1.2587-4.3333e-08j,
         0.3193-2.9802e-08j,  2.4346+3.5621e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.834534168243408-2.676521448918834e-09j)
SINR torch.Size([20]) = tensor([-3.1362,  0.2870,  0.8664,  4.7265, 10.1443,  4.2650,  1.2436,  4.3126,
         1.1911,  4.9320,  4.6674,  8.9850, -0.0292, -4.4283, -3.8982, -9.3117,
         7.6280,  6.4467,  0.4435, -2.4028], device='cuda:0')
SINR mean = 1.8466354608535767
E[H^H] = 1e-07
E_MSE (Error Power) = 1.2752548456192017
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3269, 0.5165, 0.5497, 0.7481, 0.9118, 0.7275, 0.5711, 0.7297, 0.5681,
        0.7569, 0.7455, 0.8878, 0.4983, 0.2651, 0.2895, 0.1049, 0.8528, 0.8152,
        0.5255, 0.3651], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([464, 345, 325, 204,  86, 217, 312, 216, 314, 198, 206, 106, 355, 509,
        491, 667, 132, 159, 339, 438], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 13-----------
Real SNR = tensor([12.8954, 10.4087,  9.5304, 10.6598, 12.4578, 15.2643, 10.4617, 15.3163,
        15.2049, 13.8633, 12.0756, 15.7575,  8.9388,  9.9346,  8.2462, 15.4941,
        12.4750, 14.9061, 12.7433, 13.8223], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 9.2159+6.7589e-09j,  0.8033+3.6145e-09j,  0.1326+3.0401e-09j,
         0.1076+9.8737e-10j,  1.4027+3.6168e-09j,  4.2624-2.3976e-07j,
         1.7079+1.4616e-08j,  6.3712+3.3748e-07j, 11.1311-6.2638e-09j,
        10.6045-1.2559e-08j,  0.2220-7.6616e-08j,  1.5854+2.9304e-07j,
         0.6478+1.0985e-08j,  1.5702-1.3204e-08j,  1.0477-2.9703e-08j,
        10.0913+3.7764e-08j,  3.2105-8.8196e-08j,  1.5398-1.2448e-07j,
         5.5708+1.1443e-09j,  6.2944-8.4551e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.8759567737579346+1.8851686878207374e-09j)
torch.linalg.det(H.mH@H) = tensor([2.6516-2.3007e-09j, 1.1817+2.1315e-08j, 0.0737+1.7030e-09j,
        0.3447+8.1432e-08j, 0.9793+6.0841e-08j, 5.5847+3.0204e-08j,
        0.9867-0.0000e+00j, 3.6592-3.2329e-08j, 2.0788+2.8629e-07j,
        4.1193-1.0759e-07j, 1.3542+2.3520e-08j, 0.5363-5.8421e-08j,
        0.2843-1.4901e-08j, 0.9318-1.4791e-08j, 0.5844+7.2385e-09j,
        2.4189-0.0000e+00j, 4.2686-2.9225e-08j, 0.5646-1.0487e-06j,
        5.5451-1.7309e-08j, 1.2480-2.0647e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.969797968864441-4.168429867945633e-08j)
SINR torch.Size([20]) = tensor([ 6.2538,  4.0293, -9.0912, -4.1724, -2.1931,  6.2243,  6.3672,  5.0059,
         4.9163,  8.2079, -3.4034,  4.4567,  3.6206,  4.2180, -2.8599,  5.5593,
         4.5314,  0.7777,  8.8715,  3.0708], device='cuda:0')
SINR mean = 2.719536542892456
E[H^H] = 1e-07
E_MSE (Error Power) = 1.1743673086166382
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8085, 0.7166, 0.1097, 0.2767, 0.3764, 0.8074, 0.8125, 0.7600, 0.7562,
        0.8687, 0.3135, 0.7362, 0.6971, 0.7254, 0.3411, 0.7825, 0.7395, 0.5447,
        0.8852, 0.6698], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([164, 224, 660, 500, 431, 165, 161, 196, 199, 120, 474, 212, 236, 219,
        455, 182, 210, 328, 108, 253], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 14-----------
Real SNR = tensor([12.0151, 15.6811, 14.0581, 11.0184, 13.7444, 10.2137, 13.3878, 15.8151,
        13.1653, 10.5575,  5.0335, 11.7902, 12.7338, 12.7408, 13.0822, 10.4213,
        12.5829, 14.1154, 11.8085, 11.0308], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.7375-6.9129e-08j, 2.0251+4.4742e-08j, 0.9139+3.5050e-08j,
        0.0323+2.5146e-08j, 0.9914+5.8459e-08j, 0.3213+7.4506e-09j,
        0.3251-1.5436e-08j, 4.8022-2.3290e-07j, 6.1524+6.1916e-08j,
        1.5523-2.1652e-08j, 0.0904-3.4080e-10j, 0.2266-3.4809e-07j,
        3.9459-9.2837e-08j, 1.4751-1.3873e-08j, 4.6227+4.4267e-08j,
        2.5031+3.0988e-08j, 2.8142+1.0648e-07j, 3.1994-2.0933e-08j,
        7.1669-1.0283e-07j, 0.2094+3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.355363607406616-2.4990077562847546e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0399-1.3406e-08j, 2.2252+4.7672e-08j, 0.7595+4.7240e-08j,
        0.2607+1.8626e-08j, 1.5879+7.5448e-09j, 0.2249-1.8626e-08j,
        0.1600+8.2552e-09j, 4.6751+9.0984e-08j, 1.5632+2.5452e-08j,
        0.3775-7.0346e-09j, 0.0576-7.4506e-09j, 0.7734+1.6880e-08j,
        3.1085-1.5743e-08j, 1.5168+4.7774e-09j, 4.4198-3.2287e-09j,
        1.4880+1.2338e-08j, 2.1926+9.3392e-08j, 1.8211-1.5784e-08j,
        1.5929-9.6533e-09j, 0.2905-7.4506e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5067580938339233+1.0386420612462643e-08j)
SINR torch.Size([20]) = tensor([ 8.3446e+00,  1.0506e+00,  2.5180e+00, -1.0165e+01, -6.1315e-03,
        -3.9094e+00, -4.5036e+00,  2.5253e+00,  4.0942e+00,  2.3944e+00,
        -5.3509e+00, -7.1653e+00,  9.3701e+00,  8.7367e+00,  8.2080e+00,
         3.5085e+00,  3.6157e+00,  8.6363e+00,  5.3505e+00,  1.4811e+00],
       device='cuda:0')
SINR mean = 1.9366644620895386
E[H^H] = 1e-07
E_MSE (Error Power) = 1.6024948358535767
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8723, 0.5602, 0.6410, 0.0878, 0.4996, 0.2890, 0.2617, 0.6414, 0.7196,
        0.6344, 0.2258, 0.1611, 0.8964, 0.8820, 0.8688, 0.6917, 0.6969, 0.8796,
        0.7742, 0.5844], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([118, 319, 270, 692, 355, 491, 512, 270, 222, 274, 540, 600,  99, 110,
        120, 240, 236, 112, 187, 304], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 15-----------
Real SNR = tensor([17.8588, 14.3836, 12.2919, 14.1002, 16.6993, 17.6615, 15.2241, 13.0460,
        11.4590, 15.5312, 14.8506, 14.5763, 11.8210, 14.9807, 14.7029, 12.7848,
        11.6931, 12.7799, 13.8797, 14.1911], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([11.9415-1.2108e-07j,  1.9918+3.8828e-08j,  0.7751+5.3638e-09j,
         0.8280-9.5045e-09j,  0.1182+4.2468e-07j,  6.1254+5.3771e-08j,
         7.4011+9.1712e-08j,  0.1097+1.9200e-10j,  0.0189-9.1071e-09j,
         0.0712+1.4117e-08j,  4.5519+3.0432e-09j,  1.7138+4.6702e-08j,
         0.7182-3.2783e-07j,  1.9371+5.9605e-07j,  0.4998+2.9802e-08j,
         2.0191+5.1535e-08j,  1.0274+3.2624e-08j,  0.5070-1.4901e-08j,
         1.5110-9.3606e-08j,  2.7466+8.0014e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.330641508102417+4.065953618237472e-08j)
torch.linalg.det(H.mH@H) = tensor([15.3933-6.9743e-08j,  0.9785+2.6621e-08j,  1.4950-2.3170e-08j,
         1.7038-3.1270e-08j,  0.0849-7.8231e-08j, 10.7577-6.9603e-09j,
         4.5628-2.3842e-07j,  0.4393-6.4758e-08j,  0.0488+9.1229e-09j,
         0.4597-4.4696e-09j,  6.8609-3.7553e-08j,  2.6075+1.7455e-08j,
         1.5609+2.3842e-07j,  1.4335+5.9605e-08j,  0.5493+4.4703e-08j,
         1.1294+1.3716e-09j,  1.8459-2.1019e-08j,  0.5169-7.4506e-08j,
         1.0486+1.1707e-07j,  1.4067-1.2097e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7441651821136475-7.391264489342575e-09j)
SINR torch.Size([20]) = tensor([ 13.7513,   5.2182,   0.6977,  -3.0089,  -5.2831,   6.4966,   8.6709,
         -2.1074, -10.6519,  -5.3763,   7.9813,   0.3437,   0.7485,   5.2469,
          2.7206,   7.1731,   5.5487,   4.4047,   5.3876,   3.3556],
       device='cuda:0')
SINR mean = 2.565899610519409
E[H^H] = 1e-07
E_MSE (Error Power) = 1.589003324508667
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9595, 0.7688, 0.5401, 0.3334, 0.2286, 0.8170, 0.8804, 0.3810, 0.0792,
        0.2248, 0.8627, 0.5198, 0.5430, 0.7700, 0.6517, 0.8391, 0.7820, 0.7338,
        0.7757, 0.6841], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 43, 191, 330, 460, 538, 158, 111, 428, 706, 541, 125, 343, 329, 190,
        264, 142, 182, 213, 186, 244], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 16-----------
Real SNR = tensor([16.6094, 12.2540, 16.0628, 14.0630, 17.8265, 17.7326, 12.8361, 13.8812,
        15.6533, 14.0446, 17.2568, 15.8024, 12.1656, 16.6401, 15.4205, 13.2038,
        16.2213,  7.9965, 17.6301, 17.4000], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.3264+3.2071e-08j,  2.2758+9.2222e-09j,  5.6945+5.8907e-08j,
         0.3284-1.5955e-09j,  8.3997-1.0274e-07j,  1.8539+2.7185e-08j,
         2.8880+8.2231e-08j,  0.2614+1.8331e-08j,  3.1339-2.2571e-08j,
         4.5243-2.9504e-08j, 14.7942-3.1064e-08j,  6.0754-0.0000e+00j,
         1.7671-2.1371e-08j,  0.7837+1.3209e-09j,  3.6697+1.8925e-09j,
         0.2848-6.9138e-09j,  7.0236+1.6464e-07j,  0.3865-4.2275e-09j,
         4.0799-1.6616e-07j,  1.1295-1.7881e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.6340394020080566-8.458076017348048e-09j)
torch.linalg.det(H.mH@H) = tensor([1.6719+2.1067e-08j, 0.5520+2.8531e-09j, 1.5670-2.0194e-08j,
        0.5116-5.9232e-10j, 8.3198-8.8705e-08j, 5.8532-3.1711e-08j,
        0.8896+2.9802e-08j, 0.1037+7.8743e-09j, 3.4334+4.3097e-08j,
        2.7430-3.0978e-09j, 8.6814-4.7684e-07j, 1.0693-0.0000e+00j,
        1.9872-5.5018e-08j, 1.2543+1.1262e-08j, 3.1347+1.3751e-09j,
        0.2199-1.4901e-08j, 3.3345+1.1563e-08j, 0.2518+3.7206e-09j,
        4.0361-1.9054e-07j, 1.7376+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.5676019191741943-3.446899654591107e-08j)
SINR torch.Size([20]) = tensor([10.4600,  5.1506,  8.7256, -1.6286,  8.1758,  3.2763,  6.2025, -1.1096,
         9.3970,  8.7090, 12.0882,  5.3008,  7.0161,  5.2569, 12.2013,  4.2187,
        10.8947,  2.9450,  8.6053,  7.0493], device='cuda:0')
SINR mean = 6.646739959716797
E[H^H] = 1e-07
E_MSE (Error Power) = 0.4011654555797577
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9175, 0.7660, 0.8818, 0.4073, 0.8679, 0.6801, 0.8066, 0.4365, 0.8969,
        0.8814, 0.9418, 0.7722, 0.8342, 0.7704, 0.9432, 0.7254, 0.9247, 0.6633,
        0.8788, 0.8352], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 81, 192, 110, 411, 121, 247, 165, 393,  98, 111,  60, 188, 146, 190,
         58, 219,  75, 257, 113, 145], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 17-----------
Real SNR = tensor([17.0295, 16.9514, 13.6313, 19.0397, 11.5086, 14.3520, 21.7804, 13.5982,
        11.7826, 15.9867, 11.2372, 15.5538, 14.8548, 13.2769, 13.1945, 15.2653,
        16.4634, 16.9080, 15.8451, 14.0671], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.4454-9.2409e-08j, 1.6806+1.5210e-08j, 1.5041+3.3441e-09j,
        0.8573+8.0466e-07j, 0.1746-2.7985e-09j, 0.1501-1.0431e-07j,
        9.6873-6.0100e-08j, 0.3730-3.7253e-08j, 0.2672+2.8744e-09j,
        2.0772-0.0000e+00j, 0.3593-1.8987e-09j, 1.3294-1.7735e-08j,
        0.7474-3.7500e-08j, 0.9426+2.6580e-08j, 0.0345+7.9232e-09j,
        1.3686-2.7003e-08j, 2.0267-6.1098e-09j, 0.2000-1.2003e-09j,
        0.5470-7.4506e-09j, 0.6471+1.6996e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.5209652185440063+2.4091169947837443e-08j)
torch.linalg.det(H.mH@H) = tensor([3.8155-3.1744e-08j, 1.4585-1.8242e-09j, 1.6393+1.0862e-08j,
        0.9340-4.7684e-07j, 0.0492+1.0228e-08j, 0.1608+2.6077e-08j,
        5.4540-1.1114e-07j, 0.7130+5.9605e-08j, 0.0892+2.2942e-09j,
        1.6577+8.9407e-08j, 0.1927-2.4974e-09j, 2.8166-3.3447e-08j,
        0.1968+1.0226e-08j, 0.6425+2.1444e-08j, 0.0117+1.6204e-09j,
        2.1715-1.2669e-10j, 2.3658+3.6153e-08j, 0.4119-1.3999e-08j,
        0.8381+3.8889e-08j, 0.4193+2.8815e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3019065856933594-1.6799690527591338e-08j)
SINR torch.Size([20]) = tensor([12.4569,  3.5323,  7.9656,  1.3441,  3.2723, -4.6798, 10.3555, -0.4175,
         2.9799,  6.5865,  2.0441,  7.7179,  5.5052,  8.7964, -1.2163,  5.3373,
        10.9564,  1.1286,  5.7047,  9.1664], device='cuda:0')
SINR mean = 4.926835536956787
E[H^H] = 1e-07
E_MSE (Error Power) = 0.677909791469574
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9463, 0.6928, 0.8623, 0.5768, 0.6799, 0.2540, 0.9156, 0.4760, 0.6651,
        0.8200, 0.6155, 0.8553, 0.7803, 0.8834, 0.4304, 0.7736, 0.9257, 0.5646,
        0.7881, 0.8919], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 56, 239, 125, 309, 247, 518,  83, 369, 256, 156, 286, 131, 183, 109,
        397, 187,  74, 316, 178, 102], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 18-----------
Real SNR = tensor([15.0836, 15.1590, 17.2533, 17.5123, 16.8402, 14.9519, 19.3250, 16.0778,
        17.8274, 14.6547, 16.8778, 17.2726, 14.3409, 14.6534, 16.0847, 20.1704,
        18.9768, 17.3264, 19.4415, 13.4096], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.6788-3.6310e-08j, 1.3966+2.1124e-08j, 0.4618-2.0273e-08j,
        0.6435-0.0000e+00j, 1.8467+2.9802e-08j, 1.0898+2.8034e-08j,
        6.5434-1.8919e-08j, 0.9770+8.9407e-08j, 1.1946-5.2080e-08j,
        1.0800-4.9570e-09j, 0.9087+5.9605e-08j, 8.6614-3.8893e-07j,
        2.2504+1.5707e-08j, 0.3762-1.3461e-08j, 0.1405+1.0122e-08j,
        7.7144+3.8721e-09j, 0.6684-7.4506e-08j, 1.2862-3.2244e-08j,
        9.1715-2.6916e-07j, 0.3487-4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.3719375133514404-3.4893492539822546e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.2328-4.4703e-08j,  0.5796-2.9802e-08j,  0.4218-1.4484e-08j,
         0.4176-7.4506e-09j,  1.9462-1.5742e-08j,  0.8052-1.2013e-08j,
         7.8111+3.3563e-10j,  0.6026+2.9802e-08j,  0.6096+4.7099e-08j,
         0.8551+1.6018e-08j,  2.7356+8.1839e-09j,  8.0746+1.3332e-08j,
         1.4549-1.5635e-08j,  0.5240-4.7422e-09j,  0.0925-7.7758e-09j,
         6.9264-2.6057e-07j,  0.7076-2.3842e-07j,  0.3468-2.9097e-08j,
        11.5477+1.5136e-07j,  0.0565+3.2596e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.337404251098633-1.9085467428681113e-08j)
SINR torch.Size([20]) = tensor([ 6.1943,  3.4780,  8.0361,  2.4271,  9.5781,  9.7734, 13.5698,  6.4711,
         6.7619,  7.3648,  2.0056,  8.6128, 11.5045,  5.0825, -1.6682, 10.9500,
         3.9562,  9.3590, 10.7916,  4.3499], device='cuda:0')
SINR mean = 6.929917812347412
E[H^H] = 1e-07
E_MSE (Error Power) = 0.3314483165740967
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8063, 0.6902, 0.8642, 0.6362, 0.9007, 0.9047, 0.9579, 0.8161, 0.8259,
        0.8450, 0.6134, 0.8790, 0.9340, 0.7632, 0.4051, 0.9256, 0.7132, 0.8961,
        0.9231, 0.7314], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([165, 240, 124, 273,  95,  92,  44, 159, 152, 138, 287, 113,  67, 194,
        413,  74, 226,  99,  76, 215], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 19-----------
Real SNR = tensor([19.6595, 19.9867, 22.2556, 19.4902, 21.3591, 16.7877, 17.0710, 20.0878,
        20.2240, 20.1714, 18.6539, 18.4052, 18.4940, 22.9689, 12.6315, 16.9933,
        14.5260, 16.4835, 17.7327, 21.7945], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.5251+1.8103e-08j,  2.0686+1.6641e-07j, 11.4491-2.4374e-07j,
         3.0891-1.7411e-07j,  1.7911-2.8848e-07j,  1.9587-8.7106e-09j,
         0.3232-2.3714e-08j,  5.3445+7.8967e-08j,  2.1715-4.9554e-08j,
         1.5082+1.4901e-07j,  0.8320-5.7140e-08j,  1.4611+1.7128e-08j,
         1.3895-3.3075e-08j,  6.0281+1.0094e-07j,  0.0898-0.0000e+00j,
         1.0604-9.0026e-09j,  0.0763+1.1448e-08j,  0.8667-1.7027e-08j,
         0.9878-5.9605e-08j, 21.4879-6.7434e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.3754355907440186-5.482450760041502e-08j)
torch.linalg.det(H.mH@H) = tensor([ 4.7262-5.5666e-08j,  2.1200+3.4787e-08j, 14.5125+3.9793e-07j,
         3.9481-5.3478e-08j,  2.4405+2.8456e-07j,  2.5377+2.5777e-08j,
         0.2377-1.8924e-08j,  3.5223-2.4291e-09j,  4.0204-4.1208e-08j,
         1.2955+3.5763e-07j,  1.2690+4.6991e-08j,  3.0918-1.5239e-08j,
         1.8690-4.1497e-08j,  4.1033+4.0196e-08j,  0.0275-7.4506e-09j,
         1.5204-8.2608e-09j,  0.1441-1.5132e-08j,  1.5680-1.8589e-09j,
         2.1564+3.2079e-08j, 15.5998+3.3658e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.535507917404175+6.476927438825442e-08j)
SINR torch.Size([20]) = tensor([ 9.4523,  6.8745, 12.5591,  8.5338,  5.7154, 12.2533,  4.5975, 11.1290,
         8.8583,  7.2649,  6.6907,  8.3382,  8.7084, 10.4333,  1.2430,  8.4464,
        -1.8782,  8.2333,  4.8924, 13.7794], device='cuda:0')
SINR mean = 7.806246280670166
E[H^H] = 1e-07
E_MSE (Error Power) = 0.29142746329307556
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8981, 0.8296, 0.9474, 0.8771, 0.7885, 0.9438, 0.7424, 0.9284, 0.8849,
        0.8419, 0.8236, 0.8721, 0.8813, 0.9170, 0.5711, 0.8749, 0.3935, 0.8694,
        0.7552, 0.9598], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 97, 149,  54, 114, 178,  58, 208,  72, 108, 140, 154, 118, 111,  82,
        312, 116, 420, 120, 200,  43], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 20-----------
Real SNR = tensor([15.7474, 14.4817, 21.2593, 20.6213, 19.1081, 18.1105, 19.9459, 18.6290,
        18.0968, 20.9548, 21.6926, 19.6065, 15.9968, 20.2495, 18.0637, 19.3342,
        19.5206, 19.1894, 13.1158, 19.8026], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.5460+1.5690e-08j,  0.1821-4.8791e-09j,  0.7929+3.2783e-07j,
         0.2712-8.9407e-08j,  0.2180+1.4901e-08j,  0.8760-1.0404e-08j,
         0.8297-1.5646e-07j,  2.3231+1.1921e-07j,  2.4985-1.5542e-08j,
         2.2354-5.9605e-08j, 16.8894+1.6982e-08j,  5.3096+1.0663e-07j,
         1.6311-9.4432e-09j,  1.6277-1.5277e-07j,  3.2190+1.4941e-08j,
         1.5354-9.3201e-08j,  0.0231-1.7695e-08j,  0.2441-1.0793e-07j,
         0.2998-2.9802e-08j,  1.6180+6.5199e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.2085070610046387-3.288488370500886e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.8287+4.0658e-09j,  0.2980-1.1931e-10j,  1.6924+7.1526e-07j,
         0.7513+3.8743e-07j,  0.0555+3.6322e-08j,  0.9841-2.0684e-08j,
         1.2211-1.4901e-07j,  2.4690-1.1921e-07j,  2.0723+3.2809e-09j,
         2.5324+8.3447e-07j, 13.1260+2.5092e-08j,  5.4410-5.1772e-08j,
         1.5814-2.6308e-09j,  3.0066-3.5789e-08j,  2.5817+3.6647e-08j,
         2.2221+3.3697e-08j,  0.1725+2.6077e-07j,  0.5877-1.0380e-07j,
         0.0399+2.9802e-08j,  2.5969-1.8233e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.213033437728882+8.507407045499349e-08j)
SINR torch.Size([20]) = tensor([ 8.8015,  2.0471,  2.1674,  1.5661,  0.1973, 12.1250,  1.3424,  8.1307,
        13.7070,  7.0515, 17.1178, 14.6772, 13.6538,  9.0105, 11.7111,  6.6865,
        -9.3283, -0.7802,  4.1961,  7.9112], device='cuda:0')
SINR mean = 6.5995988845825195
E[H^H] = 1e-07
E_MSE (Error Power) = 0.8399447798728943
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8836, 0.6157, 0.6222, 0.5892, 0.5114, 0.9422, 0.5767, 0.8667, 0.9592,
        0.8353, 0.9810, 0.9671, 0.9587, 0.8884, 0.9368, 0.8234, 0.1045, 0.4552,
        0.7244, 0.8608], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([109, 285, 282, 301, 348,  59, 309, 122,  43, 145,  21,  35,  44, 105,
         64, 154, 667, 382, 219, 126], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 21-----------
Real SNR = tensor([15.4056, 18.8905, 22.7272, 21.8081, 20.9730, 16.4714, 20.6711, 22.9433,
        23.2334, 22.8805, 23.5661, 16.7310, 18.1671, 20.4027, 20.9482, 19.2246,
        18.9624, 17.8086, 20.2436, 20.5527], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.4174e-01-8.9407e-08j, 4.5868e-01-3.3461e-08j, 4.7921e+00-5.9605e-08j,
        9.0427e-01+1.0319e-07j, 1.0800e+00-8.7026e-08j, 6.9510e-01+1.4901e-07j,
        7.6694e-01-5.2057e-08j, 3.4694e+00+1.3411e-07j, 2.2635e+00+2.3842e-07j,
        1.2811e+00-1.1921e-07j, 1.2608e+01+8.6402e-08j, 5.7650e-01-0.0000e+00j,
        8.1652e-01+1.3493e-08j, 1.7706e-03-8.0559e-08j, 5.9202e+00-8.4235e-08j,
        1.1506e+00-2.9802e-08j, 1.0357e+00+8.0536e-09j, 8.4307e-01+1.4493e-09j,
        2.4182e+00+1.7988e-08j, 3.4853e-01-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.0886008739471436+5.092859911570713e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.0987-7.4506e-09j,  0.3495-1.9974e-08j,  3.6458+1.4901e-07j,
         0.9963-6.6234e-09j,  1.4259-5.2139e-08j,  0.8413-8.9407e-08j,
         0.3389+2.5689e-08j,  3.3306+1.1921e-07j,  2.9759+3.3528e-08j,
         1.8249-8.3460e-08j, 15.8307+3.3958e-07j,  0.7523-5.9605e-08j,
         0.6156+4.4703e-08j,  0.0666-2.6077e-08j,  3.2770-7.0630e-09j,
         0.7850-8.9407e-08j,  1.2228-1.9296e-08j,  0.9568-3.2325e-09j,
         2.2460+3.5299e-08j,  0.1346+1.0990e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0857632160186768+1.965936569092719e-08j)
SINR torch.Size([20]) = tensor([  7.6628,   7.4004,  12.4901,   7.1379,   5.0028,  11.9343,   9.4127,
         10.7606,   4.3443,   9.1549,  15.3731,   9.9881,   9.9509, -14.8351,
         15.7881,  11.8756,   4.8705,   9.2561,  12.9228,   2.3584],
       device='cuda:0')
SINR mean = 8.142470359802246
E[H^H] = 1e-07
E_MSE (Error Power) = 1.6155016422271729
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8538, 0.8461, 0.9466, 0.8380, 0.7599, 0.9398, 0.8973, 0.9226, 0.7311,
        0.8917, 0.9718, 0.9089, 0.9082, 0.0318, 0.9743, 0.9390, 0.7543, 0.8939,
        0.9515, 0.6325], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([132, 137,  55, 143, 196,  61,  98,  77, 215, 103,  30,  88,  89, 817,
         28,  62, 200, 101,  51, 275], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 22-----------
Real SNR = tensor([22.7762, 19.4204, 20.9251, 21.0588, 18.4715, 22.4074, 21.6871, 20.3750,
        19.0798, 19.4995, 18.0140, 24.4036, 18.9387, 21.0556, 19.2650, 21.5274,
        18.1566, 20.8893, 23.0127, 22.5438], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.7605-1.1955e-08j, 1.6930+1.5793e-08j, 3.0750+5.7138e-08j,
        4.9097+6.8839e-08j, 0.8953-8.9407e-08j, 1.5631+1.7881e-07j,
        3.6528-2.3842e-07j, 1.5281-3.2377e-08j, 0.3574-3.9313e-09j,
        0.3491+8.0425e-08j, 1.2634-2.1540e-08j, 2.9689+2.0317e-08j,
        0.6374-0.0000e+00j, 4.1689-1.3239e-08j, 4.7083-7.7047e-08j,
        1.5726+3.2048e-08j, 0.4175+4.2833e-09j, 0.7779-1.0449e-08j,
        4.0085-4.7014e-08j, 1.9714-5.1224e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1639389991760254-6.947147745961502e-09j)
torch.linalg.det(H.mH@H) = tensor([2.6962-2.3425e-08j, 1.1968-2.5199e-09j, 1.8475+1.4574e-09j,
        3.2182-4.1140e-09j, 1.1782-1.9158e-09j, 1.6947+4.4703e-08j,
        3.8093-1.1921e-07j, 1.2381-4.6846e-08j, 0.5860-3.6073e-09j,
        0.4116+1.3411e-07j, 0.9807-2.5236e-10j, 3.5754-1.6764e-07j,
        2.3123-5.8321e-08j, 4.7047+8.0243e-08j, 2.8341+3.7767e-08j,
        1.4281+2.3797e-08j, 0.4802-4.6804e-09j, 0.8730-7.6391e-09j,
        4.2684+2.8711e-07j, 1.2395+4.8649e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0286552906036377+1.0883621115453934e-08j)
SINR torch.Size([20]) = tensor([11.9997, 12.4368, 12.8194, 15.5479,  8.4123, 12.1681, 12.3387,  9.1692,
         6.7995,  2.7035, 14.9994, 15.9757,  1.5592, 13.5322, 15.7825, 12.6871,
         8.8499, 12.7743, 13.0084,  8.0983], device='cuda:0')
SINR mean = 11.083090782165527
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1389717310667038
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9406, 0.9460, 0.9503, 0.9729, 0.8740, 0.9428, 0.9449, 0.8920, 0.8272,
        0.6508, 0.9693, 0.9754, 0.5888, 0.9575, 0.9743, 0.9489, 0.8847, 0.9499,
        0.9524, 0.8658], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 61,  56,  52,  29, 116,  59,  57, 102, 151, 264,  33,  27, 302,  45,
         28,  53, 108,  52,  50, 123], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 23-----------
Real SNR = tensor([21.8483, 18.8813, 24.2497, 20.1673, 24.8718, 20.5602, 19.9410, 19.4960,
        15.5315, 19.3529, 21.3666, 18.4769, 22.1235, 22.9354, 23.0471, 19.4166,
        19.3653, 23.3576, 21.9334, 21.5793], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.9966+1.9564e-08j, 0.2554+1.3864e-08j, 1.3260-2.5089e-07j,
        0.0869+3.7253e-09j, 3.2936+2.0327e-07j, 1.4381-8.3428e-08j,
        0.9187-1.8586e-08j, 0.9135+7.4506e-09j, 0.2277-3.3921e-09j,
        0.1349+2.3222e-08j, 0.4597-2.4610e-08j, 0.2619-5.2154e-08j,
        1.4619-4.1723e-08j, 1.1097-7.9524e-09j, 0.4151-2.9802e-08j,
        1.3617+2.7880e-08j, 0.1480-0.0000e+00j, 0.3752-1.1431e-07j,
        0.4991+4.6525e-08j, 2.7778+3.3712e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(0.9730760455131531-1.2381564218344465e-08j)
torch.linalg.det(H.mH@H) = tensor([1.6912+5.9605e-08j, 0.1638+3.2690e-09j, 0.7967-9.4197e-08j,
        0.1589+2.2352e-08j, 3.7182+1.5746e-08j, 0.8961-3.2424e-08j,
        0.4641-6.1437e-09j, 1.0551-1.2494e-08j, 0.1326-2.8597e-09j,
        0.1372+1.8634e-08j, 0.4589+4.7345e-09j, 0.1924+2.2352e-08j,
        1.5223+4.5015e-08j, 1.1205+1.5065e-08j, 0.3786-1.9372e-07j,
        0.9934+3.4896e-08j, 0.0511-4.6566e-09j, 0.4802-3.5808e-07j,
        0.6208-8.0773e-09j, 2.9167+1.9280e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.8974331021308899-2.2584808689884994e-08j)
SINR torch.Size([20]) = tensor([12.0271,  9.5631, 11.1425,  4.2801, 17.1088, 10.6238,  9.3559, 13.9366,
         9.6774,  6.4133, 10.2238,  9.9610, 15.1644, 11.1054,  2.7803, 14.4343,
         4.3808,  1.6613,  8.2616, 17.5571], device='cuda:0')
SINR mean = 9.982935905456543
E[H^H] = 1e-07
E_MSE (Error Power) = 0.18986451625823975
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9410, 0.9004, 0.9286, 0.7282, 0.9809, 0.9203, 0.8961, 0.9612, 0.9028,
        0.8141, 0.9133, 0.9083, 0.9705, 0.9281, 0.6548, 0.9652, 0.7328, 0.5945,
        0.8702, 0.9828], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 60,  95,  72, 217,  21,  79,  99,  41,  94, 160,  85,  89,  32,  72,
        262,  37, 214, 298, 119,  19], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 24-----------
Real SNR = tensor([23.9565, 22.9662, 21.4527, 25.6288, 21.2640, 21.1447, 21.3979, 25.8687,
        20.6560, 22.8469, 22.2848, 26.5596, 24.6128, 19.5251, 20.3069, 20.8909,
        23.5519, 21.2193, 17.6185, 23.1563], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.4617+6.1003e-08j, 0.3605-5.4392e-09j, 0.7781-0.0000e+00j,
        5.0029+1.3121e-07j, 0.9726+6.3937e-09j, 1.9880-2.3820e-08j,
        0.1175-4.9711e-09j, 4.1103+2.3842e-07j, 0.4407-1.4901e-08j,
        1.9825+2.3842e-07j, 4.2921+6.3280e-08j, 2.6823-3.0797e-07j,
        3.1637-5.8906e-09j, 0.4808+1.0310e-08j, 0.4015+4.5484e-08j,
        0.5369-0.0000e+00j, 1.0397+2.4894e-08j, 0.7338+2.0862e-07j,
        0.0394+1.6024e-09j, 2.4096-8.7568e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.799730658531189+2.89539769937619e-08j)
torch.linalg.det(H.mH@H) = tensor([3.8681-1.3062e-09j, 0.5034+2.6801e-09j, 0.5657-1.4901e-08j,
        5.4976-3.4675e-10j, 1.2089+1.2253e-08j, 2.2271+3.6336e-08j,
        0.1860+1.4796e-08j, 4.6139+3.5763e-07j, 0.7275+1.3718e-08j,
        2.2428-4.3313e-08j, 3.8148+4.3832e-08j, 2.7069+4.3464e-08j,
        3.5123+5.8831e-08j, 0.3298+1.4901e-08j, 0.6309-2.8908e-08j,
        0.9121-1.1048e-08j, 0.9546+8.1022e-08j, 0.4758-1.3411e-07j,
        0.0211+1.9721e-09j, 2.0752-4.4323e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8537282943725586+2.0158800850822445e-08j)
SINR torch.Size([20]) = tensor([18.2716, 11.5176, 13.8922, 17.2130, 11.4447, 13.8000,  7.7591, 15.1886,
         7.2555, 16.8399, 16.4500, 14.2479, 14.5628, 10.7673, 11.8406,  9.4345,
        15.0235,  7.8166,  2.9900, 14.9975], device='cuda:0')
SINR mean = 12.565649032592773
E[H^H] = 1e-07
E_MSE (Error Power) = 0.09893569350242615
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9853, 0.9341, 0.9608, 0.9814, 0.9331, 0.9600, 0.8565, 0.9706, 0.8417,
        0.9797, 0.9779, 0.9638, 0.9662, 0.9227, 0.9386, 0.8977, 0.9695, 0.8581,
        0.6656, 0.9693], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 16,  67,  42,  20,  68,  42, 130,  32, 141,  22,  24,  39,  36,  77,
         63,  98,  33, 128, 255,  33], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 25-----------
Real SNR = tensor([27.0610, 27.5413, 24.5664, 24.4290, 22.1512, 22.0432, 24.8196, 21.0210,
        18.9420, 27.4601, 24.1913, 24.5507, 22.9533, 24.2851, 22.9048, 21.4840,
        24.6735, 25.1037, 26.8965, 26.4622], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.1563-2.2145e-07j, 0.2111+3.3799e-08j, 6.0343+8.3338e-08j,
        1.2298-8.7194e-08j, 1.3449+6.3200e-09j, 0.2698+5.4719e-09j,
        0.4136+7.4506e-08j, 0.6906-4.6878e-09j, 0.1549-0.0000e+00j,
        1.6672-1.3588e-08j, 3.1281-9.9332e-09j, 0.7666+2.1689e-07j,
        0.2549-6.7276e-09j, 1.2011+7.4506e-08j, 1.4133+3.0612e-08j,
        1.0053-7.5525e-09j, 2.7853+8.1680e-10j, 2.8541+8.0284e-08j,
        1.0147+2.9400e-09j, 1.9441-1.2114e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7269935607910156+6.860926937690692e-09j)
torch.linalg.det(H.mH@H) = tensor([5.8741+1.9493e-07j, 0.4313-2.2438e-08j, 5.1432+9.3686e-09j,
        1.4080-1.1333e-08j, 1.3635-5.3491e-09j, 0.1965+8.4989e-10j,
        0.7829+2.9802e-08j, 1.0839-2.1335e-09j, 0.1208+1.1176e-08j,
        0.9954+8.3744e-09j, 2.8441-2.6009e-08j, 0.6184-8.9989e-08j,
        0.2682+1.5850e-09j, 1.3327-1.3411e-07j, 1.2041+1.8693e-08j,
        1.0046-7.4061e-09j, 1.9529-1.1571e-09j, 2.7469-2.4544e-08j,
        0.8640+1.0411e-07j, 1.2005+3.4334e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5717917680740356+1.98882172952608e-08j)
SINR torch.Size([20]) = tensor([17.5834,  2.4572, 19.9730, 14.9803, 17.4852, 11.7861,  5.4964, 13.0951,
         9.0762, 12.9984, 19.0615, 12.3232, 10.3517,  9.5521, 13.9701, 10.6029,
        15.4366, 19.0834, 12.6030, 11.0492], device='cuda:0')
SINR mean = 12.948251724243164
E[H^H] = 1e-07
E_MSE (Error Power) = 0.10235588997602463
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9829, 0.6378, 0.9900, 0.9692, 0.9825, 0.9378, 0.7800, 0.9533, 0.8899,
        0.9523, 0.9877, 0.9447, 0.9156, 0.9002, 0.9615, 0.9199, 0.9722, 0.9878,
        0.9479, 0.9272], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 19, 272,  11,  33,  19,  63, 183,  49, 104,  50,  13,  57,  83,  96,
         41,  79,  30,  13,  54,  73], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 26-----------
Real SNR = tensor([22.1402, 27.3185, 25.7823, 24.6980, 28.3989, 21.1071, 28.3363, 25.5452,
        28.4589, 27.0022, 21.8542, 27.7245, 23.8898, 26.8459, 23.4556, 27.5511,
        27.7549, 28.4185, 23.2359, 21.1399], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4384+2.9802e-08j,  1.8225+8.7034e-08j,  1.6007-4.2000e-08j,
         2.8197-2.1677e-09j, 10.9009-1.6009e-07j,  0.4509-2.2711e-08j,
         5.2594-3.5868e-08j,  0.4286+5.7718e-09j, 10.6072+2.1949e-07j,
         3.4637+1.1921e-07j,  0.8189-3.2641e-08j,  0.2895+4.5546e-08j,
         1.8410+1.4681e-08j,  3.5008-3.0739e-07j,  2.5481+1.2543e-07j,
         0.6348+2.9802e-08j,  0.6833-3.5765e-08j,  7.4306-2.6822e-07j,
         1.1714-1.4487e-07j,  0.5798-6.3748e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8645167350769043-1.906667357332026e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.4030-0.0000e+00j,  1.6985-1.5548e-07j,  1.8154-2.6006e-08j,
         2.4756-1.8379e-08j, 10.6713+5.6099e-08j,  0.3800+1.6524e-08j,
         5.3522+6.1189e-08j,  0.1832-2.1195e-08j,  9.6721-1.5340e-07j,
         3.0531-3.5763e-07j,  0.6081+1.6225e-08j,  0.6897+2.9523e-08j,
         1.5179+1.5526e-08j,  4.2160-2.2924e-08j,  2.1263-4.5629e-08j,
         0.6144+3.8743e-07j,  1.2530+6.1227e-08j,  6.2611-2.9802e-08j,
         1.3986+5.9605e-08j,  0.2628+5.8811e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7326200008392334-6.060620005854389e-09j)
SINR torch.Size([20]) = tensor([14.2688, 18.6180, 17.8379, 19.6863, 16.3313, 10.5227, 17.0923, 10.6621,
        22.0357, 18.0556, 15.4822,  6.8407, 18.3883, 15.1184, 20.4494, 13.2547,
        11.9402, 15.2843, 11.1981, 11.4786], device='cuda:0')
SINR mean = 15.227276802062988
E[H^H] = 1e-07
E_MSE (Error Power) = 0.04778730496764183
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9639, 0.9864, 0.9838, 0.9894, 0.9773, 0.9186, 0.9808, 0.9209, 0.9938,
        0.9846, 0.9725, 0.8285, 0.9857, 0.9701, 0.9911, 0.9549, 0.9399, 0.9712,
        0.9295, 0.9336], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 38,  15,  18,  12,  25,  80,  21,  78,   7,  17,  30, 150,  16,  32,
         10,  47,  61,  31,  71,  67], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 27-----------
Real SNR = tensor([31.2096, 27.2099, 25.4005, 25.6902, 29.8168, 24.5739, 27.3549, 22.0011,
        24.5772, 25.1899, 23.8548, 29.3395, 27.4543, 27.6759, 25.6027, 27.3056,
        26.1485, 24.6576, 24.9066, 22.5773], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([31.3203-8.8818e-08j,  2.1258-3.7011e-08j,  4.4417+1.4576e-08j,
         1.4675+2.8592e-08j,  3.3827-2.8179e-07j,  0.9178-0.0000e+00j,
         2.9373+9.7155e-09j,  0.5603+1.4901e-08j,  0.1441+1.1176e-07j,
         0.8579+1.1464e-08j,  1.3905-7.4010e-08j, 16.9713+1.5703e-07j,
         1.7358+4.7684e-07j,  0.8870-5.3703e-08j,  0.2777-6.4013e-09j,
         1.4231+3.3524e-08j,  2.1711+3.9186e-08j,  1.1770+2.2047e-08j,
         1.5838+2.1091e-08j,  0.0325-7.0650e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.790259599685669+1.959591777733749e-08j)
torch.linalg.det(H.mH@H) = tensor([2.9578e+01+2.5143e-07j, 2.1916e+00-4.8580e-09j, 3.4316e+00-2.4320e-09j,
        1.8694e+00-4.0981e-09j, 3.2059e+00-5.5601e-07j, 8.5510e-01+8.9407e-08j,
        2.6783e+00-6.6876e-08j, 3.2543e-01+7.5670e-09j, 2.0872e-01-5.9605e-08j,
        6.2568e-01+5.0083e-08j, 1.6356e+00+2.3579e-09j, 1.6356e+01-1.3705e-07j,
        1.6234e+00+5.9605e-08j, 5.3437e-01-2.7656e-08j, 4.3268e-01+1.0089e-08j,
        1.1344e+00+6.6743e-08j, 1.9904e+00-2.5307e-08j, 1.1113e+00-9.7797e-09j,
        9.9092e-01-1.4901e-08j, 1.3716e-02-1.2401e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.5396363735198975-1.9184739130650996e-08j)
SINR torch.Size([20]) = tensor([26.8681, 19.5487, 19.7255, 17.3329, 15.3807, 15.2749, 17.9033, 11.0803,
        10.2158, 11.4258, 20.3863, 25.4941, 17.8499, 11.7058, 14.9096, 14.7218,
        16.4983, 15.6755, 12.4506,  2.9165], device='cuda:0')
SINR mean = 15.86821174621582
E[H^H] = 1e-07
E_MSE (Error Power) = 0.06713538616895676
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9979, 0.9890, 0.9895, 0.9819, 0.9718, 0.9712, 0.9841, 0.9277, 0.9131,
        0.9328, 0.9909, 0.9972, 0.9839, 0.9368, 0.9687, 0.9674, 0.9781, 0.9736,
        0.9462, 0.6619], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  2,  12,  12,  20,  30,  31,  18,  72,  85,  68,  10,   3,  18,  64,
         34,  35,  24,  29,  56, 258], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 28-----------
Real SNR = tensor([30.8058, 27.0517, 28.5870, 31.5569, 22.5862, 27.8753, 27.1269, 26.2583,
        26.8305, 29.7753, 25.9285, 26.6998, 28.9982, 29.0326, 22.0871, 28.4150,
        28.5924, 29.9717, 27.2257, 25.1513], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 5.7267-0.0000e+00j,  0.2629-2.9802e-08j,  2.7580-2.0178e-08j,
        14.5322-9.7917e-08j,  0.2567+8.6775e-09j,  3.9274+1.2917e-07j,
         0.1098-1.1047e-08j,  2.4307+8.9558e-08j,  2.6373+1.5738e-08j,
         2.1080-3.3882e-07j,  2.3426+9.7609e-10j,  1.6770-3.5098e-08j,
         5.3848-1.1639e-07j,  4.0276+1.5897e-07j,  1.1621-6.5517e-09j,
         3.0527+1.0227e-07j,  1.4202+3.4182e-08j,  5.0523+5.3556e-07j,
         0.8495+4.1072e-08j,  0.1175+1.1176e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.9918010234832764+2.3577042540523507e-08j)
torch.linalg.det(H.mH@H) = tensor([ 8.4893+1.4135e-07j,  0.4113+3.7253e-09j,  2.4632-5.9605e-08j,
        15.7362+2.0015e-07j,  0.1913+2.9898e-09j,  4.0179-9.0275e-08j,
         0.1382-3.1521e-08j,  1.9770+1.8413e-08j,  2.7372+3.2733e-08j,
         1.6394+3.7144e-08j,  2.2853-7.0804e-09j,  1.6357+3.2256e-08j,
         5.8350+2.7560e-07j,  3.4091-3.1171e-08j,  1.3423+1.5834e-08j,
         3.1527+1.3537e-08j,  1.6354+3.0242e-08j,  4.8684-4.1310e-07j,
         1.0707+6.4547e-08j,  0.1474-1.1176e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.1591410636901855+1.1229793095424156e-08j)
SINR torch.Size([20]) = tensor([14.8402,  9.1867, 19.0778, 23.0414, 14.2830, 15.5448,  7.7319, 19.6402,
        17.3872, 15.5331, 21.6348, 20.4865, 18.4128, 22.7719, 18.1166, 16.6037,
        20.2731, 18.2638, 11.9791, 10.3710], device='cuda:0')
SINR mean = 16.758975982666016
E[H^H] = 1e-07
E_MSE (Error Power) = 0.04289788007736206
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9682, 0.8924, 0.9878, 0.9951, 0.9640, 0.9729, 0.8557, 0.9893, 0.9821,
        0.9728, 0.9932, 0.9911, 0.9858, 0.9947, 0.9848, 0.9786, 0.9907, 0.9853,
        0.9404, 0.9159], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 34, 102,  13,   5,  38,  29, 130,  12,  20,  29,   7,  10,  16,   6,
         17,  23,  10,  16,  61,  83], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 29-----------
Real SNR = tensor([23.9346, 28.7823, 29.9952, 25.7910, 31.3741, 25.9866, 30.9002, 25.5891,
        27.2726, 26.0669, 29.9743, 31.0679, 23.2810, 26.5273, 25.7389, 29.3253,
        29.3269, 26.7016, 32.5305, 26.8816], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.6643+5.6791e-09j, 2.6364-1.2566e-07j, 2.9693+3.7945e-08j,
        1.1761+8.0552e-09j, 5.2622+2.9509e-08j, 0.3710-1.4901e-08j,
        4.2038-8.4854e-08j, 1.5185-1.7479e-09j, 2.2301+1.8351e-08j,
        0.3798+3.3370e-09j, 0.1722-1.9800e-07j, 2.8326+1.5595e-07j,
        0.1116-1.0516e-09j, 0.9752-1.9063e-09j, 0.9502+2.4954e-08j,
        2.5179-4.7266e-09j, 2.7849-3.9330e-08j, 0.3339-1.4074e-07j,
        5.8568+2.7165e-07j, 0.4275-3.9847e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.918717384338379-3.07396641474611e-09j)
torch.linalg.det(H.mH@H) = tensor([0.5061-8.1656e-09j, 3.3064+1.6269e-08j, 2.8946-1.0444e-07j,
        0.9104+2.6610e-08j, 5.1205+2.4779e-07j, 0.2713+7.4506e-08j,
        3.5687+8.7193e-08j, 1.3071-6.9740e-10j, 2.2925+5.4327e-08j,
        0.3094-5.7843e-09j, 0.0693+5.7742e-08j, 3.1534+1.3668e-08j,
        0.1281-6.7825e-09j, 0.9897+1.4947e-08j, 1.1211-1.0063e-08j,
        2.4162+4.6953e-08j, 2.4436-4.6443e-08j, 0.2135-1.0678e-07j,
        5.2953+2.0096e-07j, 0.5464-1.1409e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8431686162948608+2.753374417352461e-08j)
SINR torch.Size([20]) = tensor([13.3692, 16.3184, 21.9167, 15.6823, 22.0744, 13.2932, 20.0999, 19.6273,
        21.5841, 18.0539, 11.5011, 19.7456, 11.4116, 20.2004, 21.7153, 21.9995,
        16.2204, 12.1188, 22.5435, 13.5780], device='cuda:0')
SINR mean = 17.652681350708008
E[H^H] = 1e-07
E_MSE (Error Power) = 0.032188620418310165
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9560, 0.9772, 0.9936, 0.9737, 0.9938, 0.9552, 0.9903, 0.9892, 0.9931,
        0.9846, 0.9339, 0.9895, 0.9326, 0.9905, 0.9933, 0.9937, 0.9767, 0.9422,
        0.9945, 0.9580], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([46, 25,  7, 29,  7, 47, 11, 12,  7, 17, 67, 12, 68, 10,  7,  7, 25, 59,
         6, 44], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)

--- 処理中: 画像 41 から 60 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 40)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6306, 0.6925, 0.4886, 0.7032, 0.5710, 0.5101, 0.6843, 0.5062, 0.6585,
        1.1102, 0.7262, 0.7535, 0.6937, 0.3628, 1.0899, 0.4007, 0.6435, 0.4448,
        0.6772, 0.7563], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -7.8591,  -1.8074,  -6.4596,  -1.9061,  -4.0993,  -2.5972,  -6.8280,
         -7.1529,  -8.8758, -10.6702,  -7.7862,  -9.2849,  -8.7265,  -8.0855,
         -1.8887,  -9.1347,  -7.2485,  -7.2268,  -7.1159, -10.8789],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 182.2315+9.0894e-07j,  406.9274-1.9256e-06j,  150.4245-5.8084e-07j,
          46.9238+6.7666e-07j,   38.4644-4.7684e-06j,   44.8892+8.4860e-07j,
           5.4630-5.5634e-07j,  716.4550+4.1976e-05j,  237.6830+7.3260e-08j,
          67.5989-2.0449e-06j,  264.4882-3.2082e-07j,  766.4055+4.2921e-06j,
          61.5607+1.3351e-05j,  177.7079+1.7146e-08j,  668.8785-1.6423e-05j,
         199.0627+3.1362e-07j,  437.9669-6.6147e-06j, 1071.6616-3.9387e-05j,
         185.7732+2.0325e-07j,  825.8008-2.6022e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(327.8183288574219-6.281492801463173e-07j)
torch.linalg.det(H.mH@H) = tensor([ 1.7826+2.0890e-08j,  2.7891+9.4166e-08j,  0.6846-1.1921e-07j,
         5.8998+2.4224e-08j,  1.7437-1.1883e-07j, 10.2502+1.6074e-07j,
         0.1761-3.3908e-08j,  1.5736+6.0670e-09j,  0.0600-7.4506e-09j,
         0.8731-9.8025e-09j,  0.3885-7.4506e-09j,  0.0118+2.2244e-08j,
         0.2534+2.3012e-09j,  0.5995-8.5204e-09j,  1.6594+7.8754e-07j,
         0.1094-7.4506e-09j,  0.1683-2.6077e-08j,  0.4681-9.6399e-09j,
         1.0304-0.0000e+00j,  0.0690-9.3371e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5295261144638062+3.802517056783472e-08j)
SINR torch.Size([20]) = tensor([-1.6194e+00, -1.8120e+00, -1.9545e+00, -3.3664e+00, -7.5089e+00,
        -6.8127e+00, -1.2315e+01, -1.0928e+00, -1.4609e+00, -2.6024e+00,
        -1.2511e+00,  7.2098e-02, -7.1162e+00, -3.5991e+00,  4.3017e-03,
        -2.4598e+00, -4.0590e-01, -1.7730e+00, -1.3165e+00, -6.5752e-01],
       device='cuda:0')
SINR mean = -2.9523637294769287
E[H^H] = 1e-07
E_MSE (Error Power) = 2.870276689529419
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4078, 0.3972, 0.3894, 0.3154, 0.1507, 0.1724, 0.0554, 0.4374, 0.4167,
        0.3545, 0.4285, 0.5042, 0.1627, 0.3039, 0.5002, 0.3621, 0.4767, 0.3993,
        0.4248, 0.4622], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([411, 418, 423, 472, 611, 589, 752, 392, 405, 445, 398, 352, 599, 480,
        354, 440, 368, 416, 400, 377], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -4-----------
Real SNR = tensor([-6.4874, -8.2544, -7.5838, -1.5824, -5.3598, -5.0861, -2.8131, -3.3063,
        -4.9839, -3.8163, -8.1079, -8.0188, -6.6773, -3.6337, -8.4596, -4.3399,
        -2.7565, -2.9139, -1.6437, -9.8483], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 49.6096-6.8323e-07j, 359.8563+5.4947e-06j, 133.3404-0.0000e+00j,
        141.7875-0.0000e+00j, 491.5038-1.7803e-06j, 137.3652-1.0547e-06j,
        204.1669+7.6294e-06j, 861.7507+3.3933e-06j,  22.3178-3.5286e-05j,
         11.9736-2.3112e-07j,  23.0530+2.0935e-07j, 130.0613-3.1630e-07j,
        117.6949-2.5758e-06j, 718.1405-1.2185e-06j,   7.7991+1.6689e-06j,
        543.1741+8.0448e-07j, 101.2895-6.1362e-08j,  45.5596+3.2425e-05j,
        478.4317-2.6703e-05j, 834.7649+1.2997e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(270.6820068359375-2.644088397119049e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.0365+3.7253e-09j,  0.0118-1.3102e-08j,  0.2167+3.1634e-08j,
        10.9766+4.6952e-07j,  0.8576-9.3847e-09j,  1.7456-7.8617e-09j,
         4.5294-4.7524e-08j,  0.6066+1.6533e-08j,  0.1229-1.1575e-07j,
         2.5407+4.2833e-08j,  0.2842-7.4101e-09j,  0.4011+2.9802e-08j,
         0.1297+6.7206e-09j,  0.0661+1.6315e-08j,  0.0568-7.9810e-09j,
         1.7258-3.6573e-08j,  3.9152+5.8882e-08j,  6.5521+3.6905e-08j,
         3.4775-3.5763e-07j,  0.2278+5.5879e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9240334033966064+5.762167187839395e-09j)
SINR torch.Size([20]) = tensor([ -2.5182,  -1.5808,  -2.6574,  -2.8565,  -2.0181,  -1.8302,  -3.2812,
         -0.1598,  -9.3030,  -6.6897,  -4.5929,  -1.4219,  -3.0373,  -1.4906,
         -9.7448,   0.3815,  -0.3923, -10.2675,  -1.7145,  -0.7945],
       device='cuda:0')
SINR mean = -3.2984797954559326
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0118141174316406
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3590, 0.4100, 0.3516, 0.3413, 0.3859, 0.3962, 0.3196, 0.4908, 0.1051,
        0.1765, 0.2578, 0.4189, 0.3320, 0.4150, 0.0959, 0.5219, 0.4774, 0.0859,
        0.4026, 0.4544], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([443, 410, 447, 454, 425, 418, 469, 360, 667, 585, 515, 404, 461, 406,
        680, 341, 368, 695, 414, 382], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -3-----------
Real SNR = tensor([-1.6921, -4.1635, -3.1005, -6.1642, -1.7659, -6.4117, -2.7985, -3.5998,
        -4.6667, -5.5628, -3.2703, -2.4810, -5.2720, -1.7358, -6.8060, -1.1224,
        -4.4381, -4.3428, -7.3985, -3.2618], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 82.1931+9.9720e-08j,  51.8623-3.7059e-07j, 189.3003-0.0000e+00j,
         79.8607-0.0000e+00j,   9.3307+3.6193e-08j,  45.9722+1.3420e-05j,
        224.3760+1.4468e-05j, 368.4085+1.0211e-07j,  50.0467-3.9302e-07j,
         98.6469+2.8057e-06j,   7.6697+4.7684e-06j, 192.7113-1.7331e-06j,
         18.1004+1.5755e-06j,  70.0246+1.5259e-05j,   6.5202+1.6928e-05j,
         16.5452+6.7264e-07j, 144.3716+7.2448e-07j,   8.1074-0.0000e+00j,
         34.5458+2.8570e-07j, 117.4564+2.0338e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(90.80250549316406+3.4425713693053694e-06j)
torch.linalg.det(H.mH@H) = tensor([ 3.5039+7.7911e-08j,  2.6685+1.0553e-08j,  2.4459-2.2870e-08j,
         0.5440+8.9407e-08j,  1.3472+7.5426e-08j,  0.5367+2.9802e-08j,
        12.9368+1.7087e-07j,  2.6169+3.5594e-08j,  0.2366-3.2178e-08j,
         0.3372+1.7881e-07j,  1.4928-0.0000e+00j,  2.2486+2.5725e-08j,
         3.2084-1.0051e-07j,  0.6328-1.1920e-07j,  0.8397+5.8624e-09j,
         6.4485+2.0010e-07j,  0.3933-1.0960e-08j,  0.3392-1.0682e-08j,
         0.4627+4.4318e-08j,  3.9781-3.5829e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.360883951187134+3.060777586938457e-08j)
SINR torch.Size([20]) = tensor([ -1.9002,  -0.7992,  -1.4132,  -2.4034,  -7.7224,  -6.0585,  -2.8383,
         -1.6725,  -3.7787,  -2.1106,  -8.9900,  -1.5028,  -3.8701,  -3.1687,
        -11.6806,  -5.6630,  -1.9822,  -8.8456,  -2.8439,  -3.9857],
       device='cuda:0')
SINR mean = -4.161483287811279
E[H^H] = 1e-07
E_MSE (Error Power) = 3.4931023120880127
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3923, 0.4541, 0.4194, 0.3651, 0.1445, 0.1986, 0.3422, 0.4049, 0.2952,
        0.3808, 0.1120, 0.4143, 0.2909, 0.3253, 0.0636, 0.2135, 0.3878, 0.1154,
        0.3419, 0.2854], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([421, 382, 404, 439, 618, 564, 454, 413, 487, 428, 657, 407, 490, 465,
        735, 551, 424, 653, 454, 494], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -2-----------
Real SNR = tensor([-0.2402, -2.1473, -1.3271, -4.3430, -1.6990, -2.0092, -6.6495,  1.1456,
        -4.2832, -6.2738, -3.6113, -1.0467, -6.8311, -5.4030, -6.7967, -2.4352,
        -4.1356, -3.9764, -4.7201, -8.1200], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.8324e+02-4.8006e-06j, 8.9443e+01-1.8621e-06j, 1.0075e+00+3.2903e-06j,
        2.4650e+01-1.9073e-06j, 7.1471e+01+1.9252e-06j, 1.0152e+01-1.4305e-06j,
        1.4476e+02-2.6658e-06j, 3.8419e+01-4.8820e-07j, 1.1484e+01-5.8256e-07j,
        1.2001e+02+7.3794e-06j, 1.0252e+01+6.6816e-08j, 6.5068e+02-2.0010e-06j,
        1.1382e+02-2.6246e-06j, 4.3236e+01+1.5259e-05j, 6.1972e+00+7.0940e-07j,
        5.5426e+00-3.1590e-06j, 3.8000e+01-3.6175e-07j, 2.0717e-01+1.0201e-07j,
        1.1756e-03-2.9914e-06j, 5.7284e+01-9.5367e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(80.99259185791016-2.839842352386768e-07j)
torch.linalg.det(H.mH@H) = tensor([6.6465+1.3002e-07j, 2.3899-9.2873e-10j, 0.6468-4.6602e-08j,
        0.0675-1.2107e-08j, 1.8933+2.3842e-07j, 1.1018-8.3676e-08j,
        0.1579-2.2352e-08j, 6.2549+5.6153e-08j, 0.5964+7.4978e-11j,
        0.4050+4.3586e-09j, 1.8095-1.8182e-08j, 0.0506-1.7215e-07j,
        0.6056+1.8910e-09j, 0.0567-1.8626e-09j, 0.6282+1.4706e-09j,
        0.9177+5.9605e-08j, 1.1660-1.2142e-08j, 0.5294+3.8236e-09j,
        0.3845+1.8809e-08j, 0.0491-1.0934e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3178656101226807+7.225393172660688e-09j)
SINR torch.Size([20]) = tensor([ -3.4443,   1.5226, -17.6755,  -4.4191,  -0.9206,  -7.4356,  -0.3089,
         -1.4664,  -3.6588,  -0.7732,  -6.2926,   2.3019,  -0.7290,  -5.8457,
         -5.3054, -12.4518,  -1.6435, -20.5041, -47.5461,  -4.8529],
       device='cuda:0')
SINR mean = -7.07244873046875
E[H^H] = 1e-07
E_MSE (Error Power) = 2746.045654296875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([3.1151e-01, 5.8676e-01, 1.6792e-02, 2.6551e-01, 4.4720e-01, 1.5289e-01,
        4.8223e-01, 4.1638e-01, 3.0102e-01, 4.5561e-01, 1.9017e-01, 6.2949e-01,
        4.5813e-01, 2.0652e-01, 2.2765e-01, 5.3802e-02, 4.0650e-01, 8.8255e-03,
        1.7595e-05, 2.4649e-01], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 475,  303,  884,  509,  386,  609,  365,  406,  482,  381,  572,  277,
         380,  557,  539,  756,  412,  944, 1000,  524], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -1-----------
Real SNR = tensor([-1.8164,  1.4525,  2.5462,  0.0199, -3.7404, -3.5587, -0.8231, -4.2177,
        -0.3653, -0.7846, -3.0489, -1.6450, -3.0385, -1.2935,  0.6942, -1.7632,
        -6.0182, -3.2053, -2.4213, -7.4473], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([164.0103-3.3430e-06j,  11.8910+2.6824e-07j,  32.5778-1.5301e-07j,
         13.0105-2.9718e-07j, 109.5233-1.1444e-05j,  14.7290-2.3690e-09j,
          2.8741-3.8457e-08j, 316.0976-1.6077e-05j,   7.2910+3.6405e-07j,
         78.1362+3.7588e-07j,  40.7629-3.3544e-07j,  21.3477+2.6953e-07j,
          3.8397-1.8857e-07j, 147.5834-6.6047e-07j,   6.1642-2.9372e-07j,
         84.6575+3.3977e-07j,  47.6240+5.6731e-08j,  16.6980-6.1024e-08j,
          1.4159-4.8145e-07j,  40.4288+2.7526e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(58.03315353393555-1.5713239918113686e-06j)
torch.linalg.det(H.mH@H) = tensor([ 2.6311-5.1899e-08j,  0.5667+1.4901e-08j, 12.1517-1.4957e-07j,
         1.1984-8.9151e-08j,  0.7601+2.3162e-08j,  0.1296+1.1642e-09j,
         0.4115+2.2149e-08j,  0.4250-5.9605e-08j,  0.0154-2.7940e-08j,
         1.1114+2.9802e-08j,  2.0876-6.0734e-08j,  2.7613+2.7175e-07j,
         1.7040-1.3688e-08j,  1.9681-6.5593e-09j,  0.1163+1.2925e-08j,
         0.3785-0.0000e+00j,  0.3210-1.4901e-08j,  0.8251+5.1316e-09j,
         0.6480-9.9077e-09j,  0.4491-7.7761e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5330029726028442-5.537030833835388e-09j)
SINR torch.Size([20]) = tensor([ -1.3081,  -2.7135,  -1.7519,  -3.5953,  -2.1204,  -2.5475, -10.5859,
         -0.5201,  -4.9998,  -2.2984,  -1.5986,  -2.9845,  -8.1282,  -1.3354,
         -7.3478,  -1.3968,  -1.4540,  -0.6021, -13.4277,  -0.6148],
       device='cuda:0')
SINR mean = -3.5665395259857178
E[H^H] = 1e-07
E_MSE (Error Power) = 3.795668840408325
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4253, 0.3487, 0.4005, 0.3041, 0.3803, 0.3574, 0.0804, 0.4701, 0.2403,
        0.3707, 0.4090, 0.3347, 0.1334, 0.4237, 0.1555, 0.4203, 0.4171, 0.4654,
        0.0434, 0.4647], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([400, 449, 416, 480, 429, 444, 704, 372, 529, 435, 410, 459, 631, 401,
        606, 403, 405, 375, 782, 376], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 0-----------
Real SNR = tensor([-0.8731, -3.4761, -1.6755, -1.3427,  1.3056, -7.1493, -0.4543, -0.7259,
        -2.6949, -4.1865,  0.2549,  1.3803,  1.2737,  3.1708, -2.7085, -3.3365,
        -4.7232, -1.9255, -1.2741, -1.3473], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 25.3843+2.3556e-07j,  60.4350+4.0420e-07j,   2.9548-9.5367e-07j,
         11.5616+3.5017e-07j, 103.6461-2.5061e-06j,  25.1377+9.7594e-08j,
          0.2498-1.7881e-07j,  46.6390+5.1430e-07j,  27.0436-5.8674e-07j,
          2.2911-5.9605e-08j,  23.9881+4.7684e-06j,  30.5720+1.8332e-06j,
          8.8256-9.5367e-07j,  10.8146+1.7903e-08j,   0.3100+5.9605e-08j,
         14.8347-1.0614e-07j,   8.3440-5.0711e-07j,   0.9094-0.0000e+00j,
         94.0043+7.6294e-06j,   6.9448-1.0290e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(25.24452781677246+4.977762841917865e-07j)
torch.linalg.det(H.mH@H) = tensor([0.7420+4.9950e-08j, 0.0095-4.0513e-08j, 2.3682-5.3636e-08j,
        3.6386+4.1632e-08j, 4.5081+8.9525e-08j, 0.0203-4.3244e-09j,
        2.2678+5.9605e-08j, 1.2662-3.3193e-08j, 2.8883+1.6192e-08j,
        0.1349-6.0263e-10j, 1.9206+1.6277e-08j, 0.6883-1.0725e-08j,
        5.9657+9.7481e-08j, 2.3246+1.7571e-08j, 3.9674-4.4703e-08j,
        0.1110-8.5243e-09j, 0.2249+1.4901e-08j, 0.8632-0.0000e+00j,
        1.7352-5.9605e-08j, 0.6410-4.8486e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8142845630645752+7.122960887784302e-09j)
SINR torch.Size([20]) = tensor([ -2.2212,  -0.7428,  -9.5993,  -5.2825,  -0.4691,  -4.4153, -21.0684,
         -1.4944,  -1.2957,  -5.6907,  -2.1432,  -2.2530,  -3.2145,  -1.8784,
        -15.7545,  -3.2992,  -5.8496,  -7.5197,  -2.2932,  -3.7145],
       device='cuda:0')
SINR mean = -5.009955406188965
E[H^H] = 1e-07
E_MSE (Error Power) = 10.429709434509277
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3749, 0.4573, 0.0988, 0.2286, 0.4730, 0.2657, 0.0078, 0.4148, 0.4260,
        0.2124, 0.3791, 0.3731, 0.3230, 0.3935, 0.0259, 0.3187, 0.2064, 0.1504,
        0.3710, 0.2983], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([432, 380, 675, 538, 371, 509, 956, 407, 400, 552, 429, 433, 467, 420,
        839, 470, 557, 611, 435, 484], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 1-----------
Real SNR = tensor([ 1.5984,  1.4635,  3.3070, -1.6457,  2.4093,  5.1317,  0.1136,  0.8423,
         4.2721,  0.3823, -4.5927, -3.3368, -0.8819, -6.3303, -8.0903,  0.6312,
        -2.3186, -1.3084,  1.1898, -1.1655], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.8905+5.2194e-08j, 91.5670-2.1997e-06j,  9.7797-3.5763e-07j,
        83.6804-3.3154e-07j, 64.1290+3.2941e-07j, 20.9322-1.9533e-06j,
        26.6480+3.1236e-07j,  0.5934+2.9802e-08j, 20.8712-9.0262e-08j,
        12.4774-1.4805e-07j,  1.8478-2.2106e-08j,  1.5156+4.1723e-07j,
        61.7693+3.7609e-07j,  2.6361+2.3842e-07j,  4.5865+1.7391e-08j,
         3.5906+1.7407e-06j, 59.1622-1.5554e-06j,  0.3198+1.4901e-07j,
         2.2545+8.5121e-08j, 18.4885-1.9884e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(24.53697967529297-1.554556092742132e-07j)
torch.linalg.det(H.mH@H) = tensor([ 2.1431+1.5945e-08j,  3.6696-1.9178e-07j,  3.0093+4.7547e-08j,
         0.5253-2.6610e-08j,  1.6018+8.4491e-08j, 16.1973-6.2181e-08j,
         1.5930-2.1168e-08j,  1.5855-9.5427e-09j,  2.8233+5.9605e-07j,
         0.9568+5.9605e-08j,  0.6206-4.7386e-09j,  0.5582+1.8756e-08j,
         1.9479-3.5208e-08j,  0.0451-8.9569e-10j,  0.1003-2.2352e-08j,
         1.6889-1.0048e-08j,  0.1464-3.7253e-09j,  1.7159-1.3265e-08j,
         3.1482+1.6348e-09j,  0.3890-7.1589e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2232789993286133+2.0767641828456362e-08j)
SINR torch.Size([20]) = tensor([ -8.1880,  -0.6380,  -6.9008,  -1.0639,   1.9284,  -4.8598,   0.9323,
        -13.6426,  -2.7185,  -2.3115,  -5.3045,  -8.2368,  -0.3682,  -6.1635,
         -3.2400, -11.7329,  -1.8833, -18.2121,  -8.9337,  -0.1423],
       device='cuda:0')
SINR mean = -5.083988189697266
E[H^H] = 1e-07
E_MSE (Error Power) = 8.064742088317871
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1318, 0.4633, 0.1695, 0.4391, 0.6092, 0.2462, 0.5535, 0.0414, 0.3484,
        0.3700, 0.2277, 0.1305, 0.4788, 0.1948, 0.3217, 0.0629, 0.3933, 0.0149,
        0.1133, 0.4918], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([632, 377, 592, 391, 289, 524, 323, 787, 450, 435, 539, 634, 367, 568,
        468, 736, 420, 896, 655, 359], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 2-----------
Real SNR = tensor([ 3.1522,  2.3121,  2.8475,  0.2976,  1.1814,  2.2251, -0.7939, -2.8913,
         1.7436,  4.9006,  2.8677,  1.8290, -0.8026,  2.4031, -4.5403,  3.1413,
         0.4864, -1.2002, -0.9905,  2.8090], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.8842e+00-1.0566e-07j, 2.0771e+00+1.7178e-07j, 1.7476e+00+2.9802e-08j,
        1.2976e+01-1.1921e-07j, 2.9358e+00-2.2138e-08j, 2.0814e+01+1.2306e-06j,
        8.4375e-02+1.8626e-08j, 2.6718e+01+3.0632e-07j, 2.2519e+01-9.5367e-07j,
        3.0079e+01+1.9974e-07j, 2.7873e-01-1.3411e-07j, 2.3420e+01+5.6701e-07j,
        2.1447e+00-1.9073e-06j, 8.6699e+00+9.5649e-07j, 1.6457e+01-1.2380e-06j,
        1.6547e+01+1.7876e-06j, 5.3284e+00-1.3823e-07j, 1.5234e+00-1.4622e-08j,
        2.1501e+01+1.1667e-06j, 1.0387e+02+2.5362e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(16.278562545776367+1.0276321660285248e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1275+1.9258e-08j, 2.0260+4.9423e-08j, 5.0910+1.5206e-07j,
        0.8239+4.4703e-08j, 1.9563+5.2154e-08j, 2.6755+5.3971e-08j,
        1.1844+5.9692e-08j, 0.1555-6.5193e-09j, 1.0673+6.6529e-09j,
        4.0798+2.6857e-08j, 0.1793-8.8744e-09j, 4.5016-1.0419e-08j,
        0.1184+1.2293e-07j, 0.6114+3.0816e-08j, 0.3153-1.4901e-08j,
        4.6311+1.8268e-08j, 0.8763+1.5097e-08j, 0.2445+2.8699e-09j,
        2.7532-3.8590e-08j, 3.1862+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8302364349365234+3.473298448852802e-08j)
SINR torch.Size([20]) = tensor([ -4.6804, -13.3992, -10.1257,  -3.4715,  -3.5618,  -0.9095, -19.3037,
          0.0415,   0.9979,   1.8427, -10.4700,   0.8172,  -9.8355,  -8.1515,
         -3.6266,  -5.0401,  -8.3335,  -4.2484,  -0.3426,   0.2348],
       device='cuda:0')
SINR mean = -5.078298568725586
E[H^H] = 1e-07
E_MSE (Error Power) = 8.635106086730957
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2539, 0.0437, 0.0885, 0.3102, 0.3057, 0.4478, 0.0116, 0.5024, 0.5572,
        0.6045, 0.0824, 0.5469, 0.0941, 0.1327, 0.3026, 0.2386, 0.1280, 0.2732,
        0.4803, 0.5135], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([518, 781, 691, 476, 479, 386, 919, 353, 320, 292, 701, 326, 682, 631,
        481, 530, 637, 503, 366, 346], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 3-----------
Real SNR = tensor([-0.0994,  1.9020,  5.0682,  3.2721,  2.2967,  6.1363,  1.1540,  5.4384,
         0.5673,  2.9703, -0.3970,  4.4752,  1.8085,  5.6131,  1.6386, -1.1580,
         3.2459, -4.2857,  5.2965,  3.2938], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4840+9.9652e-08j, 53.5144-3.1212e-06j, 22.6847+1.8909e-07j,
        15.1365+9.5367e-07j, 13.1196+3.0347e-06j, 14.7301+3.6580e-07j,
        12.9537-1.6079e-07j, 33.9176+1.1921e-07j, 39.0428-3.5098e-07j,
         3.9186-3.5375e-07j,  4.1934-2.3512e-06j,  8.2703-1.4639e-07j,
        82.3253+1.1812e-06j,  1.5379+9.8236e-08j,  4.7090+2.7897e-08j,
         9.8950-1.0897e-07j, 99.1676+5.7688e-07j,  1.0117+5.9605e-08j,
        69.2020+3.5878e-07j, 20.1487+1.0612e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(25.498144149780273+2.8875389190829992e-08j)
torch.linalg.det(H.mH@H) = tensor([4.2863e-02+4.4703e-08j, 1.8908e-01+3.8804e-08j, 4.6630e+00-3.5109e-07j,
        6.7268e+00-1.7804e-08j, 2.2376e+00+5.9605e-08j, 3.9060e+00-1.1832e-07j,
        1.4177e+00-1.1581e-08j, 1.5273e+01-2.7724e-08j, 4.4800e-01+1.4901e-07j,
        8.1469e-01-6.6508e-08j, 6.3221e-01+2.9802e-08j, 2.3000e+00+8.9198e-08j,
        3.0810e-01+7.4506e-08j, 6.8132e+00-9.0564e-08j, 4.2127e-01-6.7760e-09j,
        4.3081e-01-1.6527e-08j, 4.3492e+00+9.9128e-08j, 7.4895e-03+5.8208e-10j,
        6.0652e+00-1.2720e-07j, 8.5646e+00-1.4938e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.2805328369140625-1.3184719982461957e-08j)
SINR torch.Size([20]) = tensor([-16.0545,  -2.6433,  -2.1003,   0.7087,  -1.7557,  -2.2410,  -1.8921,
          0.0966,   1.9403,  -4.5891,  -5.1419,  -2.3152,   1.3964,  -9.9336,
         -3.2034,  -3.8345,   1.6902,  -5.5157,   0.1035,   0.1828],
       device='cuda:0')
SINR mean = -2.7550995349884033
E[H^H] = 1e-07
E_MSE (Error Power) = 4.306875228881836
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0242, 0.3524, 0.3814, 0.5407, 0.4003, 0.3738, 0.3928, 0.5056, 0.6099,
        0.2579, 0.2343, 0.3698, 0.5797, 0.0922, 0.3235, 0.2926, 0.5961, 0.2193,
        0.5060, 0.5105], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([847, 447, 428, 330, 416, 433, 421, 351, 289, 515, 533, 435, 307, 685,
        467, 489, 297, 546, 351, 348], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 4-----------
Real SNR = tensor([ 5.1183, -2.8809,  2.6579,  2.5327,  4.0130,  0.9326,  3.2977,  3.6763,
         6.8351,  0.7532,  1.6207,  5.8832,  4.6492, -2.1267,  2.8980,  0.7361,
        -0.6914,  1.3030,  1.8254,  4.0139], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 7.5926-1.3903e-07j,  0.2379-1.4156e-07j,  3.1659+4.9996e-09j,
         6.9694+9.5367e-07j, 19.6863-9.9142e-09j,  9.9561+2.3842e-07j,
         2.9881-2.0401e-07j, 43.5400-7.2403e-08j, 55.0745+3.3868e-06j,
         1.5979-2.6896e-07j,  8.7669+1.0243e-07j, 11.6957-3.7249e-07j,
         9.0600+9.5367e-07j, 51.8361-2.0745e-07j, 10.5889+1.3973e-07j,
         0.3687+9.6199e-08j,  1.6997-3.0048e-08j, 43.5649-1.5483e-07j,
         1.2166+1.1921e-07j,  0.6450-8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(14.512560844421387+2.152518590037289e-07j)
torch.linalg.det(H.mH@H) = tensor([1.1733+5.8230e-09j, 0.0491+6.4761e-09j, 1.0693+2.9263e-08j,
        0.8900-3.5763e-07j, 2.9046+4.8327e-08j, 0.9510+1.4901e-08j,
        0.1217+1.2763e-08j, 2.7764+1.6684e-07j, 1.3279-4.6778e-07j,
        1.5287+1.7183e-08j, 1.1774-5.7720e-09j, 0.3798-1.0583e-07j,
        6.7825+5.1864e-08j, 0.1596+2.6340e-09j, 0.0704-9.3438e-09j,
        0.8341-4.1830e-09j, 0.1126-1.2619e-08j, 0.1514-2.8344e-08j,
        1.0590+1.5790e-09j, 1.3703-1.8764e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2444628477096558-4.1073914047728977e-08j)
SINR torch.Size([20]) = tensor([ -3.4164, -10.5575,  -2.7744,  -0.8936,   0.1349,   0.0854,  -1.9531,
          0.1049,   1.6754,  -5.7405,   1.9992,  -0.5984,   2.0632,  -0.1193,
         -0.9517, -12.8030,  -2.6866,   1.0462, -10.3591, -10.0594],
       device='cuda:0')
SINR mean = -2.7901928424835205
E[H^H] = 1e-07
E_MSE (Error Power) = 3.8516736030578613
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3129, 0.0808, 0.3455, 0.4487, 0.5078, 0.5049, 0.3894, 0.5060, 0.5953,
        0.2105, 0.6131, 0.4656, 0.6166, 0.4931, 0.4454, 0.0498, 0.3501, 0.5599,
        0.0843, 0.0898], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([474, 703, 452, 385, 350, 351, 423, 351, 298, 553, 287, 375, 285, 359,
        388, 765, 448, 319, 698, 689], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 5-----------
Real SNR = tensor([ 5.0828,  5.3777, -0.4992,  0.5904,  5.4404,  3.3560,  0.7679,  1.1701,
        -1.3667,  5.9478,  7.2195,  3.2649,  6.1148,  3.4761,  1.8246, -0.4899,
         5.0745,  8.1225,  4.1732,  9.0997], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([36.0019+4.6590e-07j,  6.2208+1.3397e-06j,  5.1474-1.4992e-07j,
         2.7248-3.2710e-08j, 11.6376+2.8133e-07j, 32.4278+5.6317e-07j,
         5.3081-2.4693e-08j,  1.2671+1.7881e-07j,  1.9355-5.6011e-08j,
         5.7343+7.1526e-07j, 16.0160-4.7684e-07j,  2.4097-5.7072e-08j,
         7.2396+2.0447e-07j, 59.4387+9.3271e-07j,  2.1224+1.2892e-06j,
         3.6077+8.3417e-08j,  2.0843-2.2716e-08j, 33.2041+2.8375e-07j,
         5.4677-1.0256e-07j, 14.2953+1.1538e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(12.7145357131958+2.765270892268745e-07j)
torch.linalg.det(H.mH@H) = tensor([ 1.1909+7.4506e-08j,  0.6194+9.2481e-08j,  0.0427-4.1839e-09j,
         0.7906+2.2436e-08j,  1.1067+5.7515e-08j,  1.5953+4.0251e-09j,
         0.1145-6.7635e-09j,  0.5371+5.6860e-09j,  0.3599+2.6743e-09j,
         1.8526-2.2972e-09j, 13.6852-2.4561e-07j,  1.3228-1.1921e-07j,
        12.5110-1.2216e-07j,  2.0526+7.7466e-09j,  1.5294+7.0261e-08j,
         0.1033-4.6566e-09j,  0.1105+1.0610e-08j, 14.3514-4.3599e-07j,
         2.1097-3.4252e-08j,  2.0754+2.4702e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9030556678771973-3.1235629194270587e-08j)
SINR torch.Size([20]) = tensor([ 2.7567, -6.9682, -1.1016, -4.9938,  0.3674,  1.2554, -0.0267, -3.4673,
        -0.7326, -0.8057, -0.3540,  0.1170,  1.2129,  2.3825, -8.8534, -2.0639,
        -2.9623,  0.5094,  0.8461, -0.8271], device='cuda:0')
SINR mean = -1.1854515075683594
E[H^H] = 1e-07
E_MSE (Error Power) = 2.0065598487854004
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6536, 0.1674, 0.4369, 0.2405, 0.5211, 0.5718, 0.4985, 0.3104, 0.4579,
        0.4538, 0.4796, 0.5067, 0.5694, 0.6338, 0.1152, 0.3834, 0.3358, 0.5293,
        0.5486, 0.4525], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([263, 594, 393, 528, 342, 312, 355, 476, 380, 382, 367, 350, 313, 275,
        653, 427, 458, 337, 325, 383], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 6-----------
Real SNR = tensor([ 2.8964,  8.0650,  2.2336,  8.0496,  3.1252,  4.7668,  5.7523,  5.6352,
         6.9391,  4.0268,  2.7615,  6.8838,  6.1675,  6.1317, -0.6388,  4.7474,
         6.0930,  0.1349,  5.8169,  1.6854], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2219+1.2606e-07j,  4.6026-2.1824e-07j,  8.3827+6.1627e-08j,
         0.2684-2.5268e-08j, 10.2990-3.4961e-07j, 16.1152-2.6620e-07j,
         0.3947+1.4977e-07j,  6.4578+1.5228e-07j,  4.2568+2.1093e-08j,
        15.5477+5.1479e-07j,  7.1970+1.8863e-07j,  6.4787-4.7684e-07j,
         4.9802+1.2264e-08j, 18.2613+3.7495e-08j,  0.5631+1.7881e-07j,
         9.6001-6.9331e-08j,  0.3663-5.9605e-08j,  3.5059-3.2411e-08j,
         4.1653+1.9193e-07j,  2.5606+6.6212e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.211263179779053+1.017344697373801e-08j)
torch.linalg.det(H.mH@H) = tensor([0.7676-7.4025e-09j, 5.4191-2.7542e-07j, 0.1158+2.2352e-08j,
        0.9884+8.6734e-08j, 1.3130-3.1035e-08j, 3.4940+5.9314e-08j,
        2.5583+5.3732e-09j, 6.0870-5.8039e-08j, 1.7965+3.4221e-09j,
        1.3295-7.6247e-08j, 0.3704-8.4209e-09j, 4.3698-5.7254e-08j,
        3.4183-9.9459e-09j, 1.0299-9.8819e-09j, 0.3906+7.4506e-09j,
        1.9642+1.7206e-09j, 2.7205+5.9605e-08j, 0.3371-6.4274e-09j,
        0.3010+3.8743e-07j, 0.8081-2.0294e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9789459705352783+3.651938085269535e-09j)
SINR torch.Size([20]) = tensor([-11.9661,  -1.2272,  -0.2280,  -4.5072,   2.0537,   5.1356, -10.3140,
         -3.1211,   1.1721,  -0.9694,   1.0847,   0.2762,  -3.3400,   1.6559,
         -3.5967,  -0.5710, -11.2871,  -0.2830,  -4.2365,   0.0371],
       device='cuda:0')
SINR mean = -2.211604595184326
E[H^H] = 1e-07
E_MSE (Error Power) = 3.30631422996521
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0598, 0.4298, 0.4869, 0.2616, 0.6161, 0.7654, 0.0851, 0.3277, 0.5671,
        0.4444, 0.5621, 0.5159, 0.3167, 0.5942, 0.3040, 0.4672, 0.0692, 0.4837,
        0.2738, 0.5021], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([743, 397, 362, 512, 285, 193, 696, 464, 314, 388, 317, 345, 471, 298,
        480, 374, 724, 364, 502, 353], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 7-----------
Real SNR = tensor([ 2.7560, 11.2055,  3.7329,  7.0619,  6.5176,  6.4186,  2.7176,  7.3614,
         5.6994,  7.4542, -0.0483,  5.0811,  4.5529,  8.9561,  2.8432,  7.4961,
         4.5275,  3.8947,  6.9644,  0.0438], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.0593+3.5310e-09j,  9.8607+2.8055e-07j,  0.1758+3.0516e-08j,
         5.2279-3.0837e-07j,  2.1412+9.8348e-07j,  0.7656-7.6606e-08j,
         6.5449-5.0671e-08j,  1.1472-6.2585e-07j,  2.2148-2.8739e-08j,
         1.3422-1.1137e-08j,  2.5885-0.0000e+00j,  2.6905+6.1628e-08j,
         5.5462-3.0778e-08j, 34.4792-2.1682e-07j,  0.7506-4.4703e-08j,
        17.7367-1.7069e-08j,  2.5912+5.9605e-08j,  9.4504+4.7684e-07j,
        20.6862+4.9484e-07j,  0.1781-3.3969e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.358853816986084+4.731354152909262e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3249-2.7637e-09j, 13.0308-5.9347e-07j,  0.4183-9.5843e-09j,
         1.5102+1.3011e-07j,  1.6650+2.9802e-08j,  1.4121-3.2729e-08j,
         0.6215-1.5656e-09j,  6.2996-4.4039e-08j,  5.2467+2.3842e-07j,
         5.6863-7.4896e-08j,  0.0315+1.8626e-09j,  2.1423+3.3633e-08j,
         1.4217-3.7000e-08j,  9.6985+1.4741e-07j,  3.0184+7.4337e-09j,
         4.9391+1.0508e-07j,  0.7265+2.0862e-07j,  0.1126-1.3970e-09j,
         0.1670+3.1885e-07j,  0.2662+3.6281e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.936967611312866+2.137017496295357e-08j)
SINR torch.Size([20]) = tensor([ -4.2289,   3.9785,  -9.8453,  -1.7029,  -5.7152,  -1.9177,   1.8936,
        -13.5450,  -0.6440,  -6.1383,  -0.8693,  -0.4027,  -3.9094,   6.2503,
         -9.1776,   2.2405,  -4.3352,   1.2095,   1.0694,  -8.1293],
       device='cuda:0')
SINR mean = -2.6959636211395264
E[H^H] = 1e-07
E_MSE (Error Power) = 3.730916976928711
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2741, 0.7142, 0.0939, 0.4032, 0.2115, 0.3914, 0.6073, 0.0423, 0.4630,
        0.1957, 0.4501, 0.4768, 0.2890, 0.8083, 0.1078, 0.6262, 0.2693, 0.5692,
        0.5612, 0.1333], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([502, 226, 683, 414, 553, 421, 290, 785, 377, 567, 385, 368, 491, 164,
        663, 279, 506, 313, 318, 631], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 8-----------
Real SNR = tensor([ 2.6868, 10.1360,  3.6706, 11.4684,  7.7195,  6.1627,  7.5158,  4.9122,
         5.8806,  4.0217,  9.4569,  8.5836,  5.9956,  5.8168,  2.3890,  0.6836,
         7.1029,  2.0123,  5.1364,  0.0739], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4253-1.7297e-08j, 14.5858+7.7040e-08j,  0.0273+3.8126e-09j,
        14.5176+5.2695e-08j, 10.0888+6.9717e-08j,  4.1261+5.3687e-08j,
         1.9963+8.1240e-08j,  0.1184-1.8626e-09j,  7.2849-7.9287e-08j,
         0.7600-2.2452e-08j, 10.4167-7.2130e-08j,  1.5093+7.7338e-09j,
         2.6359+3.8071e-08j, 17.0213+2.7688e-07j,  1.6318-1.1971e-09j,
         1.0412+2.2352e-08j,  4.6356-4.7684e-07j,  0.6295-1.5408e-08j,
         0.1120-8.2888e-08j,  0.3966-1.5224e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.698033332824707-5.0675317275761245e-09j)
torch.linalg.det(H.mH@H) = tensor([0.6935+4.4652e-09j, 0.5290-3.3144e-07j, 0.0098-5.1257e-08j,
        3.3604+6.5086e-09j, 5.2455+4.1085e-08j, 1.2801+1.2059e-08j,
        0.0234-2.3348e-08j, 0.3504+3.9166e-08j, 0.8943-1.5187e-08j,
        1.1911-9.5190e-09j, 1.8168+1.0394e-07j, 3.3343+4.6693e-08j,
        2.9934+2.9866e-08j, 1.2456-2.7832e-09j, 0.4654-3.7660e-09j,
        0.0841+1.5865e-10j, 1.7078-0.0000e+00j, 0.2393-1.3532e-08j,
        1.2272+1.8820e-08j, 0.0669-3.4814e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3379167318344116-7.577426686111721e-09j)
SINR torch.Size([20]) = tensor([ -7.1896,  -0.3025, -11.2679,   4.4376,   5.7304,   0.9048,   0.5233,
         -5.4418,   3.8929,  -2.9298,   3.4410,  -0.6500,   0.9004,   3.7009,
          0.9868,  -0.5541,  -2.5890,  -2.4362, -11.4153,  -6.1156],
       device='cuda:0')
SINR mean = -1.3186743259429932
E[H^H] = 1e-07
E_MSE (Error Power) = 2.895293951034546
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1604, 0.4826, 0.0695, 0.7353, 0.7891, 0.5519, 0.5301, 0.2222, 0.7102,
        0.3375, 0.6883, 0.4627, 0.5516, 0.7010, 0.5566, 0.4681, 0.3552, 0.3633,
        0.0673, 0.1965], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([601, 365, 723, 212, 177, 323, 336, 543, 228, 457, 242, 377, 324, 234,
        321, 374, 445, 440, 728, 566], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 9-----------
Real SNR = tensor([ 2.5538,  6.1166, 11.4155,  9.3539,  7.0731, 10.6062,  4.8542,  7.5301,
         9.1261,  6.5985,  5.3746,  9.5445,  8.8725, 13.2377,  6.1624,  2.8718,
         7.1369,  8.3723,  4.5878, 12.0267], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.9429+7.9069e-09j,  2.5575+2.9802e-07j, 11.5847-3.5515e-08j,
         4.9913+1.6947e-07j,  1.6628+1.0484e-08j,  4.9509-1.8753e-08j,
         0.3537+6.5294e-09j,  2.3722-1.1105e-08j, 14.5198-7.9282e-08j,
         0.1563+3.7253e-09j,  2.8764+3.2328e-08j,  9.6473+5.7447e-07j,
         1.0159-2.9802e-08j, 19.9687-1.8929e-07j,  0.6285-1.4901e-08j,
         0.5344-2.0247e-08j,  0.4295+5.5879e-09j, 10.5840-1.8853e-07j,
         0.8948-1.2109e-09j, 10.8009+4.3067e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.123628616333008+2.814785204918735e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1764+1.1073e-08j,  0.0527+2.5652e-08j,  6.1423-6.0139e-08j,
         5.0104-2.8189e-08j,  0.2419+2.9802e-08j,  4.7316+7.5271e-08j,
         1.0949-3.9472e-09j,  0.5714+1.2287e-08j,  3.4807-5.2913e-08j,
         0.0588+3.4459e-08j,  1.6084+3.1465e-08j,  0.7773+1.2154e-07j,
         0.8976+5.9605e-08j, 15.2389+4.1646e-07j,  4.1478-5.9605e-07j,
         0.0464-1.8566e-09j,  3.4588-4.4967e-08j,  0.2420+2.0624e-08j,
         0.0562+9.8006e-09j, 14.1453+2.3302e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.1089928150177+1.465040355697056e-08j)
SINR torch.Size([20]) = tensor([-1.7322, -3.8690,  5.3973,  2.6521, -3.5673,  1.4560, -7.4590,  3.7089,
         6.4642, -7.5351,  5.5248,  1.9897, -0.6886,  5.4943, -9.3115, -4.2151,
        -5.9917, -0.2421, -2.9076,  3.9243], device='cuda:0')
SINR mean = -0.5453773736953735
E[H^H] = 1e-07
E_MSE (Error Power) = 2.01487135887146
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4016, 0.2909, 0.7760, 0.6481, 0.3055, 0.5830, 0.1522, 0.7014, 0.8158,
        0.1499, 0.7811, 0.6126, 0.4604, 0.7799, 0.1049, 0.2748, 0.2011, 0.4861,
        0.3386, 0.7117], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([415, 490, 186, 266, 479, 305, 610, 234, 159, 612, 183, 287, 378, 183,
        667, 502, 562, 363, 456, 227], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 10-----------
Real SNR = tensor([ 4.5822,  6.3558, 10.7249, 13.5963,  4.2752,  9.2291,  9.6019,  5.8589,
         9.5369, 10.1276,  5.5998, 11.8053,  9.7838,  9.8658,  8.9859,  9.7073,
         5.0503, 10.2565,  6.7079, 10.4698], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.0765-6.4222e-09j,  1.2010+1.4901e-08j,  1.6877-5.5896e-08j,
         0.5905+1.1921e-07j,  0.3697+6.8872e-09j,  5.5147-1.5173e-07j,
         1.3290+1.2745e-08j,  0.7099+1.5305e-08j, 12.5930-2.3065e-07j,
         0.1919+9.4513e-08j,  0.2459+1.8348e-09j,  6.9102-2.2487e-08j,
         6.3125+3.8534e-07j,  3.2940+2.2382e-08j,  0.3798-3.4489e-09j,
         5.4997-2.8201e-08j,  0.2737+1.3245e-08j,  6.5324-1.6368e-07j,
         0.6129-6.6407e-07j,  2.1482+3.4792e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.823662519454956-1.4614935928136674e-08j)
torch.linalg.det(H.mH@H) = tensor([0.3307-4.9549e-09j, 0.1494+6.1329e-09j, 0.7708-1.1921e-07j,
        0.3224+3.9154e-07j, 0.0273-3.0476e-09j, 2.8252-6.2945e-08j,
        2.0015+1.9277e-08j, 0.2496+1.0361e-08j, 2.8691+3.4079e-08j,
        2.5210+1.7076e-08j, 0.1343+9.3077e-09j, 0.2737-2.4021e-08j,
        3.1239-6.6355e-08j, 1.9268-2.9142e-08j, 0.7377-1.3367e-08j,
        3.1716+1.4471e-07j, 0.4344-2.2942e-09j, 3.5134-3.8242e-08j,
        0.3979-1.8984e-08j, 1.2836+1.2718e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3532251119613647+1.885499045783945e-08j)
SINR torch.Size([20]) = tensor([ -7.3135,   0.7907,   2.5666,  -1.7380,  -1.2186,   4.1695,   0.3992,
         -3.2823,   7.1775, -10.1150,  -1.3802,   3.1727,   4.2537,   3.4302,
         -4.6779,   4.6318,  -6.3197,   4.4429,  -9.9939,  -2.2678],
       device='cuda:0')
SINR mean = -0.6636109948158264
E[H^H] = 1e-07
E_MSE (Error Power) = 3.006192445755005
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1566, 0.5454, 0.6436, 0.4013, 0.4303, 0.7231, 0.5230, 0.3196, 0.8393,
        0.0887, 0.4212, 0.6749, 0.7270, 0.6878, 0.2541, 0.7439, 0.1892, 0.7356,
        0.0910, 0.3723], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([605, 327, 269, 415, 397, 220, 341, 469, 142, 691, 403, 250, 218, 242,
        518, 207, 573, 212, 687, 434], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 11-----------
Real SNR = tensor([13.3601,  6.3626,  7.9674, 12.2832, 11.6914, 10.8252,  9.5644,  7.6378,
        11.3100,  4.7824, 10.8993,  6.7225,  6.2738,  9.9799,  6.3706,  9.4508,
        10.4745, 12.2669, 10.2025, 11.2214], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.6728+2.1651e-10j, 0.4677-3.0779e-09j, 3.5789+4.4370e-08j,
        2.0585+4.4817e-08j, 2.5991-2.1634e-07j, 1.6346+1.4901e-07j,
        2.8023-1.0376e-07j, 1.7948+5.2849e-09j, 0.8797+1.7405e-08j,
        0.3291-0.0000e+00j, 2.1066+3.5690e-08j, 1.8108+6.7100e-09j,
        0.3628-2.7539e-08j, 0.2938+4.5014e-08j, 3.0076-1.2761e-08j,
        1.0673-1.3534e-08j, 1.2681+2.4936e-08j, 0.5284-3.8743e-07j,
        0.4632+3.0076e-09j, 0.0345+1.1356e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.588032603263855-1.3720546476747586e-08j)
torch.linalg.det(H.mH@H) = tensor([4.9130+2.0875e-08j, 0.2425-3.6705e-08j, 0.2164-1.3638e-08j,
        2.9928+1.6456e-08j, 6.5950+1.4376e-07j, 1.5995-4.3116e-08j,
        1.9837-1.0242e-08j, 0.4154+8.3655e-09j, 0.3582+3.5508e-08j,
        0.2894-8.8693e-09j, 0.7692-4.2093e-08j, 0.0150-2.5611e-08j,
        0.2941+1.0818e-09j, 0.4051-1.1755e-10j, 1.3094-1.6682e-08j,
        0.7274+4.7270e-09j, 0.3018+1.8196e-08j, 2.2592-2.9802e-07j,
        0.4740-3.8184e-08j, 0.2068-4.0573e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3183964490890503-1.4418694682660771e-08j)
SINR torch.Size([20]) = tensor([  5.0077,   0.7639,   3.2142,   4.6119,  -0.6677,  -2.7920,   3.2638,
          3.8159,  -4.9335,  -3.6273,   2.8181,   1.2421,  -3.0746,  -4.1298,
          5.1504,   2.3115,   1.8600,  -5.8074,  -3.2552, -15.1954],
       device='cuda:0')
SINR mean = -0.47116968035697937
E[H^H] = 1e-07
E_MSE (Error Power) = 2.9119648933410645
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7601, 0.5439, 0.6770, 0.7431, 0.4616, 0.3446, 0.6795, 0.7065, 0.2431,
        0.3025, 0.6568, 0.5710, 0.3301, 0.2787, 0.7660, 0.6300, 0.6055, 0.2080,
        0.3209, 0.0293], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([196, 328, 249, 207, 378, 452, 247, 230, 526, 481, 261, 312, 462, 499,
        192, 277, 292, 556, 468, 826], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 12-----------
Real SNR = tensor([ 9.2801, 13.1302, 11.2286, 13.0916, 11.7522, 14.5161, 13.1228,  9.9558,
        12.4837, 12.6398,  7.9872,  9.2702,  7.4817, 14.2355, 16.9003,  9.0431,
         8.3927, 13.8107, 12.9627,  7.4376], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.4172-1.5890e-07j,  7.7576+3.4964e-08j,  0.5114-5.9605e-08j,
         6.0561-8.8912e-09j,  0.1416-1.1147e-08j,  8.3643+1.4300e-07j,
        13.4982-9.0312e-09j,  3.9160-6.5090e-08j, 13.2455-1.6444e-07j,
        10.0087-1.1213e-07j,  1.1201+2.0862e-07j,  0.6170+1.6503e-08j,
         0.1870+8.5521e-09j,  1.3478-2.6498e-08j,  4.1686-2.0037e-07j,
         0.2741+3.7253e-09j,  0.3454+4.4703e-08j,  5.9873-2.2087e-07j,
         0.5921-9.4742e-08j,  3.2100-8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.288297176361084-3.805254422672988e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6894-1.0558e-07j, 5.0806+9.6353e-08j, 2.3142-2.3842e-07j,
        4.3455+5.3841e-08j, 0.1960-1.2568e-07j, 8.8460+1.3294e-07j,
        9.4033+9.2042e-08j, 0.3297-1.9558e-08j, 6.2555+1.0718e-07j,
        4.6959-5.7647e-08j, 0.5301+5.8255e-09j, 0.7805+7.2122e-09j,
        0.1340+6.9519e-09j, 0.4702+9.9281e-09j, 3.0861+1.6324e-07j,
        0.3197-5.2154e-08j, 0.3761-1.4901e-08j, 1.3257+5.9605e-08j,
        0.2810-2.1962e-07j, 0.3753+1.8626e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4917399883270264-4.8287609466513e-09j)
SINR torch.Size([20]) = tensor([ 2.7688,  5.4476, -3.0226,  6.8771, -3.4754,  6.3706, 10.8943,  0.6541,
         7.9426,  7.9559, -2.4542,  0.9140, -0.3249, -2.5450,  2.7096, -5.6727,
        -5.2308,  3.4074, -6.5154,  2.5953], device='cuda:0')
SINR mean = 1.4648116827011108
E[H^H] = 1e-07
E_MSE (Error Power) = 1.4649403095245361
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6542, 0.7781, 0.3327, 0.8297, 0.3100, 0.8126, 0.9247, 0.5376, 0.8616,
        0.8620, 0.3624, 0.5524, 0.4813, 0.3576, 0.6511, 0.2131, 0.2307, 0.6867,
        0.1824, 0.6451], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([262, 185, 460, 149, 476, 161,  75, 332, 126, 126, 440, 323, 366, 443,
        264, 551, 536, 243, 579, 268], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 13-----------
Real SNR = tensor([11.4103,  8.8301,  6.4173, 12.5293, 10.7558, 14.6908,  6.1605, 13.6701,
        11.9071, 15.0297, 17.2137, 13.0598, 13.2310, 16.1877,  6.0601, 12.5217,
        12.0928,  8.1089, 13.0015,  8.7650], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.4248+3.4744e-08j,  1.5115+5.7671e-09j,  0.0571+2.3539e-09j,
         2.4926-3.5387e-08j,  3.2101+4.6789e-08j,  0.1161-5.2704e-08j,
         0.2581-3.8250e-09j,  2.1380-3.5136e-08j,  1.3251-6.3330e-08j,
         3.2982-7.7795e-08j,  2.0390+1.0133e-06j,  1.1939-2.1012e-08j,
        25.2587+1.7779e-07j, 15.4198-5.5858e-08j,  0.5653-5.9331e-09j,
         1.4167+7.1212e-09j,  0.2163-1.3039e-08j,  0.2501-5.2154e-08j,
         0.1636+3.1330e-09j,  0.4651-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.1409990787506104+4.2995083049390814e-08j)
torch.linalg.det(H.mH@H) = tensor([0.8784+1.6449e-08j, 1.1740+8.9765e-10j, 0.0823+5.5886e-09j,
        0.5617+5.9605e-08j, 0.9655+2.0607e-09j, 0.2961+8.7088e-08j,
        0.1347+5.4817e-10j, 0.4532+4.5825e-08j, 0.4472+7.4506e-09j,
        2.5067-6.4781e-09j, 2.0720+5.1105e-08j, 0.3877-2.3977e-09j,
        7.1317+1.6936e-08j, 7.3063+3.5513e-08j, 0.1560+1.5913e-09j,
        2.3524-1.8595e-08j, 0.0554+1.2480e-07j, 0.2299-7.4506e-09j,
        0.2980-2.8528e-10j, 0.3838-1.2643e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3936494588851929+2.038027524520203e-08j)
SINR torch.Size([20]) = tensor([ 5.1753,  3.7596, -5.5790,  3.4782,  3.6971, -9.1424,  3.3191, -0.4678,
        -0.6919,  7.6187,  0.8486,  0.8665,  6.8655, 11.1886,  4.4227,  1.8002,
        -9.9435, -2.2209, -6.4185,  0.6596], device='cuda:0')
SINR mean = 0.9617775082588196
E[H^H] = 1e-07
E_MSE (Error Power) = 2.1181862354278564
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7670, 0.7038, 0.2168, 0.6902, 0.7008, 0.1086, 0.6823, 0.4731, 0.4603,
        0.8525, 0.5487, 0.5497, 0.8293, 0.9293, 0.7347, 0.6022, 0.0920, 0.3749,
        0.1857, 0.5379], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([192, 232, 548, 240, 234, 662, 245, 371, 378, 133, 325, 325, 149,  71,
        213, 294, 685, 432, 576, 332], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 14-----------
Real SNR = tensor([11.7476,  9.6171, 15.8112, 16.9251,  8.4727, 15.9319, 14.8824, 14.8818,
        10.3453,  9.4434, 16.2885, 11.0681, 12.8299, 11.2685, 10.1834,  9.5236,
        12.6811, 16.4549, 18.1738, 17.3518], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.9549+4.0523e-08j,  1.7572+6.7392e-08j,  5.9650+2.3842e-07j,
        12.4299+2.3842e-07j,  1.7223+1.8292e-08j,  1.1452-3.7631e-09j,
         6.6804+1.6268e-07j,  0.8651-9.5237e-08j,  0.6293-1.6764e-08j,
         2.0174+2.9861e-08j,  2.2480-0.0000e+00j,  2.6720+5.3079e-08j,
         2.0466+2.1998e-08j,  0.7828+2.0039e-08j,  0.0716+9.5479e-09j,
         3.0204-6.4844e-08j,  0.0728-4.0813e-09j,  5.3908-5.9221e-07j,
         5.1644+4.7684e-07j, 13.1268-1.9799e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.4881489276885986+2.0110196174982775e-08j)
torch.linalg.det(H.mH@H) = tensor([1.6118+2.2797e-08j, 0.2617+1.3970e-09j, 1.8961+4.7684e-07j,
        5.3248-3.5763e-07j, 0.4066+6.9926e-09j, 0.8030-2.2938e-08j,
        2.2286-2.9802e-07j, 0.3850-8.3259e-08j, 0.5383+1.4901e-08j,
        0.5004-1.7142e-08j, 5.9611+2.9282e-07j, 0.7546+1.4901e-08j,
        2.2790-4.8805e-09j, 1.0389+3.1916e-08j, 0.4251-4.4703e-08j,
        0.5054-8.8599e-10j, 0.3192-7.4506e-09j, 4.5060+1.5355e-07j,
        1.4723-2.9802e-08j, 5.0879+6.3977e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8152812719345093+1.0669120698025836e-08j)
SINR torch.Size([20]) = tensor([ 5.4836,  4.7676, -0.0300, 10.2476,  6.4285,  6.8788,  8.6702,  3.8672,
         1.5991,  5.9657,  1.2935,  5.9963,  4.1154,  4.2324, -4.0736,  6.6863,
        -8.4736,  7.5174,  4.1766, 11.2760], device='cuda:0')
SINR mean = 4.331254482269287
E[H^H] = 1e-07
E_MSE (Error Power) = 0.9013790488243103
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7795, 0.7498, 0.4983, 0.9137, 0.8146, 0.8298, 0.8804, 0.7090, 0.5910,
        0.7980, 0.5739, 0.7991, 0.7206, 0.7260, 0.2813, 0.8234, 0.1244, 0.8495,
        0.7235, 0.9306], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([184, 203, 355,  84, 160, 149, 111, 229, 300, 171, 310, 170, 222, 218,
        497, 154, 641, 135, 220,  70], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 15-----------
Real SNR = tensor([15.9902, 14.0609, 16.3531,  8.8415, 13.2873, 18.3488, 15.5559, 14.5137,
        13.3307, 14.1858, 15.5380, 17.0005, 17.7055, 19.2910, 11.9122, 15.0182,
        12.9582, 13.2812, 16.2122, 11.0734], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 5.9357-4.0792e-08j,  0.1027+1.9511e-08j,  1.3442-9.9370e-09j,
         0.1918-5.7132e-09j,  1.9486+1.6964e-08j,  0.7620+8.6447e-08j,
         4.5098-4.9664e-09j,  7.6226-1.7569e-07j,  0.8992+5.4762e-08j,
         0.1626-1.8999e-07j, 15.1177-2.0701e-07j,  1.5221+3.4294e-08j,
         0.7739+2.5012e-08j, 16.4398+2.9693e-07j,  0.6290+2.4074e-09j,
         0.9589-2.9412e-08j,  0.1424+8.8851e-09j,  1.6010+1.1294e-09j,
         4.1377-1.7732e-08j,  0.8890-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.284536838531494-6.744851344109293e-09j)
torch.linalg.det(H.mH@H) = tensor([ 8.2337-3.0783e-08j,  2.0208-6.8719e-08j,  1.3056+1.4399e-08j,
         0.1334-1.8626e-08j,  1.5019+1.1921e-07j,  3.8493+5.2633e-07j,
         4.2453-9.3546e-08j,  4.5344+4.3794e-08j,  1.2054-6.4608e-08j,
         0.6166+2.3842e-07j,  8.7817+3.9352e-07j,  2.8095-5.5282e-08j,
         0.7631+2.4792e-08j, 17.5114-4.1542e-07j,  0.2359+6.5247e-09j,
         0.5241-9.6858e-08j,  0.2241-2.5447e-08j,  0.2968-4.6548e-08j,
         8.2336+5.9883e-08j,  0.2459-8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.3636224269866943+2.1081673295952896e-08j)
SINR torch.Size([20]) = tensor([  9.6111, -12.0956,   6.4901,  -0.8012,   3.6602,  -1.6892,  10.2307,
          3.1032,   1.3982,  -4.5925,  11.7319,   4.8196,   4.1202,   7.0385,
          3.4510,   5.9720,  -0.1767,   6.3215,   7.5396,   4.5130],
       device='cuda:0')
SINR mean = 3.5322868824005127
E[H^H] = 1e-07
E_MSE (Error Power) = 1.4639239311218262
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9014, 0.0581, 0.8167, 0.4540, 0.6991, 0.4040, 0.9134, 0.6714, 0.5798,
        0.2578, 0.9371, 0.7521, 0.7209, 0.8349, 0.6888, 0.7982, 0.4898, 0.8109,
        0.8502, 0.7387], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 95, 746, 158, 382, 235, 413,  85, 252, 307, 515,  64, 202, 221, 145,
        241, 171, 361, 162, 134, 210], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 16-----------
Real SNR = tensor([18.7386, 13.1218, 13.3326, 15.8229, 13.4848, 13.4972, 13.7012, 12.6355,
        13.2252, 14.6938, 17.9318, 13.9469, 16.1264, 15.8361, 15.7281, 15.2564,
        15.5174, 19.0827, 17.0669, 17.6187], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.3984e+00-8.4319e-08j, 4.2579e-01-1.4156e-07j, 1.3832e+00-8.1057e-09j,
        5.9016e-02+1.1176e-08j, 1.2578e+00-1.8626e-08j, 6.5324e-01-9.0976e-08j,
        1.0899e+00-0.0000e+00j, 1.0986e-01-1.0449e-09j, 1.9304e-01-1.4156e-07j,
        1.0983e+00+9.2289e-08j, 3.6491e+00+4.1911e-09j, 6.5494e+00+4.0490e-07j,
        1.0510e+01+1.0562e-07j, 3.5133e-03-3.2080e-09j, 7.8203e+00+1.1921e-07j,
        8.1764e-01+1.8626e-08j, 1.0342e+00-3.2549e-08j, 1.6163e+01-1.1208e-07j,
        5.1116e+00-3.7619e-08j, 1.3886e-01+5.1287e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.1733005046844482+4.4746797378536485e-09j)
torch.linalg.det(H.mH@H) = tensor([ 5.0501-1.0690e-07j,  0.2682-1.4901e-08j,  1.0188+3.8709e-08j,
         0.9843+2.9802e-08j,  1.3837+2.3194e-08j,  0.5784+4.3519e-08j,
         0.7695+5.9605e-08j,  0.3745+4.5357e-09j,  0.3665+5.9605e-08j,
         1.0785-9.7510e-08j,  4.5225+4.3375e-08j,  1.5584+3.7098e-08j,
         6.2194+2.3842e-07j,  0.1385-4.9343e-09j,  0.4240+7.4506e-09j,
         0.5305+8.1956e-08j,  0.7308-1.2107e-08j, 16.8818+1.2328e-07j,
         1.8929+1.2648e-07j,  0.1040+3.3093e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2437641620635986+3.568828432776172e-08j)
SINR torch.Size([20]) = tensor([  7.2124,  -3.0839,   7.1917, -11.7705,   5.1516,   6.4996,   2.2484,
         -3.9263,  -4.2421,   3.8253,  10.3205,   7.1375,  11.8435, -13.1048,
          3.2913,   0.0918,   1.2060,  13.6948,   5.9122,  -4.9800],
       device='cuda:0')
SINR mean = 2.225950241088867
E[H^H] = 1e-07
E_MSE (Error Power) = 2.9769694805145264
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8403, 0.3296, 0.8397, 0.0624, 0.7661, 0.8171, 0.6266, 0.2882, 0.2735,
        0.7070, 0.9150, 0.8380, 0.9386, 0.0466, 0.6809, 0.5053, 0.5690, 0.9590,
        0.7960, 0.2411], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([142, 462, 142, 737, 192, 158, 279, 492, 503, 230,  83, 143,  63, 773,
        246, 351, 313,  43, 173, 528], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 17-----------
Real SNR = tensor([15.2937, 11.8076, 18.1206, 19.0453, 15.3191, 20.5595, 16.6214, 19.6979,
        10.6562, 14.7642, 14.7689, 10.9262, 14.3824, 16.2126, 14.5118, 15.9020,
        19.7832, 14.9122, 12.3851, 11.2147], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.9702e-01+7.1347e-10j, 5.5321e-03+1.8772e-09j, 4.7852e+00-1.1056e-07j,
        1.4768e+01+2.1752e-08j, 4.6958e+00-1.2099e-07j, 5.1111e+00+2.0378e-10j,
        1.9286e+00+2.8157e-07j, 3.4597e+01-4.6249e-07j, 1.0183e-01+6.9038e-10j,
        8.6388e-01+1.2042e-08j, 1.4163e+00-4.6833e-08j, 1.0029e-01+7.4506e-09j,
        7.7908e-03+8.4593e-09j, 5.3203e+00+1.2227e-09j, 2.8058e+00-1.3411e-07j,
        4.0401e+00+1.5455e-08j, 3.4420e-01-4.7749e-07j, 5.5842e-01-7.4506e-08j,
        5.3900e-01+6.6734e-09j, 9.8904e-01+1.3013e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.188756465911865-5.279247972111989e-08j)
torch.linalg.det(H.mH@H) = tensor([6.4804e-01-8.2743e-09j, 1.3751e-02-9.3933e-09j, 3.4790e+00-9.5100e-08j,
        6.0860e+00+3.5448e-08j, 1.4483e+00-7.6262e-08j, 3.6610e+00+4.6377e-08j,
        3.3160e+00+5.8635e-08j, 1.8417e+01-2.3596e-07j, 1.2625e-01-3.2523e-09j,
        1.7553e-01-5.9522e-09j, 2.1033e+00-1.3110e-08j, 3.7969e-01-0.0000e+00j,
        1.2528e-01+1.5752e-08j, 1.7393e+00+7.4506e-08j, 1.7847e+00+2.9802e-08j,
        2.4257e+00+2.6640e-08j, 1.2891e+00+1.2397e-07j, 5.8281e-01-4.1723e-07j,
        3.7150e-01-1.4748e-08j, 1.9072e-01+2.6077e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.418137311935425-2.2104229557839972e-08j)
SINR torch.Size([20]) = tensor([  4.9812, -13.7532,   9.3115,  10.6372,   9.1031,  11.0794,   4.1171,
         11.0322,  -0.4593,   5.2205,   5.9352,   1.3705, -18.9810,   8.1292,
          8.0914,  11.4030,  -0.1520,   5.3087,   8.9910,   6.6050],
       device='cuda:0')
SINR mean = 4.3985419273376465
E[H^H] = 1e-07
E_MSE (Error Power) = 5.575049877166748
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7590, 0.0404, 0.8951, 0.9205, 0.8905, 0.9276, 0.7207, 0.9269, 0.4736,
        0.7689, 0.7968, 0.5782, 0.0125, 0.8667, 0.8657, 0.9325, 0.4912, 0.7725,
        0.8880, 0.8207], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([197, 790, 100,  79, 103,  72, 221,  73, 370, 191, 172, 308, 912, 122,
        123,  68, 360, 188, 105, 156], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 18-----------
Real SNR = tensor([20.0155, 20.0726, 17.9127, 15.9313, 16.6168, 14.4863, 21.3772, 15.0489,
        12.9535, 14.0730, 16.6827, 19.4377, 17.7180, 13.8553, 13.2406, 14.0042,
        19.5697, 15.3765, 16.9909, 17.6214], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.5269-8.5461e-09j, 3.8308+1.7708e-09j, 0.1648+2.7328e-08j,
        0.3022-9.9958e-09j, 1.1777-4.0662e-08j, 0.5111+4.2867e-09j,
        0.4772-7.4779e-09j, 0.2801-9.9896e-09j, 0.1392-5.6457e-10j,
        1.0328+1.0682e-08j, 1.7889-5.9393e-08j, 1.2913+3.7385e-07j,
        3.6381-1.2746e-08j, 0.2221-2.2484e-09j, 3.5884-4.8703e-10j,
        0.2542+2.9802e-08j, 1.7258+2.1207e-07j, 2.3331+1.3568e-08j,
        0.1536-1.3074e-08j, 3.0097+7.1526e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4723942279815674+6.117175388453688e-08j)
torch.linalg.det(H.mH@H) = tensor([3.2566-3.0020e-07j, 3.2982-3.7072e-07j, 0.9544+8.6689e-09j,
        1.1737+1.0332e-08j, 2.2113+2.8718e-08j, 0.4806+6.6963e-09j,
        2.1615-4.8634e-08j, 0.1854-3.4218e-09j, 0.1278+1.7857e-10j,
        1.1017-1.6661e-08j, 0.6461+5.9605e-08j, 0.9240-1.0991e-08j,
        2.9038+2.8484e-08j, 0.4979+1.1073e-08j, 2.8569+3.3312e-08j,
        0.0887+1.6764e-08j, 2.1669-1.5358e-07j, 0.5550-6.0266e-08j,
        0.0507+7.6478e-10j, 3.9327-3.5763e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4786876440048218-5.587476792356938e-08j)
SINR torch.Size([20]) = tensor([10.2261,  7.5448, -5.4598,  0.8436,  4.9388,  6.3828, -1.2968,  6.5400,
         5.2752,  8.8797,  6.3476,  6.1751, 14.0272,  3.1168,  8.9484, -2.3486,
        12.5772,  4.1022,  2.2523,  7.2007], device='cuda:0')
SINR mean = 5.313661098480225
E[H^H] = 1e-07
E_MSE (Error Power) = 0.6045512557029724
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9133, 0.8503, 0.2215, 0.5484, 0.7572, 0.8130, 0.4259, 0.8185, 0.7711,
        0.8854, 0.8118, 0.8056, 0.9619, 0.6721, 0.8870, 0.3680, 0.9476, 0.7200,
        0.6268, 0.8400], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 85, 134, 544, 326, 198, 161, 400, 157, 189, 108, 162, 166,  40, 252,
        106, 437,  54, 222, 279, 142], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 19-----------
Real SNR = tensor([22.0599, 18.2420, 19.1361, 14.8940, 15.8720, 19.6596, 15.4831, 16.5025,
        19.2165, 15.9465, 20.9190, 15.6776, 18.8743, 17.4742, 11.2312, 15.6453,
        19.0131, 20.0315, 17.9755, 16.8813], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.8135+1.6015e-07j, 2.2149-1.9313e-09j, 0.1265-5.0291e-08j,
        0.0544+1.3970e-09j, 2.2071-6.2453e-08j, 1.5725+7.9564e-08j,
        0.1635+6.2899e-09j, 2.3093-1.5855e-08j, 1.5689-7.7314e-09j,
        0.7306-3.0115e-08j, 4.9329-4.0009e-08j, 2.0731-0.0000e+00j,
        1.6867-1.1902e-08j, 2.4649-6.6185e-09j, 0.0362+8.3819e-09j,
        0.2669+1.6545e-08j, 4.7401+5.3130e-08j, 1.2149-2.2100e-10j,
        2.0670+5.2743e-08j, 5.1830-2.6281e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1713616847991943-5.586904716636809e-09j)
torch.linalg.det(H.mH@H) = tensor([11.4534-2.4126e-07j,  2.3996+1.9198e-08j,  0.1946-1.1176e-08j,
         0.2816+2.6077e-08j,  1.7790+6.6262e-08j,  0.5900-1.2751e-07j,
         0.1857+1.2966e-08j,  1.7380-1.2974e-08j,  2.2078-3.5572e-08j,
         1.1981-1.6857e-08j,  4.6631-2.1341e-08j,  0.3344+9.5337e-10j,
         1.1924-8.7076e-10j,  1.2460+2.8792e-09j,  0.0263+5.8208e-10j,
         0.1074-7.6703e-09j,  5.0471-6.4346e-09j,  0.2942-2.1893e-09j,
         1.8028-4.9340e-08j,  8.8659-2.3769e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.280364513397217-3.209876098253517e-08j)
SINR torch.Size([20]) = tensor([13.4389, 10.2823, -8.8857, -2.0434, 14.7462,  5.2603,  1.6887, 10.2801,
         6.3977,  9.9962, 10.0983,  5.2385,  8.7195,  8.2838,  4.3203,  3.6827,
         8.8777,  5.6869,  9.9759,  9.7301], device='cuda:0')
SINR mean = 6.788760662078857
E[H^H] = 1e-07
E_MSE (Error Power) = 0.7290312051773071
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9567, 0.9143, 0.1145, 0.3845, 0.9676, 0.7705, 0.5960, 0.9143, 0.8135,
        0.9090, 0.9109, 0.7696, 0.8816, 0.8707, 0.7300, 0.7001, 0.8854, 0.7874,
        0.9086, 0.9038], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 46,  84, 654, 426,  35, 190, 297,  84, 161,  88,  87, 190, 111, 119,
        216, 234, 108, 178,  89,  93], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 20-----------
Real SNR = tensor([19.2229, 21.2184, 18.9268, 17.6286, 23.1877, 16.5367, 21.6144, 17.2962,
         8.3099, 16.1592, 17.7148, 19.3654, 16.3370, 21.2566, 14.2562, 21.0687,
        20.4516, 15.9005, 11.2362, 19.1054], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.1055+6.6461e-08j, 0.3377+1.1330e-07j, 1.0542+1.7593e-08j,
        0.3703-2.4214e-08j, 1.0827-1.0540e-07j, 0.4878-4.8512e-09j,
        5.2002+9.6503e-08j, 0.6293-0.0000e+00j, 0.0690+4.8855e-10j,
        1.2193+8.2929e-08j, 0.8936+1.4848e-08j, 3.0001-6.5309e-08j,
        0.2774+1.9372e-07j, 7.8088+2.0642e-08j, 1.2351-0.0000e+00j,
        3.2540-3.9275e-08j, 0.5465-2.7666e-08j, 0.1833+2.0489e-08j,
        0.1483-8.4242e-10j, 2.1377-6.1441e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.502042531967163+1.7663101203879705e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0195-5.1078e-08j, 0.5076+4.2398e-09j, 0.9063-1.6842e-08j,
        0.4995-2.6077e-08j, 2.7091+2.0623e-07j, 0.1481-1.0023e-12j,
        7.8028+3.3531e-08j, 0.4206+3.7225e-08j, 0.0103-1.9494e-10j,
        0.7564-2.6081e-08j, 2.0689+8.1721e-08j, 1.9730-7.0095e-09j,
        0.5349-2.9802e-08j, 5.2500-7.6369e-09j, 0.6947-0.0000e+00j,
        3.4307-5.2752e-08j, 0.2924-6.1154e-08j, 0.3874+8.6184e-08j,
        0.1419+1.7855e-09j, 1.7825-2.3285e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5168356895446777+7.450435823841417e-09j)
SINR torch.Size([20]) = tensor([ 0.6564,  1.7897, 10.8991,  4.0666,  4.2227,  5.9358, 12.8518,  8.0911,
         5.0434, 10.6802,  4.6171, 10.4367,  0.6189, 10.1599,  9.1837, 13.6321,
         5.9700,  3.8703,  5.7919,  9.3755], device='cuda:0')
SINR mean = 6.894632816314697
E[H^H] = 1e-07
E_MSE (Error Power) = 0.328402578830719
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5377, 0.6016, 0.9248, 0.7184, 0.7256, 0.7969, 0.9507, 0.8657, 0.7616,
        0.9212, 0.7433, 0.9171, 0.5356, 0.9121, 0.8923, 0.9585, 0.7981, 0.7091,
        0.7914, 0.8965], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([332, 294,  75, 223, 218, 172,  51, 123, 195,  78, 207,  82, 333,  86,
        102,  44, 171, 229, 176,  99], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 21-----------
Real SNR = tensor([20.2716, 18.9898, 14.9974, 15.4014, 20.6983, 21.4995, 19.9734, 18.8809,
        19.6428, 12.0905, 21.2804, 11.7279, 23.6909, 17.2204, 17.9804, 18.1638,
        24.5713, 18.1167, 20.5352, 17.4529], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([9.1651e-01+4.4252e-09j, 2.7817e+00-5.3123e-09j, 1.3847e-02-1.1642e-09j,
        3.2510e-03+5.8208e-09j, 2.7498e+00+4.5088e-09j, 1.0744e+00-1.1921e-07j,
        3.3774e+00+1.5291e-08j, 1.4236e+00-3.0672e-08j, 1.2756e+00+4.4703e-08j,
        1.5813e-01-2.2187e-09j, 1.7291e-01+9.3132e-08j, 9.2009e-02-3.7253e-09j,
        2.7375e+00+1.0283e-07j, 4.1705e-01+4.4703e-08j, 7.3651e+00+1.0380e-07j,
        5.8337e-01+3.1561e-08j, 1.7457e+01+7.7329e-09j, 3.7658e-01-3.0323e-09j,
        7.9301e-02+1.3838e-08j, 6.7487e-01-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1865241527557373+1.2370913182735421e-08j)
torch.linalg.det(H.mH@H) = tensor([8.7929e-01-3.7626e-08j, 1.4681e+00+6.3222e-09j, 2.0115e-02-1.6298e-09j,
        1.0374e-01-0.0000e+00j, 2.5698e+00-6.2422e-08j, 1.2962e+00-2.3842e-07j,
        2.2573e+00-5.6573e-09j, 1.2842e+00-6.2958e-09j, 1.2140e+00+8.9407e-08j,
        1.8123e-01-1.3567e-09j, 3.2609e-01-2.1607e-07j, 7.0947e-02-1.1070e-09j,
        4.6717e+00+1.5874e-07j, 2.3167e-01-3.2596e-09j, 6.9610e+00+4.9582e-09j,
        4.1863e-01+1.0024e-08j, 2.0369e+01-1.7405e-07j, 1.7589e-01-2.1400e-08j,
        1.3569e-02-1.5710e-09j, 3.7391e-01-4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2443320751190186-2.7305276262268308e-08j)
SINR torch.Size([20]) = tensor([ 10.0059,  12.7368,  -3.1902, -13.0686,  14.5335,   9.7783,  14.5713,
         13.8417,  10.1536,  10.2393,  -2.4643,   4.4764,  12.0918,   7.2492,
         12.9824,   8.6646,  18.6634,   7.8194,   3.8632,   7.8964],
       device='cuda:0')
SINR mean = 8.04220199584961
E[H^H] = 1e-07
E_MSE (Error Power) = 1.3333486318588257
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9092, 0.9494, 0.3242, 0.0470, 0.9660, 0.9048, 0.9663, 0.9603, 0.9120,
        0.9135, 0.3618, 0.7371, 0.9418, 0.8415, 0.9521, 0.8803, 0.9866, 0.8582,
        0.7088, 0.8604], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 88,  53, 466, 772,  36,  92,  36,  42,  86,  85, 441, 211,  60, 141,
         50, 112,  15, 128, 229, 127], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 22-----------
Real SNR = tensor([21.5075, 13.7728, 19.6759, 17.0601, 21.3052, 23.0715, 19.2216, 21.6329,
        20.4607, 20.5923, 20.5286, 23.6818, 12.6411, 24.0663, 20.1056, 24.2971,
        20.7592, 18.7495, 24.4688, 17.8729], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.3308+2.1114e-08j, 0.0239-1.6052e-09j, 0.1976+8.4042e-09j,
        0.0719-3.9173e-09j, 8.5919+2.2968e-07j, 0.2221-3.8919e-09j,
        2.8821+7.3292e-09j, 1.7099+8.7103e-08j, 3.0444+5.7494e-09j,
        1.6728-1.8973e-07j, 0.0376-3.4459e-08j, 4.1097-1.8841e-07j,
        0.0159-4.6633e-09j, 4.3346+8.3176e-09j, 2.0620+6.5264e-09j,
        5.2644+8.6997e-08j, 1.6612-3.1025e-08j, 1.5618-6.0928e-09j,
        0.2611-1.2103e-08j, 0.3318-9.6411e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.1693742275238037-7.821739922420079e-10j)
torch.linalg.det(H.mH@H) = tensor([3.5605-1.4460e-07j, 0.0221+2.0250e-10j, 0.4133+2.0810e-09j,
        0.0084-5.4702e-10j, 7.1801+3.9125e-08j, 0.3575-5.8438e-09j,
        2.6383+1.4771e-08j, 0.7395+5.6200e-09j, 2.6853+3.0482e-08j,
        1.8355-1.6107e-07j, 0.1485-0.0000e+00j, 3.1697+3.4126e-08j,
        0.0248+9.2805e-10j, 3.2875-7.8598e-08j, 0.8042-1.6493e-09j,
        4.9430+1.5580e-07j, 2.1866+2.0891e-08j, 0.7922-9.7760e-09j,
        0.4258+1.0343e-08j, 0.2479+4.1742e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7735424041748047-4.176884615958443e-09j)
SINR torch.Size([20]) = tensor([15.9056,  3.7642,  4.1034,  0.8741, 17.5987,  1.3160, 13.2736, 12.5740,
        11.1397, 10.5861, -4.5036, 16.4493,  2.9320, 17.6419, 14.0325, 16.7285,
        11.9286, 10.4173,  8.1315,  8.1289], device='cuda:0')
SINR mean = 9.651110649108887
E[H^H] = 1e-07
E_MSE (Error Power) = 0.46583691239356995
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9750, 0.7041, 0.7201, 0.5501, 0.9829, 0.5752, 0.9551, 0.9476, 0.9286,
        0.9196, 0.2617, 0.9779, 0.6626, 0.9831, 0.9620, 0.9792, 0.9397, 0.9167,
        0.8667, 0.8667], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 27, 232, 222, 324,  19, 310,  47,  54,  72,  79, 512,  24, 257,  19,
         40,  23,  62,  82, 122, 122], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 23-----------
Real SNR = tensor([23.2017, 19.2530, 21.0088, 17.2827, 24.8930, 19.7868, 21.9978, 21.3081,
        24.8536, 17.3490, 21.8375, 24.7464, 25.5183, 24.2709, 22.2596, 19.0351,
        26.0026, 20.9193, 24.6570, 20.5510], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.3891-2.3842e-07j, 0.3562-6.8683e-09j, 0.0351-2.9802e-08j,
        0.0393+7.4647e-09j, 1.9184-1.1973e-07j, 0.5047-3.7253e-09j,
        1.1803-1.7208e-08j, 1.8162-5.9078e-09j, 6.3080-4.7684e-07j,
        1.4095+2.4269e-08j, 1.6624+2.2352e-08j, 8.7072-9.6623e-08j,
        0.4049-5.4658e-08j, 2.9602-1.1921e-07j, 0.2653+2.9802e-08j,
        0.7524-4.9830e-09j, 1.8165-5.9605e-08j, 0.7874+1.1737e-08j,
        2.7140-5.9605e-08j, 0.0933-5.4017e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8060115575790405-6.257863560676924e-08j)
torch.linalg.det(H.mH@H) = tensor([3.1572e+00-2.8312e-07j, 5.0864e-01-4.3848e-09j, 2.0702e-03-1.6415e-08j,
        7.7257e-02-9.2526e-09j, 2.6156e+00+1.0517e-08j, 5.1793e-01+1.3039e-08j,
        1.2464e+00-1.5316e-08j, 2.1156e+00+1.2326e-08j, 3.7173e+00-5.9605e-07j,
        1.3936e+00-4.1527e-09j, 2.4430e+00-2.6317e-08j, 8.5435e+00+6.5423e-08j,
        1.1636e+00+3.3307e-08j, 3.3087e+00-1.1921e-07j, 4.1780e-01-3.7253e-09j,
        7.0367e-01-1.9039e-08j, 2.8923e+00+1.1921e-07j, 5.7635e-01+2.0890e-09j,
        3.4884e+00-1.9167e-08j, 2.3203e-01-1.4156e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9560483694076538-5.0089965952793136e-08j)
SINR torch.Size([20]) = tensor([12.5768, 11.6339, -0.6694, -1.9996, 12.8975,  9.1317, 14.3082, 15.1522,
        13.6209, 15.0221, 11.9611, 14.8965,  3.6581, 14.4871,  4.8157, 14.8634,
        11.4010,  8.0041, 11.8030,  1.7558], device='cuda:0')
SINR mean = 9.965998649597168
E[H^H] = 1e-07
E_MSE (Error Power) = 0.301427960395813
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9476, 0.9358, 0.4615, 0.3869, 0.9512, 0.8912, 0.9642, 0.9704, 0.9584,
        0.9695, 0.9401, 0.9686, 0.6990, 0.9656, 0.7519, 0.9684, 0.9325, 0.8633,
        0.9381, 0.5997], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 54,  65, 378, 424,  51, 103,  38,  32,  44,  33,  61,  34, 235,  37,
        202,  34,  68, 125,  63, 295], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 24-----------
Real SNR = tensor([19.2525, 25.3357, 22.4953, 23.4284, 25.3191, 21.3119, 19.3645, 25.0456,
        22.0622, 15.9228, 21.2349, 21.9001, 23.5767, 24.6244, 19.3876, 25.0338,
        22.0234, 18.6664, 25.5471, 20.6999], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.2392-1.8626e-08j, 0.7837+3.8833e-08j, 1.1753-2.3793e-09j,
        2.8137-1.0198e-07j, 6.0409+2.8178e-08j, 0.3062-5.9605e-08j,
        0.8510+8.9768e-10j, 2.8196+6.9626e-08j, 1.7799+2.1435e-08j,
        0.1943-1.4009e-09j, 1.3359-5.9605e-08j, 0.1705+2.1505e-08j,
        5.4582+3.5763e-07j, 2.1188+5.9605e-08j, 0.6951-5.9605e-08j,
        1.0647-2.0602e-09j, 1.3287+3.9719e-08j, 0.2624-7.2258e-10j,
        0.6629+1.4721e-07j, 0.8942-2.5007e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.549751877784729+2.2682337785795426e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4598+4.9655e-09j, 0.3574-1.5617e-08j, 0.9225-8.5030e-09j,
        2.3534+1.0486e-07j, 5.1066-2.3074e-08j, 0.2863-2.9802e-08j,
        0.7769+6.9438e-09j, 2.9503+4.0198e-08j, 1.1532-1.7800e-08j,
        0.2456-2.5496e-09j, 0.8648-2.9802e-08j, 0.1707-1.5362e-08j,
        6.2356-5.1971e-08j, 1.4985-5.9605e-08j, 0.7349-0.0000e+00j,
        1.5728+1.0359e-07j, 1.3436-1.2843e-08j, 0.3463+3.3302e-09j,
        0.5902+1.8800e-07j, 0.7696+6.3918e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.436954140663147+9.567642678121047e-09j)
SINR torch.Size([20]) = tensor([ 5.9052, 10.9674, 10.9135, 15.7272, 18.9183, 11.7962, 13.3076, 15.6599,
        11.7851,  9.9631, 12.3376,  9.1128, 18.6302, 15.3062, 14.5549,  9.2941,
        14.2835,  9.3149,  9.7970, 13.0989], device='cuda:0')
SINR mean = 12.533679008483887
E[H^H] = 1e-07
E_MSE (Error Power) = 0.08529900014400482
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7957, 0.9259, 0.9250, 0.9739, 0.9873, 0.9380, 0.9554, 0.9736, 0.9378,
        0.9084, 0.9448, 0.8907, 0.9865, 0.9714, 0.9662, 0.8947, 0.9640, 0.8952,
        0.9052, 0.9533], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([173,  74,  75,  28,  14,  63,  47,  29,  63,  89,  57, 103,  15,  31,
         36, 100,  38, 100,  92,  49], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 25-----------
Real SNR = tensor([21.0720, 23.6536, 22.9332, 28.1198, 22.9606, 26.2502, 27.4379, 27.3915,
        25.3390, 23.9724, 23.0876, 24.2041, 25.1309, 26.7714, 23.3902, 18.7396,
        23.9825, 26.7231, 23.4541, 21.3805], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4275-1.1646e-08j,  1.0753+5.9605e-08j,  1.1115+5.5234e-10j,
        13.4918+2.6484e-07j,  0.8470-0.0000e+00j,  2.8524+1.2690e-08j,
         5.4093+3.1226e-07j,  1.8132+1.9282e-08j,  0.4121+2.6822e-07j,
         8.7859-1.2442e-07j,  1.3309-2.9802e-07j,  3.6000+2.3764e-08j,
        12.7483+9.8577e-08j,  4.2294+2.3163e-07j,  0.2106+7.4506e-09j,
         0.1501-0.0000e+00j,  2.1186-1.7323e-08j,  3.6961+4.7684e-07j,
         1.1655+1.5648e-08j,  0.6462+4.2549e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.3060860633850098+6.912502925615627e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.5021-7.0846e-09j,  1.2716+1.4901e-08j,  0.8258+3.3921e-09j,
        15.7695+1.5019e-07j,  0.6241+2.9802e-08j,  3.7375+4.9229e-08j,
         5.5012+1.3320e-07j,  1.8146-6.1702e-09j,  0.1472+3.3528e-08j,
         8.0439+2.0307e-07j,  0.7799+1.1921e-07j,  2.6354+2.0433e-08j,
        11.7234+8.3121e-08j,  6.1815+5.5821e-07j,  0.2669-0.0000e+00j,
         0.1004-0.0000e+00j,  1.8074+5.3012e-09j,  3.3105-1.1921e-07j,
         0.8677+7.2795e-10j,  0.8734-3.1122e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.339202880859375+6.20366904513503e-08j)
SINR torch.Size([20]) = tensor([16.9442, 13.4981, 16.2481, 22.6099, 12.9819, 13.8581, 19.8451, 16.0158,
         7.4106, 19.8437, 10.9100, 15.2203, 21.9827, 14.3744,  8.1273,  9.1101,
        18.7949, 18.8969, 13.2060, 12.1168], device='cuda:0')
SINR mean = 15.099740982055664
E[H^H] = 1e-07
E_MSE (Error Power) = 0.0649678036570549
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9802, 0.9572, 0.9768, 0.9945, 0.9521, 0.9605, 0.9897, 0.9756, 0.8464,
        0.9897, 0.9250, 0.9708, 0.9937, 0.9648, 0.8666, 0.8907, 0.9870, 0.9873,
        0.9544, 0.9421], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 22,  45,  25,   6,  50,  42,  11,  27, 137,  11,  75,  32,   7,  38,
        122, 103,  14,  14,  48,  59], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 26-----------
Real SNR = tensor([23.0912, 25.0347, 30.6150, 24.4463, 25.4702, 26.7515, 22.9892, 23.4391,
        23.0630, 24.2868, 24.5520, 22.7271, 24.4147, 29.9943, 21.2099, 23.0152,
        23.2624, 25.1368, 25.8032, 27.9296], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1365+1.9057e-08j, 1.0688+3.0234e-10j, 4.1437-8.1394e-08j,
        4.2316-2.5086e-08j, 1.2079-5.9605e-08j, 0.4643+3.2234e-08j,
        0.6648+8.4492e-09j, 0.5536-2.0854e-08j, 0.3120-4.4703e-08j,
        0.2521+2.8141e-08j, 0.5843+3.5575e-08j, 0.2995+3.7253e-09j,
        0.8929-9.3910e-09j, 8.0696-1.4212e-07j, 0.7456+3.0435e-08j,
        0.0548+1.3039e-08j, 0.1214-1.5240e-08j, 0.3061-9.9419e-08j,
        3.0428-0.0000e+00j, 4.8440-7.4544e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.649823784828186-2.0070093142976475e-08j)
torch.linalg.det(H.mH@H) = tensor([1.3461+1.2209e-08j, 1.0408-1.4872e-08j, 6.0815-3.8352e-07j,
        4.5655+1.2456e-08j, 1.2140-5.9605e-08j, 0.1701+5.1988e-08j,
        0.4493+5.6808e-09j, 0.4323+2.5339e-09j, 0.4993-9.3132e-09j,
        0.3118+6.0392e-08j, 1.0208+4.2411e-08j, 0.3326-7.4506e-09j,
        0.8194-4.3535e-09j, 6.5333-2.3842e-07j, 0.8445+1.7958e-08j,
        0.1812-1.4901e-08j, 0.0579+1.3185e-08j, 0.3092-4.1146e-08j,
        2.8960+5.9605e-08j, 5.2526-1.7278e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7179216146469116-2.5622112431733512e-08j)
SINR torch.Size([20]) = tensor([16.8283, 19.2638, 13.8963, 21.7140, 13.4310,  7.9967, 15.9995, 11.9248,
         4.4693,  4.1383, 11.7009, 13.8654, 14.4207, 17.2350, 12.0889,  1.3932,
         5.5076, 11.4855, 13.4764, 19.8203], device='cuda:0')
SINR mean = 12.532800674438477
E[H^H] = 1e-07
E_MSE (Error Power) = 0.14077909290790558
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9797, 0.9883, 0.9608, 0.9933, 0.9566, 0.8631, 0.9755, 0.9397, 0.7367,
        0.7217, 0.9367, 0.9606, 0.9651, 0.9814, 0.9418, 0.5795, 0.7804, 0.9337,
        0.9570, 0.9897], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 22,  13,  42,   7,  46, 125,  27,  62, 211, 221,  64,  42,  37,  20,
         60, 307, 183,  67,  45,  11], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 27-----------
Real SNR = tensor([29.5952, 26.6199, 28.2303, 22.8663, 24.8612, 29.1793, 21.3759, 27.3490,
        23.1321, 24.6502, 25.5045, 28.2096, 29.0016, 26.8837, 28.7719, 24.7485,
        26.4409, 25.8757, 23.8002, 31.0694], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1891+1.6491e-08j,  3.7367+6.6155e-08j,  6.9368+3.1457e-08j,
         1.0374+1.6096e-09j,  1.3896+2.0016e-08j,  0.6128+3.4229e-08j,
         0.7673-3.7361e-09j,  2.6788+2.3842e-07j,  0.2238-1.6764e-08j,
         2.2456+1.0745e-11j,  0.9690-8.9407e-08j,  6.8077-2.4620e-07j,
         2.4304-6.2125e-08j,  1.5490+2.3283e-08j,  5.5877+1.7223e-07j,
         0.6900-1.9276e-09j,  0.9035+3.0250e-08j,  0.6642-5.6604e-09j,
         0.0221+2.2745e-09j, 13.1716+4.2382e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.6306653022766113+1.2649403302589235e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3899-2.5408e-09j,  3.2455+5.6127e-08j,  4.5268+1.0812e-07j,
         0.9687-4.6893e-09j,  1.4267+1.5600e-08j,  0.4253+5.0631e-07j,
         0.7282-1.3309e-08j,  1.8492-2.9802e-07j,  0.2354+2.2352e-08j,
         2.0881-3.4738e-09j,  1.2778+5.9605e-08j,  5.5268-3.2389e-07j,
         1.8240+8.1189e-08j,  1.8706-2.2352e-08j,  6.5430-1.1717e-07j,
         0.6418-3.2124e-10j,  0.7729+1.1753e-08j,  0.7950-3.0257e-08j,
         0.0327+3.3603e-09j, 12.2548+2.5871e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.371156930923462+1.53553170179066e-08j)
SINR torch.Size([20]) = tensor([10.0905, 22.1813, 15.3684, 20.3263, 16.9269,  8.5667, 18.2695, 13.6700,
        10.0233, 19.8005, 14.7745, 18.7611, 16.7944, 16.5455, 22.0266, 16.2059,
        14.7507, 15.5248,  3.6378, 18.7523], device='cuda:0')
SINR mean = 15.649859428405762
E[H^H] = 1e-07
E_MSE (Error Power) = 0.05666564777493477
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9108, 0.9940, 0.9718, 0.9908, 0.9801, 0.8779, 0.9853, 0.9588, 0.9095,
        0.9896, 0.9678, 0.9869, 0.9795, 0.9783, 0.9938, 0.9766, 0.9676, 0.9727,
        0.6980, 0.9868], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 87,   6,  31,  10,  22, 113,  16,  44,  88,  11,  35,  14,  22,  24,
          7,  26,  35,  30, 236,  14], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 28-----------
Real SNR = tensor([30.2775, 24.7708, 29.9935, 28.4653, 26.6302, 27.4912, 25.4835, 26.7759,
        24.6455, 28.0834, 29.2444, 30.8259, 25.7288, 30.6800, 25.0607, 25.5028,
        28.5457, 30.5621, 25.7979, 27.6818], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 5.0964+7.6362e-09j,  2.2986-5.7840e-08j,  7.0953+2.5050e-08j,
         5.7752-3.3646e-08j,  0.2979+2.9802e-08j,  0.0810+1.2723e-07j,
         1.3281-1.8918e-08j,  2.5819+3.2641e-08j,  0.2528+2.9802e-08j,
         4.0333-1.1921e-07j,  4.3875+1.4979e-08j, 11.3987+6.0403e-08j,
         1.2644-2.9802e-08j,  1.1329+7.8373e-08j,  3.8974-1.2120e-07j,
         1.2517-7.8944e-10j,  1.2834+3.1488e-08j,  4.2275+7.5928e-08j,
         0.6066+9.7036e-08j,  0.7909-8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.954061508178711+6.977762811999355e-09j)
torch.linalg.det(H.mH@H) = tensor([ 4.5644-5.7435e-08j,  2.1585+7.8324e-09j,  5.8692-8.6788e-08j,
         5.5604+1.0922e-07j,  0.2230+4.0978e-08j,  0.1224-1.8656e-07j,
         1.1413-1.4546e-08j,  2.7465+1.0221e-07j,  0.3762-2.9802e-08j,
         4.0035-4.5249e-08j,  4.4192-1.1487e-07j, 11.5825-1.4988e-07j,
         1.1701-0.0000e+00j,  1.2242+2.0151e-08j,  4.1255-6.0220e-08j,
         1.1943-1.5137e-08j,  1.0931+3.1136e-08j,  4.2329-4.7763e-08j,
         0.5409+7.6832e-08j,  0.7567-8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.855250597000122-2.5465107356126282e-08j)
SINR torch.Size([20]) = tensor([24.7936, 21.7121, 18.3069, 22.8713, 13.6933,  7.4568, 21.9224, 22.6641,
        12.1889, 19.3557, 24.2231, 24.6356, 15.9387, 15.8574, 19.2066, 22.2374,
        18.9986, 21.6971, 16.7293, 15.8863], device='cuda:0')
SINR mean = 19.018768310546875
E[H^H] = 1e-07
E_MSE (Error Power) = 0.029150916263461113
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9967, 0.9933, 0.9854, 0.9949, 0.9590, 0.8477, 0.9936, 0.9946, 0.9430,
        0.9885, 0.9962, 0.9966, 0.9752, 0.9747, 0.9881, 0.9941, 0.9876, 0.9933,
        0.9792, 0.9749], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  3,   7,  16,   5,  43, 136,   7,   6,  59,  13,   4,   4,  27,  27,
         13,   6,  14,   7,  23,  27], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 29-----------
Real SNR = tensor([25.1245, 29.1573, 29.9279, 29.5219, 28.6522, 28.7342, 22.8536, 27.1343,
        26.0311, 27.5207, 25.8819, 27.6885, 28.6510, 25.1519, 26.8041, 28.3465,
        25.3683, 29.8849, 30.1988, 30.0303], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3702+1.4228e-08j, 1.3275+2.5400e-08j, 1.1911-1.1921e-07j,
        3.7653+5.9665e-08j, 0.5618-1.7351e-08j, 4.5788-4.9595e-08j,
        0.0950-1.5527e-09j, 1.1656+1.4435e-08j, 1.1987-1.8369e-08j,
        5.7504+2.0102e-08j, 0.6303-2.9802e-08j, 3.2143-4.7684e-07j,
        0.1381-1.8669e-09j, 0.6927+1.5667e-08j, 4.6962-0.0000e+00j,
        2.6699-5.8451e-08j, 1.5106+4.1511e-09j, 0.4663-2.6090e-09j,
        2.3263-8.3698e-08j, 9.5654+3.6807e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.295719623565674-3.3444422342654434e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3732-1.2927e-08j,  1.4715+1.6686e-07j,  1.4948-9.8642e-08j,
         3.5834+4.4633e-08j,  0.7966-1.6030e-08j,  4.2887-7.4401e-08j,
         0.1035-1.4917e-09j,  1.2791+5.8476e-08j,  1.2001+5.0493e-09j,
         5.0286-2.7088e-09j,  0.6956-1.4901e-08j,  3.1338+1.1921e-07j,
         0.1895+1.0992e-07j,  0.5745+6.9882e-09j,  4.6740+3.5763e-07j,
         2.3268+5.2825e-08j,  1.4282-6.5469e-09j,  0.8417+5.5295e-09j,
         2.7166+2.2289e-08j, 10.0508-9.9656e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3125522136688232+3.110475788048461e-08j)
SINR torch.Size([20]) = tensor([16.7358, 20.3093, 15.3272, 22.1826, 14.6439, 21.1361, 10.8594, 16.5459,
        21.8942, 21.7050, 15.1745, 22.1190,  6.6896, 13.5613, 22.3907, 21.5483,
        17.6687, 10.2163, 22.6111, 25.0209], device='cuda:0')
SINR mean = 17.9169979095459
E[H^H] = 1e-07
E_MSE (Error Power) = 0.04753204435110092
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9792, 0.9908, 0.9715, 0.9940, 0.9668, 0.9924, 0.9242, 0.9783, 0.9936,
        0.9933, 0.9705, 0.9939, 0.8235, 0.9578, 0.9943, 0.9930, 0.9832, 0.9131,
        0.9945, 0.9969], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 23,  10,  31,   6,  36,   8,  75,  24,   7,   7,  32,   7, 154,  44,
          6,   8,  18,  85,   6,   3], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)

--- 処理中: 画像 61 から 80 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 60)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6583, 0.6378, 0.7080, 0.4698, 0.4843, 0.5120, 0.8771, 0.5660, 0.6880,
        0.6601, 0.6396, 0.6972, 0.6009, 0.7180, 0.5978, 0.4435, 0.5451, 0.5308,
        0.7748, 0.5434], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -1.6225,  -6.3051,  -4.7200,  -5.7938,  -6.6959,  -8.4351, -13.4923,
         -9.6432,  -5.6183,  -5.5136,  -6.8968,  -6.1691,  -1.5672, -10.7407,
         -7.9465,  -2.0608,  -6.3113,  -4.4474,  -5.1479,  -5.7089],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([819.7056-1.6241e-05j, 298.1170-1.6902e-05j, 456.3334+9.1553e-05j,
         91.1076-4.2210e-06j, 162.8728-4.3454e-07j,  93.5399-8.0794e-07j,
         81.6412-1.0848e-05j,  73.9775+3.1292e-06j, 134.1044+1.9089e-06j,
         41.8958+7.0571e-07j,  17.9609+8.7966e-07j,  98.1094-1.1444e-05j,
          6.8555-4.7684e-07j, 183.6748-2.6490e-05j, 328.6106+5.7220e-06j,
        877.9673-2.2128e-05j, 579.6125-2.6708e-06j, 789.5229-1.4589e-05j,
         63.6273+7.3145e-06j, 641.5117+2.5260e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(292.03741455078125-6.756867492185847e-07j)
torch.linalg.det(H.mH@H) = tensor([0.2036+3.4667e-08j, 1.5267+1.2514e-08j, 3.8088+1.4370e-08j,
        0.3780+8.2017e-08j, 0.0219-8.0899e-10j, 0.3190-0.0000e+00j,
        0.0919+4.0636e-10j, 0.3834+4.0371e-09j, 4.3445+6.4989e-08j,
        2.2971-4.6255e-08j, 0.1334-4.6566e-09j, 0.8138-1.5870e-08j,
        8.1269-1.1918e-07j, 0.1990-8.2056e-10j, 0.6603+3.3092e-08j,
        0.3886+9.7366e-09j, 1.2762-0.0000e+00j, 1.0531+2.3842e-07j,
        1.0166-1.0599e-07j, 2.2984+4.1773e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4670652151107788+1.2121666337350234e-08j)
SINR torch.Size([20]) = tensor([-0.1160, -1.6767, -1.4452, -5.3699, -1.4975, -3.1737, -4.3253, -5.3366,
        -3.9763, -5.6662, -8.0545, -6.7483, -9.2278, -3.9525, -3.8812, -0.1964,
        -1.5185, -1.2702, -5.4624, -1.3846], device='cuda:0')
SINR mean = -3.7139930725097656
E[H^H] = 1e-07
E_MSE (Error Power) = 2.8509774208068848
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4933, 0.4047, 0.4176, 0.2251, 0.4146, 0.3250, 0.2697, 0.2264, 0.2859,
        0.2134, 0.1353, 0.1745, 0.1067, 0.2870, 0.2904, 0.4887, 0.4135, 0.4274,
        0.2214, 0.4210], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([358, 413, 405, 541, 407, 466, 505, 540, 493, 551, 628, 587, 664, 493,
        490, 361, 407, 399, 544, 403], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -4-----------
Real SNR = tensor([-3.2331, -6.4811, -0.4328, -3.3500, -2.2932, -7.1367, -5.3613, -5.2642,
        -6.7102, -5.6967, -7.5818, -3.9885, -4.8156, -3.8595, -4.7864, -1.5757,
        -5.8954, -7.2754, -4.7018, -7.1572], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  24.2261+7.2473e-07j,  110.6200+1.1563e-06j,  598.4446+3.0518e-05j,
          38.3115-6.6757e-06j,  947.8228-9.0819e-06j,   21.2989+9.2983e-06j,
          10.7351-3.3379e-06j,  581.8146+1.1245e-05j,  271.2471+3.3427e-05j,
         455.5095+5.6500e-06j,  226.4209-1.5361e-05j,  140.9565-4.9613e-06j,
          56.6746+1.1640e-06j, 1428.6550-2.5116e-05j,   57.1137-3.2772e-06j,
          15.1854-9.5367e-07j,  310.7583-3.6616e-06j,   60.6291-2.4944e-06j,
          24.0889+3.1765e-07j,  999.3185-1.0098e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(318.9915466308594+4.241292970164068e-07j)
torch.linalg.det(H.mH@H) = tensor([0.7491+1.1176e-08j, 0.2584-6.7086e-09j, 1.1438+2.5741e-08j,
        2.7886-2.1844e-08j, 4.2950-9.4508e-08j, 0.1797+2.9802e-08j,
        0.6909-1.1921e-07j, 3.2523+4.0289e-08j, 2.8878-1.0762e-08j,
        1.6706-1.7973e-08j, 0.0389+3.7253e-08j, 3.8162+1.3670e-08j,
        1.6230+2.3893e-08j, 2.4799-7.6117e-09j, 3.8395+1.3288e-08j,
        3.2713-1.9619e-08j, 1.2351+8.9407e-08j, 0.6241-5.5422e-09j,
        0.4363+2.9802e-08j, 0.0568-5.7523e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7668555974960327+2.3950849636911187e-10j)
SINR torch.Size([20]) = tensor([ -7.8715,  -2.7608,  -2.1435,  -3.2719,   0.0283, -11.0029,  -8.0017,
         -1.3671,  -3.4846,  -1.5262,  -2.0013,  -1.9258,  -4.2587,   1.0216,
         -4.1120,  -8.2068,  -1.4820,  -3.0095,  -4.9404,  -0.6904],
       device='cuda:0')
SINR mean = -3.5503697395324707
E[H^H] = 1e-07
E_MSE (Error Power) = 3.1061761379241943
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1403, 0.3462, 0.3791, 0.3201, 0.5016, 0.0735, 0.1368, 0.4219, 0.3095,
        0.4130, 0.3868, 0.3909, 0.2728, 0.5585, 0.2795, 0.1313, 0.4155, 0.3334,
        0.2428, 0.4603], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([623, 451, 429, 469, 353, 716, 627, 402, 476, 408, 424, 422, 503, 319,
        498, 633, 406, 460, 527, 378], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -3-----------
Real SNR = tensor([-3.9880, -3.0344, -1.7493,  1.7413,  1.5170, -3.4879, -6.5240, -6.1710,
        -6.4446, -5.0445, -5.4062, -6.7619, -0.8537, -9.5483, -8.1349, -2.5380,
        -1.4241, -3.7273, -4.8712, -1.8399], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 246.1031+2.5725e-06j,   50.0280-8.2438e-06j,   34.9200+9.2127e-07j,
           2.1911+1.6038e-06j,   92.4948-9.4829e-07j,   39.6898-1.8706e-06j,
         123.5859+6.3397e-06j,   30.1027-9.6809e-07j, 1048.3342-2.0877e-06j,
          18.9321-9.5367e-07j,   51.3184-1.0808e-06j,  114.3503-1.7933e-06j,
         239.1666-1.5259e-05j,   11.2877-1.1976e-06j,  312.8427+1.3464e-06j,
         287.3577+1.5080e-06j,  116.2435-3.7272e-06j,   13.7316-6.3181e-06j,
         298.9083+8.6442e-07j,  317.7621+7.6294e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(172.467529296875-1.0831199688254856e-06j)
torch.linalg.det(H.mH@H) = tensor([0.6880+1.1921e-07j, 1.5087-1.3410e-07j, 4.8356+8.9407e-08j,
        5.2481-6.7372e-08j, 2.4154-2.3842e-07j, 0.4649-9.1665e-08j,
        1.8564+4.8801e-08j, 0.2655-7.4506e-09j, 1.2430+7.5483e-09j,
        0.4233+2.3569e-09j, 1.2816+2.5019e-08j, 0.7358-8.9407e-08j,
        1.7349-1.8054e-07j, 0.0806-2.9598e-09j, 0.2157-2.2352e-08j,
        4.0065-5.8677e-08j, 2.4020+1.1921e-07j, 1.4150+5.9605e-08j,
        2.0284-4.5682e-08j, 1.4035-2.9802e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.712636947631836-3.827463856964641e-08j)
SINR torch.Size([20]) = tensor([  0.1433,  -5.0267,  -2.8729, -12.8763,  -3.0077,  -4.5710,  -1.7365,
         -3.4381,   0.3536,  -3.1321,  -2.5384,  -2.5180,  -0.4884,  -6.8530,
         -1.3954,   0.9591,  -1.8468,  -7.2331,  -0.4365,  -1.5990],
       device='cuda:0')
SINR mean = -3.005701780319214
E[H^H] = 1e-07
E_MSE (Error Power) = 2.946185350418091
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5083, 0.2391, 0.3404, 0.0490, 0.3335, 0.2587, 0.4013, 0.3118, 0.5203,
        0.3271, 0.3579, 0.3590, 0.4719, 0.1711, 0.4204, 0.5550, 0.3953, 0.1590,
        0.4749, 0.4090], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([349, 529, 455, 767, 460, 514, 415, 475, 342, 464, 443, 443, 371, 590,
        403, 322, 419, 602, 370, 410], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -2-----------
Real SNR = tensor([ -7.7608,  -2.6915,  -5.1045,  -1.0446,  -2.2092,  -2.3290,  -1.5592,
         -2.4612,   0.3229,   0.4986,   0.1334,  -4.4530,  -3.1379,  -0.4152,
        -10.5502,   0.1587,   0.8771,   1.0668,  -2.6974,  -1.2487],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.6721e+01-2.5349e-06j, 3.0954e+02+2.2359e-06j, 7.3580e+01-6.0254e-06j,
        1.0791e+02-2.9980e-07j, 1.4420e+01-7.4152e-07j, 8.6964e+00-6.6754e-08j,
        4.9116e+01+6.1640e-06j, 7.7051e+00+2.3575e-07j, 4.0052e+02-4.5542e-06j,
        8.1642e+01+2.8610e-06j, 6.8792e+02+2.5541e-06j, 3.9538e+00+2.3842e-07j,
        3.8409e-01-6.6712e-09j, 1.8713e-01+2.1685e-07j, 4.2283e+01+1.2398e-05j,
        4.1657e+01-8.5831e-06j, 1.0581e+02+5.1613e-07j, 1.8021e+02+3.4432e-06j,
        1.9386e+01-0.0000e+00j, 1.3865e+01+4.7830e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(108.77544403076172+4.2645561393328535e-07j)
torch.linalg.det(H.mH@H) = tensor([0.2098-4.8467e-09j, 0.0131-1.0034e-08j, 0.0487-9.4891e-10j,
        0.4479-1.0489e-07j, 4.4387-1.0313e-08j, 0.0110-1.8301e-08j,
        0.3042+2.9652e-07j, 0.9057-2.7825e-08j, 7.8613-1.0896e-07j,
        1.6425+3.1899e-08j, 4.5209+2.0883e-07j, 1.1632+3.4662e-08j,
        0.1660+5.9605e-08j, 0.8007-7.7486e-07j, 0.0267+5.1830e-10j,
        0.6475-1.3416e-08j, 6.9893+1.5600e-09j, 2.6134-6.4877e-08j,
        0.3702+5.5235e-08j, 4.1325+5.0978e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.865656852722168-1.9973057874267397e-08j)
SINR torch.Size([20]) = tensor([ -3.1034,  -0.1507,  -2.3241,  -1.3729,  -5.4183,  -2.6883,  -7.0159,
         -4.5174,   0.3812,  -4.6520,   0.6326,  -9.1271, -17.1832, -23.2705,
         -4.1243,  -5.1856,  -2.3213,  -1.5275,  -4.8717,  -4.8419],
       device='cuda:0')
SINR mean = -5.134119987487793
E[H^H] = 1e-07
E_MSE (Error Power) = 15.591822624206543
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3286, 0.4913, 0.3693, 0.4216, 0.2231, 0.3500, 0.1658, 0.2611, 0.5219,
        0.2552, 0.5364, 0.1089, 0.0188, 0.0047, 0.2790, 0.2325, 0.3695, 0.4130,
        0.2457, 0.2470], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([463, 360, 436, 402, 543, 449, 595, 512, 341, 517, 333, 661, 873, 999,
        499, 535, 436, 408, 524, 523], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -1-----------
Real SNR = tensor([ -0.6118,  -6.8309,   1.4333,  -2.7459,   0.8563,   2.2844, -10.3572,
         -8.3637,   2.7472,  -6.8031,  -5.4214,  -2.0455,  -3.5813,  -4.2041,
         -4.3315,  -0.5580,  -0.6456,  -2.0891,  -6.7313,  -0.7902],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 40.9541+1.3822e-06j,  50.6670+4.0389e-08j, 112.4877-9.8640e-07j,
        164.0004-5.4442e-06j, 144.8766-4.2842e-07j, 103.1154-7.1477e-07j,
         29.6867-1.6886e-06j, 185.9137+5.5163e-07j,  30.3673-0.0000e+00j,
         40.0771-5.0888e-07j,  12.7737-4.7684e-07j,  61.8985-2.9070e-07j,
         23.4261+1.6874e-06j, 152.8848+1.8075e-06j,   2.2516+7.2177e-09j,
         76.3793+1.9594e-06j,  71.5025+1.1093e-06j,   7.1497-4.8624e-06j,
         51.0636+6.1512e-07j,   1.6146-2.9095e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(68.15451049804688-3.135091048989125e-07j)
torch.linalg.det(H.mH@H) = tensor([1.4283-1.0010e-07j, 0.1666-3.7253e-09j, 2.9138-2.7997e-07j,
        0.3883+7.0532e-09j, 1.1750+7.7463e-08j, 2.0074+6.9095e-08j,
        0.0424+1.6852e-09j, 0.1114+2.7114e-10j, 8.3458+7.1783e-08j,
        0.0910-2.3032e-09j, 0.9258-9.0555e-09j, 1.0385-0.0000e+00j,
        0.1041+8.3819e-09j, 0.8855+2.6322e-08j, 1.2886+3.0676e-08j,
        1.6138-1.1921e-07j, 6.6980+7.7224e-08j, 0.8478-5.5132e-09j,
        0.3320+3.9970e-09j, 0.2975+4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.535076379776001-5.0609059165651615e-09j)
SINR torch.Size([20]) = tensor([-3.6655, -1.0535, -0.9307, -0.4665,  1.1629,  1.2103, -2.7266,  0.0197,
        -3.1669, -3.8248, -2.5876, -1.3493, -4.0349, -2.3431, -9.0257, -0.1778,
         0.8743, -8.2796, -1.6819, -8.4962], device='cuda:0')
SINR mean = -2.527179718017578
E[H^H] = 1e-07
E_MSE (Error Power) = 2.3617279529571533
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3007, 0.4396, 0.4466, 0.4732, 0.5665, 0.5692, 0.3480, 0.5011, 0.3254,
        0.2930, 0.3553, 0.4229, 0.2831, 0.3683, 0.1112, 0.4898, 0.5502, 0.1294,
        0.4044, 0.1239], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([483, 391, 387, 371, 315, 313, 450, 354, 465, 488, 445, 401, 495, 436,
        658, 361, 324, 635, 413, 642], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 0-----------
Real SNR = tensor([-0.1792,  1.0075, -0.7082,  3.0525, -4.5851,  0.8672, -2.3828,  2.1179,
         1.2468, -1.1642, -3.3582,  0.4051, -1.2275, -3.1999, -1.8618,  4.4200,
        -1.1085,  0.9667, -1.0623, -0.5273], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([141.5337-5.6402e-07j,  17.3748+1.6273e-06j,   7.0862-6.0123e-08j,
         10.7699-3.2642e-07j,  15.9400+9.8073e-07j,  45.1961+4.7203e-07j,
        114.5820+2.4205e-06j,   1.6819+4.7684e-07j,  58.3324-2.0544e-07j,
         45.1382-8.7171e-07j,   4.1889+1.4305e-06j, 246.3440+2.8095e-06j,
         57.7946-0.0000e+00j,  23.7543+6.0288e-07j,  40.1426-3.8147e-06j,
        130.6189-4.3526e-05j,   4.2676-4.7684e-07j, 127.1723+7.6294e-06j,
         54.0693+4.7658e-07j,  23.7371+1.9073e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(58.486244201660156-1.450576519346214e-06j)
torch.linalg.det(H.mH@H) = tensor([ 7.9905+9.4804e-08j,  4.0451-4.2057e-09j,  3.0771+3.4667e-08j,
         1.5352+6.9372e-08j,  0.7416-1.3786e-08j,  0.3598-5.2154e-08j,
         0.1039+1.6959e-08j,  0.6877+2.6822e-07j,  2.2244+1.4922e-08j,
         3.0893+2.7945e-08j,  0.6066-4.9373e-09j,  6.4474-1.2133e-08j,
         2.5431+2.6922e-08j,  0.6381+1.0295e-08j,  0.0918-4.6566e-10j,
        10.7648-2.4564e-07j,  1.1102-2.0702e-08j,  5.2044-2.0416e-07j,
         1.8478-1.0074e-08j,  4.2711-4.3171e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.8689961433410645-4.2301381841802765e-10j)
SINR torch.Size([20]) = tensor([-1.8392, -5.3551, -5.0369, -4.7977, -5.7159, -2.2222,  1.1296, -9.3793,
        -0.3091, -3.3766, -7.7082, -1.0949, -1.4646, -1.2773, -1.6106,  0.1581,
        -4.9341, -0.7479, -0.3079, -4.8915], device='cuda:0')
SINR mean = -3.0390594005584717
E[H^H] = 1e-07
E_MSE (Error Power) = 2.610365629196167
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3957, 0.2256, 0.2387, 0.2489, 0.2115, 0.3748, 0.5647, 0.1034, 0.4822,
        0.3149, 0.1449, 0.4373, 0.4165, 0.4270, 0.4083, 0.5091, 0.2430, 0.4571,
        0.4823, 0.2448], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([419, 541, 530, 522, 553, 432, 316, 669, 365, 473, 617, 393, 406, 399,
        411, 349, 526, 380, 365, 525], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 1-----------
Real SNR = tensor([ 0.9636, -6.3670, -4.8206, -0.5936,  3.0645,  0.2624,  0.5245,  2.6660,
        -1.1159,  2.7352, -2.4413, -0.3190, -5.8454, -2.8004,  0.3077, -1.4253,
         0.2105, -1.8360, -3.5982, -0.6276], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.3614+4.8195e-08j,  3.2910+8.6073e-08j, 17.7671+4.8769e-07j,
        40.8990-6.8985e-07j, 21.0499+7.7486e-07j,  8.6488+5.3408e-07j,
        29.1890-9.0770e-07j, 41.7520-1.0409e-05j, 39.0709+3.7158e-06j,
         9.2635-1.2180e-06j, 49.8185+2.8203e-07j, 11.3041+4.1657e-06j,
        46.6544-9.0413e-07j, 16.6045+4.5500e-07j,  4.6114-8.5557e-08j,
         1.3461-2.5203e-07j,  1.9726+3.2707e-07j, 18.9519+9.5367e-07j,
         0.4016+2.2352e-08j, 10.4089-4.4785e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(18.968324661254883-1.3089447747915983e-07j)
torch.linalg.det(H.mH@H) = tensor([ 3.5486+6.6432e-08j,  0.2375-2.2509e-09j,  0.2997-3.8224e-09j,
         0.2277-5.2154e-08j, 15.0963-6.0802e-08j,  1.3797-2.0084e-08j,
         0.4280-1.3604e-07j,  2.9700+3.5135e-07j,  0.6722-2.1011e-08j,
         1.1347+2.9686e-07j,  1.9005+3.4905e-08j,  1.3904+2.6408e-09j,
         0.0822+3.7253e-09j,  0.3143+1.0431e-07j,  2.2755+1.4314e-07j,
         0.4577-1.0836e-07j,  1.2995+6.5175e-08j,  0.1408-0.0000e+00j,
         0.1710-3.7977e-09j,  0.1149-6.4396e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7070592641830444+2.9791470623763416e-08j)
SINR torch.Size([20]) = tensor([ -0.8405,  -6.1803,  -1.0576,  -2.5748,  -1.4695,  -6.0316,  -0.5274,
         -1.6424,  -2.2670,  -2.8503,   1.0610,  -7.1682,  -0.8725,  -2.3942,
         -5.2197, -10.6449,  -7.5561,  -1.9173,  -9.3366,  -5.3856],
       device='cuda:0')
SINR mean = -3.743778944015503
E[H^H] = 1e-07
E_MSE (Error Power) = 3.2887489795684814
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4518, 0.1942, 0.4394, 0.3560, 0.4162, 0.1996, 0.4697, 0.4066, 0.3724,
        0.3416, 0.5608, 0.1610, 0.4499, 0.3656, 0.2311, 0.0794, 0.1493, 0.3914,
        0.1043, 0.2244], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([384, 568, 391, 445, 406, 563, 373, 412, 434, 454, 318, 600, 385, 438,
        536, 706, 613, 421, 668, 542], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 2-----------
Real SNR = tensor([ 0.9720,  1.0325, -3.4456,  3.7217, -1.1078, -1.5680,  2.0066,  5.1449,
         3.2794,  1.1596,  3.2291, -1.3290, -0.2080,  1.5582, -0.6138, -0.9030,
        -0.1547, -0.3717,  3.8981,  3.5148], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  1.7658-5.6420e-08j,  53.3444+1.0402e-06j,   3.8793+1.1921e-07j,
         13.2842-1.4052e-06j,  87.3643-1.2277e-07j,   1.8627+5.7781e-07j,
         14.6883+3.6031e-07j,  32.6814-0.0000e+00j,  80.3765-5.2952e-07j,
          8.8768+4.7684e-07j,   4.5102-6.3162e-07j,   3.3124+3.2783e-07j,
          0.7674+9.4622e-07j,  20.0493+8.8445e-07j,  19.2712+5.6415e-07j,
         21.3401-8.9779e-07j, 127.5480-3.0969e-07j,  13.4357-3.2210e-07j,
          7.7364+9.5367e-07j,  24.5639-2.3957e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(27.032917022705078+8.680068219746317e-08j)
torch.linalg.det(H.mH@H) = tensor([ 2.5569+5.9006e-08j,  2.6752-1.0985e-08j,  0.2213-5.6054e-09j,
         2.8628-2.6320e-08j,  1.2628+3.2282e-08j,  0.1222-8.1956e-08j,
         1.7326+3.7880e-08j, 10.3777-1.0413e-07j,  6.4618+1.0560e-08j,
         2.4351-5.9541e-08j,  4.6145+1.7041e-07j,  0.7135-8.9407e-08j,
         0.2859+1.4901e-08j,  3.0944-5.0243e-09j,  0.6294-0.0000e+00j,
         0.4143-1.5456e-08j,  2.5505-2.1171e-08j,  0.2893+3.7253e-08j,
         0.0689+1.0058e-07j,  1.7986-1.4323e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.258394956588745-4.997836366982256e-09j)
SINR torch.Size([20]) = tensor([ -6.7215,   0.8546,  -2.9721,  -1.0705,  -0.8995,  -6.5905,  -0.7139,
         -0.4900,   2.1161,  -5.6082,  -5.3691,  -9.2041, -11.7411,  -1.7400,
         -4.8189,   0.2779,   1.9756,   0.0476,  -4.2935,   0.3328],
       device='cuda:0')
SINR mean = -2.831430673599243
E[H^H] = 1e-07
E_MSE (Error Power) = 2.9223339557647705
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1754, 0.5490, 0.3353, 0.4387, 0.4484, 0.1798, 0.4590, 0.4718, 0.6195,
        0.2156, 0.2251, 0.1072, 0.0628, 0.4012, 0.2479, 0.5160, 0.6118, 0.5027,
        0.2712, 0.5191], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([586, 325, 458, 392, 386, 582, 379, 371, 283, 549, 541, 664, 737, 415,
        522, 345, 288, 353, 504, 343], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 3-----------
Real SNR = tensor([ 1.6461,  3.0988,  1.2477,  3.4738,  0.1896,  2.1583,  3.6254,  2.5431,
         3.6536,  3.9341,  1.7722, -2.4792, -1.2814,  0.6167,  1.6521,  5.4521,
         1.7485,  0.8499,  1.0976, -0.0536], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 18.4139-5.9590e-07j,   9.8094+5.8332e-07j,   8.7981+2.9743e-07j,
        137.0588-1.5821e-06j,   0.9153-1.7881e-07j,   2.1990-5.9605e-08j,
         16.5714+2.6725e-10j,  21.9198+1.6544e-07j,  36.1115+2.0051e-06j,
         89.7528-0.0000e+00j,  28.0566-5.2310e-07j,   2.9666-1.4905e-07j,
          0.3563-1.3940e-09j,  14.7830+3.9507e-07j,   9.3876+4.7684e-07j,
         44.1976+1.9836e-06j,   0.1828-0.0000e+00j,   2.8887+6.0507e-08j,
         14.4534+6.0296e-07j,   2.0603-1.1325e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(23.044160842895508+1.174078292365266e-07j)
torch.linalg.det(H.mH@H) = tensor([0.5661+4.5520e-08j, 3.7425-2.2505e-08j, 0.5545-1.8370e-08j,
        8.2268+5.4075e-09j, 0.8655+7.8636e-09j, 1.6504+3.3788e-10j,
        3.5272-1.7479e-08j, 0.0259-4.0047e-08j, 5.8443+9.9125e-08j,
        7.3655-2.1112e-08j, 3.2209-5.8424e-08j, 0.1113+2.0924e-10j,
        0.1543-1.0245e-08j, 1.2216+1.2299e-07j, 0.7018-1.7002e-08j,
        5.0701-9.4552e-08j, 0.8752+2.9802e-08j, 0.6991-1.0411e-09j,
        2.5644-9.9799e-09j, 0.9186+1.9086e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3952908515930176+9.7901120543753e-10j)
SINR torch.Size([20]) = tensor([ -3.3694,  -3.5009,  -3.9298,   2.9299,  -9.8221,  -7.5353,  -1.7168,
         -3.5817,   1.6427,   0.5050,   0.5353,  -1.2835,  -9.1112,   1.9743,
         -3.3949,   0.1976, -12.7405,  -2.0772,  -2.2872,  -6.9090],
       device='cuda:0')
SINR mean = -3.173740863800049
E[H^H] = 1e-07
E_MSE (Error Power) = 3.568213701248169
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3152, 0.3087, 0.2881, 0.6625, 0.0944, 0.1499, 0.4024, 0.3048, 0.5935,
        0.5290, 0.5308, 0.4266, 0.1093, 0.6117, 0.3140, 0.5114, 0.0505, 0.3827,
        0.3713, 0.1693], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([472, 477, 492, 257, 682, 612, 414, 480, 299, 337, 336, 399, 661, 288,
        473, 348, 764, 427, 434, 592], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 4-----------
Real SNR = tensor([-2.7609,  2.7940,  2.2700,  5.5659,  4.7690,  2.9115,  1.7049,  5.9994,
         3.4284,  4.5733,  3.9398,  5.3864,  8.1097,  4.0853,  4.7095,  6.3871,
         3.4175, -0.2951,  2.4009,  6.6716], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.5104+1.6993e-07j,  0.7386-2.9802e-08j, 21.8106-1.5015e-06j,
         1.8679+1.8130e-07j, 15.9257+4.3403e-07j,  1.9090+1.7125e-07j,
         3.5949+3.4583e-09j,  6.6671+8.0669e-08j,  1.2352-8.0466e-07j,
         4.1255+1.5524e-08j,  7.9118-0.0000e+00j,  1.8472+9.1829e-08j,
         3.3034+2.6822e-07j, 52.1163+1.6520e-06j,  1.4960+1.5031e-07j,
         3.9387+4.7684e-07j,  1.3517-1.1608e-08j, 13.0598+1.3386e-07j,
        19.7251+1.4305e-06j, 27.3348-6.1754e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(9.673480033874512+1.147303265724986e-07j)
torch.linalg.det(H.mH@H) = tensor([0.0148+2.4403e-09j, 1.5094-4.5437e-08j, 3.3058-7.5774e-08j,
        4.2502-6.3161e-09j, 2.0254+9.2995e-08j, 3.4570-3.7246e-08j,
        1.3135+4.4184e-08j, 4.7005+1.2797e-07j, 1.0415+1.1306e-08j,
        0.8678-0.0000e+00j, 2.5257-9.9042e-09j, 0.9944+8.5070e-09j,
        5.0634+1.7146e-08j, 3.3610+8.9238e-08j, 0.8576-4.6639e-08j,
        1.5714-1.5464e-07j, 0.1670-2.2352e-08j, 0.5197-2.5984e-09j,
        0.3480+1.1990e-08j, 3.4683+1.3760e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.068127393722534+7.123947209919379e-09j)
SINR torch.Size([20]) = tensor([-2.3453, -7.5877,  1.1971, -7.5263,  1.4938, -7.3238, -5.8878, -1.4544,
        -7.4040,  0.0350, -3.2134, -7.7874, -6.2170,  2.5123, -8.6657, -5.3033,
        -5.8294,  0.6667, -3.3549,  1.3068], device='cuda:0')
SINR mean = -3.634434223175049
E[H^H] = 1e-07
E_MSE (Error Power) = 3.4334678649902344
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3682, 0.1484, 0.5685, 0.1502, 0.5852, 0.1563, 0.2049, 0.4170, 0.1538,
        0.5020, 0.3230, 0.1427, 0.1929, 0.6407, 0.1197, 0.2277, 0.2071, 0.5383,
        0.3159, 0.5747], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([436, 614, 314, 612, 304, 605, 558, 405, 608, 353, 467, 620, 569, 271,
        647, 539, 556, 332, 472, 310], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 5-----------
Real SNR = tensor([ 1.3021,  5.2500,  5.8277,  2.3527,  1.3481,  5.5894,  5.6418,  0.7993,
         4.5907,  1.3641,  5.8198,  0.8536,  3.3864,  4.3755,  1.4283, -0.0753,
         5.6505, -2.3869,  6.6346,  2.9396], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2421+2.1988e-08j,  9.8292+1.2205e-06j,  6.2235-7.1526e-07j,
         3.0618+3.5464e-08j,  6.9820+3.9871e-08j,  2.4896-2.3842e-07j,
         0.9656-2.9802e-08j,  0.9144+3.2256e-08j,  9.6387+4.7684e-07j,
        20.5402-3.4795e-07j, 18.8054-1.6309e-08j,  2.5590-0.0000e+00j,
         2.9733+2.3842e-07j, 33.7188-1.0608e-07j,  0.0788-3.0932e-08j,
         0.9332+1.7824e-09j, 38.9925-1.1777e-06j, 15.4946+1.4544e-07j,
         8.4275+2.7874e-07j,  0.7788-1.3039e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(9.182459831237793-1.5079978155085882e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6416+3.2875e-09j, 1.0476-9.9139e-08j, 1.6583-0.0000e+00j,
        0.0211-1.7067e-09j, 0.2302-7.4506e-09j, 4.3053-2.1505e-08j,
        1.1114+1.5036e-08j, 0.1366+2.2352e-08j, 1.7233-2.9802e-07j,
        0.8256-1.4224e-09j, 8.0745+4.6022e-08j, 0.2938+1.4901e-08j,
        1.9071+1.5130e-08j, 4.0472-0.0000e+00j, 0.1333+2.9553e-09j,
        0.2133+1.7949e-09j, 1.5322-2.9802e-08j, 0.1628+2.7940e-09j,
        2.9669-4.3450e-08j, 2.0644-2.3406e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6548261642456055-2.0081637686075737e-08j)
SINR torch.Size([20]) = tensor([-12.3464,  -1.9635,  -0.8423,  -2.4147,  -0.6747,  -4.5375,  -7.4787,
         -6.6720,  -1.8573,  -1.5768,   0.6008,  -4.2732,  -6.4307,  -0.7010,
        -14.7531,  -2.6471,   3.3261,  -1.3626,   0.8546,  -7.7715],
       device='cuda:0')
SINR mean = -3.676077365875244
E[H^H] = 1e-07
E_MSE (Error Power) = 4.432210445404053
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0551, 0.3889, 0.4517, 0.3645, 0.4612, 0.2602, 0.1516, 0.1771, 0.3947,
        0.4102, 0.5345, 0.2721, 0.1853, 0.4597, 0.0324, 0.3522, 0.6826, 0.4222,
        0.5490, 0.1431], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([753, 423, 384, 439, 378, 513, 610, 584, 419, 409, 334, 504, 576, 379,
        815, 447, 245, 402, 325, 619], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 6-----------
Real SNR = tensor([ 2.4136,  7.7320,  2.8665,  8.3980,  4.4227,  5.6300,  3.9872,  6.5758,
         7.1926, -3.9244,  5.7364,  5.3078,  9.5031,  5.7397,  0.7556,  6.7761,
         1.9343,  8.8842,  1.1883,  5.8474], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.3803+2.3423e-07j, 31.7528+5.7739e-07j,  1.9373+2.9078e-07j,
         8.0651-5.2901e-07j,  3.1679+3.2643e-08j, 11.8220-1.0977e-08j,
        12.2699-5.2715e-07j,  0.1123+7.8976e-07j, 28.2774+3.1881e-08j,
         1.1141-2.3824e-09j,  4.0251+2.4071e-08j,  3.6004-1.7881e-07j,
        24.3025+2.3147e-08j,  3.7126-1.0609e-08j,  0.1638+1.8384e-09j,
         3.3796+2.7898e-08j,  3.6832-2.3457e-08j,  2.5496-0.0000e+00j,
         1.5935+9.2406e-08j,  0.4860-1.9743e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.519777774810791+4.1195676203642506e-08j)
torch.linalg.det(H.mH@H) = tensor([1.6683e+00+1.5100e-08j, 2.4678e+00+4.6163e-08j, 3.8516e-01+1.4901e-08j,
        8.2429e-01-5.3644e-07j, 2.0027e+00+2.8333e-08j, 3.4035e+00-2.3488e-08j,
        6.4037e-01+6.7055e-08j, 3.4768e+00+4.4857e-08j, 4.0328e+00-0.0000e+00j,
        4.6230e-04+2.6807e-09j, 3.0908e+00-2.3798e-08j, 2.4236e+00-1.7881e-07j,
        1.4843e+01+2.4755e-07j, 1.5320e+00-5.6855e-08j, 3.4103e-01-2.9076e-10j,
        7.3787e-01-5.4438e-09j, 4.3887e-02-1.0122e-09j, 4.7594e+00-2.8425e-07j,
        1.2834e+00+6.1374e-09j, 1.4484e+00-1.9032e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.470287322998047-3.28325420184683e-08j)
SINR torch.Size([20]) = tensor([  0.8604,   2.1550,  -2.1555,  -3.2490,  -2.0371,   3.9418,   3.3586,
        -16.3174,   2.0326,  -2.6737,   1.1623,  -3.1765,   0.5055,   1.2760,
         -7.2776,  -1.7987,  -1.4844, -12.3364,  -3.0323, -10.6526],
       device='cuda:0')
SINR mean = -2.54494571685791
E[H^H] = 1e-07
E_MSE (Error Power) = 5.658534526824951
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5494, 0.6216, 0.3784, 0.3212, 0.3848, 0.7125, 0.6842, 0.0228, 0.6149,
        0.3508, 0.5665, 0.3249, 0.5291, 0.5729, 0.1577, 0.3979, 0.4154, 0.0552,
        0.3322, 0.0792], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([325, 282, 430, 468, 426, 227, 244, 853, 286, 448, 315, 466, 337, 311,
        604, 417, 406, 753, 461, 706], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 7-----------
Real SNR = tensor([3.9133, 7.4050, 7.3751, 4.3992, 3.5234, 7.8841, 0.5984, 7.5959, 3.3127,
        2.9170, 3.4642, 7.7417, 3.6212, 5.3301, 8.3552, 8.8204, 4.6935, 3.4241,
        6.5521, 5.9323], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 7.7232-3.0887e-07j, 12.4157+2.2444e-08j,  3.4081-1.3360e-07j,
         1.2874-9.5995e-08j,  0.3381+3.7057e-09j,  9.7780-2.3505e-07j,
         4.4818+4.2293e-08j,  0.1219+2.2600e-08j,  0.4028-5.9605e-08j,
         1.5686+1.1176e-08j,  0.8808-1.1921e-07j, 10.3802-5.9585e-07j,
         0.0981-2.4665e-08j,  1.0196+5.3673e-08j,  1.2890+7.6722e-08j,
         5.8110-2.3842e-07j,  1.9418+3.1080e-09j, 13.7890+4.2100e-07j,
         1.5355-1.7881e-07j, 10.7481-6.9253e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.4509429931640625-7.013041170012002e-08j)
torch.linalg.det(H.mH@H) = tensor([0.8516-3.0469e-09j, 0.1434-3.6897e-09j, 2.2037+1.6071e-08j,
        0.1994-1.8626e-08j, 0.9210+1.0830e-08j, 7.1226+7.2446e-08j,
        0.4160-2.9104e-09j, 3.8973-2.3556e-08j, 0.3356-4.0050e-09j,
        0.0594+4.2841e-08j, 0.2689+5.1183e-09j, 4.4058-4.6884e-08j,
        0.5465+1.5984e-08j, 2.7594-4.6822e-08j, 0.0804-1.7727e-07j,
        2.1310+1.4901e-08j, 0.9272-0.0000e+00j, 0.0815+1.3399e-09j,
        1.2046+8.2050e-08j, 1.6552+1.2958e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5105253458023071-2.6138522457586078e-09j)
SINR torch.Size([20]) = tensor([  1.9409,   2.7511,  -0.3395,  -1.6898,  -0.1283,   0.3637,   0.7108,
        -13.8407,  -3.5198,  -4.2264,  -5.6174,   2.0886, -16.6668,  -4.8548,
         -4.9518,   1.9316,  -2.1845,   2.3907,  -5.9521,   3.0505],
       device='cuda:0')
SINR mean = -2.4372036457061768
E[H^H] = 1e-07
E_MSE (Error Power) = 5.594217777252197
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6099, 0.6533, 0.4805, 0.4039, 0.4926, 0.5209, 0.5408, 0.0397, 0.3078,
        0.2743, 0.2153, 0.6180, 0.0211, 0.2464, 0.2423, 0.6094, 0.3768, 0.6342,
        0.2025, 0.6687], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([289, 263, 366, 413, 359, 342, 330, 792, 478, 502, 549, 284, 861, 524,
        527, 289, 431, 274, 561, 254], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 8-----------
Real SNR = tensor([ 6.6980,  7.4457,  3.2328,  5.8989,  8.6381, 10.9518,  6.1051,  7.1581,
         8.8054,  4.7675, 10.1367, -1.1604,  2.9460,  8.0066,  5.8166,  6.9726,
         4.0203,  8.1318,  5.1611,  9.4096], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.5715+1.6764e-08j,  1.0334-1.7881e-07j,  2.2080+2.1602e-08j,
         1.0494+7.4506e-09j, 12.5990+3.9863e-07j,  8.3654-0.0000e+00j,
         4.3032+2.0132e-08j,  0.0709-2.8315e-09j,  0.2316+1.8620e-08j,
         1.9403-1.7430e-08j,  7.8522+7.8943e-07j,  0.7129+2.0862e-07j,
         1.4661+8.8126e-09j,  5.8043-7.3974e-08j,  2.2892-6.1238e-08j,
         0.5871-5.9605e-08j,  4.0637-3.8316e-08j,  5.0774+8.7855e-08j,
         2.4273-8.2621e-09j,  7.2296+2.0137e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.494124174118042+5.7879201875721265e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.8187-1.4901e-08j,  1.4888-5.9605e-08j,  0.3006-0.0000e+00j,
         0.3142+3.5097e-09j,  0.6205-4.8509e-08j, 13.0304+9.5367e-07j,
         2.9325-3.4405e-08j,  0.0182-2.8915e-08j,  0.3312+8.7087e-09j,
         0.6277+1.4901e-08j,  6.4381-1.0261e-07j,  0.0612-0.0000e+00j,
         0.3363+4.5066e-09j,  2.1819-8.9407e-08j,  0.3417+1.4901e-08j,
         0.1952+1.4901e-08j,  0.7244+6.4137e-09j,  2.1082+6.0745e-08j,
         0.2410+7.4506e-08j,  0.9974-3.4553e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7054160833358765+3.719301133742192e-08j)
SINR torch.Size([20]) = tensor([ -7.8147,  -7.2784,   0.2583,   0.3161,   1.2319,  -2.4406,   2.7924,
        -12.1274,  -7.0432,  -1.1920,   2.0815,  -5.9464,  -0.0315,   3.2438,
         -3.2252,  -6.4689,   2.5015,   3.9321,  -1.5337,   2.2568],
       device='cuda:0')
SINR mean = -1.8243827819824219
E[H^H] = 1e-07
E_MSE (Error Power) = 2.7390849590301514
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1419, 0.1576, 0.5149, 0.5182, 0.5704, 0.3631, 0.6554, 0.0577, 0.1650,
        0.4318, 0.6176, 0.2027, 0.4982, 0.6785, 0.3224, 0.1840, 0.6401, 0.7121,
        0.4126, 0.6271], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([621, 604, 345, 344, 312, 440, 262, 747, 596, 396, 284, 560, 355, 248,
        467, 578, 271, 227, 408, 279], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 9-----------
Real SNR = tensor([ 5.5846, 10.9632, 12.3906,  8.7333,  6.0488,  6.1936,  6.2553, 11.0825,
         3.5205, 10.6816,  8.6529,  5.1243,  5.8190,  9.4148,  8.7069,  8.0993,
         4.8645, 13.1562, 10.3232,  8.1474], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2398+9.3145e-09j, 15.1939-5.3230e-08j,  1.7278-1.6805e-07j,
         0.1385+6.6567e-09j,  1.5913-2.4428e-08j,  1.6842-1.3381e-08j,
         2.5379-2.7709e-07j, 13.2194+1.1395e-06j,  1.3577-2.8513e-08j,
         1.9604-1.2782e-08j,  2.2747-8.9407e-08j,  0.3820+1.4901e-08j,
         3.5130+9.1538e-08j,  5.5103+4.0132e-08j,  0.4058-2.9802e-08j,
         3.9424+1.2508e-07j,  0.0776-3.9155e-08j, 14.6718+7.5762e-07j,
         0.6220-6.2307e-08j,  1.4234+4.6566e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.6236984729766846+6.956445730565974e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.1601-4.6265e-08j,  7.4900-6.8269e-09j,  1.7285-8.8240e-09j,
         1.3296-2.6301e-09j,  0.4075-2.9159e-09j,  0.9693-1.3986e-08j,
         4.4949+1.0735e-07j,  1.4297-6.7258e-08j,  0.1598-0.0000e+00j,
         2.2789+2.9906e-08j,  2.9604+1.1589e-08j,  0.9292-1.3836e-08j,
         1.2300+2.4674e-08j,  1.3297-6.6095e-08j,  0.0286-9.9628e-08j,
         3.0568+2.0411e-08j,  0.3887-1.0272e-08j, 24.8800-3.1730e-07j,
         4.1506-3.4097e-07j,  2.5894+3.5954e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.099595785140991-3.834620798670585e-08j)
SINR torch.Size([20]) = tensor([ -6.6442,   4.2045,  -2.2940,  -6.8853,   2.1986,   3.0704,  -2.0070,
          5.6199,   0.4710,  -5.7816,   0.6363,  -6.1582,   5.1183,   4.4223,
         -9.6708,   0.4340, -10.1050,   8.0956,  -6.5004,   0.9354],
       device='cuda:0')
SINR mean = -1.0420093536376953
E[H^H] = 1e-07
E_MSE (Error Power) = 3.03202748298645
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1780, 0.7247, 0.3709, 0.1700, 0.6239, 0.6697, 0.3865, 0.7848, 0.5271,
        0.2090, 0.5366, 0.1950, 0.7647, 0.7346, 0.0974, 0.5250, 0.0889, 0.8658,
        0.1829, 0.5536], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([583, 219, 435, 591, 281, 253, 425, 180, 338, 555, 333, 567, 193, 213,
        677, 339, 690, 123, 579, 322], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 10-----------
Real SNR = tensor([ 6.9371,  3.8653, 13.0227, 16.4964,  5.1867, 16.2202, 12.6910,  7.9831,
         4.7178,  4.6742, 11.0338,  9.5447, 10.7745,  6.5431, 10.6621, 12.9006,
        12.7087,  9.2586, 12.7232, 12.0428], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.2924e-01-2.2352e-08j, 5.7952e+00-2.1267e-07j, 1.6966e+00+1.6048e-08j,
        2.2798e-01+1.4675e-07j, 1.6070e+00-2.8965e-09j, 4.5965e+01+1.5182e-07j,
        8.7388e+00+3.0785e-07j, 5.0290e-01+1.4901e-08j, 6.6148e+00-2.3102e-08j,
        1.7128e-01-1.6764e-08j, 2.1766e+01+7.7552e-08j, 3.9215e+00-9.0182e-09j,
        5.5109e-01-2.0862e-07j, 3.0549e-02-4.9826e-08j, 4.2302e+00+2.9802e-08j,
        1.7117e+01-1.1053e-06j, 6.0483e+00-9.2727e-08j, 3.8069e-02-1.9671e-07j,
        4.6177e+00-3.6114e-07j, 6.2825e+00-6.7612e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.812603950500488-1.1162624247162967e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.3884+1.8808e-08j,  0.3197-0.0000e+00j,  2.7876+7.6031e-08j,
         9.3911+2.1216e-08j,  0.1884+8.3683e-09j, 19.2153+4.0801e-07j,
         5.0994+9.0366e-08j,  1.3333-2.4924e-08j,  0.2647+1.1243e-08j,
         0.5661-6.2341e-09j,  7.0985+5.5336e-08j,  0.4769-2.1264e-08j,
         4.1217+6.5645e-09j,  0.7186+5.9605e-08j,  6.5601-8.9249e-09j,
         0.1006-2.8943e-08j,  1.6298+1.3177e-07j,  0.8305-1.1423e-07j,
         1.7930-9.4958e-08j,  4.1561+1.9167e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.351987600326538+3.897584122114495e-08j)
SINR torch.Size([20]) = tensor([ -5.3603,   2.0437,   3.9391, -18.3877,   3.9023,   7.3273,   8.6757,
         -3.0185,   3.6860,  -7.3528,   7.0016,   2.1709, -11.5886, -18.5672,
          3.2503,   1.0559,   3.9998, -17.9611,   2.0536,   4.5855],
       device='cuda:0')
SINR mean = -1.427228331565857
E[H^H] = 1e-07
E_MSE (Error Power) = 11.915811538696289
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2254, 0.6155, 0.7124, 0.0143, 0.7106, 0.8439, 0.8805, 0.3329, 0.7003,
        0.1554, 0.8337, 0.6224, 0.0649, 0.0137, 0.6788, 0.5605, 0.7152, 0.0157,
        0.6161, 0.7419], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([541, 286, 227, 900, 228, 139, 111, 460, 234, 606, 146, 281, 732, 903,
        247, 318, 225, 890, 285, 208], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 11-----------
Real SNR = tensor([ 1.7208,  7.2855, 10.8389,  9.6314, 14.7222,  7.9988, 10.1550,  9.3040,
        13.5579,  9.7424,  7.1251,  7.9993,  3.8624,  8.0814, 10.6971,  7.5537,
         9.7240, 10.8694, 10.8534,  8.0643], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1148e-01+1.2591e-08j, 3.2133e-01-1.5669e-08j, 4.3382e+00-1.2677e-06j,
        4.6103e+00-1.9847e-08j, 3.8785e+00+3.5448e-08j, 6.7052e-01-2.3693e-09j,
        2.8085e+00-4.9483e-09j, 8.7681e-01+2.6255e-08j, 7.6707e+00-8.5838e-08j,
        6.6322e+00-4.7684e-07j, 3.8568e-01-1.4901e-08j, 6.5170e-01+2.1542e-08j,
        2.8295e-03-1.0128e-08j, 2.2912e-01+8.4363e-08j, 6.0351e+00+1.4516e-07j,
        5.4301e+00-2.3842e-07j, 1.7498e+00-4.4703e-08j, 1.8735e+01+1.3498e-07j,
        2.6406e+00+1.8454e-08j, 6.1534e-01+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.419678211212158-8.438570375801646e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0494e-02+3.2890e-09j, 3.9485e-01-4.8982e-09j, 1.4390e+00+1.4901e-07j,
        1.2835e+00+1.9415e-08j, 5.5853e+00+1.5039e-07j, 9.8590e-02+9.5069e-09j,
        1.6700e-01+7.5057e-09j, 2.1625e+00-8.0325e-10j, 2.1996e+01-2.5675e-08j,
        1.4638e+00-0.0000e+00j, 1.6377e-01+1.8626e-09j, 8.4263e-01-9.5195e-09j,
        2.5631e-01+1.7403e-09j, 7.3240e-02+6.7055e-08j, 1.7112e-01-3.0161e-08j,
        2.0796e-01+2.2352e-08j, 1.0378e+00-3.1665e-08j, 6.3716e+00+6.9035e-08j,
        3.3091e+00-1.0415e-07j, 1.0776e+00+1.1321e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4056079387664795+1.5280667398087644e-08j)
SINR torch.Size([20]) = tensor([ -6.9506,  -3.9862,   0.0764,   7.2288,   2.7014,  -4.1783,  -1.9353,
         -0.3172,   6.0255,   3.5704,  -2.2197,  -4.0476, -22.0194,  -4.3560,
          2.3416,   2.2417,   0.6595,   8.5197,   3.9307,  -3.2498],
       device='cuda:0')
SINR mean = -0.7982110977172852
E[H^H] = 1e-07
E_MSE (Error Power) = 12.125689506530762
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1679, 0.2854, 0.5044, 0.8408, 0.6507, 0.2765, 0.3904, 0.4817, 0.8002,
        0.6947, 0.3749, 0.2825, 0.0062, 0.2684, 0.6316, 0.6263, 0.5379, 0.8767,
        0.7120, 0.3212], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([593, 494, 352, 141, 265, 500, 422, 365, 170, 238, 432, 496, 975, 507,
        276, 279, 332, 114, 227, 468], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 12-----------
Real SNR = tensor([12.3407, 13.0133, 10.4761, 10.8160, 11.2780, 12.6225,  9.6226, 12.5203,
        10.3278, 11.6542, 10.4298, 11.2570, 11.6547, 11.6497, 10.1495, 14.3411,
        10.1870,  8.6444, 13.3484, 12.7444], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.7396+1.3009e-07j, 10.4095-4.7684e-07j,  4.6424+2.3842e-07j,
         1.7151+1.4901e-08j,  0.4350+4.1088e-09j,  4.8143+5.3438e-09j,
         0.5642+2.9802e-08j,  1.7965+7.7486e-07j,  1.1768+3.2945e-07j,
         9.5525+6.9717e-08j,  1.1381-7.7884e-08j,  4.6957-1.9516e-07j,
         5.1146+4.4703e-08j,  6.3802+7.6336e-08j,  2.3690-3.5577e-08j,
         0.1527+7.8231e-08j,  1.7105-1.6862e-08j,  0.5587-2.9802e-08j,
         1.4026+2.9802e-07j,  2.0488+9.4153e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.120842218399048+6.780103944947768e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4928+3.7085e-08j, 9.0402-2.3842e-07j, 0.2578-3.6254e-08j,
        1.3337+5.9605e-08j, 0.1300+2.3383e-08j, 1.3789-8.3672e-08j,
        2.3115-5.9605e-08j, 1.0877+2.9802e-07j, 0.4756-8.3818e-09j,
        7.8594+9.3873e-08j, 0.6039-2.4078e-09j, 4.6263-1.0180e-07j,
        0.7259-5.9605e-08j, 6.7006+1.3110e-07j, 0.8901+1.4564e-08j,
        2.5726-8.8316e-08j, 0.8807+2.0870e-08j, 0.1877-3.7253e-09j,
        2.4298-0.0000e+00j, 2.7734+1.4671e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.337939500808716+5.4916038383368e-10j)
SINR torch.Size([20]) = tensor([ 1.7814e+00,  6.2168e+00,  4.8886e+00,  1.4460e+00, -2.9981e+00,
         2.5707e+00, -2.3622e+00,  1.2208e+00, -1.8615e+00,  8.1542e+00,
         2.9821e-03,  3.4871e+00,  3.6221e+00,  6.0466e+00,  4.7862e+00,
        -9.7178e+00,  2.6788e+00, -1.6162e+00, -1.0826e+00,  3.1198e+00],
       device='cuda:0')
SINR mean = 1.5191853046417236
E[H^H] = 1e-07
E_MSE (Error Power) = 1.2681540250778198
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6011, 0.8071, 0.7550, 0.5825, 0.3340, 0.6438, 0.3673, 0.5698, 0.3945,
        0.8673, 0.5002, 0.6906, 0.6972, 0.8010, 0.7506, 0.0964, 0.6495, 0.4080,
        0.4380, 0.6722], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([294, 165, 200, 305, 459, 269, 437, 313, 419, 122, 354, 240, 236, 169,
        202, 679, 265, 411, 392, 251], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 13-----------
Real SNR = tensor([10.0568,  8.9474, 12.1224, 14.4807, 13.5464,  8.9722, 14.7057, 11.7803,
         9.7963, 11.1822,  9.7901,  9.8674, 13.3411, 12.0074,  8.3124, 15.6695,
        12.9214,  8.4315, 15.2798, 11.1737], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3206+2.9802e-08j, 3.0603-8.9407e-08j, 2.2079-4.3195e-08j,
        3.5550-1.0275e-07j, 4.3827-5.7790e-08j, 1.1894+1.9169e-08j,
        1.4633-1.7241e-08j, 5.2183-0.0000e+00j, 0.3705-1.0848e-08j,
        2.8788-3.6857e-08j, 0.3913-2.9589e-08j, 0.5733-4.5536e-09j,
        1.3022+1.6638e-08j, 0.3141+5.2122e-09j, 0.3010-5.0355e-09j,
        2.1808+3.3444e-07j, 0.5239-1.1108e-08j, 0.2082-1.1176e-08j,
        3.9824+1.4066e-07j, 0.4874-4.0116e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7455723285675049+4.312447288157273e-09j)
torch.linalg.det(H.mH@H) = tensor([0.6575-5.9605e-08j, 0.6252-1.3355e-08j, 2.3765-1.2625e-08j,
        4.0186-9.6926e-08j, 5.4513-6.2848e-08j, 0.5599+7.4285e-09j,
        0.9086+2.1279e-08j, 1.0211-1.2709e-07j, 0.3094+4.4703e-08j,
        0.7826-2.7313e-08j, 0.3936+2.9802e-08j, 0.8129+2.9802e-08j,
        1.5230-4.9897e-08j, 0.4992+9.3333e-09j, 0.4684+3.0794e-08j,
        1.1972-1.7893e-08j, 0.1810-1.2383e-07j, 0.3424+2.2352e-08j,
        7.1490-1.4293e-08j, 1.1339-1.8462e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5205702781677246-2.0601003569709064e-08j)
SINR torch.Size([20]) = tensor([-6.9691,  3.3619,  9.9519,  3.9770,  8.9422,  7.3143,  1.0988,  2.8057,
         1.3143,  4.5952,  1.1363,  3.6395,  2.9931,  1.1228, -1.3844,  2.0265,
        -8.0121, -4.9424,  5.9819,  2.7713], device='cuda:0')
SINR mean = 2.086238384246826
E[H^H] = 1e-07
E_MSE (Error Power) = 1.3078724145889282
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1673, 0.6844, 0.9082, 0.7142, 0.8869, 0.8435, 0.5629, 0.6561, 0.5751,
        0.7423, 0.5650, 0.6980, 0.6658, 0.5643, 0.4210, 0.6146, 0.1365, 0.2427,
        0.7986, 0.6543], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([594, 244,  89, 226, 106, 139, 317, 261, 310, 208, 316, 236, 255, 316,
        403, 286, 627, 527, 171, 262], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 14-----------
Real SNR = tensor([12.9330, 15.3388, 10.5539, 16.3901, 14.4070, 10.6226, 14.3854, 15.2265,
        11.0785, 11.1143,  5.7676, 10.6264, 12.9992, 13.7263, 15.1060, 16.8641,
        12.0029, 12.3201,  6.6934,  8.5422], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.0239-3.7223e-08j, 1.3705+2.0411e-08j, 0.7851-1.0081e-08j,
        3.6991+7.8454e-08j, 1.0677+5.1248e-09j, 0.4000+2.9802e-08j,
        3.0574+1.2412e-08j, 5.8180+2.6822e-07j, 0.6607-5.7340e-08j,
        0.7417-1.1306e-08j, 0.1481+3.7253e-09j, 0.1254+1.8626e-08j,
        0.3063-7.8231e-08j, 0.7145-5.9605e-08j, 0.4053-2.3842e-07j,
        8.4352+5.6223e-08j, 3.7254-4.8728e-08j, 2.6367+2.5435e-08j,
        0.2779-1.0528e-09j, 1.0914-1.9833e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.874516487121582-2.169191715140073e-09j)
torch.linalg.det(H.mH@H) = tensor([6.1335e-01+1.6353e-08j, 1.3577e+00+7.5990e-09j, 8.1615e-01-1.9200e-09j,
        1.4844e+00-3.3234e-08j, 3.2179e+00-7.2044e-08j, 1.1177e-02+4.6566e-10j,
        6.4553e-01-1.5581e-08j, 6.8244e+00+2.2785e-08j, 1.4953e-01-1.8703e-09j,
        3.3006e-01-3.9719e-09j, 6.6204e-02+8.8115e-10j, 1.0572e+00+7.5117e-09j,
        8.0462e-01-1.6391e-07j, 1.3152e+00-8.9407e-08j, 2.0486e+00+2.3842e-07j,
        5.6177e+00-7.2755e-10j, 1.7377e+00-1.1541e-08j, 9.1630e-01-1.3658e-08j,
        8.2768e-04-2.1591e-09j, 3.7980e-01+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4697160720825195-5.055596830061404e-09j)
SINR torch.Size([20]) = tensor([ 4.8941,  4.8608,  3.1957,  8.7618,  3.6906, -2.2820,  7.9117,  7.9863,
        -2.0628,  4.1826,  2.4430, -7.0897, -1.8912,  4.3906, -6.4145,  6.7184,
         6.2328,  8.2308,  0.3215,  6.8781], device='cuda:0')
SINR mean = 3.0479276180267334
E[H^H] = 1e-07
E_MSE (Error Power) = 1.042900562286377
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7553, 0.7538, 0.6761, 0.8826, 0.7005, 0.3716, 0.8608, 0.8628, 0.3834,
        0.7237, 0.6370, 0.1635, 0.3928, 0.7332, 0.1859, 0.8245, 0.8077, 0.8693,
        0.5185, 0.8297], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([199, 200, 249, 110, 234, 434, 126, 125, 427, 220, 273, 598, 421, 214,
        576, 153, 165, 120, 343, 149], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 15-----------
Real SNR = tensor([ 5.5487, 12.1218, 14.3373, 13.4795, 13.9240, 11.9307, 15.5139, 11.9989,
         9.8628, 10.2842, 14.4391, 13.5533, 14.8723, 13.9463, 10.9892, 16.3522,
        13.0064, 12.7293, 11.2168, 15.1941], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.2348+4.5931e-09j, 0.4563+7.0803e-08j, 0.0991+1.6764e-08j,
        0.3294+1.4901e-08j, 0.9945-1.5198e-08j, 0.8692+5.9605e-08j,
        0.5231-6.4571e-08j, 1.0991-6.9843e-09j, 0.5325-7.4257e-09j,
        0.7179+9.6437e-09j, 0.4309+1.1921e-07j, 3.5065-1.1219e-07j,
        2.2704+3.9527e-08j, 0.2712-5.3483e-09j, 1.7934+7.4506e-09j,
        1.0726+6.6810e-08j, 1.2654-1.5068e-08j, 0.9979+4.0971e-08j,
        3.3375+2.3842e-07j, 4.3421+3.5435e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.2571847438812256+2.486735617424074e-08j)
torch.linalg.det(H.mH@H) = tensor([2.8691e-03-2.9104e-10j, 3.7311e-01-7.6671e-08j, 6.2167e-01+1.5626e-08j,
        1.2418e-02+6.0536e-08j, 1.5777e+00-7.1088e-09j, 4.3003e-01-7.4506e-08j,
        3.0080e-01-1.1991e-07j, 8.2842e-01-9.1318e-09j, 4.1646e-02+5.4017e-08j,
        9.2800e-01-1.9807e-09j, 1.1519e+00+1.0431e-07j, 3.8218e+00+4.6851e-08j,
        1.7087e+00+3.9630e-08j, 8.5008e-01+1.0238e-08j, 7.9628e-01-7.4506e-09j,
        1.0218e+00+7.7018e-08j, 4.8514e-01+2.2992e-08j, 7.4701e-01+2.7338e-08j,
        1.2841e+00-1.0090e-08j, 3.1293e+00+4.1592e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0056369304656982+9.65017665777168e-09j)
SINR torch.Size([20]) = tensor([ 0.4185, -2.6158, -4.8479, -2.4488,  3.3376, -3.3497,  3.0094,  4.6757,
         5.3764,  5.0275,  1.2458,  8.0515,  5.9137, -0.2642,  3.5955, -0.1919,
         6.9336,  4.2474,  1.8613, 10.7348], device='cuda:0')
SINR mean = 2.535515785217285
E[H^H] = 1e-07
E_MSE (Error Power) = 0.959049642086029
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5241, 0.3538, 0.2467, 0.3627, 0.6832, 0.3162, 0.6666, 0.7459, 0.7752,
        0.7609, 0.5712, 0.8646, 0.7960, 0.4848, 0.6959, 0.4890, 0.8315, 0.7267,
        0.6055, 0.9221], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([340, 446, 523, 440, 245, 472, 255, 206, 186, 196, 312, 124, 173, 364,
        237, 361, 148, 218, 292,  77], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 16-----------
Real SNR = tensor([11.2525, 12.1515, 17.3586, 17.4412, 13.7161, 18.6350, 14.7582, 17.3584,
        18.3045,  9.9979, 20.5769, 13.6160, 14.9056, 11.4217, 14.3265, 15.3734,
        19.1720, 18.2570, 19.0549, 12.7403], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.3287-5.9605e-08j,  0.0565+9.3132e-09j,  1.2616+1.2769e-07j,
         0.3638-1.0031e-08j,  0.9143-1.9129e-08j,  9.1816-2.7563e-07j,
         1.2025+3.8888e-08j,  1.9761+8.8244e-08j, 12.7481+6.5828e-08j,
         0.3882-2.1474e-09j, 28.8677+4.4775e-07j,  1.7270-3.0414e-08j,
         0.9514+2.4664e-08j,  0.0635-1.8626e-09j,  2.1768-9.0313e-09j,
         3.0107+6.2365e-08j,  4.0345+4.1694e-08j,  3.9482-9.2449e-08j,
         0.3023+4.7900e-08j,  0.0968+1.4345e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.730013370513916+2.2773528840502877e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.0836+1.6764e-08j,  0.4687+6.9095e-09j,  2.2948-4.8092e-08j,
         0.2955+3.4705e-08j,  0.8367-8.7849e-10j,  6.2727+2.9802e-07j,
         2.3644-4.2173e-08j,  1.3957+1.7550e-08j,  7.5779+2.4010e-08j,
         0.2677-0.0000e+00j, 30.2762+4.3759e-07j,  1.4241-5.1179e-09j,
         2.7121+1.5690e-08j,  0.3555-0.0000e+00j,  1.5664-4.3516e-08j,
         1.9998-4.3231e-08j,  7.0359+1.1921e-07j,  3.3284-5.3349e-07j,
         0.0892+1.3171e-08j,  1.1257-8.3730e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.5885486602783203+1.2937507065657883e-08j)
SINR torch.Size([20]) = tensor([ 2.4816, -6.2004,  8.2547, -2.7471,  7.7452, 10.8230,  7.6007,  6.8961,
        12.6387,  3.5089, 13.8526,  6.6929,  2.0333, -4.8498,  6.5923,  8.3878,
         7.3581, 11.7618, -0.8890, -5.4643], device='cuda:0')
SINR mean = 4.823863506317139
E[H^H] = 1e-07
E_MSE (Error Power) = 0.9652061462402344
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6391, 0.1935, 0.8700, 0.3469, 0.8561, 0.9236, 0.8520, 0.8303, 0.9483,
        0.6917, 0.9604, 0.8236, 0.6150, 0.2466, 0.8202, 0.8734, 0.8448, 0.9375,
        0.4490, 0.2213], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([271, 569, 120, 451, 130,  76, 133, 149,  54, 240,  42, 153, 286, 523,
        156, 117, 138,  64, 385, 544], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 17-----------
Real SNR = tensor([10.9845, 19.3353, 15.8589, 16.3108,  9.8692, 17.3385, 12.1556, 16.4081,
        13.1556, 15.4728, 14.6746,  8.4999, 18.0952, 13.0877, 21.2079, 17.9270,
        16.3092, 16.2733, 17.0056, 13.2767], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3402-1.1272e-08j, 1.1714-1.7217e-08j, 0.8585-1.6391e-07j,
        0.9038-7.8523e-09j, 0.2893-3.9499e-09j, 1.9622+8.9280e-09j,
        1.4441-1.4365e-08j, 1.7527+8.7196e-08j, 0.5497-1.5588e-08j,
        1.4633-2.0593e-08j, 1.9419-9.6348e-08j, 0.0527+2.2890e-10j,
        8.3802-5.7468e-08j, 0.8838+6.0302e-09j, 0.7598-1.0026e-07j,
        0.3412-2.2352e-08j, 1.8655+1.5161e-07j, 8.2118-1.2409e-07j,
        1.2856-0.0000e+00j, 0.3392-2.8794e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7398475408554077-2.0207677309258543e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0089+1.3970e-09j, 2.0141-8.4382e-08j, 1.0719+2.3842e-07j,
        0.7090+1.8621e-09j, 0.1361-9.1000e-09j, 0.8956-1.7850e-09j,
        0.3155+3.5566e-08j, 1.6936-2.1489e-07j, 0.5523+1.0575e-08j,
        1.6024+3.0713e-09j, 0.5878-4.4661e-08j, 0.0814+1.2576e-09j,
        7.9312+2.2491e-07j, 0.8246+8.6780e-09j, 0.9408-6.8272e-08j,
        0.4370-0.0000e+00j, 1.3195-8.8832e-09j, 2.9303-1.1921e-07j,
        1.4613-3.3666e-08j, 0.1858+9.5628e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2849514484405518-2.477838156877965e-09j)
SINR torch.Size([20]) = tensor([ 1.5773,  1.8903,  2.0483, 10.2824,  4.7141,  6.3812,  8.6998,  9.4383,
         8.9034,  4.7344,  4.8860,  2.3406, 13.8046,  7.8618,  2.9872, -5.4254,
         5.2695,  9.2613, 10.6483,  2.4449], device='cuda:0')
SINR mean = 5.637417793273926
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5367472767829895
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5898, 0.6071, 0.6158, 0.9143, 0.7475, 0.8130, 0.8811, 0.8978, 0.8860,
        0.7484, 0.7549, 0.6316, 0.9600, 0.8594, 0.6655, 0.2228, 0.7709, 0.8940,
        0.9207, 0.6371], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([301, 291, 285,  84, 204, 161, 111,  98, 107, 204, 200, 276,  42, 128,
        256, 543, 189, 101,  78, 273], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 18-----------
Real SNR = tensor([17.6282, 12.1394, 20.9032, 15.6340, 15.4481, 19.4560, 18.0510, 15.2481,
        16.3947, 16.1382, 17.1659, 16.0855, 18.0787, 18.5907, 16.7540, 17.9252,
        11.5926, 14.3932, 15.7987, 19.0861], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.2014-3.2558e-08j, 0.1298-1.3872e-09j, 4.8037-2.8840e-07j,
        0.2617-1.6611e-08j, 0.2602-2.1157e-09j, 8.2367+3.2618e-08j,
        5.0579+1.2223e-07j, 0.4905-1.4901e-08j, 1.8168+1.4901e-07j,
        1.1414+6.6230e-09j, 0.7618+2.1362e-08j, 1.4513+4.7684e-07j,
        6.0638+1.3367e-07j, 5.2246+5.3342e-09j, 0.7667+3.6939e-08j,
        2.8577-1.6315e-08j, 0.0176-4.8647e-09j, 2.6917-1.6052e-08j,
        0.6907-1.4901e-08j, 6.0638+1.5771e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.449488401412964+3.671156534323927e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0708+9.3049e-09j, 0.0634+4.6566e-09j, 1.8976-4.1734e-07j,
        0.6653-3.5751e-09j, 0.2480+4.0931e-09j, 5.4497+4.3356e-08j,
        2.2046+7.2372e-08j, 0.8177-6.8987e-10j, 0.7358-1.6391e-07j,
        0.5655+1.0407e-08j, 0.7527+1.9833e-08j, 1.9435+1.7881e-07j,
        2.8809-1.1929e-08j, 5.5937-2.8535e-08j, 0.2972-5.9681e-09j,
        1.8081-2.5839e-08j, 0.0677-2.5629e-10j, 0.5997-4.7732e-09j,
        0.4804-2.9802e-08j, 6.3742+8.5565e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6758317947387695-1.3210945226660442e-08j)
SINR torch.Size([20]) = tensor([ 2.9651,  0.3011,  8.8238,  5.0174,  5.2559, 12.9485, 12.7197,  2.1739,
         6.2421,  9.7358,  5.4709,  9.2552, 10.7484, 14.0875,  2.3606, 10.8487,
        -3.1935,  7.7374,  2.2712, 13.1646], device='cuda:0')
SINR mean = 6.946710109710693
E[H^H] = 1e-07
E_MSE (Error Power) = 0.38508450984954834
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6643, 0.5173, 0.8841, 0.7605, 0.7703, 0.9517, 0.9493, 0.6226, 0.8080,
        0.9039, 0.7790, 0.8939, 0.9224, 0.9624, 0.6326, 0.9240, 0.3240, 0.8559,
        0.6278, 0.9540], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([256, 344, 109, 196, 190,  50,  53, 281, 164,  93, 184, 101,  77,  40,
        275,  76, 466, 130, 278,  48], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 19-----------
Real SNR = tensor([12.9334, 17.3412, 16.9363, 19.4086, 17.8554, 13.9951, 16.7495, 15.9377,
        20.3862, 18.9634, 14.4224, 15.9298, 21.3201, 20.3495, 15.9830, 21.9057,
        17.9888, 17.5729, 19.9233, 17.8139], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.0784-2.5913e-08j, 0.9692+5.1157e-08j, 0.2345+4.4703e-08j,
        0.6890-2.6822e-07j, 2.5848+1.7881e-07j, 0.8411-8.0782e-09j,
        1.6988+1.1921e-07j, 0.1761-5.3380e-09j, 1.1782-1.1921e-07j,
        0.8951-2.9802e-08j, 0.1178+1.3970e-09j, 2.7169+2.1918e-09j,
        1.2987+2.0149e-07j, 2.4138+9.4810e-09j, 0.4602+4.5677e-08j,
        8.0126-8.4950e-08j, 1.1036-1.1921e-07j, 2.5202+3.4544e-08j,
        3.7968-2.3304e-08j, 0.9577-8.1755e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.637189507484436-1.7671197838353692e-10j)
torch.linalg.det(H.mH@H) = tensor([0.0767+4.9587e-09j, 1.6780+8.2181e-09j, 0.1540-1.8626e-08j,
        0.4117-1.4901e-08j, 2.1962+1.1921e-07j, 0.3833+2.7759e-08j,
        1.7790+5.9605e-08j, 0.0939-6.6296e-10j, 0.6799+5.9605e-07j,
        2.2300+5.9605e-08j, 0.2360-1.8626e-09j, 1.2054+1.4207e-08j,
        2.1834-9.8645e-08j, 2.6603+1.7639e-08j, 0.1662+2.5770e-09j,
        2.5612-4.0654e-08j, 0.1410-3.7253e-09j, 1.9683-9.4667e-08j,
        3.0253+2.5870e-09j, 0.9123+8.0292e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2371071577072144+3.594787045813064e-08j)
SINR torch.Size([20]) = tensor([ 1.8805,  6.6642,  2.3674,  1.0553, 10.8007,  9.6070,  8.8835,  5.4896,
         5.7831,  1.6078,  3.7469,  9.3979,  4.5143, 11.0122,  4.6333, 10.9562,
         5.8376, 10.2736, 13.1446,  8.5451], device='cuda:0')
SINR mean = 6.81002950668335
E[H^H] = 1e-07
E_MSE (Error Power) = 0.3125888407230377
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6066, 0.8227, 0.6330, 0.5605, 0.9232, 0.9013, 0.8855, 0.7797, 0.7911,
        0.5915, 0.7032, 0.8970, 0.7387, 0.9266, 0.7440, 0.9257, 0.7932, 0.9142,
        0.9538, 0.8774], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([291, 154, 275, 318,  76,  95, 107, 183, 176, 300, 232,  98, 210,  73,
        207,  74, 174,  84,  48, 114], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 20-----------
Real SNR = tensor([19.8814, 15.1831, 19.5638, 15.7562, 14.4272, 18.4355, 20.3419, 21.7829,
        20.8773, 20.0797, 20.9577, 15.1937, 21.8322, 17.1883, 18.6705, 19.0038,
        19.1873, 19.4958, 19.3225, 19.7590], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.5644-2.8303e-09j, 0.3098+2.3866e-08j, 2.4213-3.7746e-08j,
        0.1568+1.2704e-09j, 0.1530+8.5643e-10j, 3.2459+3.0611e-08j,
        0.6847+1.4901e-08j, 1.1422-1.6391e-07j, 0.4272+5.0855e-08j,
        2.7520-1.1921e-07j, 1.1443-0.0000e+00j, 0.9672+7.5057e-09j,
        6.9639+1.4901e-07j, 0.1820-1.3472e-10j, 0.9381+2.9802e-08j,
        0.6340-5.9605e-08j, 2.0320+1.7881e-07j, 0.6906-1.2886e-08j,
        0.7403-3.0140e-08j, 2.7973+2.4202e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4973433017730713+4.261591524112873e-09j)
torch.linalg.det(H.mH@H) = tensor([1.6612+8.5589e-09j, 0.1720+2.2352e-08j, 1.8188-6.1641e-09j,
        0.3128-7.6500e-10j, 0.0547-1.5867e-10j, 2.6044+9.6463e-09j,
        0.7752-4.4703e-08j, 1.4998-4.4703e-08j, 0.4216-5.6355e-09j,
        2.1956-7.4506e-08j, 2.0398+4.1723e-07j, 0.7971+8.3356e-10j,
        5.5727+8.9407e-08j, 0.3944+8.4065e-09j, 1.7635-1.9138e-08j,
        0.8906+8.9407e-08j, 1.1116-0.0000e+00j, 1.1368+4.5668e-09j,
        0.9588-8.4715e-08j, 2.7181+2.8960e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4449836015701294+1.9944058848864188e-08j)
SINR torch.Size([20]) = tensor([11.5357,  8.7364, 10.4679,  3.0310,  2.1552, 14.0949,  5.5496,  6.0886,
         3.6482,  9.5271,  7.3626,  9.8398, 11.1229,  0.9675,  7.6845,  8.2373,
         6.8802,  8.6820,  6.1492, 10.8170], device='cuda:0')
SINR mean = 7.628880500793457
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2825062870979309
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9344, 0.8820, 0.9176, 0.6677, 0.6216, 0.9625, 0.7821, 0.8025, 0.6985,
        0.8997, 0.8449, 0.9060, 0.9283, 0.5555, 0.8544, 0.8695, 0.8298, 0.8807,
        0.8047, 0.9235], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 66, 110,  81, 254, 282,  40, 182, 168, 235,  96, 138,  91,  72, 321,
        131, 120, 149, 111, 167,  76], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 21-----------
Real SNR = tensor([14.8857, 21.2130, 14.9087, 23.2789, 19.6342, 20.5652, 20.4252, 21.1687,
        20.5645, 25.3435, 15.1190, 19.8258, 18.5395, 20.8980, 21.3211, 19.7670,
        19.5069, 21.4028, 18.0174, 18.4388], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.1275+1.4901e-08j, 1.7756+5.9605e-08j, 0.6312+5.6923e-09j,
        3.8079-3.9211e-08j, 1.7169+6.9666e-09j, 5.2804-2.3967e-08j,
        0.6156-2.1851e-08j, 1.6092+2.9802e-08j, 1.5975-2.9802e-07j,
        6.0316+2.9910e-07j, 0.0108-4.7395e-09j, 3.3983+1.7271e-08j,
        0.3555+5.9605e-08j, 0.6195-1.1921e-07j, 0.3157+4.9928e-09j,
        1.1353+4.8952e-08j, 1.1510+1.1417e-09j, 4.3967-7.3001e-08j,
        0.2813-7.4506e-09j, 0.0160-5.8083e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7436760663986206-4.875569725726336e-09j)
torch.linalg.det(H.mH@H) = tensor([0.0137+5.5879e-09j, 1.9152-2.9802e-08j, 0.2267+9.2793e-10j,
        4.0719-1.2446e-07j, 1.5717-4.8652e-09j, 5.5902+1.1514e-09j,
        0.8122-1.6476e-08j, 1.7458-7.4506e-08j, 2.0374-0.0000e+00j,
        3.5828-2.0797e-07j, 0.0421-1.3556e-08j, 2.1291-6.6650e-09j,
        0.6890+1.1921e-07j, 1.3888+2.4043e-08j, 0.4168-9.2398e-08j,
        0.6207-2.4019e-08j, 1.2567+1.6989e-08j, 5.5285-3.5449e-08j,
        0.1128+1.8626e-08j, 0.1383-1.2741e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.69451904296875-2.2818372968913536e-08j)
SINR torch.Size([20]) = tensor([ 0.9653,  6.0640,  9.2571, 14.0615, 13.1150, 16.4502,  9.4961, 12.0089,
         8.9421, 13.9403, -4.9531, 12.7822,  3.6828,  6.6000,  2.7749, 11.1694,
         9.2139, 12.5422,  7.5042, -7.2458], device='cuda:0')
SINR mean = 7.9185614585876465
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5998837351799011
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5553, 0.8016, 0.8939, 0.9622, 0.9535, 0.9779, 0.8990, 0.9408, 0.8869,
        0.9612, 0.2422, 0.9499, 0.7001, 0.8205, 0.6545, 0.9290, 0.8930, 0.9472,
        0.8491, 0.1586], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([321, 169, 101,  40,  49,  24,  97,  61, 106,  41, 527,  52, 234, 156,
        262,  71, 101,  55, 135, 603], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 22-----------
Real SNR = tensor([17.6312, 21.8523, 21.2591, 22.7155, 18.5949, 20.3184, 14.8724, 21.0752,
        23.6194, 20.7273, 24.1488, 22.8634, 21.7654, 20.7427, 22.3517, 23.5066,
        22.6117, 19.3854, 23.2585, 23.3075], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1073-8.9966e-10j,  4.7162-8.0917e-09j,  1.9286-1.7881e-07j,
         2.3156+6.7307e-08j,  0.1366+5.2678e-09j,  2.0114+3.3882e-08j,
         0.1038-4.3741e-09j,  2.4034+3.7617e-08j, 12.1226-1.4685e-07j,
         3.9993-4.2405e-08j,  1.5463+3.2783e-07j,  2.7629-2.5482e-08j,
         0.6795-1.5180e-08j,  1.3919+2.3682e-08j,  1.1562+2.7164e-08j,
         7.5551+1.3572e-07j,  3.8346+1.0126e-07j,  0.1875-1.4901e-08j,
         0.5504-1.9149e-07j,  2.4250-5.1950e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.59671950340271+3.963724903854882e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.3178+7.0244e-09j,  4.7406-8.6663e-09j,  1.9290-2.9802e-08j,
         2.2397-6.9272e-08j,  0.0271-1.2124e-08j,  1.4303-4.2441e-08j,
         0.2554+5.7504e-10j,  1.5883+2.8910e-08j, 12.3885-1.1806e-07j,
         5.1265+2.5378e-08j,  0.9581+1.3411e-07j,  3.8652-1.1239e-10j,
         0.9484+2.9802e-08j,  1.0344-2.8102e-08j,  1.3318-2.1486e-08j,
         6.8788+5.6691e-09j,  5.3204-9.2808e-08j,  0.1375+3.7253e-09j,
         0.4649-6.8635e-10j,  1.6364+1.4240e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6309518814086914-2.29857355371621e-09j)
SINR torch.Size([20]) = tensor([ 4.6898, 16.5552, 15.2769, 17.0463,  4.2460,  9.6318,  2.5710, 12.1416,
        17.2649, 16.2464, 11.4943, 12.7959,  7.6868, 16.1634, 12.8834, 17.0517,
        13.6855,  2.6847,  2.6407, 11.6812], device='cuda:0')
SINR mean = 11.2218656539917
E[H^H] = 1e-07
E_MSE (Error Power) = 0.16908173263072968
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7465, 0.9784, 0.9712, 0.9806, 0.7266, 0.9018, 0.6438, 0.9424, 0.9816,
        0.9768, 0.9338, 0.9501, 0.8545, 0.9764, 0.9510, 0.9807, 0.9590, 0.6498,
        0.6475, 0.9364], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([205,  24,  31,  21, 218,  94, 269,  59,  20,  25,  67,  52, 131,  26,
         51,  21,  43, 265, 266,  65], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 23-----------
Real SNR = tensor([22.8478, 13.2122, 21.3578, 22.4328, 22.2589, 19.5423, 15.5838, 22.5350,
        23.3338, 20.6131, 21.0017, 20.0780, 17.2040, 25.2695, 26.6656, 25.5159,
        20.4013, 22.2275, 23.8363, 19.8497], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.0244e+00+3.5763e-07j, 7.7497e-02-1.5869e-09j, 8.4681e-01-2.4324e-08j,
        1.7715e+00+1.0626e-07j, 7.5810e-01-1.4990e-08j, 9.5862e-01+2.2327e-08j,
        3.3983e-01+2.9802e-08j, 5.4104e-02-4.2101e-09j, 1.2228e+00-3.0376e-08j,
        1.7816e-03-1.9797e-09j, 4.9813e-01-3.1062e-08j, 1.4053e+00+5.9605e-08j,
        2.7059e-01-7.4064e-09j, 3.1167e-01-7.7745e-08j, 3.3235e+00+8.5349e-08j,
        1.0403e+01-1.7651e-07j, 1.2463e+00-4.7466e-09j, 2.1802e+00+2.1248e-08j,
        6.4768e-01-3.6175e-08j, 2.6388e-01-2.4098e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4302729368209839+1.343495359407143e-08j)
torch.linalg.det(H.mH@H) = tensor([2.1188-1.1921e-07j, 0.0173-4.6566e-10j, 0.5140-1.3064e-09j,
        0.8160+2.9802e-08j, 1.2118+2.9802e-07j, 0.6341-1.1027e-08j,
        0.3318-1.0665e-08j, 0.1852+7.0527e-10j, 1.4558+1.7211e-08j,
        0.0182+2.1331e-09j, 0.2266+1.6100e-08j, 1.1494-5.9605e-08j,
        0.2246+1.3316e-09j, 0.7404+1.3508e-08j, 3.2735-7.1793e-08j,
        8.8136+5.5002e-08j, 0.7030+8.1563e-10j, 1.9909+4.9137e-08j,
        0.8811-1.8398e-08j, 0.0513-1.1642e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2678738832473755+8.982977028892947e-09j)
SINR torch.Size([20]) = tensor([15.9466,  7.0585, 11.2031,  9.6120, 10.6359, 12.8402, 13.2844,  0.1512,
         8.1296, -9.2902, 10.1983, 17.2858, 11.2519,  6.1508, 17.0404, 14.7820,
        12.4838, 14.9585, 13.5983,  7.1215], device='cuda:0')
SINR mean = 10.222136497497559
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5729478597640991
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9752, 0.8355, 0.9295, 0.9014, 0.9205, 0.9506, 0.9552, 0.5087, 0.8667,
        0.1054, 0.9128, 0.9817, 0.9303, 0.8048, 0.9806, 0.9678, 0.9466, 0.9691,
        0.9582, 0.8375], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 27, 145,  71,  95,  79,  51,  47, 349, 122, 666,  85,  20,  70, 167,
         21,  35,  55,  33,  44, 144], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 24-----------
Real SNR = tensor([29.1973, 24.9073, 24.1528, 23.0402, 20.1170, 21.8100, 24.3732, 17.1098,
        24.6354, 23.6115, 22.8138, 24.5636, 20.7963, 19.9346, 26.5947, 25.2950,
        23.0704, 22.5395, 22.5273, 23.3244], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([11.6228+6.6502e-09j,  0.9445-6.4015e-09j,  2.1537-1.4449e-08j,
         0.3110+5.2154e-08j,  0.5918-6.6696e-10j,  0.1756-2.9802e-08j,
         4.7390-4.1889e-08j,  0.0775+1.7585e-09j,  1.7803+1.3531e-09j,
         5.2754+2.9802e-08j,  0.7356-2.7940e-08j,  4.4694-2.3410e-08j,
         0.2458+1.4901e-08j,  0.0243-3.9936e-09j,  3.1333-5.1713e-07j,
         0.3224+2.8687e-09j,  2.2841+3.8958e-08j,  1.1051+5.9605e-08j,
         1.0558+2.5738e-08j,  4.0152-4.0860e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.253129005432129-2.1798909344283857e-08j)
torch.linalg.det(H.mH@H) = tensor([1.4205e+01-1.6992e-07j, 8.4087e-01+1.2220e-07j, 1.8672e+00-1.6072e-07j,
        2.3924e-01-2.6077e-08j, 5.5566e-01+9.3776e-09j, 3.2660e-01+1.4901e-08j,
        4.9240e+00+3.7547e-09j, 1.0268e-01+4.8015e-10j, 2.2131e+00+7.3451e-09j,
        4.2829e+00-1.8626e-08j, 7.3814e-01-0.0000e+00j, 3.6567e+00+5.9244e-08j,
        2.2866e-01-0.0000e+00j, 4.4385e-03-9.5907e-09j, 2.8425e+00-2.7732e-07j,
        6.4677e-01+1.1834e-08j, 2.7831e+00-3.4835e-09j, 1.2864e+00-0.0000e+00j,
        1.3632e+00-3.8801e-08j, 2.7048e+00+4.7032e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2906036376953125-2.1418340878653908e-08j)
SINR torch.Size([20]) = tensor([16.6956, 14.3172, 12.4909,  2.4745, 10.1182,  8.0173, 20.4748,  8.3478,
        15.9380, 17.9510, 14.0034, 17.4706,  9.2227, -0.7734, 13.2773,  5.2580,
        10.9223, 14.9884, 13.8055, 14.1553], device='cuda:0')
SINR mean = 11.95777416229248
E[H^H] = 1e-07
E_MSE (Error Power) = 0.17059744894504547
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9790, 0.9643, 0.9467, 0.6387, 0.9113, 0.8637, 0.9911, 0.8724, 0.9752,
        0.9842, 0.9617, 0.9824, 0.8932, 0.4556, 0.9551, 0.7704, 0.9252, 0.9693,
        0.9600, 0.9630], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 23,  38,  55, 272,  86, 124,  10, 118,  27,  17,  41,  19, 101, 381,
         47, 190,  75,  33,  42,  39], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 25-----------
Real SNR = tensor([22.8852, 28.3916, 22.6994, 23.8388, 27.7224, 25.8066, 22.6188, 25.0516,
        19.2661, 22.1443, 19.0642, 20.7130, 22.3399, 23.2864, 22.6137, 24.7936,
        26.7179, 26.6085, 21.4855, 20.3174], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.3326+1.3114e-08j, 8.4864+1.1921e-07j, 0.1441+1.4901e-08j,
        0.9112-1.9725e-09j, 5.9221-2.6804e-07j, 1.8893-5.8588e-08j,
        0.9444-2.9932e-08j, 3.8091-8.9783e-09j, 0.2799+1.8626e-09j,
        2.9094+2.0091e-08j, 0.2104-8.2359e-09j, 1.0742+2.0040e-08j,
        0.2171-1.3411e-07j, 0.7019-2.9802e-08j, 0.9444-1.6351e-08j,
        1.8635-5.9752e-08j, 0.6319-8.5682e-08j, 2.4251+3.2411e-09j,
        0.7057-6.8909e-09j, 0.2876+3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7345176935195923-2.560748946223157e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1717+4.9091e-09j, 9.1924+5.9605e-08j, 0.3918-4.4703e-08j,
        1.2413+4.2917e-09j, 5.0475+1.3004e-07j, 2.0763+9.2176e-10j,
        1.0255-1.1390e-08j, 3.2196-2.2768e-09j, 0.2892+5.5879e-09j,
        3.1463+1.3701e-09j, 0.1548+4.4310e-09j, 1.1907-3.6036e-08j,
        0.1123+2.8223e-07j, 0.6627+1.7881e-07j, 0.5558-5.9605e-08j,
        1.9506-1.9032e-08j, 1.0862-4.4121e-08j, 3.3617+2.8079e-08j,
        0.7002-2.6591e-09j, 0.3516-2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7964123487472534+2.2532997689950207e-08j)
SINR torch.Size([20]) = tensor([10.2346, 16.8501,  1.8839, 14.9409, 17.0142, 13.0788, 14.3639, 20.3984,
        10.7635, 21.1550, 12.3176, 15.1103,  8.8716, 15.5657, 12.3803, 11.3546,
         7.5901, 16.2665, 11.9403, 10.6154], device='cuda:0')
SINR mean = 13.134787559509277
E[H^H] = 1e-07
E_MSE (Error Power) = 0.09286639839410782
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9135, 0.9798, 0.6068, 0.9689, 0.9805, 0.9531, 0.9647, 0.9910, 0.9226,
        0.9924, 0.9446, 0.9701, 0.8852, 0.9730, 0.9454, 0.9318, 0.8517, 0.9769,
        0.9399, 0.9201], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 85,  22, 291,  33,  21,  49,  38,  10,  77,   8,  57,  32, 108,  29,
         56,  69, 133,  25,  61,  79], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 26-----------
Real SNR = tensor([26.8106, 26.3315, 26.0752, 25.6753, 24.5755, 25.5252, 27.1561, 23.6985,
        26.3954, 25.8423, 21.9443, 18.4741, 21.4248, 22.8826, 27.1295, 26.4118,
        29.3855, 22.5363, 26.0666, 27.3456], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 5.0320+1.2547e-07j,  1.3319-1.1911e-08j,  0.0776+4.0047e-08j,
         3.8800+3.0843e-08j,  0.4691+7.0570e-09j,  2.0452-1.1183e-07j,
         1.1991-7.8405e-08j,  0.4198-9.3604e-10j,  1.9919+1.2183e-07j,
         3.1800-4.6179e-08j,  1.2347-3.6948e-09j,  0.2156+2.3804e-10j,
         0.3921+1.6288e-09j,  0.1416-6.8656e-09j,  4.5958-2.4811e-08j,
         2.9887+1.5013e-08j, 13.8577+3.6584e-08j,  0.1048-8.1074e-09j,
         0.3045+4.4703e-08j,  6.0993-1.1059e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.478079319000244+1.0040240860931249e-09j)
torch.linalg.det(H.mH@H) = tensor([ 5.4277+3.3488e-08j,  0.7060-2.4799e-08j,  0.0746+8.5449e-08j,
         4.3643+7.8603e-08j,  0.6339-4.2401e-09j,  1.9064+7.5119e-08j,
         1.7304+4.1429e-08j,  0.4127-3.9447e-09j,  1.1208+1.5057e-09j,
         2.9576+1.3552e-08j,  1.2521+1.0686e-08j,  0.1941-2.8830e-10j,
         0.4440-1.3862e-08j,  0.0878-7.1670e-09j,  3.2124+1.5394e-08j,
         2.3628+9.3559e-09j, 12.4119+1.6868e-07j,  0.1705-4.5209e-09j,
         0.4676-1.4901e-08j,  6.0416-2.8968e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.298949718475342+2.1528549609683978e-08j)
SINR torch.Size([20]) = tensor([17.7916, 10.6409,  3.3007, 20.0611,  7.6283, 18.2342, 14.3199, 16.3897,
        13.0537, 18.2862, 14.5507, 13.0513,  9.1197,  9.6461, 16.9654, 19.2919,
        22.0818,  5.1596,  8.6763, 18.7203], device='cuda:0')
SINR mean = 13.848467826843262
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1054406389594078
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9836, 0.9206, 0.6814, 0.9902, 0.8528, 0.9852, 0.9643, 0.9776, 0.9528,
        0.9854, 0.9661, 0.9528, 0.8909, 0.9021, 0.9803, 0.9884, 0.9938, 0.7664,
        0.8806, 0.9868], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 18,  79, 246,  11, 132,  16,  38,  25,  49,  16,  36,  49, 103,  94,
         22,  13,   7, 192, 111,  15], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 27-----------
Real SNR = tensor([26.5505, 25.8755, 27.1699, 29.6688, 28.6782, 26.1574, 29.5338, 27.7513,
        27.1751, 28.1045, 24.9605, 25.1030, 28.7421, 29.2266, 24.3319, 24.9946,
        24.7164, 19.5973, 27.4215, 26.5367], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.0821-4.9582e-08j, 1.7429-9.5279e-09j, 2.9243+4.1476e-08j,
        1.7813+1.1237e-08j, 5.7987+1.5177e-07j, 0.3134-2.3578e-08j,
        0.3077+1.5638e-07j, 2.1371-3.5727e-08j, 4.6562+4.8960e-08j,
        7.2787+5.8551e-08j, 3.5127-2.3464e-08j, 1.4608+1.7040e-08j,
        0.8274-2.6433e-07j, 4.0886+2.3842e-07j, 0.3096-7.4506e-09j,
        0.5566-4.1274e-11j, 0.7569-2.9802e-08j, 0.1041-9.7623e-10j,
        1.4151-2.6567e-08j, 0.6211+8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.183774948120117+1.710957953093839e-08j)
torch.linalg.det(H.mH@H) = tensor([3.7237+5.2364e-08j, 1.4940-2.6038e-08j, 2.8250-3.1993e-08j,
        1.6183+9.0015e-09j, 5.4617+6.7324e-08j, 0.3477-3.7557e-08j,
        0.1974+1.9806e-07j, 3.0514+3.2089e-08j, 4.1204-3.0685e-08j,
        7.5041-4.6799e-08j, 2.9499-2.7689e-08j, 1.6750+4.2557e-09j,
        1.1420-2.5987e-07j, 5.0306-0.0000e+00j, 0.2159+6.7055e-08j,
        0.5817-3.4494e-09j, 0.5190-4.4703e-08j, 0.1314+1.8207e-09j,
        1.1221+2.7378e-08j, 0.6848+8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.219805955886841+1.9984014443252818e-09j)
SINR torch.Size([20]) = tensor([18.6702, 18.4268, 20.5099, 16.0128, 18.4263,  6.9656,  8.5479, 13.4757,
        23.1567, 22.6592, 21.2532, 17.5766, 11.5151, 19.0297, 13.5712, 16.7645,
        14.6068, 13.3574, 20.1552, 18.0254], device='cuda:0')
SINR mean = 16.635303497314453
E[H^H] = 1e-07
E_MSE (Error Power) = 0.049559008330106735
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9866, 0.9858, 0.9912, 0.9756, 0.9858, 0.8326, 0.8774, 0.9570, 0.9952,
        0.9946, 0.9926, 0.9828, 0.9341, 0.9877, 0.9579, 0.9794, 0.9665, 0.9559,
        0.9904, 0.9845], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 15,  16,  10,  27,  16, 147, 114,  45,   5,   6,   8,  19,  67,  14,
         44,  23,  36,  46,  10,  17], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 28-----------
Real SNR = tensor([21.8242, 23.5073, 24.3549, 28.3675, 27.4115, 29.4168, 30.8764, 28.9174,
        29.5594, 23.9598, 26.4999, 23.3415, 27.8777, 25.3718, 26.9479, 23.8645,
        23.1351, 27.3374, 31.8394, 25.7945], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.8480e-01-2.2822e-09j, 5.4456e-01+4.0088e-09j, 1.0453e+00-2.8250e-09j,
        6.3200e-01-4.4703e-07j, 1.7501e-01+1.0151e-07j, 4.3262e+00+1.0967e-07j,
        2.5256e+00-1.6172e-07j, 1.6634e+00+2.2277e-07j, 2.0524e+00+1.0136e-07j,
        1.3181e-01+7.4506e-09j, 4.8502e-01-1.8626e-08j, 1.1624e+00-6.6744e-09j,
        1.4874e-01+1.7509e-07j, 2.8299e+00-3.7721e-09j, 9.9051e-01+1.8122e-08j,
        1.4018e-01+4.4238e-09j, 1.0274e-01-3.7253e-09j, 2.5424e-03-4.4217e-08j,
        1.6063e+01+1.0290e-07j, 5.1145e-01-1.7021e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.7858628034591675+7.736324469931333e-09j)
torch.linalg.det(H.mH@H) = tensor([ 0.1691+4.1728e-09j,  0.6000-6.9573e-09j,  1.0740+1.0382e-08j,
         0.4888+1.3411e-07j,  0.4746-8.1956e-08j,  4.0259-1.3692e-08j,
         2.1582-1.1923e-07j,  1.9588+4.7296e-08j,  2.1804+2.1173e-07j,
         0.1030+1.4901e-08j,  0.6027-6.4865e-08j,  1.0022+1.1067e-08j,
         0.1498-1.2573e-07j,  2.5899+4.8448e-08j,  0.8565-1.3342e-08j,
         0.1156-3.7253e-09j,  0.1811+1.4901e-08j,  0.0178+1.2947e-07j,
        16.9552-1.9668e-08j,  0.3758+8.6321e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8039649724960327+9.297182579359742e-09j)
SINR torch.Size([20]) = tensor([15.9944, 13.3012, 18.3144,  9.5315,  0.8232, 20.6547, 21.0936, 18.1197,
        19.2935, 11.5369, 15.8648, 19.2043, 13.0776, 18.5524, 16.6589,  6.8573,
         5.7327, -9.5090, 23.5872, 14.7337], device='cuda:0')
SINR mean = 13.67113971710205
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5545616149902344
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9755, 0.9553, 0.9855, 0.8998, 0.5472, 0.9915, 0.9923, 0.9848, 0.9884,
        0.9344, 0.9747, 0.9881, 0.9531, 0.9862, 0.9789, 0.8291, 0.7892, 0.1007,
        0.9956, 0.9675], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 27,  47,  16,  96, 326,   9,   8,  17,  13,  66,  27,  13,  49,  15,
         23, 150, 177, 673,   5,  35], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 29-----------
Real SNR = tensor([26.4417, 28.6013, 29.6652, 25.8100, 28.4053, 27.8839, 24.2226, 28.2939,
        24.5479, 30.3405, 30.6317, 29.9563, 25.4135, 28.4073, 32.6780, 30.8609,
        28.7630, 26.9957, 29.2071, 30.7233], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.1797-2.2303e-08j, 3.3749-3.4214e-08j, 1.3692+5.9605e-08j,
        0.0807-7.4573e-09j, 0.5126+1.6167e-08j, 0.5555-6.0368e-08j,
        0.7119+5.3654e-09j, 4.2432-0.0000e+00j, 0.3125-9.9835e-09j,
        1.7431-5.9605e-08j, 5.2071-1.4981e-07j, 0.2719-1.0258e-08j,
        0.6932-0.0000e+00j, 4.1363+9.0259e-08j, 5.7190+4.4389e-08j,
        2.3661+1.7703e-08j, 0.1872-2.5575e-07j, 1.0623-2.9802e-08j,
        5.3293-6.0850e-08j, 9.8207-1.8141e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.4938199520111084-3.241625634586853e-08j)
torch.linalg.det(H.mH@H) = tensor([1.8554+6.8838e-09j, 3.7469+1.0227e-07j, 1.4770+5.9605e-08j,
        0.1214+1.9161e-09j, 0.5925+5.1852e-09j, 0.6633+5.8684e-08j,
        0.6500-3.8757e-09j, 3.5064-0.0000e+00j, 0.2508-7.2879e-09j,
        1.2363-5.9605e-08j, 4.8415-1.7746e-07j, 0.3673-1.1158e-08j,
        0.5439+1.4901e-08j, 4.1554-1.0751e-08j, 6.0068-1.1767e-07j,
        2.7266+1.0003e-08j, 0.0872-2.0266e-07j, 1.0802-3.1687e-08j,
        5.1720-7.6982e-08j, 9.1157+1.3289e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.409834384918213-1.53395642854548e-08j)
SINR torch.Size([20]) = tensor([18.7445, 20.0774, 22.1237,  8.6343, 15.7815, 17.9275, 19.9603, 18.0042,
        16.3152, 13.9348, 22.7108, 10.9918, 18.7639, 25.3820, 22.8617, 18.7491,
         9.1493, 19.5449, 24.1083, 25.1090], device='cuda:0')
SINR mean = 18.443714141845703
E[H^H] = 1e-07
E_MSE (Error Power) = 0.029589295387268066
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9868, 0.9903, 0.9939, 0.8795, 0.9743, 0.9841, 0.9900, 0.9844, 0.9772,
        0.9612, 0.9947, 0.9263, 0.9869, 0.9971, 0.9949, 0.9868, 0.8916, 0.9890,
        0.9961, 0.9969], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 15,  11,   7, 112,  28,  17,  11,  17,  25,  41,   6,  74,  14,   3,
          5,  14, 103,  12,   4,   3], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)

--- 処理中: 画像 81 から 100 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 80)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6931, 0.5226, 0.7302, 0.7399, 0.7176, 0.6209, 0.5511, 0.6197, 0.7088,
        0.8136, 0.7387, 0.7753, 0.8751, 0.5915, 0.6488, 0.7575, 0.5067, 0.6304,
        0.9574, 0.5433], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -6.0819,  -6.7361,  -4.7900,  -4.8430, -13.8463,  -9.8192,  -9.8593,
         -4.1915,  -8.5128,   0.0925,  -2.6134,  -4.3503, -10.4120,  -4.4376,
         -9.2420,  -6.6896,  -8.3383,  -6.9851,  -5.7051,  -3.7843],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 290.8168-3.8052e-06j,   98.4750+2.9082e-06j,   98.8359+2.8616e-05j,
         432.3422+3.1533e-06j,   46.5597+1.5831e-04j,    1.8494-5.9605e-08j,
          27.8460+9.5367e-07j,  997.4424+1.5868e-05j,  307.0495+6.0800e-06j,
          67.7352-1.5553e-07j,  503.9381+2.0637e-05j,    6.8206+3.7559e-06j,
          13.4111+1.5497e-06j,  452.7080+2.3185e-05j, 1246.6027+2.7159e-06j,
         469.6974-8.3656e-06j,  210.3946+1.2028e-06j,   20.6200+1.2874e-07j,
         235.8857-3.0108e-06j, 1571.7007+1.9045e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(355.03656005859375+1.3635605682793539e-05j)
torch.linalg.det(H.mH@H) = tensor([1.6102+2.5172e-08j, 1.4622+3.4405e-08j, 1.6745+2.3075e-07j,
        0.6830-0.0000e+00j, 0.0396+9.3132e-10j, 0.3250+1.1381e-08j,
        0.0970+1.3039e-08j, 0.2460-5.9605e-08j, 0.6298-1.0125e-08j,
        4.5375+2.1842e-07j, 0.9521-2.9296e-07j, 6.3636-1.4901e-08j,
        0.2357-6.2499e-09j, 3.0030+5.5001e-08j, 0.2890-8.2735e-10j,
        2.2572-6.9311e-08j, 0.2385-7.2307e-09j, 0.0121-2.8289e-08j,
        0.5481+4.2160e-09j, 4.9623-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.508310317993164+2.210523986079238e-09j)
SINR torch.Size([20]) = tensor([ -0.4316,  -4.0840,  -4.1305,  -1.6437,  -8.7534, -20.9265,  -7.6186,
         -1.4775,  -0.5372,  -9.0683,  -0.9886, -14.7795, -10.5192,  -3.5569,
         -1.4281,  -1.3180,  -1.8207,  -4.5955,  -1.0179,   0.7655],
       device='cuda:0')
SINR mean = -4.896511077880859
E[H^H] = 1e-07
E_MSE (Error Power) = 10.176933288574219
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4752, 0.2808, 0.2787, 0.4065, 0.1176, 0.0080, 0.1475, 0.4158, 0.4691,
        0.1103, 0.4433, 0.0322, 0.0815, 0.3060, 0.4185, 0.4247, 0.3967, 0.2577,
        0.4417, 0.5440], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([369, 497, 499, 412, 650, 953, 615, 406, 373, 659, 389, 816, 702, 479,
        404, 400, 418, 515, 390, 328], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -4-----------
Real SNR = tensor([ -8.6908,  -5.8209,  -6.3194,  -4.5172, -12.6406,  -1.2454,  -4.1763,
         -7.2210,  -9.0444,  -5.4464,  -1.0947,  -3.8577,  -1.6716,  -8.8934,
         -2.4145,  -7.9024,  -6.4472,  -5.1443,  -4.7416,  -9.2858],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([180.8839+4.6698e-06j, 849.9703+6.8262e-07j,  17.0493-1.6500e-07j,
        231.8427-1.0802e-06j, 607.5435-1.1341e-05j, 637.2538-3.9181e-06j,
        624.8765+1.2327e-05j, 188.2729+2.6215e-06j, 664.7097+2.1528e-06j,
         40.7880+7.7999e-06j, 166.8580+2.3085e-08j, 309.0197-1.5109e-05j,
         62.8458-1.9073e-06j, 832.0421-5.3803e-06j, 852.2737-1.7022e-05j,
        173.1796-3.8970e-07j, 336.4729-0.0000e+00j,  66.6388-0.0000e+00j,
        167.2780-2.0027e-05j,  29.6742+2.1437e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(351.97369384765625-2.1959124296699883e-06j)
torch.linalg.det(H.mH@H) = tensor([0.0243+6.5193e-09j, 2.3854+2.2267e-08j, 0.9262-5.0020e-09j,
        1.8728-2.9886e-08j, 0.0402-2.7605e-10j, 4.2829-1.2923e-07j,
        0.3859+1.4726e-08j, 0.4618-7.7251e-09j, 0.1008-4.7952e-09j,
        0.4633-2.6893e-09j, 6.3165-4.1632e-08j, 2.8612-3.5763e-07j,
        7.4497+1.9842e-07j, 0.1994+1.8626e-09j, 1.2210-2.3842e-07j,
        0.4381+4.1789e-09j, 1.0943+3.5030e-08j, 1.5481-8.0213e-08j,
        1.7971+2.0010e-08j, 0.0193+1.3504e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6944106817245483-2.9048885963334214e-08j)
SINR torch.Size([20]) = tensor([-1.6309,  0.1877, -7.5560, -1.0847, -1.2255, -1.4869, -1.8901, -1.0082,
        -1.4781, -5.0349, -1.7860, -1.5111, -6.0298, -0.3953,  0.7638, -2.4463,
        -1.9593, -2.9077, -2.8468, -4.7910], device='cuda:0')
SINR mean = -2.3058536052703857
E[H^H] = 1e-07
E_MSE (Error Power) = 2.1229653358459473
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4072, 0.5108, 0.1493, 0.4379, 0.4299, 0.4152, 0.3929, 0.4422, 0.4157,
        0.2388, 0.3986, 0.4139, 0.1997, 0.4773, 0.5439, 0.3628, 0.3891, 0.3386,
        0.3418, 0.2491], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([411, 348, 613, 392, 397, 406, 420, 389, 406, 530, 417, 407, 563, 368,
        328, 440, 423, 456, 454, 521], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -3-----------
Real SNR = tensor([ -2.3423,  -3.2658,  -0.6638,  -2.4714,  -2.7572,  -8.4638,  -5.6192,
         -5.3259,  -1.5912,  -1.3446, -10.6183,  -5.9828,  -4.4442,  -0.6472,
         -9.9355,  -6.8094,  -8.7479,  -2.7755,  -1.7093,  -6.6702],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([140.0656+2.0516e-06j,  13.1796-2.6430e-07j,   7.4399+4.7684e-06j,
         43.1418-2.0502e-07j,  49.5941-1.7345e-08j,  45.3293+2.9973e-06j,
        121.4431-2.7584e-06j,  14.9221-0.0000e+00j,   5.1683+1.7058e-06j,
        359.5522-1.0089e-05j, 321.0453-2.6054e-05j, 172.6220+3.8360e-06j,
        219.0115+3.8147e-06j, 131.3327+2.0403e-06j,  54.4160-3.1642e-06j,
        219.1131-3.2287e-07j, 517.6700-1.0454e-05j,  65.1454+1.1292e-07j,
         84.0498+3.9077e-06j,  27.7291+2.8610e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(130.59854125976562-1.2616488902494893e-06j)
torch.linalg.det(H.mH@H) = tensor([7.1845+1.9152e-07j, 4.1017+3.4604e-07j, 8.6452-1.3025e-07j,
        2.2519-3.4008e-09j, 6.3906-2.5799e-08j, 0.3908-5.5325e-10j,
        0.7469+3.1283e-08j, 0.1347-8.8365e-09j, 5.1729-2.6218e-08j,
        1.4098-2.5382e-08j, 0.0203-3.7253e-09j, 0.0600-2.9288e-09j,
        0.1631+7.5749e-09j, 3.2501-2.3842e-07j, 0.1826-3.7253e-08j,
        1.3349+1.3087e-08j, 0.0904-2.7340e-09j, 0.9606+4.2829e-08j,
        1.3088+7.8296e-09j, 0.4856+5.1223e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2142646312713623+6.989695489068026e-09j)
SINR torch.Size([20]) = tensor([  0.2596,  -5.0592, -11.9311,  -1.7932,  -4.0980,  -3.0622,  -3.8821,
         -5.2532, -11.4583,  -0.4560,  -1.1588,   0.3966,   0.3917,  -0.0379,
         -3.4295,   0.4569,  -1.4684,  -5.6878,  -1.9097,  -5.6888],
       device='cuda:0')
SINR mean = -3.2434639930725098
E[H^H] = 1e-07
E_MSE (Error Power) = 3.2258529663085938
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5149, 0.2378, 0.0602, 0.3982, 0.2802, 0.3307, 0.2903, 0.2298, 0.0667,
        0.4738, 0.4337, 0.5228, 0.5225, 0.4978, 0.3122, 0.5263, 0.4163, 0.2125,
        0.3918, 0.2125], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([345, 531, 742, 417, 498, 462, 490, 537, 729, 370, 395, 341, 341, 356,
        474, 339, 406, 552, 421, 552], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -2-----------
Real SNR = tensor([-2.4852, -3.0695, -3.5847, -6.7610, -3.5991, -2.2289, -4.6678, -5.0073,
        -4.5763, -9.7467, -4.8340, -7.2255, -7.2946, -4.1487, -4.5202, -8.9547,
         0.8058,  2.6268, -3.3672, -4.7948], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.9665e+01+7.2239e-07j, 1.6695e+02-0.0000e+00j, 9.5929e+00-1.5487e-07j,
        4.2725e+01+8.3136e-08j, 4.3717e+01+1.8463e-07j, 1.7986e+02+2.0018e-06j,
        9.1615e+02-2.1119e-05j, 1.4984e+02-6.6408e-07j, 5.1486e+01-2.1852e-06j,
        1.5414e+02-1.2134e-06j, 2.3921e+02+2.2180e-07j, 1.5581e+02+1.3548e-06j,
        6.3398e+01-7.6294e-06j, 6.1262e+00-7.1526e-07j, 1.2101e+01-5.0666e-08j,
        1.5708e-01-1.4156e-07j, 5.6625e+02-3.5061e-06j, 3.0953e+02+4.7900e-06j,
        4.1044e+01-1.0500e-07j, 1.3434e+02-9.4944e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(164.1051025390625-1.4537738479702966e-06j)
torch.linalg.det(H.mH@H) = tensor([8.4163+7.1817e-08j, 0.4012+1.4901e-07j, 0.7213+1.6919e-08j,
        0.6042-3.4837e-09j, 1.1547+5.9605e-08j, 2.4389-5.9605e-08j,
        1.0943-1.1856e-08j, 1.0025+1.0214e-08j, 3.4058-7.0124e-08j,
        0.1105-8.5419e-11j, 1.6528-4.8514e-10j, 0.4731+7.4506e-08j,
        0.6309-2.9802e-08j, 1.0853+2.2326e-08j, 2.9409+5.9015e-09j,
        0.4456+9.0568e-09j, 6.5352-1.2548e-08j, 7.1845-1.5497e-06j,
        1.3486+4.3820e-09j, 0.4116+2.4446e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.102917432785034-6.447627498573638e-08j)
SINR torch.Size([20]) = tensor([ -1.7394,  -0.0322,  -4.3374,  -1.7917,  -2.2017,  -0.7388,  -0.5710,
         -0.3092,  -0.6332,  -0.7982,  -1.1687,  -1.1518,  -0.8787,  -6.9219,
         -4.2420, -17.5402,   1.1316,   0.2167,  -0.7248,  -0.7361],
       device='cuda:0')
SINR mean = -2.2584261894226074
E[H^H] = 1e-07
E_MSE (Error Power) = 4.003124237060547
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4012, 0.4981, 0.2692, 0.3983, 0.3759, 0.4576, 0.4672, 0.4822, 0.4636,
        0.4542, 0.4331, 0.4341, 0.4496, 0.1688, 0.2735, 0.0173, 0.5648, 0.5125,
        0.4584, 0.4577], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([415, 356, 506, 417, 431, 380, 374, 365, 376, 382, 395, 395, 385, 592,
        503, 881, 316, 347, 380, 380], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -1-----------
Real SNR = tensor([-1.4376, -4.3858, -1.6543, -1.1395, -5.0193, -2.0428, -1.4459, -0.1022,
        -5.8320, -5.1681,  0.8289, -0.9435,  0.8541,  1.2571, -1.9062, -0.6894,
        -5.0963, -0.0416, -3.4764,  0.2527], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 30.5631+1.4522e-06j,  32.9642-1.4818e-06j,  15.8601-1.3105e-08j,
         48.6056-4.5709e-08j,   3.2464-7.1526e-07j, 229.1772-2.7683e-06j,
        173.0051-1.0284e-06j, 159.7700+5.7742e-07j,  21.5576+1.5142e-07j,
         13.0269+1.3100e-07j,   5.4294-1.1757e-06j,  10.3422-6.3226e-08j,
        212.8913-1.6964e-08j, 112.1768+1.4344e-06j,   2.1620-8.3447e-07j,
         62.1992+1.1695e-06j,   9.0265+7.8058e-08j, 166.2177+4.7731e-06j,
         40.3618+2.8797e-07j,  16.9554-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(68.27693176269531+9.560684333109748e-08j)
torch.linalg.det(H.mH@H) = tensor([1.6050-1.0625e-08j, 1.5311+6.1721e-09j, 1.6412+4.5971e-09j,
        0.0937+1.4885e-08j, 1.9144-3.3202e-09j, 2.1980-3.6176e-08j,
        4.0645-6.8906e-09j, 1.0817+5.3644e-07j, 0.5141+3.7253e-09j,
        0.2056+2.6983e-09j, 2.7282-6.2880e-08j, 0.3768-4.9152e-09j,
        0.1418+4.6965e-08j, 5.3711+5.1039e-07j, 1.4870-2.7368e-09j,
        0.9773-2.9802e-08j, 0.4704-9.3974e-10j, 2.1630+2.9404e-08j,
        2.0402+1.2767e-08j, 5.5030-1.0034e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.805398941040039+4.547100829199735e-08j)
SINR torch.Size([20]) = tensor([ -4.0008,  -2.5522,  -0.1657,  -3.0051,  -9.6608,   1.1462,   0.9579,
         -0.5306,  -2.6983,  -4.7655, -11.2460,  -4.6667,  -0.0763,  -1.0085,
         -9.6662,  -2.9717,  -3.1097,   0.0155,  -1.9326,  -4.6358],
       device='cuda:0')
SINR mean = -3.228646993637085
E[H^H] = 1e-07
E_MSE (Error Power) = 3.087439775466919
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2847, 0.3572, 0.4905, 0.3336, 0.0976, 0.5656, 0.5549, 0.4695, 0.3495,
        0.2502, 0.0698, 0.2545, 0.4956, 0.4422, 0.0975, 0.3353, 0.3283, 0.5009,
        0.3905, 0.2559], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([494, 444, 360, 460, 677, 315, 322, 373, 449, 521, 723, 517, 357, 390,
        677, 458, 463, 354, 422, 516], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 0-----------
Real SNR = tensor([-1.8062,  2.2335, -2.2926,  2.1371, -2.9771,  0.8730,  0.8811, -1.1272,
        -0.5565, -0.7391, -2.2062,  1.2162, -0.2973, -2.1814, -6.2959, -6.6100,
        -1.6678, -5.8210, -1.7720, -2.9055], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([173.7391-2.9945e-07j,  89.0156-1.3169e-07j,  11.3503-5.2452e-06j,
         46.1197-1.4610e-06j,  35.4445-8.5989e-07j,  15.6737+9.3121e-07j,
         41.7126+2.1777e-07j,  36.9269-2.2054e-06j,  14.0948+9.5367e-07j,
         20.3798-2.8424e-06j,   7.7646+1.6266e-08j,  47.2463+2.5174e-06j,
         62.9412+1.5772e-06j,  93.7707-4.8168e-07j,   5.7341-5.9924e-10j,
         26.4890+1.0953e-07j,  12.9678+4.7684e-07j,  60.1043-3.1066e-06j,
         67.0670-7.2148e-07j,   5.3553-3.0840e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(43.69487380981445-5.293147182783287e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1013+2.5100e-08j, 6.1885-8.8846e-09j, 0.3833+8.8313e-09j,
        1.0846+3.2358e-08j, 0.8996-5.2285e-09j, 7.1692-1.7120e-07j,
        0.6280-5.1834e-08j, 0.5251-8.9407e-08j, 2.0707-1.7881e-07j,
        4.0912+8.5135e-08j, 0.9917+4.5492e-08j, 7.3133-1.5281e-07j,
        8.8261-6.1901e-08j, 0.7194-2.9802e-08j, 0.2420-2.2352e-08j,
        0.0245-2.7940e-09j, 0.5876-0.0000e+00j, 0.1142+1.4901e-08j,
        0.2637-1.2296e-08j, 1.5250-2.1574e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1874496936798096-2.8883141212077135e-08j)
SINR torch.Size([20]) = tensor([-2.4349,  0.9895, -7.1651, -2.1495,  0.3522, -3.6363, -0.2880, -5.9060,
        -4.4377, -3.6912, -7.3754, -5.1969,  1.2087, -0.9263, -3.8760, -2.4402,
        -2.8416, -1.8887, -0.1206, -6.0057], device='cuda:0')
SINR mean = -2.8914830684661865
E[H^H] = 1e-07
E_MSE (Error Power) = 2.4834420680999756
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3634, 0.5567, 0.1611, 0.3787, 0.5203, 0.3021, 0.4834, 0.2043, 0.2647,
        0.2994, 0.1547, 0.2321, 0.5691, 0.4469, 0.2906, 0.3631, 0.3420, 0.3930,
        0.4931, 0.2005], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([440, 321, 600, 430, 342, 482, 364, 559, 509, 484, 607, 535, 313, 387,
        490, 440, 454, 420, 359, 562], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 1-----------
Real SNR = tensor([ 0.6817,  0.3957, -0.6396, -0.2643, -2.0587,  2.3158, -2.1561,  4.2713,
         0.4504,  1.5194, -2.0865, -1.7212, -3.5793, -1.0120, -6.0727, -1.8937,
        -6.4638, -1.8610, -1.3326,  3.7771], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 33.5965-2.8610e-06j,   2.8433-8.5231e-07j,  34.7470+6.0363e-07j,
          4.1374+8.3447e-07j,  68.7100-1.3014e-06j,  72.3736-6.9129e-07j,
          0.3046+1.7732e-06j,   9.0568-2.4984e-06j,   8.3931-3.1422e-07j,
         22.8296+2.0304e-07j,  35.5930+6.5800e-08j,   0.2522-5.3518e-09j,
         59.4733+1.5234e-06j,   9.1646+6.1157e-07j,   3.7525-1.5497e-06j,
         53.6195-1.6534e-06j,   5.4752+2.4391e-07j,  16.0973+1.7447e-07j,
        127.7353+5.0822e-07j, 202.3836+7.9745e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(38.52692794799805-2.1939399630355183e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.3858+1.6503e-08j,  2.1200-5.4053e-08j,  0.3553+2.2352e-08j,
         1.1488-1.9445e-08j,  0.1448-1.8626e-08j,  1.2417+1.4260e-07j,
         0.7550+9.2353e-09j,  7.9812-1.0820e-07j,  1.2283+4.8071e-08j,
         6.5507+8.3148e-08j,  1.8895-5.7898e-09j,  0.2058-2.9802e-08j,
         1.2555-9.5289e-09j,  0.5310+7.4506e-09j,  0.2134+9.6585e-10j,
         1.4687+1.7881e-07j,  0.0359-1.8626e-09j,  0.3416-4.4703e-08j,
         1.3379+8.3739e-09j, 11.9769+5.3892e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.058398485183716+1.1302479840935575e-08j)
SINR torch.Size([20]) = tensor([ -2.8594,  -9.6396,   0.4486,  -4.6992,  -0.0556,  -1.1420, -17.9527,
         -4.7939,  -6.4483,  -2.8100,  -1.5074, -16.6269,   0.7758,  -1.6631,
         -6.3931,  -2.1095,  -5.1369,  -1.8765,   1.3874,   1.3945],
       device='cuda:0')
SINR mean = -4.085387229919434
E[H^H] = 1e-07
E_MSE (Error Power) = 8.70091724395752
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3411, 0.0980, 0.5258, 0.2531, 0.4968, 0.4346, 0.0158, 0.2490, 0.1847,
        0.3437, 0.4141, 0.0213, 0.5445, 0.4054, 0.1866, 0.3809, 0.2345, 0.3936,
        0.5792, 0.5796], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([455, 677, 339, 518, 356, 394, 890, 522, 577, 453, 407, 860, 328, 412,
        575, 428, 533, 420, 307, 307], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 2-----------
Real SNR = tensor([ 3.6382,  0.0966,  2.7945,  0.7871,  1.1639, -1.2572,  2.8100, -1.9197,
         1.7651,  7.1951, -0.1235,  3.2729,  1.7007,  2.3412,  2.9816, -0.0976,
         3.1559, -0.7616, -2.6729,  1.5994], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([238.7291-4.0126e-06j,  85.5007+2.7047e-06j, 114.5730-1.2324e-06j,
         28.4029-3.0996e-07j,  19.1112-2.7671e-06j,   9.2110+4.7275e-07j,
        113.7260-1.3284e-07j,  11.5624-9.5367e-07j,   6.1145+6.9942e-08j,
         64.2027+1.2374e-06j,   1.9301+7.1526e-07j,  26.7524+7.7088e-07j,
         29.0040+2.4783e-08j,  12.5972-1.7881e-07j,  11.9624-9.7724e-08j,
         11.1748-2.8131e-07j,   1.2461+1.7881e-07j,  23.9677+4.9419e-08j,
          6.7192-3.5653e-07j,  28.5647-1.3326e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(42.25260543823242-2.056129488892111e-07j)
torch.linalg.det(H.mH@H) = tensor([ 3.4851-0.0000e+00j,  0.6945-1.1921e-07j,  0.4346-6.1550e-08j,
         3.3578+2.7538e-08j,  0.5148+1.0727e-08j,  0.9557+1.7874e-08j,
         2.6838+4.7108e-09j,  0.5309+8.4208e-09j,  3.1719+4.2844e-10j,
         2.1464-3.3754e-08j,  1.7144-1.8644e-08j, 12.9260+2.5026e-08j,
         1.8193+2.4773e-08j,  0.4763+4.0978e-07j,  0.1843+3.8960e-08j,
         0.1024+4.7311e-07j,  1.3001+1.0058e-07j,  0.6768-1.4901e-08j,
         0.3434-0.0000e+00j,  1.8108+3.3934e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9664669036865234+4.639045769749828e-08j)
SINR torch.Size([20]) = tensor([ 2.6291, -0.1682,  1.0908, -1.1197, -1.9878, -2.5329,  1.7896, -4.2598,
        -2.0657, -2.2446, -8.7631, -0.7690,  1.3116, -3.4771, -0.1020, -2.8427,
        -8.2078,  0.5205, -3.1064,  2.3806], device='cuda:0')
SINR mean = -1.5962361097335815
E[H^H] = 1e-07
E_MSE (Error Power) = 2.024092435836792
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6469, 0.4903, 0.5625, 0.4359, 0.3875, 0.3582, 0.6016, 0.2727, 0.3833,
        0.3736, 0.1173, 0.4558, 0.5749, 0.3099, 0.4941, 0.3420, 0.1313, 0.5299,
        0.3284, 0.6337], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([267, 360, 317, 393, 424, 443, 294, 503, 427, 433, 650, 381, 310, 476,
        358, 454, 633, 336, 463, 275], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 3-----------
Real SNR = tensor([ 0.0885,  0.5367,  2.1788,  2.8768,  3.5505,  0.6167,  2.6817,  3.6816,
        -0.3080,  2.4456,  1.8273, -0.8955,  5.0108,  0.7634, -1.0187, -3.0002,
        -0.1813,  0.7450, -1.8411, -1.6369], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.2544-4.7698e-08j,  1.0388-4.5179e-07j,  5.0445-1.1921e-06j,
         6.9364+2.3842e-07j, 15.9520-9.1076e-08j, 68.2564+5.3630e-07j,
        15.0637+2.3842e-07j,  2.0138+1.4820e-09j,  0.6536-1.6204e-07j,
        30.3611+6.7606e-08j,  5.9085+1.9689e-07j,  2.3402-6.6927e-10j,
        19.9166+1.5201e-07j,  1.4728+1.1325e-06j, 34.0401-3.1737e-07j,
        36.8677-5.7189e-08j,  1.4445+2.9802e-07j, 16.1263+1.1302e-07j,
         1.8663+2.5164e-08j,  2.8353-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(13.469656944274902+2.803396448314288e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4063-1.0980e-09j, 0.5883+8.9686e-08j, 2.2260-1.2381e-08j,
        0.8888-4.3793e-08j, 3.9313+1.1626e-08j, 1.6437-1.9219e-08j,
        3.8346+6.8266e-08j, 4.5613-1.1921e-07j, 0.2642-1.0026e-09j,
        3.0591+6.6331e-08j, 0.7512+4.6663e-09j, 0.9845+3.5153e-08j,
        7.0686+3.2947e-07j, 0.1472+2.0117e-07j, 0.0525+1.0017e-08j,
        0.0832-5.3551e-09j, 0.3376+8.0922e-09j, 1.4895+5.3870e-09j,
        0.4871-2.8936e-08j, 0.0110-3.9783e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6408056020736694+2.992350189856552e-08j)
SINR torch.Size([20]) = tensor([ -8.0058, -12.4614,  -6.7355,  -1.8544,   1.0702,   2.0389,  -0.8222,
         -2.8184,  -9.4952,  -1.0012,  -1.0081,  -5.8850,   2.1799, -10.2458,
          0.3741,  -0.3839,  -7.1672,   1.9159,  -5.3985,  -4.4826],
       device='cuda:0')
SINR mean = -3.5093212127685547
E[H^H] = 1e-07
E_MSE (Error Power) = 4.097899913787842
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1366, 0.0537, 0.1750, 0.3948, 0.5613, 0.6153, 0.4528, 0.3432, 0.1010,
        0.4426, 0.4422, 0.2050, 0.6229, 0.0863, 0.5215, 0.4779, 0.1611, 0.6085,
        0.2239, 0.2627], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([627, 756, 586, 419, 318, 286, 383, 453, 672, 389, 389, 558, 281, 694,
        342, 368, 600, 290, 542, 511], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 4-----------
Real SNR = tensor([ 2.2206,  5.5432,  4.2487, -0.3106, -1.8797,  0.4232,  4.8059,  4.2049,
         4.0241,  5.8428,  5.6909,  0.7319,  1.6466, -0.3970, -1.7193,  3.6162,
         5.0212, -1.4865,  2.5645,  4.1435], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.7435-0.0000e+00j, 34.8865-9.8583e-08j,  9.5912+5.9605e-08j,
        13.1811+4.6778e-07j, 32.2105+1.1567e-07j,  2.2784+1.9548e-07j,
        36.3780+8.2459e-07j,  8.0028+2.3117e-07j,  5.4300+9.8884e-07j,
        10.4654+4.0139e-07j,  0.7887-7.9857e-07j,  2.0636+1.7366e-08j,
         3.5601-8.9480e-08j,  5.4053-1.7509e-07j,  3.8574-2.3842e-07j,
         2.5645-8.0754e-08j, 26.6693-4.7684e-07j,  4.1833+3.9076e-08j,
         5.0713+2.3801e-07j,  7.3700+5.3304e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(10.885058403015137+8.132840179086998e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6798+1.1151e-08j, 4.4466+1.5554e-07j, 4.8298+4.0696e-08j,
        0.3072+7.7108e-09j, 0.1613+7.4506e-09j, 0.1827-1.4153e-10j,
        6.6899-1.9351e-08j, 3.5341+1.6660e-07j, 0.7014+1.4901e-08j,
        0.5233+1.1921e-07j, 0.0352-3.1716e-08j, 0.1869-2.2352e-08j,
        3.0559+6.7090e-08j, 0.6318-8.9407e-08j, 0.2020-0.0000e+00j,
        2.5113+2.0862e-07j, 0.7983-5.9605e-08j, 0.4905-1.9057e-09j,
        0.7450+3.9277e-08j, 0.8020-3.9949e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.575746774673462+2.8690323006230756e-08j)
SINR torch.Size([20]) = tensor([-1.1510e+00,  4.9176e-03, -3.8975e+00, -9.1962e-01,  7.7969e-02,
        -5.8098e+00,  1.5360e+00,  3.5185e-01, -2.9321e+00, -7.6238e-01,
        -9.6251e+00, -2.5891e+00, -9.6864e-01, -3.4374e+00, -4.9850e+00,
        -5.8362e+00,  2.2819e-01, -7.0048e-01, -8.4526e-01, -3.4591e+00],
       device='cuda:0')
SINR mean = -2.2859818935394287
E[H^H] = 1e-07
E_MSE (Error Power) = 2.235163927078247
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4341, 0.5003, 0.2896, 0.4473, 0.5045, 0.2079, 0.5875, 0.5202, 0.3373,
        0.4562, 0.0983, 0.3552, 0.4445, 0.3119, 0.2409, 0.2069, 0.5131, 0.4598,
        0.4515, 0.3108], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([395, 354, 491, 386, 352, 556, 302, 342, 457, 381, 676, 445, 388, 475,
        528, 557, 347, 379, 384, 475], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 5-----------
Real SNR = tensor([ 4.3209,  5.6511,  4.4112,  2.3709,  4.0359,  3.2295,  4.6558,  2.7513,
         6.9162,  7.1035,  1.1115,  0.8201,  8.0917,  8.2835,  1.4903, -0.4883,
         6.9823,  7.7052,  3.9978,  2.1766], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.8677+4.1723e-07j, 27.1564-1.7230e-07j,  1.2135-5.9605e-08j,
         2.9258-1.7881e-06j,  2.8357+7.7787e-09j, 18.7748+2.1870e-07j,
         0.1392+9.4075e-08j, 10.5787+1.0815e-07j,  0.8034+1.8777e-07j,
         3.8639+3.1712e-06j,  0.4726+1.0788e-09j,  3.9899+4.7148e-08j,
        23.0029-3.9524e-07j, 15.4644+6.3043e-07j, 16.7367+3.3911e-07j,
        16.6059+4.5684e-07j,  0.7047+1.6631e-08j,  4.9499-7.2578e-07j,
         3.8250+1.5814e-07j,  0.4755+1.0247e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.769339084625244+1.3617180627534253e-07j)
torch.linalg.det(H.mH@H) = tensor([0.7075+3.6617e-08j, 4.6310-0.0000e+00j, 3.8793-3.1571e-08j,
        0.7122-1.4901e-07j, 0.3580+5.9264e-09j, 0.6889+5.9605e-08j,
        2.3915-2.6844e-08j, 0.5997-6.1065e-09j, 0.3441+1.0628e-07j,
        1.7624-8.1999e-08j, 0.4628+1.7445e-08j, 0.4986+5.7230e-09j,
        0.9659-3.3452e-09j, 9.4147+9.0151e-08j, 0.5737-0.0000e+00j,
        0.0178-0.0000e+00j, 4.1878+8.4953e-08j, 5.0028+1.8352e-07j,
        3.4651-2.0998e-08j, 0.1861-9.6287e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0424857139587402+1.3469228399287658e-08j)
SINR torch.Size([20]) = tensor([ -8.9197,   1.6547,  -6.6701,  -3.6147,  -1.5674,   1.0942, -16.8485,
          1.2273,  -6.4961,  -4.4690,  -4.9365,  -2.1996,  -1.7729,   1.6471,
          1.4257,  -0.1555,  -8.9252,  -5.0894,  -0.2417,  -9.1531],
       device='cuda:0')
SINR mean = -3.7005233764648438
E[H^H] = 1e-07
E_MSE (Error Power) = 5.509210109710693
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1137, 0.5941, 0.1771, 0.3032, 0.4107, 0.5627, 0.0202, 0.5702, 0.1831,
        0.2633, 0.2429, 0.3760, 0.3993, 0.5937, 0.5813, 0.4910, 0.1135, 0.2365,
        0.4861, 0.1084], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([655, 298, 584, 481, 409, 317, 865, 313, 578, 510, 526, 431, 416, 299,
        306, 360, 655, 532, 363, 662], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 6-----------
Real SNR = tensor([-0.4794,  5.0114,  5.6816,  6.6878,  2.9335,  1.8962,  6.1405,  3.1447,
         4.2958,  7.5219,  0.5208,  6.6245,  7.0415,  1.9838,  4.8308,  4.0189,
         6.9767,  5.7005,  6.1245,  8.7165], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.3315-3.3009e-08j,  3.7279-2.3424e-07j,  0.3801+1.3411e-07j,
        15.4869+2.6226e-06j,  5.4807+2.2246e-08j,  0.8590-5.0664e-07j,
         5.2939+4.5284e-08j,  9.6112-6.3885e-08j,  1.4060-1.4913e-08j,
         5.2677+1.1214e-07j,  6.2911-1.0806e-08j,  2.8706-6.7456e-08j,
         2.6009+5.9605e-08j,  1.7716+8.9407e-08j,  2.9214-5.3695e-08j,
         3.8891+8.1292e-08j, 11.8775+1.1921e-06j,  2.3379+7.3476e-09j,
         0.0811+7.4506e-09j, 20.1533+4.1014e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.281970977783203+1.8995366701801686e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.1146-0.0000e+00j,  0.4724+4.2930e-09j,  3.6335+1.0480e-08j,
         3.7901+3.0394e-08j,  0.2263-5.9605e-08j,  0.2112+1.0310e-08j,
         1.6575+1.8292e-08j,  0.0714+5.1650e-08j,  4.4631-1.9703e-08j,
         8.1451+1.9036e-07j,  0.3784+1.2340e-08j,  1.3328-8.0124e-08j,
         0.8875-2.8312e-07j,  0.5762+3.5336e-09j,  0.0359-9.9728e-08j,
         0.6547+1.1921e-07j,  0.3440-7.3234e-09j,  2.0573+8.6099e-08j,
         0.0243-2.0974e-08j, 10.2778-1.1496e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9677021503448486-7.4291506280133035e-09j)
SINR torch.Size([20]) = tensor([-3.3844e-03,  1.3903e+00, -1.1508e+01, -1.4978e+00,  7.5344e-01,
        -6.0048e+00, -2.9450e+00,  2.8065e-01, -2.9713e+00, -6.7166e-01,
         1.3738e+00, -8.5162e-01,  4.4565e-01, -5.1360e+00, -6.6353e-01,
         6.7720e-01, -2.6414e+00, -3.2431e+00, -1.4341e+01,  1.6745e+00],
       device='cuda:0')
SINR mean = -2.294161558151245
E[H^H] = 1e-07
E_MSE (Error Power) = 3.589184522628784
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4998, 0.5794, 0.0660, 0.4146, 0.5433, 0.2006, 0.3367, 0.5161, 0.3353,
        0.4614, 0.5784, 0.4511, 0.5256, 0.2346, 0.4619, 0.5389, 0.3525, 0.3215,
        0.0355, 0.5952], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([355, 307, 730, 407, 329, 562, 458, 345, 458, 378, 308, 384, 339, 533,
        377, 331, 447, 468, 805, 298], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 7-----------
Real SNR = tensor([8.2976, 6.9070, 4.7267, 7.7378, 4.2268, 7.1468, 4.4809, 8.0943, 4.8085,
        6.0223, 2.9125, 3.0927, 7.7439, 4.8463, 2.8789, 1.3056, 5.4832, 7.0626,
        1.8331, 5.9796], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.2734-6.3712e-08j, 5.7433+5.4180e-08j, 3.7540-9.8292e-08j,
        5.7383+6.8878e-08j, 2.4089-0.0000e+00j, 9.5123+9.4773e-08j,
        0.5455+7.4506e-08j, 8.4836+2.4409e-08j, 1.3516-1.4444e-07j,
        4.3179-5.7026e-08j, 3.5265+9.7460e-09j, 7.9802-3.8204e-08j,
        4.2278+8.3447e-07j, 0.7571-7.3418e-08j, 3.2830+9.7760e-09j,
        0.0468+1.9262e-09j, 1.8191+4.4852e-08j, 0.7540-1.4901e-07j,
        0.2677-9.3132e-09j, 0.6858+3.7253e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.4238364696502686+3.10671879333313e-08j)
torch.linalg.det(H.mH@H) = tensor([1.1229e+00+1.7881e-07j, 2.5484e-01+3.3890e-09j, 9.1209e-01-2.9802e-08j,
        3.4007e-01-2.0019e-08j, 1.3743e+00+1.2390e-08j, 1.8047e+00-2.6023e-08j,
        7.9117e-01+3.9971e-09j, 6.3337e+00-1.7744e-07j, 2.9062e-01-1.0151e-08j,
        2.5067e+00-7.1472e-08j, 3.7241e-02-8.0333e-09j, 9.6163e-02-7.4506e-09j,
        1.1965e+00+1.8442e-08j, 1.0543e+00+3.2125e-08j, 1.0404e+00+8.1412e-09j,
        1.9310e-01-1.9266e-09j, 6.9308e-01+2.9802e-08j, 1.8278e-01+6.7055e-08j,
        4.7240e-03-1.3099e-08j, 8.7389e-01+6.1210e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0551599264144897+2.497211326613069e-09j)
SINR torch.Size([20]) = tensor([ -0.3252,   0.4813,   0.3362,   1.9416,  -1.4574,   3.8802,  -5.0643,
          2.2319,  -4.1742,   2.7646,   0.6545,   0.0814,  -2.2756,  -1.7059,
          2.8973, -11.7691,  -0.9721,  -5.2804,  -5.9487,  -7.5394],
       device='cuda:0')
SINR mean = -1.562156081199646
E[H^H] = 1e-07
E_MSE (Error Power) = 2.592942953109741
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4813, 0.5277, 0.5193, 0.6099, 0.4169, 0.7096, 0.2376, 0.6257, 0.2767,
        0.6540, 0.5376, 0.5047, 0.3719, 0.4030, 0.6609, 0.0624, 0.4443, 0.2287,
        0.2027, 0.1498], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([366, 338, 343, 289, 405, 228, 531, 280, 500, 263, 332, 352, 434, 414,
        258, 737, 388, 538, 560, 612], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 8-----------
Real SNR = tensor([ 8.7592, 11.8549,  3.6536,  5.9713,  9.1895,  5.7161,  4.7198,  9.6417,
         8.5370, 12.9198, 10.4361,  5.9890,  7.3460,  9.7117,  6.7269,  3.7772,
         3.3362,  2.7356,  9.2310,  2.4955], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1122-2.9802e-08j, 19.1044-7.9646e-08j,  0.0482-3.7253e-09j,
         0.0465+7.9721e-07j,  2.9258-1.1529e-08j,  2.0529-4.7226e-09j,
         1.2994+2.1930e-08j,  0.7353-3.0837e-08j,  7.1566-2.5881e-08j,
         5.5576+6.7456e-07j,  1.8589-4.3198e-08j,  3.1204+9.2671e-08j,
         0.5439+2.9802e-08j, 25.6676+4.1103e-07j,  3.4677-5.5290e-08j,
         5.3251+3.9935e-08j,  9.2088-4.7122e-08j,  0.8244+9.1604e-09j,
         3.9445+1.3413e-08j,  0.7033+1.5490e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.6851806640625+8.867245782084865e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0189-7.8231e-08j, 4.8334+2.6995e-08j, 0.1152+1.1176e-08j,
        2.8595-2.1237e-09j, 3.3932+9.8929e-08j, 1.1597-2.7259e-09j,
        1.0137+5.4997e-09j, 4.6698-5.1546e-08j, 6.5628-1.1457e-07j,
        4.5073+5.1393e-07j, 0.5949-2.9984e-07j, 0.5982-1.1921e-07j,
        1.0514+1.4901e-07j, 6.0730-4.6706e-08j, 0.6784+1.4126e-09j,
        0.8617+3.1800e-08j, 0.0093-1.2107e-08j, 0.2499+3.9174e-09j,
        0.1166-1.7950e-07j, 0.4904+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9928619861602783-2.449304092877469e-09j)
SINR torch.Size([20]) = tensor([-17.0128,   4.8607, -11.5766, -21.6891,   0.7616,  -1.9646,  -4.1251,
        -10.5907,   4.3320,   4.1282,  -3.5268,  -0.8950,  -5.1848,   4.2115,
         -5.0218,  -2.3790,   0.3666,  -3.1689,   1.5340,   1.0760],
       device='cuda:0')
SINR mean = -3.2932183742523193
E[H^H] = 1e-07
E_MSE (Error Power) = 16.565004348754883
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0195, 0.7538, 0.0650, 0.0067, 0.5437, 0.3888, 0.2789, 0.0803, 0.7306,
        0.7212, 0.3074, 0.4487, 0.2326, 0.7251, 0.2393, 0.3664, 0.5211, 0.3253,
        0.5874, 0.5616], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([869, 200, 732, 968, 328, 423, 499, 704, 215, 221, 478, 386, 535, 219,
        529, 438, 342, 465, 302, 318], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 9-----------
Real SNR = tensor([ 7.9529,  7.8548,  5.0973, 10.0530, 11.2677,  4.5100,  7.5177,  6.1377,
         9.8512,  4.9864, 10.3308,  9.7861, 10.5491,  9.3395,  7.8926,  4.8580,
        12.3256,  8.2964,  8.8852,  9.0203], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.5153-4.1166e-08j, 12.1824+1.1652e-07j,  0.9817-2.0862e-07j,
         4.3551-3.5763e-07j,  4.9393-1.2089e-06j,  0.7158+3.6971e-08j,
         3.3056-1.9445e-08j,  0.9795+1.7166e-08j,  3.3115+5.3030e-08j,
         3.1266-6.6303e-08j,  6.1925+5.4997e-08j,  2.5222+5.4719e-08j,
         9.5681-1.7335e-07j,  2.8723+5.5572e-07j,  1.5859-5.9605e-08j,
         3.8070-5.9605e-08j,  2.2180-8.1956e-08j, 19.0024-1.2754e-08j,
         4.3210+2.4493e-08j,  0.7960-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.5149149894714355-6.878672564880617e-08j)
torch.linalg.det(H.mH@H) = tensor([2.6869-1.8083e-08j, 3.6606+8.3626e-08j, 0.7861+2.7741e-09j,
        4.7561-7.5869e-08j, 0.5873-1.7976e-08j, 0.2627-1.8074e-09j,
        1.7527-5.9605e-08j, 0.0462-9.8907e-10j, 2.8250+4.2109e-08j,
        0.7121+1.8652e-08j, 5.3337+1.1921e-07j, 1.3982+1.2776e-07j,
        9.4567-6.9093e-08j, 0.2622-8.7157e-08j, 2.7622+2.9802e-08j,
        0.7599+2.7152e-08j, 3.5597-1.0133e-06j, 6.0500-7.7226e-08j,
        4.5015+7.0507e-08j, 1.4472+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6803550720214844-3.9014206976162313e-08j)
SINR torch.Size([20]) = tensor([ 4.5158,  3.4143, -5.6305,  2.2145,  1.8342, -0.3539,  3.0639, -4.3668,
         1.7305,  0.6746,  1.4418, -0.3337,  6.7393, -5.1514, -4.3745, -0.8006,
        -3.9613,  6.8523,  7.6049, -3.8480], device='cuda:0')
SINR mean = 0.5632758736610413
E[H^H] = 1e-07
E_MSE (Error Power) = 1.327859878540039
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7388, 0.6870, 0.2148, 0.6248, 0.6040, 0.4796, 0.6694, 0.2679, 0.5983,
        0.5388, 0.5822, 0.4808, 0.8252, 0.2339, 0.2675, 0.4540, 0.2866, 0.8289,
        0.8521, 0.2919], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([210, 242, 550, 280, 292, 367, 253, 507, 296, 331, 305, 366, 152, 534,
        507, 382, 493, 150, 133, 489], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 10-----------
Real SNR = tensor([ 8.4778, 11.0416,  9.8385,  7.3873,  7.0805,  9.5757, 11.3337, 12.4955,
        11.3422, 14.1616,  8.4157,  4.0787,  5.1317,  3.3803,  2.9625, 12.0916,
         8.9716,  6.9403, 13.4752, 11.6167], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.9130+4.1017e-07j, 3.2311-1.8438e-07j, 3.4344-4.7805e-08j,
        2.6692+1.1921e-07j, 1.4021+4.6187e-07j, 2.7103-2.5667e-08j,
        6.4929+4.5914e-07j, 7.8357-2.7416e-07j, 1.8713+5.5301e-08j,
        7.0046+4.4418e-07j, 3.6432-2.5035e-09j, 0.1727+1.6391e-07j,
        0.6588-5.5879e-08j, 3.0315-9.4146e-08j, 1.9652+5.9605e-08j,
        1.3179-3.2711e-07j, 0.3710-2.7255e-09j, 3.5803-0.0000e+00j,
        0.0395-6.0077e-08j, 2.5125-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.8928585052490234+5.1966527081503955e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0786-1.1921e-07j, 1.1787+1.1221e-07j, 4.8393-1.2554e-07j,
        3.0627+1.7260e-10j, 1.4149-4.5730e-08j, 3.2137+3.5431e-09j,
        3.9633-3.0848e-07j, 6.5244+1.1321e-07j, 0.7313-7.3579e-08j,
        6.8164+8.8164e-08j, 3.0524-8.4567e-09j, 0.3624-3.1407e-09j,
        0.2470+7.4506e-09j, 0.0982+2.4873e-10j, 0.0682-1.8626e-08j,
        2.4985+2.4283e-07j, 1.6874+1.2965e-08j, 0.5731-1.8355e-08j,
        2.2148-4.2531e-08j, 4.7468-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.418598175048828-1.5102990857940313e-08j)
SINR torch.Size([20]) = tensor([  4.8587,  -0.7390,   0.4047,   2.9905,  -3.6722,   3.3516,   3.5284,
          3.8055,   3.0539,   4.1118,   2.5038,  -9.6863,   0.1626,   2.9075,
         -1.0636,  -5.5596,  -2.5545,  -0.1204, -17.2306,   3.0671],
       device='cuda:0')
SINR mean = -0.29401054978370667
E[H^H] = 1e-07
E_MSE (Error Power) = 5.280725479125977
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7538, 0.4576, 0.5233, 0.6657, 0.3004, 0.6839, 0.6926, 0.7060, 0.6689,
        0.7205, 0.6403, 0.0971, 0.5094, 0.6614, 0.4391, 0.2175, 0.3570, 0.4931,
        0.0186, 0.6696], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 380, 340, 255, 483, 244, 239, 231, 253, 222, 271, 678, 349, 258,
        391, 547, 444, 359, 874, 253], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 11-----------
Real SNR = tensor([ 8.0242,  6.6851, 10.2760,  7.0623,  8.9612, 13.5559,  9.0910, 11.7628,
        12.0336,  9.9065, 11.2778,  3.3098,  7.9679,  3.4608,  7.6002,  9.6983,
        13.0071,  8.1394,  6.4899,  8.6312], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.9982+2.9802e-08j, 0.4639+4.2371e-08j, 2.9174+8.9688e-07j,
        0.2289-3.1292e-07j, 3.2182+1.0451e-08j, 1.9109+6.3630e-07j,
        1.4035-0.0000e+00j, 1.6730+2.3842e-07j, 0.2074-2.1348e-07j,
        0.4830+1.4901e-08j, 8.9557+2.0716e-07j, 0.1355+7.0035e-09j,
        5.3622-6.1127e-08j, 0.7567+1.2337e-08j, 2.7117-3.5763e-07j,
        0.7747-1.9735e-08j, 1.3962+9.4123e-09j, 2.4927+1.0763e-08j,
        2.5120-5.9605e-08j, 4.7269-2.7672e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.166442632675171+5.318157292322212e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0342+1.1176e-08j, 0.0407-2.4841e-08j, 1.2295-7.7480e-08j,
        0.3391+8.9407e-08j, 0.0407-1.8068e-07j, 0.7350+6.3531e-08j,
        1.4961-2.4182e-08j, 1.0578-6.4376e-08j, 1.7193-1.1882e-08j,
        1.5422+7.5945e-09j, 1.1573+3.6723e-07j, 0.1528+1.5397e-09j,
        0.2294+1.1001e-07j, 0.1236+5.3252e-10j, 0.1369-1.8626e-09j,
        0.3834-1.2529e-08j, 1.3107+8.2172e-08j, 1.4206+6.4226e-09j,
        0.5973+1.5649e-08j, 1.0637-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.7405224442481995+1.7872055835255196e-08j)
SINR torch.Size([20]) = tensor([ 1.3349, -2.1269,  3.3272, -6.0004, -1.1996, -3.1178,  1.1273, -1.5292,
        -9.7810, -3.6155,  4.5032, -4.6282,  5.0819, -0.5051,  1.6562, -0.0613,
         0.3591,  4.4281,  5.5699,  3.6963], device='cuda:0')
SINR mean = -0.07403867691755295
E[H^H] = 1e-07
E_MSE (Error Power) = 1.7090145349502563
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5762, 0.3800, 0.6827, 0.2007, 0.4314, 0.3279, 0.5645, 0.4129, 0.0952,
        0.3031, 0.7383, 0.2562, 0.7632, 0.4710, 0.5942, 0.4965, 0.5207, 0.7349,
        0.7829, 0.7008], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([309, 429, 245, 562, 396, 464, 316, 408, 681, 481, 210, 516, 194, 372,
        298, 357, 342, 213, 181, 234], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 12-----------
Real SNR = tensor([12.5437, 11.5197,  8.9775, 14.1265, 14.4512, 12.1297,  8.2342,  9.1112,
        11.7510,  8.1040, 10.5860, 12.2721,  8.7160,  9.9741, 11.6204,  9.0294,
        15.1289, 12.1301, 12.0523, 11.0042], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.9726+5.0659e-08j, 0.4351+1.8376e-08j, 0.0381+7.8954e-10j,
        1.5189-2.5704e-08j, 4.3084+3.9266e-08j, 3.0503-9.3188e-09j,
        1.3637-7.5862e-08j, 3.7242-1.6237e-07j, 0.3768-3.7501e-08j,
        1.1864+8.9407e-08j, 5.3607+1.3824e-07j, 1.0476+4.5728e-08j,
        0.1542+6.2170e-09j, 4.9023-3.7845e-10j, 1.5242+1.1199e-07j,
        5.8485+1.1921e-06j, 2.9694+1.0729e-06j, 1.4532+5.8129e-08j,
        0.2167-6.7055e-08j, 0.2959-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.0873754024505615+1.2153448381013732e-07j)
torch.linalg.det(H.mH@H) = tensor([1.4594-1.3425e-08j, 0.5889+7.0577e-08j, 0.2508-9.1368e-09j,
        3.8817+7.5647e-08j, 0.0147-1.2042e-08j, 1.7496-2.9783e-08j,
        0.3646-2.9802e-08j, 0.5838-1.8776e-08j, 0.3794+5.9193e-08j,
        1.0667+2.9802e-08j, 1.3100-0.0000e+00j, 0.8804+3.0728e-08j,
        0.0546-2.2233e-08j, 1.5799-1.8823e-08j, 0.5537+2.1035e-09j,
        1.2464+4.7375e-09j, 3.4382+1.1921e-07j, 1.3127+1.1637e-09j,
        2.0536-2.3136e-08j, 1.2151-1.7044e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1992107629776+9.947927814835111e-09j)
SINR torch.Size([20]) = tensor([ 4.4306, -2.6732, -9.2134,  0.7365,  3.6628,  5.8849,  1.6118,  4.2049,
        -5.0572,  3.0049,  4.5979,  2.1341,  0.1110,  8.4718,  3.4354,  6.4716,
        -3.6010,  1.2882, -7.7170, -0.9226], device='cuda:0')
SINR mean = 1.0431009531021118
E[H^H] = 1e-07
E_MSE (Error Power) = 1.6379632949829102
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7350, 0.3508, 0.1070, 0.5423, 0.6992, 0.7950, 0.5917, 0.7248, 0.2379,
        0.6664, 0.7424, 0.6204, 0.5064, 0.8755, 0.6881, 0.8161, 0.3038, 0.5736,
        0.1447, 0.4471], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([212, 448, 664, 329, 235, 173, 300, 219, 530, 255, 208, 283, 351, 115,
        242, 159, 480, 311, 618, 386], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 13-----------
Real SNR = tensor([13.3946, 12.1991, 15.9292, 13.3270, 11.3602, 10.8284,  9.2648, 15.2469,
         7.6864, 12.0620, 10.6748,  8.0753, 13.7744, 11.4472, 15.7892,  9.5144,
         8.2992, 10.8152, 11.1369, 11.0861], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.8848+2.8458e-08j,  2.7472-1.1820e-07j, 13.8522-4.9520e-08j,
         2.2531-7.7310e-08j,  2.7527-2.5589e-08j,  0.7091-9.3896e-08j,
         0.3844-0.0000e+00j,  5.4872-6.3238e-08j,  0.5476-2.4019e-09j,
         0.2427+8.9407e-08j,  0.4149-6.5192e-09j,  1.4137-0.0000e+00j,
         1.9756+2.3666e-08j,  1.0569+5.1506e-09j,  4.6325-1.2071e-07j,
         1.2383+1.6885e-08j,  0.5309+2.2656e-09j,  0.4076-4.7084e-09j,
         0.6730+2.0862e-07j,  1.8291+5.2350e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.4016811847686768-6.7648175949841516e-09j)
torch.linalg.det(H.mH@H) = tensor([5.8895-3.2805e-08j, 0.9931+6.8671e-08j, 8.8504+3.2468e-07j,
        2.2957+2.4829e-08j, 0.6621+5.9605e-08j, 0.7013-2.9889e-11j,
        0.1926+7.4506e-09j, 2.9067+5.4392e-08j, 0.0264+8.0477e-10j,
        0.3099-5.4062e-09j, 0.3694-3.1417e-08j, 0.2145+2.2352e-08j,
        1.0790-2.1836e-08j, 3.5034+1.7460e-08j, 0.3636-1.3424e-07j,
        0.6493-6.3219e-09j, 0.6783-6.4481e-09j, 0.6904-2.4247e-09j,
        0.7192+8.9407e-08j, 1.4221-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6258480548858643+2.069090854206479e-08j)
SINR torch.Size([20]) = tensor([10.6046,  5.2053,  8.7628,  1.2805,  5.9940,  0.8506, -1.5263,  7.9140,
         2.2640,  0.2195,  4.7734,  4.0496,  4.5376,  2.9925,  3.5900,  4.2611,
         0.3427, -0.0897, -0.4222,  0.2523], device='cuda:0')
SINR mean = 3.2928097248077393
E[H^H] = 1e-07
E_MSE (Error Power) = 0.6906166076660156
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9200, 0.7683, 0.8826, 0.5732, 0.7990, 0.5488, 0.4130, 0.8608, 0.6275,
        0.5126, 0.7501, 0.7176, 0.7398, 0.6658, 0.6956, 0.7273, 0.5197, 0.4948,
        0.4757, 0.5145], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 79, 191, 110, 311, 170, 325, 408, 126, 278, 347, 203, 223, 209, 255,
        237, 217, 343, 357, 369, 346], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 14-----------
Real SNR = tensor([ 9.1892, 15.5127, 12.0266, 14.7284, 11.1445, 10.3910, 12.0227, 10.8157,
        12.6098, 13.7398, 11.0959, 13.0909, 12.5073,  9.4663, 14.6955,  8.4798,
        11.7582, 11.9829, 14.3973, 15.4958], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.7605-2.9802e-08j, 2.2872+3.2294e-08j, 0.9009+2.9802e-08j,
        2.0053+5.0274e-08j, 0.9057-1.9954e-08j, 1.3115-0.0000e+00j,
        3.2059+2.7910e-07j, 3.0744-2.4633e-08j, 2.6096+1.1167e-07j,
        0.6731-2.1914e-08j, 0.0650+2.8685e-07j, 5.1868+1.2447e-07j,
        0.4932-1.6518e-08j, 2.4024+5.2468e-08j, 2.3709+3.5763e-07j,
        0.3486-2.6077e-08j, 1.8791+2.1572e-09j, 0.6858-2.4691e-08j,
        1.1007+3.3207e-07j, 0.8559+3.3667e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.6561330556869507+9.159247582601893e-08j)
torch.linalg.det(H.mH@H) = tensor([1.5366e-01+5.5879e-09j, 1.2627e-01-1.9900e-07j, 9.4481e-01+2.1861e-08j,
        9.4807e-01+5.8041e-08j, 7.9071e-01-2.3707e-08j, 2.8686e-01+8.9407e-08j,
        3.9680e-01+1.7564e-09j, 1.8761e+00-6.8419e-09j, 3.5590e+00+6.8326e-08j,
        1.7158e-01+1.0663e-07j, 3.4953e-01-1.4901e-08j, 3.7589e+00+2.4265e-08j,
        1.5571e+00+1.6188e-08j, 8.6300e-01-1.8305e-09j, 5.2706e+00-9.8059e-09j,
        7.6828e-02-4.6566e-10j, 1.2879e+00-5.5208e-08j, 1.6651e+00+1.9728e-08j,
        4.2192e-03-2.4325e-08j, 6.2621e-01+2.1447e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2356637716293335+1.4508685808323207e-08j)
SINR torch.Size([20]) = tensor([ 4.6334,  1.4119,  0.1766,  0.6653,  4.7594,  0.9381,  6.0516,  5.5228,
         6.5481,  0.2857, -8.3330,  6.4154, -1.2295,  6.6340,  2.8472, -0.2569,
         3.3215,  5.5458,  1.6336, -3.1484], device='cuda:0')
SINR mean = 2.221125602722168
E[H^H] = 1e-07
E_MSE (Error Power) = 1.1613035202026367
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7440, 0.5806, 0.5102, 0.5382, 0.7495, 0.5538, 0.8011, 0.7810, 0.8187,
        0.5164, 0.1280, 0.8141, 0.4297, 0.8216, 0.6583, 0.4852, 0.6824, 0.7819,
        0.5929, 0.3263], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([207, 306, 348, 332, 203, 322, 169, 183, 157, 345, 637, 160, 397, 155,
        260, 363, 245, 182, 299, 465], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 15-----------
Real SNR = tensor([12.2523, 14.8966, 15.7361, 14.4290, 14.2452, 18.2772, 13.4739, 13.8369,
        13.7127, 16.7579, 14.0230, 14.7493, 15.4653, 13.1222, 13.6435, 13.0460,
        15.2894, 12.8845, 16.5991, 16.1870], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.8448+8.9407e-08j, 0.3877-0.0000e+00j, 0.0914+4.2599e-08j,
        2.0042-3.6726e-08j, 0.5084-1.4901e-08j, 4.8855-2.4370e-08j,
        0.0163+1.9674e-08j, 4.4280+2.9510e-08j, 4.0315-2.2517e-08j,
        1.7326+8.9482e-08j, 2.5238+2.3814e-08j, 3.4393+3.0859e-07j,
        5.3173-8.0321e-08j, 0.3637-2.2058e-09j, 1.1355+5.4709e-09j,
        0.3990+8.9407e-08j, 2.0929-5.9605e-08j, 0.5507-8.9407e-08j,
        3.6087-2.5266e-08j, 1.5668+1.1569e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.9964096546173096+2.29162235854119e-08j)
torch.linalg.det(H.mH@H) = tensor([0.8562+1.8659e-08j, 0.9691+5.0074e-08j, 0.9463+2.3842e-07j,
        1.4576-1.5983e-08j, 0.5089+8.9407e-08j, 6.6930+1.1823e-07j,
        1.2838+2.9802e-08j, 1.9837-0.0000e+00j, 1.9316-0.0000e+00j,
        1.2528+3.7965e-08j, 3.1081-1.7829e-08j, 1.8653-2.3842e-07j,
        3.2525-4.7229e-08j, 0.3296-5.2250e-09j, 1.0633+8.4992e-10j,
        0.4301+7.4506e-08j, 1.7307+1.7881e-07j, 1.6896+5.9605e-08j,
        4.6941+1.4541e-07j, 4.3239-1.1773e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0185117721557617+2.996614512085216e-08j)
SINR torch.Size([20]) = tensor([  6.7174,  -1.4342, -10.4645,   6.4628,  -0.4632,   7.5247, -13.9112,
          7.9924,   9.4111,   1.5630,   4.8251,   7.7404,  10.8234,  -0.7528,
         10.3876,  -2.1265,   5.7175,  -4.0115,   8.3478,   0.9665],
       device='cuda:0')
SINR mean = 2.765786647796631
E[H^H] = 1e-07
E_MSE (Error Power) = 2.711383104324341
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8244, 0.4182, 0.0824, 0.8158, 0.4734, 0.8497, 0.0390, 0.8630, 0.8972,
        0.5890, 0.7523, 0.8560, 0.9236, 0.4568, 0.9162, 0.3800, 0.7886, 0.2842,
        0.8724, 0.5554], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([153, 404, 701, 159, 370, 135, 794, 125,  98, 301, 201, 130,  76, 381,
         82, 429, 178, 495, 118, 321], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 16-----------
Real SNR = tensor([15.1775, 14.8036, 11.6398, 13.0412, 14.0853, 18.1451, 11.1857, 12.0313,
        13.9935, 18.0344, 19.1166, 14.4235, 14.2352, 17.1993, 14.2607, 10.7126,
        17.3683, 12.6972, 10.4322, 14.2060], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.9995+1.3316e-08j, 0.9373+4.4703e-07j, 2.1737-3.8255e-08j,
        1.2352-5.2624e-09j, 1.9849+4.4734e-08j, 1.8699+8.2568e-08j,
        0.2394+4.4703e-08j, 0.2965-2.3424e-09j, 0.6901+7.4506e-09j,
        0.0549-2.2959e-08j, 7.7978-4.2672e-08j, 0.5239-2.7682e-08j,
        1.7405+1.8579e-09j, 0.7231+2.6352e-07j, 2.0704+2.2640e-08j,
        0.5206+4.0351e-10j, 2.8043-4.4886e-08j, 0.9391-2.2642e-09j,
        1.5239+1.1921e-07j, 1.5444+6.1267e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.5334758758544922+4.611890602745916e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.5515+2.6222e-09j,  0.2306+1.4901e-07j,  0.4200+3.6352e-08j,
         1.0373+2.3945e-08j,  0.4844+8.8434e-09j,  4.5628+2.0267e-07j,
         0.2863-7.3030e-10j,  0.2373-0.0000e+00j,  0.5853-7.4506e-09j,
         0.2033-2.2609e-07j, 11.4410-1.8165e-07j,  0.3658-1.3693e-07j,
         1.2891-0.0000e+00j,  0.1530-1.0803e-07j,  0.7968-2.7820e-08j,
         0.0333-1.4426e-08j,  6.4727-2.0405e-07j,  0.2588-5.9605e-08j,
         0.8233+7.0027e-09j,  1.5511+2.9348e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.63919198513031-2.534999055114895e-08j)
SINR torch.Size([20]) = tensor([ 7.0235, -0.0619,  3.5814,  4.4100,  6.3408,  5.0532,  0.6875,  2.2308,
         4.8971, -7.0820,  9.1514,  0.5791,  8.0455,  2.8429,  7.7787,  3.7172,
         2.4717,  2.6581,  7.1758,  7.6575], device='cuda:0')
SINR mean = 3.9579124450683594
E[H^H] = 1e-07
E_MSE (Error Power) = 0.691314697265625
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8344, 0.4964, 0.6952, 0.7341, 0.8115, 0.7620, 0.5395, 0.6257, 0.7554,
        0.1637, 0.8916, 0.5333, 0.8644, 0.6580, 0.8571, 0.7018, 0.6386, 0.6484,
        0.8392, 0.8536], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([146, 357, 237, 213, 162, 195, 331, 280, 199, 597, 103, 334, 124, 260,
        129, 233, 272, 266, 142, 132], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 17-----------
Real SNR = tensor([18.3718, 17.9829, 15.0058, 17.8349, 13.6081, 14.7628, 16.7077, 12.3713,
        13.9632, 12.5607, 14.6729, 12.0139, 12.9648, 18.4168, 14.2680, 15.3979,
        16.6509, 15.8899, 14.2181, 14.2641], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 5.9665-1.3528e-07j,  0.2937-4.9183e-08j,  3.3344+1.7881e-07j,
         3.3010+1.7115e-07j,  1.5330-2.6441e-09j,  1.4850-4.4728e-08j,
         3.1516+6.7259e-08j,  0.2114-1.1176e-08j,  1.8926-4.8052e-08j,
         0.7323-3.9102e-09j,  2.9798-3.1927e-08j,  0.5519-6.5883e-09j,
         0.9440-1.0053e-08j, 16.3227-2.8908e-07j,  3.7714+9.6023e-08j,
         1.1480+3.5836e-08j,  0.7405-1.6341e-08j,  0.8290+1.2405e-08j,
         0.8851+1.7419e-07j,  0.0753-2.0207e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.50747013092041+3.325706599e-09j)
torch.linalg.det(H.mH@H) = tensor([ 7.0809+5.9779e-09j,  0.5271+3.0021e-09j,  3.2496-3.7339e-08j,
         3.7525-1.1592e-07j,  1.6825-1.8424e-08j,  0.8991-1.1775e-08j,
         1.5864-3.7214e-07j,  0.2743-7.4506e-09j,  1.5661+7.9940e-08j,
         0.7272-1.2856e-08j,  1.6020+8.2224e-08j,  0.8220+3.6895e-10j,
         0.8557-1.3131e-08j, 11.8453-3.6624e-07j,  2.5608+4.2619e-08j,
         2.3321-8.1620e-09j,  1.1074-8.6086e-08j,  0.7626-1.6772e-08j,
         0.3531+5.2154e-08j,  0.1800+2.5975e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.18833327293396-3.8702054894201865e-08j)
SINR torch.Size([20]) = tensor([11.2589, -3.5607,  9.3141,  8.7020,  7.9071, 10.3918,  9.4228,  2.4210,
         9.8683,  4.0368,  8.7363,  9.0536,  8.3831, 15.6974,  9.6129,  7.7774,
         1.1473,  9.2489,  7.0627, -4.1227], device='cuda:0')
SINR mean = 7.117947578430176
E[H^H] = 1e-07
E_MSE (Error Power) = 0.4451441764831543
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9304, 0.3058, 0.8952, 0.8812, 0.8606, 0.9163, 0.8975, 0.6359, 0.9066,
        0.7170, 0.8820, 0.8894, 0.8733, 0.9738, 0.9015, 0.8570, 0.5657, 0.8938,
        0.8357, 0.2790], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 70, 479, 100, 111, 127,  82,  98, 273,  90, 224, 110, 104, 117,  28,
         95, 129, 315, 101, 145, 498], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 18-----------
Real SNR = tensor([18.0791, 17.9269, 15.0418, 13.6228, 16.3673, 13.4997, 17.1930, 14.1615,
        17.3507, 16.5265, 17.8233, 16.2439, 11.6500, 19.7835, 18.0985, 16.8972,
        16.4296, 14.1354, 16.9179, 15.0249], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.3954-1.7772e-08j, 0.3024-1.5646e-07j, 0.1981+1.0410e-08j,
        0.8095-0.0000e+00j, 0.2282-1.4531e-08j, 0.3155-1.1176e-08j,
        0.6533+7.7198e-08j, 0.2110+7.4506e-09j, 1.9763+3.8368e-08j,
        0.1646+7.4506e-09j, 0.0664-1.5120e-08j, 0.6304-4.4703e-08j,
        0.1577+1.5673e-09j, 3.0370-1.6197e-07j, 2.0358+3.0583e-08j,
        6.8451-2.4153e-08j, 1.6670+3.4606e-08j, 0.2348-2.2352e-08j,
        7.3200-1.0047e-07j, 0.2994+2.3051e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.4273980855941772-1.793877402178623e-08j)
torch.linalg.det(H.mH@H) = tensor([0.9686+1.5166e-08j, 0.5955+2.6822e-07j, 0.2598-1.8162e-08j,
        0.0767+3.3528e-08j, 0.3566-8.0966e-10j, 0.1661+3.7253e-09j,
        0.0625+3.1676e-08j, 0.6128-1.0652e-08j, 2.4420+7.9128e-08j,
        0.0753-0.0000e+00j, 0.2434+3.7156e-08j, 0.8898-0.0000e+00j,
        0.1780+2.2115e-09j, 3.1702+4.0545e-09j, 2.3668+1.6329e-08j,
        5.3807+6.8516e-08j, 1.6479+1.2278e-08j, 0.1303+1.1176e-08j,
        1.4442-4.0423e-08j, 0.6729+1.5997e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0870144367218018+2.5735801045811968e-08j)
SINR torch.Size([20]) = tensor([ 8.1772,  1.7371, -0.8052,  3.7928, -0.5741,  3.8190, -0.0236,  1.1261,
        11.5316, -5.7894, -4.9816,  7.2566,  3.8981,  7.0142,  6.9439, 13.6100,
         6.6642,  4.0173,  4.4746,  3.4913], device='cuda:0')
SINR mean = 3.7690086364746094
E[H^H] = 1e-07
E_MSE (Error Power) = 0.8719047904014587
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8679, 0.5987, 0.4538, 0.7054, 0.4670, 0.7067, 0.4986, 0.5645, 0.9343,
        0.2087, 0.2410, 0.8417, 0.7104, 0.8341, 0.8319, 0.9583, 0.8227, 0.7161,
        0.7370, 0.6908], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([121, 296, 382, 231, 374, 230, 355, 316,  66, 555, 528, 141, 228, 146,
        148,  44, 154, 224, 211, 240], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 19-----------
Real SNR = tensor([14.4517, 17.1354, 14.7632, 20.6707, 13.4231, 20.4071, 17.5693, 21.6152,
        18.3552, 17.9924, 12.8214, 16.4296, 20.4244, 21.6003, 18.7975, 17.3268,
        16.8959, 19.1960, 11.9946, 16.0601], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.8476+2.1036e-09j, 1.2788-2.3739e-08j, 0.1999-1.4901e-08j,
        3.2799-2.1312e-08j, 0.7591-4.8500e-09j, 7.4164-1.1921e-07j,
        0.4124+2.2352e-08j, 2.0876+3.7428e-07j, 2.0404+2.8422e-08j,
        4.4695+1.4614e-08j, 0.0264+5.5879e-09j, 0.4268-7.4506e-08j,
        8.3678-7.4871e-08j, 0.1606-8.0916e-08j, 0.2161+2.4042e-09j,
        0.3415-5.6126e-09j, 1.7025+1.0858e-08j, 1.3359-0.0000e+00j,
        0.7743+1.0181e-09j, 0.2273-9.3151e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8185402154922485+1.6201945340910129e-09j)
torch.linalg.det(H.mH@H) = tensor([0.3940-3.5281e-09j, 1.5340+5.0675e-08j, 0.0453-7.4506e-09j,
        3.3686+3.5326e-08j, 0.1954+1.4606e-09j, 5.2948+2.3842e-07j,
        1.9535-7.8175e-09j, 2.7407+1.2482e-07j, 1.9451-3.3613e-08j,
        3.6204-5.7752e-08j, 0.0940+1.5762e-08j, 0.1508+7.8231e-08j,
        9.4072-1.2099e-07j, 0.6394+5.7070e-09j, 0.6282-1.0753e-08j,
        1.3727+1.9298e-08j, 0.9903+1.0714e-08j, 3.1153+1.1921e-07j,
        0.6722-8.0423e-09j, 0.5252+3.6906e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9343622922897339+2.432915735539609e-08j)
SINR torch.Size([20]) = tensor([ 9.2679,  9.6526,  4.1048,  9.9870,  8.5859, 12.8097,  1.4733,  6.4745,
        12.7217,  9.3267, -0.1668,  3.8968, 14.2284, -4.8883, -1.2710,  2.0836,
        11.5557,  7.6635, 12.4294,  4.2329], device='cuda:0')
SINR mean = 6.708410739898682
E[H^H] = 1e-07
E_MSE (Error Power) = 0.5044922232627869
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8942, 0.9023, 0.7201, 0.9088, 0.8784, 0.9502, 0.5840, 0.8162, 0.9493,
        0.8954, 0.4904, 0.7104, 0.9636, 0.2450, 0.4274, 0.6177, 0.9347, 0.8538,
        0.9459, 0.7260], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([101,  94, 222,  89, 113,  52, 304, 159,  53, 100, 360, 228,  39, 525,
        399, 284,  66, 132,  56, 218], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 20-----------
Real SNR = tensor([23.5095, 18.8619, 19.3278, 16.3643, 20.1464, 19.0255, 17.7706, 16.0480,
        21.2927, 21.8878, 18.1440, 19.6316, 16.7270, 19.4463, 22.6308, 15.8367,
        18.9858, 18.5480, 17.2468, 19.5380], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([14.1649-1.0435e-07j,  0.1219-6.6953e-09j,  0.1600-3.7253e-09j,
         0.3488+2.2783e-09j,  2.9279+1.1921e-07j,  4.5203+1.0959e-08j,
         0.4235-1.9092e-08j,  2.9686-3.2991e-08j,  1.0667-4.4697e-08j,
         0.3643-2.9208e-08j,  1.1799+7.8678e-08j,  0.2415-3.4429e-08j,
         1.2783-5.9605e-08j,  2.6808+2.1256e-08j,  1.9615+8.3447e-07j,
         0.4110+3.6322e-08j,  0.0813+2.0650e-08j,  3.0396-8.4641e-08j,
         0.7768-1.1176e-08j,  0.6519+3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.9684619903564453+3.484650434870673e-08j)
torch.linalg.det(H.mH@H) = tensor([1.3459e+01+8.6496e-08j, 1.4238e-01+1.9672e-08j, 7.6830e-01-1.1176e-08j,
        6.2629e-01-9.4783e-10j, 4.2288e+00-4.7684e-07j, 3.8300e+00+1.2057e-07j,
        6.5140e-01+4.4703e-08j, 1.1402e+00-2.1624e-08j, 1.8282e+00+8.9719e-08j,
        6.4150e-01+1.2395e-08j, 1.3455e+00+7.5800e-09j, 5.9307e-01-8.1774e-08j,
        8.5911e-01+1.1176e-08j, 9.1851e-01-1.7585e-08j, 1.1074e+00+3.5763e-07j,
        2.2944e-01-3.7253e-09j, 1.3325e-02+2.6134e-09j, 1.8718e+00-2.7033e-08j,
        7.6480e-01-2.9802e-08j, 1.6090e+00-2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8313827514648438+2.6125293040024644e-09j)
SINR torch.Size([20]) = tensor([13.6186,  0.6669, -4.8940, 10.9335, 11.5119, 15.8908,  5.5241,  9.6324,
         8.9618,  6.7913, 11.8771,  2.8094, 10.0227,  8.8485,  6.8586,  1.5379,
        -2.0844, 13.6998,  9.1092,  3.7140], device='cuda:0')
SINR mean = 7.251495361328125
E[H^H] = 1e-07
E_MSE (Error Power) = 0.4288615882396698
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9583, 0.5383, 0.2447, 0.9254, 0.9341, 0.9749, 0.7811, 0.9018, 0.8873,
        0.8269, 0.9390, 0.6563, 0.9095, 0.8847, 0.8291, 0.5876, 0.3823, 0.9591,
        0.8907, 0.7017], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 44, 332, 525,  74,  67,  27, 183,  94, 106, 151,  62, 261,  88, 108,
        150, 302, 427,  43, 103, 233], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 21-----------
Real SNR = tensor([24.0770, 20.2416, 17.3267, 18.0705, 21.2476, 20.0946, 13.6150, 23.9128,
        21.6667, 23.0542, 17.2602, 14.4735, 20.7303, 22.5188, 18.6198, 16.1336,
        16.1380, 18.7337, 20.1634, 20.0044], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([9.0672+2.0597e-07j, 3.6152+2.0825e-08j, 0.4429+1.7605e-08j,
        0.7895-1.7489e-08j, 0.4396-1.0431e-07j, 2.6811-2.9816e-08j,
        0.0702-0.0000e+00j, 9.1362-7.8049e-08j, 2.0113+1.7881e-07j,
        6.1053+1.2614e-07j, 0.3547-7.6242e-09j, 0.1652-8.1956e-08j,
        0.0673-7.4206e-09j, 6.1642+1.4636e-07j, 0.5203-3.6003e-08j,
        0.2037+2.1226e-09j, 0.9044-6.6458e-09j, 1.2844+3.9947e-08j,
        2.1053+7.1360e-09j, 1.4785-2.8840e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.3803210258483887+1.8636653109638246e-08j)
torch.linalg.det(H.mH@H) = tensor([11.1065+1.1664e-07j,  2.9470+3.2787e-08j,  0.4276-1.4901e-08j,
         0.4022-6.9579e-09j,  1.1351+9.8420e-08j,  2.7536+2.6274e-08j,
         0.0722-3.0681e-09j,  9.6277-4.3346e-07j,  1.3876+2.3842e-07j,
         2.6070-3.7253e-08j,  0.1464+1.1270e-09j,  0.0580+3.1665e-08j,
         0.1090-2.0163e-09j,  6.6600+3.1772e-07j,  0.2006-1.7244e-07j,
         0.0786-6.6140e-09j,  0.4106-6.9057e-09j,  0.8622+1.0405e-07j,
         2.0382+9.2271e-09j,  1.2937+1.0956e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2161946296691895+1.4691045713277617e-08j)
SINR torch.Size([20]) = tensor([18.7782, 11.4792,  8.6926, 13.1344,  6.1842, 14.0327,  5.9661, 15.7457,
         5.2501, 13.5159,  7.2941, -2.1047,  1.4896, 14.5671,  2.7731,  4.8099,
         8.7977, 13.3742, 13.9563, 15.3677], device='cuda:0')
SINR mean = 9.655203819274902
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2905786633491516
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9869, 0.9336, 0.8810, 0.9537, 0.8060, 0.9620, 0.7980, 0.9741, 0.7701,
        0.9574, 0.8428, 0.3812, 0.5849, 0.9662, 0.6544, 0.7517, 0.8835, 0.9560,
        0.9613, 0.9718], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 14,  67, 111,  49, 166,  40, 171,  28, 190,  45, 140, 428, 304,  36,
        262, 202, 109,  46,  41,  31], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 22-----------
Real SNR = tensor([17.4884, 19.7818, 21.0484, 22.4331, 22.8358, 22.3164, 20.7320, 18.0588,
        21.2881, 21.9278, 23.4395, 16.7418, 19.8172, 21.9120, 23.9316, 19.1543,
        21.4866, 17.5600, 16.6127, 20.4007], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.1834+5.3920e-09j, 1.4354+3.7253e-08j, 2.8843+1.3494e-08j,
        0.8042-1.7103e-07j, 1.2625-7.2238e-08j, 5.0219+1.0736e-08j,
        2.0799-6.0810e-09j, 0.0501+6.0969e-09j, 1.9471-1.0953e-06j,
        1.8578+1.0139e-07j, 6.4001+1.7469e-07j, 1.3251+1.9311e-08j,
        2.6434-1.3055e-08j, 1.1719-7.7454e-09j, 2.8323+1.2147e-07j,
        1.2401+5.1261e-09j, 2.3813-2.9211e-08j, 0.1158-1.4901e-08j,
        0.3329-9.1973e-09j, 1.2664-8.4388e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.8617957830429077-4.623140270609838e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4005+4.6657e-09j, 1.1290-0.0000e+00j, 1.9589+2.9827e-08j,
        0.4241+2.9802e-08j, 0.6451-1.5690e-08j, 6.1597+2.7887e-08j,
        2.2697+5.2034e-08j, 0.1095-2.8232e-09j, 1.5077-9.0070e-08j,
        1.2996+3.7854e-08j, 7.0764+7.2705e-09j, 0.8435+1.3778e-08j,
        2.1729+7.1318e-10j, 1.4245-1.8233e-08j, 1.1856-1.3035e-07j,
        1.3685+8.2696e-09j, 2.1643-5.7754e-08j, 0.3218+7.4506e-09j,
        0.0469+2.3050e-10j, 1.3997-1.8467e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6953938007354736-5.680223846837862e-09j)
SINR torch.Size([20]) = tensor([ 7.3175,  9.4445, 11.9825,  6.8316,  5.9932, 15.7371, 13.9754,  0.1352,
         9.7272, 11.0344, 14.9712, 13.3132, 16.0167,  8.7447, 10.8867, 10.9711,
        13.8854,  2.0915,  6.8278, 13.1455], device='cuda:0')
SINR mean = 10.151610374450684
E[H^H] = 1e-07
E_MSE (Error Power) = 0.21557417511940002
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8436, 0.8980, 0.9404, 0.8282, 0.7990, 0.9740, 0.9615, 0.5078, 0.9038,
        0.9270, 0.9691, 0.9554, 0.9756, 0.8822, 0.9246, 0.9260, 0.9607, 0.6181,
        0.8281, 0.9538], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([139,  97,  61, 150, 171,  28,  41, 350,  93,  73,  33,  47,  27, 110,
         75,  74,  42, 284, 150,  48], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 23-----------
Real SNR = tensor([21.3910, 18.2985, 23.7553, 26.6574, 24.0725, 18.6399, 17.4675, 25.0165,
        20.3257, 22.1651, 20.6679, 21.3008, 21.4336, 21.7822, 20.9054, 22.5566,
        23.4558, 18.9251, 19.4223, 17.6559], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.5003+9.4851e-09j,  0.8958+1.0609e-08j,  1.6557-2.6983e-07j,
         8.6623+2.6538e-07j,  0.0559-7.6774e-08j,  0.7059+1.4856e-08j,
         0.3370-5.9697e-09j,  0.0465-4.7848e-08j,  0.4003+8.2332e-09j,
        12.7405-8.5356e-08j,  0.5397-5.1593e-08j,  0.0480-2.2352e-08j,
         3.6287+9.3132e-08j,  2.0052+1.1921e-07j,  0.4143+1.4901e-08j,
         0.5387+1.3708e-08j,  0.4933-5.2748e-08j,  0.7992-0.0000e+00j,
         2.0580-1.0935e-08j,  0.5738-6.9414e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.904971718788147-4.041815770960966e-09j)
torch.linalg.det(H.mH@H) = tensor([1.8616-1.2710e-08j, 0.8535+3.5004e-09j, 1.2991-2.6403e-07j,
        7.7442-1.7726e-07j, 0.3710+9.9382e-09j, 0.9150-9.1559e-09j,
        0.1965+1.4521e-09j, 0.1307+2.1550e-08j, 0.5154-2.4596e-09j,
        9.0314+7.5420e-08j, 0.4886-2.2656e-08j, 0.1713+1.2666e-07j,
        3.9738+1.1921e-07j, 2.2251-1.3313e-08j, 0.3679+2.8312e-07j,
        0.9838+2.5209e-09j, 1.1152+4.6479e-08j, 0.9175-0.0000e+00j,
        1.9411+2.0860e-09j, 0.3538-9.2115e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7728248834609985+9.471160744567442e-09j)
SINR torch.Size([20]) = tensor([15.1861, 10.7254, 12.2863, 15.9860, -0.8900, 13.6962, 12.5970, -5.5822,
        11.3811, 14.6405,  8.2536,  0.0431, 16.4145, 10.4649,  5.2265, 10.3724,
         2.3192, 12.4700, 14.3862, 10.7263], device='cuda:0')
SINR mean = 9.535143852233887
E[H^H] = 1e-07
E_MSE (Error Power) = 0.4261760711669922
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9706, 0.9220, 0.9442, 0.9754, 0.4489, 0.9591, 0.9479, 0.2166, 0.9322,
        0.9668, 0.8699, 0.5025, 0.9777, 0.9176, 0.7691, 0.9159, 0.6304, 0.9464,
        0.9649, 0.9220], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 32,  77,  57,  27, 385,  43,  54, 548,  68,  36, 120, 353,  24,  81,
        190,  83, 277,  55,  38,  77], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 24-----------
Real SNR = tensor([23.3982, 21.7237, 27.1333, 26.3621, 23.0886, 24.7858, 25.2979, 19.6229,
        18.2141, 25.9733, 18.4464, 18.0918, 22.4068, 21.4794, 26.2291, 24.3966,
        26.2097, 16.6035, 27.0210, 17.4482], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.4011-1.6530e-08j,  2.5908+2.8947e-07j, 16.9250-8.9705e-08j,
         0.8662+6.4153e-08j,  3.9115+7.7448e-08j,  5.6599+4.1114e-08j,
         0.3769-4.2846e-09j,  0.3944+3.6312e-09j,  0.0627-1.5832e-08j,
         6.6088-5.1186e-08j,  0.0838+5.9731e-10j,  1.0234-6.3517e-09j,
         0.2081+4.0354e-08j,  0.9296+1.3214e-08j, 10.2766-2.1575e-07j,
         0.8229+2.9802e-08j,  0.0343-4.1059e-08j,  0.3501+1.6506e-09j,
         2.2067-5.9605e-08j,  0.0550+3.6389e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.789398193359375+3.0748823487414256e-09j)
torch.linalg.det(H.mH@H) = tensor([ 2.5246+2.1479e-08j,  2.1086-5.2572e-08j, 15.1186+1.3909e-07j,
         1.3707-3.1796e-07j,  3.2032+6.6935e-09j,  6.0766-2.0246e-08j,
         0.3462-5.8907e-09j,  0.4150-3.8237e-09j,  0.1290-9.3132e-09j,
         8.6560-8.0112e-08j,  0.0796+4.3894e-10j,  0.4964+2.9802e-08j,
         0.1085-3.1503e-08j,  0.6940+8.1367e-10j,  9.8091-7.2953e-08j,
         0.7973-1.4901e-08j,  0.0478-6.1424e-09j,  0.2668-4.5906e-09j,
         2.4309-3.2783e-07j,  0.0156+1.2275e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7347252368927-3.7414519482581454e-08j)
SINR torch.Size([20]) = tensor([19.1273, 12.3001, 20.3480,  9.1669, 16.5686, 16.8882,  5.5167,  8.4086,
         3.0280, 18.1798,  8.3410, 12.4611,  9.3073, 13.2550, 20.4096, 13.0471,
        -2.2741, 11.5944, 11.9860,  6.5185], device='cuda:0')
SINR mean = 11.708907127380371
E[H^H] = 1e-07
E_MSE (Error Power) = 0.1826297491788864
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9879, 0.9444, 0.9909, 0.8919, 0.9784, 0.9799, 0.7808, 0.8739, 0.6676,
        0.9850, 0.8722, 0.9463, 0.8950, 0.9549, 0.9910, 0.9528, 0.3720, 0.9352,
        0.9405, 0.8177], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 13,  57,  10, 102,  24,  22, 183, 116, 254,  16, 118,  55, 100,  47,
         10,  49, 434,  66,  61, 158], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 25-----------
Real SNR = tensor([22.4544, 25.3245, 21.2342, 20.4283, 24.3601, 20.7283, 24.9629, 21.6677,
        22.1074, 28.3759, 21.6363, 27.1980, 23.8139, 18.3011, 20.3244, 24.3837,
        23.3877, 24.8908, 22.1695, 26.8703], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.1076-3.7253e-09j,  2.0019-5.9605e-08j,  0.0389-1.9558e-08j,
         0.1687+2.2352e-08j,  3.6976-7.4736e-08j,  0.0967-2.8205e-08j,
         0.9003-1.7616e-08j,  0.8490-1.0924e-08j,  0.3620-1.0514e-08j,
         8.8643+6.8751e-07j,  0.3892-7.4506e-09j, 10.4502+4.5010e-07j,
         5.6056+6.1769e-09j,  0.0385-2.7940e-09j,  0.4046+1.5824e-09j,
         4.2631+1.6824e-07j,  1.0849-2.9802e-08j,  1.0826+5.9605e-08j,
         1.8486+7.5636e-09j,  3.2549+6.7274e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(2.275458574295044+6.027362786653612e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1060-1.8626e-08j, 2.3737+1.1921e-07j, 0.0697+5.5879e-09j,
        0.1750-5.9605e-08j, 3.0291-6.6802e-08j, 0.1385-4.7337e-09j,
        0.4413-2.5320e-09j, 0.8798+1.3115e-08j, 0.2923-2.5385e-08j,
        8.0083+1.5666e-07j, 0.2229-7.4506e-09j, 9.5024-3.2433e-08j,
        4.3786+6.3718e-08j, 0.0828-1.4901e-08j, 0.3298+4.0465e-10j,
        3.9547-7.8709e-08j, 1.2470+2.9802e-08j, 1.2791-2.3842e-07j,
        2.0589+5.8057e-08j, 2.3645+3.1756e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0467262268066406-3.5640401740977268e-09j)
SINR torch.Size([20]) = tensor([ 9.7435, 16.2627,  3.0903,  6.9470, 18.6982,  7.5019, 10.6314, 13.4080,
        11.5492, 18.9626, 10.1084, 16.9086, 20.1103,  7.1928, 14.3047, 21.1055,
        11.6534, 15.1742, 18.7615, 17.1917], device='cuda:0')
SINR mean = 13.465296745300293
E[H^H] = 1e-07
E_MSE (Error Power) = 0.0910198912024498
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9041, 0.9769, 0.6707, 0.8320, 0.9867, 0.8491, 0.9204, 0.9564, 0.9346,
        0.9875, 0.9111, 0.9800, 0.9903, 0.8397, 0.9642, 0.9923, 0.9360, 0.9705,
        0.9869, 0.9813], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 92,  25, 252, 148,  15, 135,  79,  46,  66,  14,  87,  22,  11, 142,
         38,   8,  65,  32,  14,  21], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 26-----------
Real SNR = tensor([26.7354, 26.3926, 23.1570, 19.4726, 23.0997, 22.9264, 24.4969, 21.5840,
        25.5884, 23.1917, 23.9431, 20.7081, 24.8691, 24.4428, 24.8618, 21.5262,
        27.1737, 25.7623, 22.0256, 24.3487], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.7722+2.9802e-08j, 3.4001+4.5622e-08j, 0.3001+7.4506e-09j,
        0.2232+4.6566e-09j, 0.6795-1.7287e-08j, 0.6796-0.0000e+00j,
        0.2010+1.4901e-08j, 0.4194+4.4703e-08j, 2.5560+1.6586e-08j,
        0.4235-4.4703e-08j, 0.2158+6.7055e-08j, 0.6771+1.7605e-09j,
        0.6134+3.3528e-08j, 2.0823+2.4899e-08j, 0.7669+7.0940e-08j,
        0.0875+7.7086e-08j, 4.8805-0.0000e+00j, 4.0165+3.2368e-09j,
        1.1103+5.2719e-11j, 1.3684-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.3736568689346313+1.9014501972947073e-08j)
torch.linalg.det(H.mH@H) = tensor([2.4939-6.1255e-08j, 2.8929+1.2135e-08j, 0.0887-1.8626e-08j,
        0.3384-7.4506e-09j, 0.8283+1.5029e-08j, 0.5874-1.2107e-08j,
        0.2893-2.2352e-08j, 0.2987+7.5450e-08j, 1.8996-4.2181e-08j,
        0.6490-2.6822e-07j, 0.2737-2.5332e-07j, 0.8678-1.2139e-08j,
        0.3305-1.2924e-08j, 2.1262-9.3000e-08j, 1.2855+1.0290e-07j,
        0.0270+4.4915e-08j, 4.5562-0.0000e+00j, 3.3909-1.6650e-08j,
        1.1859-9.6505e-09j, 1.6847-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3047324419021606-3.195284747903315e-08j)
SINR torch.Size([20]) = tensor([17.5621, 19.1270,  5.5391,  9.0562, 14.6426, 10.9907,  9.0600,  7.6167,
        18.7164,  8.1983,  8.3702, 14.3061, 12.2214, 15.4737, 10.2989,  1.9599,
        15.8895, 20.5596, 20.7004, 13.8451], device='cuda:0')
SINR mean = 12.706697463989258
E[H^H] = 1e-07
E_MSE (Error Power) = 0.10567324608564377
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9828, 0.9879, 0.7817, 0.8895, 0.9668, 0.9263, 0.8895, 0.8524, 0.9867,
        0.8685, 0.8730, 0.9642, 0.9434, 0.9724, 0.9146, 0.6109, 0.9749, 0.9913,
        0.9916, 0.9604], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 19,  13, 182, 104,  36,  74, 104, 133,  15, 121, 117,  38,  58,  30,
         84, 288,  27,  10,   9,  42], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 27-----------
Real SNR = tensor([26.9585, 28.9295, 26.5145, 25.2901, 23.1619, 23.7964, 22.7163, 25.4441,
        26.9003, 25.0675, 25.6684, 19.9983, 19.5182, 24.9633, 24.5931, 26.9389,
        24.9923, 23.8755, 29.5250, 24.7846], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.9103+5.1519e-09j, 1.5521-5.9605e-08j, 0.6850-5.7711e-09j,
        2.5309+1.1723e-08j, 0.6764+7.3289e-10j, 0.2739-1.5647e-09j,
        0.1588-3.7253e-08j, 2.3090-2.3100e-08j, 2.9701-7.5603e-08j,
        0.7724+4.4703e-08j, 0.4539-5.5883e-09j, 0.2695+3.4493e-09j,
        0.1896+1.9349e-09j, 1.1197-1.4901e-08j, 1.6727-8.2961e-09j,
        1.7281-7.9363e-08j, 1.4858+3.9150e-08j, 1.3847-1.1036e-08j,
        1.2636-1.5699e-08j, 0.5682+2.7056e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.348738431930542-1.0193939026237331e-08j)
torch.linalg.det(H.mH@H) = tensor([3.9615+1.1015e-07j, 1.6038-5.9605e-08j, 0.7882-1.2221e-08j,
        2.2008-4.6488e-08j, 0.7667-2.6333e-08j, 0.2395-4.4318e-09j,
        0.1565+3.7253e-08j, 2.2393-4.6855e-09j, 3.0457+5.5295e-08j,
        0.9512+8.9407e-08j, 0.6010-3.5984e-08j, 0.1791-6.8828e-10j,
        0.3103-7.5862e-10j, 1.1526+1.4901e-08j, 1.4228+5.3062e-08j,
        0.9983-4.0978e-08j, 1.5894+4.6930e-09j, 1.3273-5.2956e-09j,
        1.3597-3.1487e-08j, 0.7423+2.9673e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2818037271499634+6.273921382415892e-09j)
SINR torch.Size([20]) = tensor([19.0963, 16.7135, 13.8197, 16.9375, 16.9483, 14.0979, 12.8239, 22.1316,
        19.6553, 11.1019, 12.9401, 15.1770, 11.4784, 13.5598, 12.2208, 11.2992,
        14.6750, 19.8673, 16.9567, 14.6648], device='cuda:0')
SINR mean = 15.308252334594727
E[H^H] = 1e-07
E_MSE (Error Power) = 0.041322920471429825
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9878, 0.9791, 0.9602, 0.9802, 0.9802, 0.9625, 0.9504, 0.9939, 0.9893,
        0.9280, 0.9516, 0.9705, 0.9336, 0.9578, 0.9434, 0.9310, 0.9670, 0.9898,
        0.9802, 0.9670], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([13, 23, 42, 22, 22, 40, 52,  7, 12, 72, 50, 32, 67, 45, 58, 69, 35, 11,
        22, 35], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 28-----------
Real SNR = tensor([30.6062, 22.5636, 26.8287, 28.5495, 27.1242, 26.9684, 28.9163, 29.9683,
        26.8488, 28.6661, 25.7180, 27.4268, 20.1086, 28.5392, 28.8516, 27.2776,
        28.2139, 23.8392, 24.7109, 28.1904], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([9.2354+2.1973e-07j, 0.0929-1.5362e-09j, 1.4412+1.7580e-08j,
        2.8319-5.9605e-08j, 3.5114-0.0000e+00j, 0.4277+6.2187e-08j,
        1.8678-0.0000e+00j, 9.6903+4.7684e-07j, 5.2410+2.6176e-08j,
        3.6625+2.0362e-08j, 0.8981-3.0119e-08j, 3.9780+1.5690e-08j,
        0.4953+7.4506e-09j, 2.5847-7.4918e-08j, 0.6817+5.9605e-08j,
        6.2674+5.6383e-08j, 3.5215+1.7587e-08j, 0.3640+6.0370e-09j,
        0.6843-1.1151e-08j, 4.8932+3.0997e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.118516445159912+4.1964693053841984e-08j)
torch.linalg.det(H.mH@H) = tensor([9.4890+4.0554e-07j, 0.1020-9.2712e-10j, 1.2670+1.4820e-08j,
        3.0858-5.9605e-08j, 3.3982+2.3842e-07j, 0.6045+6.0465e-08j,
        1.7080+1.1921e-07j, 9.0709-2.3842e-07j, 4.6566-7.5847e-08j,
        3.3460-1.7161e-07j, 0.6888-8.1933e-10j, 4.1216-6.1640e-08j,
        0.3087-3.1432e-09j, 2.4667-9.7123e-09j, 0.5152+2.3842e-07j,
        5.5445-2.7371e-08j, 3.7767-1.1107e-07j, 0.4476+3.0886e-11j,
        0.7869+1.5652e-08j, 3.8494-5.2297e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9616992473602295+1.4004771564657403e-08j)
SINR torch.Size([20]) = tensor([25.5289, 13.4096, 19.8668, 21.2585, 22.2536,  8.0378, 12.1140, 19.8284,
        18.1529, 21.4925, 17.7022, 19.7363, 14.8462, 24.3592, 12.9561, 24.3501,
        20.9087, 14.5155, 16.2366, 18.4312], device='cuda:0')
SINR mean = 18.299251556396484
E[H^H] = 1e-07
E_MSE (Error Power) = 0.03152059391140938
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.9972, 0.9564, 0.9898, 0.9926, 0.9941, 0.8642, 0.9421, 0.9897, 0.9849,
        0.9930, 0.9833, 0.9895, 0.9683, 0.9963, 0.9518, 0.9963, 0.9920, 0.9659,
        0.9768, 0.9859], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([  3,  46,  11,   8,   6, 124,  59,  11,  17,   8,  18,  12,  34,   4,
         50,   4,   9,  37,  25,  16], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 29-----------
Real SNR = tensor([32.4976, 30.1639, 27.4917, 29.6162, 27.3764, 26.1521, 27.1690, 29.2381,
        28.2535, 28.4393, 26.0726, 25.8497, 29.1661, 27.0200, 24.8041, 25.3379,
        24.4455, 27.9711, 26.8913, 27.1650], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([0.0204-7.0102e-08j, 0.5292+5.0961e-10j, 1.2465+6.7055e-08j,
        3.4607+8.2868e-08j, 2.3333+8.5151e-08j, 0.4996-6.2797e-09j,
        1.6331-1.2614e-08j, 3.2770+2.8574e-08j, 1.4505-1.1921e-07j,
        0.0341+8.9407e-08j, 1.1508+1.2544e-08j, 1.2406-4.8094e-09j,
        0.2449-3.3528e-08j, 0.5762-5.8015e-09j, 1.5925-2.3842e-07j,
        0.0654-1.1176e-08j, 0.3919+1.2588e-09j, 0.1708-8.1956e-08j,
        1.2993+4.4086e-09j, 0.0443+3.9116e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(1.0630565881729126-8.650142824251361e-09j)
torch.linalg.det(H.mH@H) = tensor([0.0870+3.4513e-08j, 0.4691+8.2227e-08j, 1.1843-8.9407e-08j,
        3.0817+1.0190e-07j, 2.0496+1.7022e-07j, 0.5842+7.6376e-09j,
        1.5134+2.5950e-08j, 3.5977-3.9887e-08j, 1.5210+5.9605e-07j,
        0.0318-1.1176e-07j, 1.2069-4.0023e-09j, 1.2866+2.4172e-08j,
        0.2109-5.7742e-08j, 0.5688-1.2577e-08j, 1.4059+5.9605e-08j,
        0.1133-3.7253e-08j, 0.3685+4.7418e-09j, 0.1330-1.0803e-07j,
        1.0374+1.4362e-08j, 0.0445-1.3039e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0247691869735718+3.238364598701082e-08j)
SINR torch.Size([20]) = tensor([-3.8939, 13.9747, 17.3627, 18.9471, 17.4963, 16.5693, 16.4923, 24.0731,
        21.7321,  0.6203, 21.0477, 19.1804,  9.1673, 16.7450, 17.1863,  6.3142,
        17.2556,  6.4683, 20.6978,  7.8540], device='cuda:0')
SINR mean = 14.264540672302246
E[H^H] = 1e-07
E_MSE (Error Power) = 0.2815292477607727
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2897, 0.9615, 0.9820, 0.9874, 0.9825, 0.9784, 0.9781, 0.9961, 0.9933,
        0.5356, 0.9922, 0.9881, 0.8920, 0.9793, 0.9812, 0.8106, 0.9815, 0.8160,
        0.9916, 0.8592], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([491,  41,  20,  14,  19,  24,  24,   4,   7, 333,   9,  13, 102,  23,
         21, 163,  20, 159,   9, 128], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)

全 100 枚の画像の処理が完了しました。
Your samples are ready and waiting four you here: 
outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic 
Enjoy.
