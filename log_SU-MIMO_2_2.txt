Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6331, 0.7854, 0.6502, 0.7924, 0.5607, 0.5562, 1.0437, 0.4510, 0.6230,
        0.6187, 0.5298, 0.5912, 0.5910, 0.6297, 0.6507, 0.9634, 0.4686, 0.9956,
        0.5815, 0.6080], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -6.7687,  -1.8185,  -5.5981,  -3.0655,  -6.1973,  -8.5055,  -5.5858,
        -13.7154,  -6.4890,  -5.9268, -10.0110,  -5.6203,  -3.6978,  -5.1573,
         -5.7579,  -9.5897,  -5.9659,  -7.6043,  -4.9876,  -2.0120],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([461.4606-1.3003e-05j, 960.8683+3.2991e-06j, 315.7179-3.0428e-06j,
        433.3040+1.5245e-07j, 575.0622-4.9363e-07j,  10.0656-1.9125e-07j,
         12.3383-2.8610e-06j,  22.7386-1.9073e-06j, 317.6746-1.5259e-05j,
        213.0297-5.3406e-05j, 131.3902-1.4055e-05j, 518.0030+5.9121e-06j,
        164.3488+3.8147e-06j, 219.7243-1.4797e-05j,  85.0061-3.1480e-06j,
         53.0437+8.5854e-06j, 104.8416-2.2888e-05j, 255.9503+3.4093e-06j,
        693.1107-6.1035e-05j, 224.7473-3.4695e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(288.6213073730469-9.219158528139815e-06j)
torch.linalg.det(H.mH@H) = tensor([0.2986+2.8719e-08j, 7.3832+1.8443e-07j, 1.5062-1.5703e-08j,
        0.1252-2.0217e-09j, 1.0074+2.2196e-08j, 0.8670+5.9605e-08j,
        0.3579+3.0654e-08j, 0.0977-1.8185e-09j, 0.5044-5.1320e-08j,
        3.2771-5.8338e-09j, 0.2778+2.2352e-08j, 2.9749-2.1542e-08j,
        6.4992+5.1067e-08j, 3.2562+4.3534e-08j, 1.9916-3.9498e-08j,
        0.6843-7.4506e-09j, 0.2527+3.0899e-08j, 0.1452+1.4156e-07j,
        0.5836+1.1433e-08j, 0.0406-2.5239e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6065315008163452+1.1443524350340795e-08j)
SINR torch.Size([20]) = tensor([ -1.5454,  -1.0408,  -1.4427,  -0.9323,  -1.8604,  -6.6701, -10.9273,
         -8.1178,  -1.7737,  -4.6781,  -4.4364,  -0.4416,  -3.6327,  -2.1953,
         -3.1152,  -6.3931,  -5.1016,  -1.3209,   0.8155,  -2.9118],
       device='cuda:0')
SINR mean = -3.3860816955566406
E[H^H] = 1e-07
E_MSE (Error Power) = 2.7427525520324707
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4120, 0.4404, 0.4177, 0.4465, 0.3945, 0.1771, 0.0747, 0.1336, 0.3993,
        0.2540, 0.2647, 0.4746, 0.3023, 0.3763, 0.3280, 0.1866, 0.2360, 0.4245,
        0.5468, 0.3384], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([408, 391, 405, 387, 419, 584, 714, 630, 416, 518, 509, 370, 482, 431,
        463, 575, 532, 400, 326, 456], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = -4-----------
Real SNR = tensor([ -4.2337,  -1.9662,  -4.6876,  -1.5022,  -4.9090,  -5.0331, -10.0267,
         -4.6413,  -3.6926,  -7.8584,  -4.3045,  -3.3462,  -4.2751,  -2.0534,
         -3.3269,  -6.3335,  -7.8177,  -5.1085,  -7.5468,  -3.0157],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  41.4830+1.9227e-06j,  295.0178+4.4760e-06j,  364.0733-2.8673e-05j,
          94.0775-3.1603e-06j, 1626.5957-1.4901e-05j,   60.1737-6.3570e-07j,
         125.3022-1.4116e-07j,   19.0945-1.2014e-06j,   58.6915+1.6797e-06j,
         238.6736+2.9307e-06j,  225.0219-7.6331e-07j,   66.7443-1.3351e-05j,
          47.2047+9.5367e-06j,  225.8450-7.3311e-07j,  562.0448-5.0868e-06j,
        1515.3389-4.5500e-06j,  474.6038+2.9432e-06j,  252.7966-7.6294e-06j,
        1004.1985+1.2275e-05j,  153.4232+4.4189e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(372.5202331542969-2.0321808733569924e-06j)
torch.linalg.det(H.mH@H) = tensor([ 4.3600+1.3771e-07j,  2.9888-1.1921e-06j,  0.0514+1.7881e-07j,
         2.2846-8.0493e-08j,  1.3175+3.3528e-08j,  2.1528+1.0416e-09j,
         0.6121-2.9802e-08j,  4.0576-1.8959e-08j,  0.2706-3.2786e-09j,
         0.3233+1.7102e-10j,  0.4261+4.4703e-08j,  1.1915-3.3692e-07j,
         2.3471+1.0995e-07j, 10.4351-4.2161e-09j,  4.7373+1.9061e-08j,
         2.5985-3.0381e-08j,  0.9919+1.6350e-08j,  1.2213-7.5434e-09j,
         0.0958-6.0972e-10j,  5.9284-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4195897579193115-6.410863306882675e-08j)
SINR torch.Size([20]) = tensor([-4.0115e+00,  1.7136e-04, -6.9160e-01, -3.7228e+00, -2.6729e-02,
        -4.7093e+00, -1.4658e+00, -8.7216e+00, -3.6491e+00, -3.1137e+00,
        -3.5255e+00, -4.5169e+00, -7.0264e+00,  1.3518e+00,  1.0465e+00,
         8.1357e-01, -2.8816e-01, -3.6267e+00,  4.3403e-01, -2.7104e+00],
       device='cuda:0')
SINR mean = -2.4080026149749756
E[H^H] = 1e-07
E_MSE (Error Power) = 2.197192668914795
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2842, 0.5000, 0.4603, 0.2979, 0.4985, 0.2527, 0.4164, 0.1183, 0.3015,
        0.3281, 0.3075, 0.2611, 0.1655, 0.5772, 0.5600, 0.5467, 0.4834, 0.3026,
        0.5250, 0.3488], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([495, 354, 378, 485, 355, 519, 406, 649, 482, 463, 478, 512, 596, 308,
        319, 327, 364, 481, 339, 449], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = -3-----------
Real SNR = tensor([-11.6928,  -6.4499,  -4.2420,  -4.9027,  -1.5128,  -2.4937,  -0.4966,
         -0.8050,  -1.7635,  -4.5297,  -1.3945,  -4.2438,  -5.1186,  -3.4136,
         -2.6823,  -1.7807,  -4.7225,   3.7055, -12.5323,  -6.3110],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  16.6125+2.5788e-06j,   64.0406+9.3743e-08j,  253.5594+1.6116e-05j,
           6.5260-2.6226e-06j,   58.2459-0.0000e+00j,   41.8534+5.2700e-06j,
           4.5609-8.0403e-07j,  187.9221+2.3055e-06j,   18.1188+2.6937e-07j,
          21.9399-8.5831e-06j,  131.4655+3.8147e-06j,   49.6961+3.9483e-07j,
         582.7788+9.5576e-06j,  229.2065+1.5329e-05j,   29.2460-3.2848e-06j,
          28.8217+1.0587e-07j,  574.4984-0.0000e+00j,  542.5318-1.9247e-05j,
         122.3395+8.4837e-08j, 1128.9381-5.0226e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(204.6450958251953+1.0664331284715445e-06j)
torch.linalg.det(H.mH@H) = tensor([2.1541e-02+4.6566e-09j, 3.3116e-01+4.4703e-08j, 4.6012e-01-1.4901e-08j,
        3.5917e-01-1.0431e-07j, 1.2037e+00-1.9219e-08j, 1.2584e+00+2.6729e-08j,
        3.1028e+00-2.4043e-07j, 3.3712e-01+6.0484e-07j, 4.1576e+00+2.3842e-07j,
        1.7648e+00-8.5125e-09j, 8.1975e+00-1.1378e-07j, 7.7994e-01+1.7499e-08j,
        9.9274e-01-3.1979e-08j, 9.9699e-01-2.9802e-08j, 1.5317e+00+3.0014e-08j,
        7.6805e+00+2.1772e-08j, 2.6337e+00+1.0994e-08j, 1.2311e+01+2.3498e-07j,
        3.9775e-03-1.0477e-09j, 1.1891e-01-1.1231e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4121549129486084+3.297020612080814e-08j)
SINR torch.Size([20]) = tensor([ -4.6989,  -1.7320,  -1.7189, -11.0264,  -3.1444,  -5.9001, -13.9253,
         -2.9736,  -5.3105,  -5.4618,  -0.9149,  -4.6732,  -0.5466,  -1.4751,
         -4.7789,  -4.3886,  -1.6638,   4.2548,  -2.0796,  -0.3595],
       device='cuda:0')
SINR mean = -3.6258583068847656
E[H^H] = 1e-07
E_MSE (Error Power) = 3.7463042736053467
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2531, 0.4016, 0.4023, 0.0732, 0.3265, 0.2045, 0.0389, 0.3352, 0.2274,
        0.2214, 0.4475, 0.2543, 0.4686, 0.4159, 0.2497, 0.2669, 0.4054, 0.7271,
        0.3825, 0.4793], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([518, 415, 414, 717, 464, 559, 794, 459, 539, 544, 386, 517, 373, 406,
        521, 508, 413, 218, 427, 367], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = -2-----------
Real SNR = tensor([-4.6162, -7.1189, -5.0235, -3.3908, -5.1756, -3.6493, -1.5888, -6.1894,
        -5.5263,  0.2531, -2.7524, -1.0989, -3.5006, -7.3140, -1.1565, -4.5869,
        -1.0600, -4.3489, -1.1459, -1.3170], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  1.5882+9.6858e-08j,  45.6738-1.3351e-05j,  50.7251+7.6848e-06j,
          0.5620+5.9605e-07j, 111.2800-0.0000e+00j,  33.8925-2.6226e-06j,
         69.7033-2.4161e-07j,  44.3576-7.6294e-06j, 218.1531+3.0299e-06j,
         28.4013-2.1101e-08j,  67.3497+1.5469e-06j, 151.2202-1.5259e-05j,
          5.0523-1.6809e-05j, 138.6786-7.6294e-06j,  54.4449-2.4783e-07j,
         29.2276+7.1526e-07j,  16.0567+6.4347e-08j,  62.3767+6.5494e-07j,
        302.3371+2.1822e-06j,  78.3736-2.2273e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(75.47270965576172-2.3731086002953816e-06j)
torch.linalg.det(H.mH@H) = tensor([ 1.5163+1.2719e-08j,  0.4885-1.4901e-08j,  1.2019-1.2771e-08j,
         0.3996-1.7623e-08j,  0.3641-1.6024e-08j,  0.6831+3.6625e-08j,
         0.8893-4.5379e-08j,  0.5496+2.8948e-10j,  0.2942+2.5005e-09j,
         0.8616-2.9478e-08j,  1.4555-3.8377e-08j,  2.9477+2.8076e-08j,
         0.7555+1.9746e-08j,  0.0278+1.4409e-08j, 13.7759-1.5741e-07j,
         1.5176-3.4269e-08j,  8.5722+2.9666e-08j,  0.1211-4.0978e-08j,
         6.0300-1.6199e-08j,  2.2051-1.3015e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.232823133468628-2.0476091933119278e-08j)
SINR torch.Size([20]) = tensor([-14.6467,  -4.0791,  -3.8641, -14.9334,  -2.3778,  -7.3538,   0.7884,
         -5.1370,  -0.4970,  -5.0716,  -2.4006,  -1.0077, -13.7824,  -2.2670,
         -2.7602,  -4.4905,  -3.8444,  -1.2538,   0.5227,  -4.0163],
       device='cuda:0')
SINR mean = -4.623616695404053
E[H^H] = 1e-07
E_MSE (Error Power) = 6.193262100219727
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0332, 0.2811, 0.2912, 0.0311, 0.3664, 0.1553, 0.5453, 0.2345, 0.4714,
        0.2373, 0.3652, 0.4423, 0.0402, 0.3724, 0.3462, 0.2623, 0.2921, 0.4283,
        0.5301, 0.2840], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([812, 497, 490, 819, 438, 606, 327, 533, 372, 531, 438, 389, 791, 434,
        451, 511, 489, 398, 336, 495], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = -1-----------
Real SNR = tensor([-1.6739, -0.8256,  0.9205, -3.2201,  1.5635, -6.4554, -5.9254, -1.1185,
        -2.4609, -3.9792, -2.5393,  1.9809, -1.4100, -5.0919, -2.3501, -2.8813,
         0.3388, -6.2432, -2.9565, -0.6115], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  8.4441-1.1921e-07j,  58.9059+1.9073e-06j,  20.7142+1.9135e-08j,
         33.0698-5.7671e-07j,  83.5366+1.1444e-05j,   0.5110+1.1176e-07j,
         48.1252-8.1082e-08j, 116.0343-9.9650e-08j,  18.8001-6.6612e-07j,
         11.6885+2.3402e-07j,  35.1655-0.0000e+00j,   3.4275+3.0888e-09j,
         19.6317+9.5367e-07j,  18.3071+1.1921e-06j,  14.6528-0.0000e+00j,
         79.8021-1.9073e-06j,  36.7156+1.1444e-05j,  60.3157-8.8427e-06j,
          4.2778+8.6839e-08j, 153.3239+1.0722e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(41.2724723815918+8.087794753919297e-07j)
torch.linalg.det(H.mH@H) = tensor([1.0677+1.4901e-07j, 2.4961+1.7905e-08j, 5.4354-2.7807e-08j,
        0.0460+1.4715e-07j, 7.5867+6.3759e-08j, 0.1957-3.1549e-09j,
        0.2546-1.4901e-08j, 4.2119-4.0741e-08j, 0.2396+1.8626e-07j,
        0.3696+3.7253e-09j, 0.7337-2.9802e-08j, 4.7021+2.4454e-08j,
        5.8832+1.0007e-07j, 0.5874-4.2342e-10j, 1.3686-5.9605e-08j,
        1.6416-3.6786e-08j, 1.4324-2.7780e-08j, 0.4835+1.0090e-08j,
        0.0675-2.4129e-08j, 0.8669-4.2163e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9835048913955688+1.9756821956207204e-08j)
SINR torch.Size([20]) = tensor([ -6.0542,  -1.3759,  -3.5072,  -4.1930,  -1.6984, -14.7781,  -1.2245,
         -2.2312,  -4.2723,  -4.9362,  -4.1806, -11.7595,  -6.6891,  -4.0565,
         -3.5881,  -0.5570,  -3.4673,  -1.5290,  -9.4534,  -1.4330],
       device='cuda:0')
SINR mean = -4.549224853515625
E[H^H] = 1e-07
E_MSE (Error Power) = 4.887260913848877
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1988, 0.4215, 0.3084, 0.2758, 0.4035, 0.0322, 0.4300, 0.3743, 0.2722,
        0.2429, 0.2764, 0.0625, 0.1765, 0.2821, 0.3044, 0.4680, 0.3104, 0.4129,
        0.1019, 0.4183], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([564, 402, 477, 501, 414, 816, 397, 432, 504, 526, 500, 737, 585, 496,
        480, 374, 476, 408, 671, 404], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 0-----------
Real SNR = tensor([ 2.3381, -4.1600,  1.0519,  0.5885, -2.5835,  1.9523, -1.1966, -5.0016,
        -0.7826, -2.7018,  0.6426, -3.9939, -1.5237,  0.7840,  2.3333,  2.2067,
        -0.2949, -6.0929, -0.3158, -3.7672], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 50.6544+7.6723e-07j,  27.5576-1.4180e-06j,  58.6302+8.0224e-07j,
         66.2297-1.5006e-06j,  31.0020+3.0436e-07j,   2.3782+1.2842e-09j,
         61.7565-5.2502e-06j,  57.6075+1.5973e-06j,   1.7436-1.2684e-07j,
        154.7917-2.8594e-07j,  75.5625+7.7501e-07j,  56.1467-1.3058e-06j,
         40.5796-1.0805e-06j,  29.3490-1.4305e-06j,  32.3379-2.7013e-07j,
          5.4679+5.4215e-07j,  19.7057+1.0152e-06j,  42.2992-1.2320e-06j,
         58.6854+8.6825e-07j,  20.4058+3.0345e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(44.6445426940918-3.462042741375626e-07j)
torch.linalg.det(H.mH@H) = tensor([ 3.7339-5.1269e-08j,  0.2829-1.6835e-09j,  0.6654-1.4901e-08j,
         3.6109-7.1660e-10j,  0.2723-5.2154e-08j,  4.4459+4.6646e-08j,
         3.5731+2.0607e-08j,  0.0873-0.0000e+00j,  1.2131-3.1632e-08j,
         0.1689+3.7253e-09j,  9.5079+8.8219e-08j,  0.2638-3.8181e-09j,
         2.2414+1.9842e-08j,  2.8953-0.0000e+00j, 11.1748+3.3669e-08j,
         4.8225+8.9704e-08j,  0.7377-6.9359e-08j,  1.3486-5.9605e-08j,
         0.7846-6.7922e-09j,  0.2221+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.6026103496551514+1.2691977469003746e-09j)
SINR torch.Size([20]) = tensor([  0.4249,  -1.3563,  -0.5315,  -2.7861,  -1.0579, -12.4322,   0.3275,
         -3.0959, -11.5414,  -0.0484,  -2.1452,  -2.2824,   0.1892,  -0.7163,
         -2.0517,  -9.5018,  -1.7871,  -2.2292,   0.6474,  -1.5699],
       device='cuda:0')
SINR mean = -2.6772255897521973
E[H^H] = 1e-07
E_MSE (Error Power) = 3.9560348987579346
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5244, 0.4226, 0.4694, 0.3449, 0.4394, 0.0540, 0.5188, 0.3290, 0.0655,
        0.4972, 0.3790, 0.3716, 0.5109, 0.4589, 0.3840, 0.1008, 0.3986, 0.3744,
        0.5372, 0.4106], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([340, 402, 373, 452, 391, 755, 343, 463, 731, 356, 429, 434, 348, 379,
        426, 672, 417, 432, 332, 409], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 1-----------
Real SNR = tensor([ 0.2219,  2.6635,  0.1300, -2.1675,  0.8061,  0.1239, -2.2303,  0.3668,
         1.4101, -3.2291,  2.8466, -3.9113, -1.3746, -4.0804,  1.9899, -0.1934,
         0.4003, -0.9716,  2.4703, -2.3601], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.7732e+00+2.3842e-07j, 5.7867e+01-7.3590e-07j, 1.0712e+02-8.9186e-07j,
        4.7727e+00-4.9304e-07j, 2.9631e+00-1.1068e-06j, 1.2217e+02+4.5598e-07j,
        2.4782e+01-9.5367e-07j, 1.0009e+01-6.6757e-06j, 2.3278e+01+1.0747e-06j,
        1.2771e+01-3.1280e-07j, 2.2936e+01+3.5917e-07j, 2.9111e+01-7.5360e-08j,
        1.9577e+01+7.6653e-08j, 7.0548e+00+1.6503e-07j, 1.1081e+01-2.9687e-07j,
        1.9052e+01-9.6318e-07j, 3.6463e+00+1.0173e-06j, 8.7592e-02-5.5940e-07j,
        6.5673e-01+1.1921e-07j, 1.1424e+00+1.2116e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(24.392187118530273-4.173288914444129e-07j)
torch.linalg.det(H.mH@H) = tensor([2.6053-1.2684e-08j, 7.5772+1.7221e-07j, 4.5061-4.8955e-08j,
        2.1520+3.9100e-09j, 3.1515+4.1656e-08j, 5.3867+1.9104e-08j,
        1.1415-8.5453e-09j, 1.3875+1.7881e-07j, 1.0295-2.7027e-08j,
        0.1724-0.0000e+00j, 3.6909-0.0000e+00j, 0.7790+8.9797e-09j,
        0.1536+2.2665e-08j, 0.5874-6.6856e-09j, 3.8070+6.7747e-09j,
        3.6219-9.0774e-09j, 3.5037-1.1813e-08j, 0.7804-1.2792e-08j,
        3.4918+8.1861e-09j, 1.2705+1.5519e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.539797306060791+1.7011757336149458e-08j)
SINR torch.Size([20]) = tensor([ -2.7158,   1.3483,   2.6446,  -5.8013,  -8.7877,  -0.5154,  -1.4536,
         -5.8468,  -0.1552,  -3.6167,  -2.3999,  -2.2229,  -3.0484,  -1.8072,
         -4.8473,  -1.2852, -10.4943, -22.3056,  -9.9760, -12.1843],
       device='cuda:0')
SINR mean = -4.773532867431641
E[H^H] = 1e-07
E_MSE (Error Power) = 13.340357780456543
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3486, 0.5770, 0.6477, 0.2082, 0.1168, 0.4704, 0.4171, 0.2065, 0.4911,
        0.3031, 0.3653, 0.3748, 0.3314, 0.3974, 0.2467, 0.4266, 0.0819, 0.0058,
        0.0914, 0.0570], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([449, 309, 266, 555, 651, 372, 405, 557, 360, 481, 438, 432, 461, 418,
        523, 399, 701, 980, 686, 749], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 2-----------
Real SNR = tensor([ 0.5236,  0.4912, -2.1416, -2.2699,  3.2929, -1.7415,  1.5701, -1.1081,
        -0.7359,  2.6152,  3.0858,  4.2206,  3.0159, -0.6634,  6.4222, -5.1122,
         2.4515,  1.5053, -2.2107,  3.2498], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 11.8995-2.3128e-09j,   0.9528+2.3842e-07j,  13.4924-3.0636e-07j,
          2.4703+2.3842e-07j,  38.9148+2.5612e-07j,  91.3470+3.8147e-06j,
         35.6921+9.5367e-07j,   5.4211+1.9237e-08j,  29.5498+1.1538e-07j,
          8.7516+3.1288e-08j,  63.7160-4.2688e-07j,  78.5442+5.4326e-07j,
         18.0784-1.0842e-06j,   1.6460-1.5950e-08j,  23.2863+4.6329e-07j,
          1.6122+4.7387e-08j, 192.3960+8.7609e-08j,   9.0424-2.1608e-07j,
         10.3102-2.2800e-07j,  17.5591+2.8901e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(32.73411178588867+2.409027217709081e-07j)
torch.linalg.det(H.mH@H) = tensor([2.6832+2.8911e-08j, 1.4542-1.4331e-08j, 0.4442+1.8626e-08j,
        0.8468-1.1547e-08j, 6.8307-3.7532e-09j, 0.3617-1.4901e-08j,
        0.5618-6.3330e-08j, 0.8244-6.7987e-08j, 0.1413-0.0000e+00j,
        7.4325+9.7920e-08j, 4.6754-2.4277e-07j, 2.0664+1.4824e-07j,
        2.9239-1.3578e-07j, 0.1577-2.2352e-08j, 2.9409-2.8632e-07j,
        0.2160+1.8626e-09j, 4.3994-3.9006e-08j, 0.0564-6.9382e-09j,
        0.4852-2.1567e-09j, 1.2046+2.6822e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0353314876556396-1.736944987840161e-08j)
SINR torch.Size([20]) = tensor([-2.7263, -9.0196, -1.9145, -5.3487,  1.4918, -0.4577, -0.5091, -5.7849,
        -0.5308, -4.4951, -2.8703,  2.0069, -2.7149, -4.2764, -2.0781, -5.1971,
         2.8609,  1.0654, -1.2338, -1.1319], device='cuda:0')
SINR mean = -2.143200397491455
E[H^H] = 1e-07
E_MSE (Error Power) = 2.216327667236328
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3480, 0.1114, 0.3915, 0.2259, 0.5850, 0.4737, 0.4707, 0.2088, 0.4695,
        0.2621, 0.3405, 0.6135, 0.3486, 0.2720, 0.3826, 0.2321, 0.6590, 0.5610,
        0.4295, 0.4352], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([450, 658, 421, 540, 304, 370, 372, 555, 373, 511, 455, 287, 449, 504,
        427, 535, 259, 318, 397, 394], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 3-----------
Real SNR = tensor([ 5.1117,  1.7808,  0.7437,  3.2855,  3.0805,  3.5144,  3.3789,  1.4770,
        -1.9500,  5.0926,  2.1897, -3.5223,  3.3845, -0.9761, -0.8564, -0.5542,
        -0.3451, -1.9666,  3.0434,  2.1933], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 19.5313+1.1598e-07j,   7.8777-1.0492e-06j,  20.5426-2.7191e-07j,
         23.9888-3.5763e-07j,   0.8024-1.3411e-07j,  21.5077-0.0000e+00j,
         19.0968-1.9073e-06j,   6.4954+9.4399e-07j,  66.6373-6.2255e-07j,
          7.5801-2.4848e-11j,   9.4311-7.0279e-08j,   0.4503-3.5724e-07j,
        210.5710+3.1654e-06j,  39.9639-5.5600e-07j,  14.1980-6.7919e-09j,
         10.0359-9.5367e-07j,  11.6583+4.7684e-07j,   1.1860-1.4305e-06j,
          7.4816-2.3842e-07j,  16.7557+9.5367e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(25.789579391479492-1.1498919150199072e-07j)
torch.linalg.det(H.mH@H) = tensor([0.0773+3.6164e-08j, 5.1235+2.3138e-07j, 0.2673-2.2721e-08j,
        1.6129-8.9407e-08j, 1.1753-1.0792e-07j, 0.0956-2.0140e-08j,
        5.0913+2.3842e-07j, 0.6044-6.3345e-08j, 0.5613+1.4248e-08j,
        1.4400+1.1823e-07j, 1.8519+6.7055e-08j, 0.0929-3.5342e-09j,
        3.6241-7.1968e-08j, 0.0654+8.1956e-08j, 0.6496+9.7327e-09j,
        0.7975-0.0000e+00j, 0.1759+1.0770e-09j, 1.2324+3.6342e-09j,
        4.6189+1.4499e-08j, 1.5956+8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5376631021499634+2.6338193848118863e-08j)
SINR torch.Size([20]) = tensor([  1.4720,  -4.2562,  -0.4581,  -0.6234, -11.5375,  -1.5460,  -2.1163,
         -5.9657,   1.1549,  -2.2361,  -2.6765, -10.5614,   1.6199,   0.6049,
          0.2122,  -0.3566,  -0.3338, -11.2794,  -4.9857,   0.4076],
       device='cuda:0')
SINR mean = -2.6730587482452393
E[H^H] = 1e-07
E_MSE (Error Power) = 3.3694984912872314
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5839, 0.2729, 0.4737, 0.4642, 0.0656, 0.4119, 0.3805, 0.2020, 0.5661,
        0.3741, 0.3506, 0.0808, 0.5922, 0.5348, 0.5122, 0.4795, 0.4808, 0.0693,
        0.2409, 0.5234], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([304, 503, 370, 376, 731, 408, 428, 561, 315, 433, 448, 703, 299, 334,
        347, 367, 366, 724, 528, 340], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 4-----------
Real SNR = tensor([ 0.8330,  2.9959,  0.8735,  2.0358,  7.1324,  3.7532,  0.4750,  1.6799,
        -1.2980,  3.1900,  0.7133, -1.3375,  2.6261,  5.8373,  2.2812,  5.8292,
         2.8892,  5.8051,  5.8725, -1.9802], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 9.3080+3.6319e-07j, 55.9971+8.4768e-07j, 11.5297-1.6716e-07j,
        12.5149-4.2461e-07j, 18.8901+9.5367e-07j, 23.2523+1.2177e-07j,
         2.2977-2.3842e-07j,  5.7995+3.3547e-08j,  6.4302+9.0661e-08j,
        52.7474+4.8434e-07j, 15.2079-3.9848e-07j,  1.0744-5.1113e-08j,
        48.8384+4.3729e-07j, 11.3864+5.3942e-07j,  0.7310-5.9605e-08j,
        25.4493-9.1857e-08j,  6.8785-2.3842e-07j,  0.6920-7.4506e-08j,
        11.1751+7.4021e-08j,  8.5689-2.1954e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(16.438430786132812+9.909431497590049e-08j)
torch.linalg.det(H.mH@H) = tensor([0.7503-1.4901e-08j, 0.8839-1.3042e-08j, 0.8749-2.2779e-09j,
        3.7823+2.4119e-08j, 4.9619-9.5367e-07j, 2.1659-3.7367e-08j,
        1.6473+8.3395e-08j, 1.1267-1.4769e-08j, 0.3392-4.0481e-09j,
        1.8982-5.5265e-08j, 1.4375-2.1863e-09j, 0.0825-1.4663e-09j,
        1.1124+4.4703e-08j, 0.1952+6.6324e-08j, 0.5487+7.4506e-09j,
        3.6903-4.7684e-07j, 2.3145+5.4843e-08j, 0.0157+1.1208e-08j,
        3.4937-2.3221e-08j, 0.1982-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5759719610214233-6.609565161852515e-08j)
SINR torch.Size([20]) = tensor([ -0.9242,   3.4463,   2.2136,  -1.5603,  -0.2366,   2.7838,  -9.9208,
         -1.6340,  -3.7021,   3.5013,   0.2161,  -3.4092,   0.7937,  -2.1580,
        -11.3245,   3.8731,  -2.6025,  -7.3033,  -3.3469,  -2.0480],
       device='cuda:0')
SINR mean = -1.6671390533447266
E[H^H] = 1e-07
E_MSE (Error Power) = 2.593348503112793
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4470, 0.6886, 0.6247, 0.4111, 0.4864, 0.6550, 0.0924, 0.4070, 0.2989,
        0.6913, 0.5124, 0.3132, 0.5456, 0.3783, 0.0687, 0.7093, 0.3545, 0.1569,
        0.3163, 0.3842], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([387, 241, 280, 409, 363, 262, 685, 411, 484, 240, 347, 474, 327, 430,
        725, 229, 446, 605, 472, 426], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 5-----------
Real SNR = tensor([ 8.2955, -0.8570,  5.8899,  0.0899,  2.6763,  2.6822,  2.4625,  4.6842,
         6.3219, -5.3945, -0.8532,  9.9510,  4.6688,  5.4896,  0.6474,  2.0738,
         3.7709,  1.6372,  4.2205,  6.1074], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([30.5835+6.6757e-06j,  1.4779+3.7075e-07j,  3.0524-1.0729e-06j,
         7.7063-3.6950e-07j,  6.1696-9.1318e-07j,  4.7961-2.2939e-08j,
        12.4229+1.5699e-08j,  2.7788-3.1086e-08j, 41.8612-2.0227e-06j,
         8.9640-5.4786e-08j,  2.7222-5.7528e-08j,  5.1930-3.0417e-08j,
         6.3813-1.1921e-07j, 51.6624+3.7963e-07j,  0.0964-7.2643e-08j,
        46.3196-1.7380e-08j,  3.9417+4.3329e-08j,  0.1219-7.0311e-09j,
        10.1405-1.4509e-08j, 23.1710-1.9682e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(13.47813606262207+1.2412662897531845e-07j)
torch.linalg.det(H.mH@H) = tensor([1.3644e+00+1.2436e-07j, 3.8969e-01-1.8387e-09j, 5.5298e-01-2.9802e-08j,
        5.5073e-01+4.6035e-09j, 6.4558e-02-3.1336e-08j, 1.5227e+00+4.7502e-08j,
        7.3553e-01-8.3971e-10j, 1.5518e+00-3.6053e-08j, 1.2127e+00+4.0527e-09j,
        8.7603e-03-6.2220e-09j, 1.9258e-01+1.1176e-08j, 2.3550e+01+1.6212e-07j,
        3.4233e+00+6.7055e-08j, 4.6877e+00-1.4267e-07j, 2.2518e-01-3.0058e-09j,
        3.1162e+00-1.3518e-07j, 9.4028e-02-2.3995e-08j, 6.9365e-01-4.0359e-09j,
        1.8671e+00+2.6681e-08j, 1.1081e+00+1.7881e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3455700874328613+1.0569389807812968e-08j)
SINR torch.Size([20]) = tensor([  1.0782,  -6.3776,  -7.2608,  -2.7213,  -3.4461,  -1.5508,   0.0491,
         -3.8169,  -0.2783,  -0.5606,  -1.4736,   0.1074,   0.4316,   3.1359,
        -14.8260,   1.7187,  -1.4225, -14.2506,  -0.3462,   1.1058],
       device='cuda:0')
SINR mean = -2.535231351852417
E[H^H] = 1e-07
E_MSE (Error Power) = 4.6867876052856445
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5617, 0.1872, 0.1582, 0.3483, 0.3114, 0.4117, 0.5028, 0.2934, 0.4840,
        0.4678, 0.4160, 0.5062, 0.5248, 0.6731, 0.0319, 0.5977, 0.4188, 0.0362,
        0.4801, 0.5633], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([318, 575, 603, 450, 475, 409, 353, 488, 364, 374, 406, 351, 340, 251,
        817, 296, 404, 803, 366, 317], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 6-----------
Real SNR = tensor([ 4.3919, -1.7715,  4.6771,  5.6038,  1.5073,  2.5872,  8.9130,  0.3057,
         7.0946,  3.8959,  5.8432,  5.6672,  2.7210,  8.5691,  2.1258,  8.4266,
         7.0768,  1.1017,  1.1096,  2.2922], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([13.2119+2.1101e-07j,  7.2670+2.4788e-08j,  1.7123-2.3842e-07j,
        12.1812-9.7640e-08j,  0.2578-7.4506e-09j,  2.7362+3.1192e-08j,
        22.5037-1.6840e-07j,  2.0782+2.6346e-08j,  2.2406-1.2073e-07j,
         1.8721-1.7184e-07j,  6.4333-3.9858e-07j,  3.1250-2.2190e-07j,
         2.4240+4.2759e-08j, 15.8385-1.1190e-06j,  1.1123-4.8429e-08j,
        27.8886-9.5367e-07j, 37.2317-3.9366e-07j,  6.0305+8.1636e-07j,
         0.9749+2.8771e-08j,  4.9119+1.7118e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.601597785949707-1.2936524740325694e-07j)
torch.linalg.det(H.mH@H) = tensor([8.1278e-01-1.1921e-07j, 5.4189e-02-5.5879e-09j, 7.3125e-01+2.9802e-08j,
        3.1816e+00-6.6849e-09j, 3.2624e-01-3.0163e-09j, 1.6602e-02+4.6566e-10j,
        6.3567e-01-4.3496e-08j, 2.2430e-01-2.1511e-10j, 6.3878e-01+1.7001e-07j,
        1.7277e+00-5.9605e-08j, 1.3032e+00+1.0606e-07j, 1.2944e+00+1.9897e-08j,
        7.3508e-03-1.4150e-09j, 3.7350e+00+2.4652e-07j, 1.8361e+00-1.3467e-08j,
        1.9850e+01+3.3038e-09j, 1.5093e+00+6.0123e-08j, 5.4362e+00-2.4852e-07j,
        1.6745e-01+9.8331e-09j, 2.2840e-01-3.0121e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.185850143432617+7.089694609163644e-09j)
SINR torch.Size([20]) = tensor([ 4.1005,  0.3122, -4.1277, -1.4290, -5.5577, -1.9092,  1.3290, -3.6747,
        -5.7907, -2.8592, -0.0657, -1.4784,  0.2925,  1.5086, -6.1252,  1.3066,
         1.8824, -3.8161, -3.4138, -0.2291], device='cuda:0')
SINR mean = -1.4872421026229858
E[H^H] = 1e-07
E_MSE (Error Power) = 1.9628260135650635
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7199, 0.5180, 0.2788, 0.4185, 0.2176, 0.3918, 0.5759, 0.3002, 0.2086,
        0.3411, 0.4962, 0.4157, 0.5168, 0.5860, 0.1962, 0.5747, 0.6067, 0.2934,
        0.3130, 0.4868], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([222, 344, 499, 404, 547, 421, 309, 483, 555, 455, 357, 406, 344, 303,
        566, 310, 291, 488, 474, 362], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 7-----------
Real SNR = tensor([ 6.7994,  2.0639,  6.9294,  4.8717,  3.9455, 11.4356,  7.0255,  5.6930,
         7.8703,  4.0327,  4.6161,  6.2616,  6.5822,  6.6667,  9.4845,  6.5158,
         6.0179,  2.5774,  2.4817,  6.6507], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.7717e+00+9.4649e-09j, 4.8949e+00+5.8016e-08j, 1.4383e+01-0.0000e+00j,
        4.8506e+00-8.6868e-08j, 1.6957e+01+1.6118e-07j, 7.2376e+00+1.5868e-09j,
        1.7975e+00-1.5143e-08j, 4.0758e+00-1.4996e-07j, 1.9299e+01+7.3630e-07j,
        1.6455e+00+1.9805e-07j, 1.2572e+00-1.2440e-09j, 2.2038e+00-5.9605e-08j,
        3.4080e-01+8.3540e-09j, 2.8951e+00+2.1080e-08j, 5.2744e+00-3.4597e-07j,
        2.5712e+01+2.6226e-07j, 1.7550e+00+1.4901e-08j, 2.1760e-03-2.1304e-07j,
        1.2976e+00-1.2517e-06j, 4.1580e+01-7.8814e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.961507320404053-7.202356044899716e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4782+5.5188e-10j, 0.2542-2.9802e-08j, 7.1565-9.5367e-07j,
        1.1773-1.7669e-08j, 0.3914-8.6604e-09j, 3.7109+2.2758e-07j,
        0.8014+6.4237e-08j, 1.7499-1.7980e-08j, 3.6422-1.1921e-07j,
        0.8562-2.0722e-08j, 1.8765+1.0965e-08j, 1.8097+4.9945e-08j,
        0.0115+1.3791e-08j, 2.1514-1.1393e-07j, 0.9127+4.9668e-08j,
        4.9388+7.9416e-08j, 1.1759+1.8984e-09j, 1.3246-8.4702e-08j,
        0.7793+1.4901e-08j, 1.2835-2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8241043090820312-4.415982601813084e-08j)
SINR torch.Size([20]) = tensor([ -0.3119,   1.0726,   2.8817,  -0.1820,   3.5476,   2.4282,  -4.5930,
          2.3059,   0.8978,  -5.1779,  -7.2863,  -4.2215,  -5.6357,  -3.0759,
          0.5565,   5.5347,  -0.3844, -30.1451,  -3.4281,   3.6435],
       device='cuda:0')
SINR mean = -2.078669309616089
E[H^H] = 1e-07
E_MSE (Error Power) = 67.31800842285156
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4821, 0.5614, 0.6601, 0.4895, 0.6936, 0.6362, 0.2578, 0.6297, 0.5515,
        0.2329, 0.1574, 0.2745, 0.2146, 0.3300, 0.5320, 0.7815, 0.4779, 0.0010,
        0.3123, 0.6982], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 365,  318,  259,  361,  238,  273,  515,  277,  324,  535,  604,  502,
         550,  462,  335,  182,  368, 1000,  474,  235], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 8-----------
Real SNR = tensor([ 6.9060,  0.4511,  2.5106,  3.1545,  9.1377,  3.7827,  7.6513,  8.7866,
         6.4132,  5.4723,  7.5087,  5.6490,  7.0739,  8.0630, 11.3111,  5.4799,
         8.8997,  4.5063,  7.3881,  5.9519], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.6970e-01-2.1257e-08j, 7.0490e+00-4.0553e-08j, 2.1698e+00+6.2961e-08j,
        8.4238e-01-1.7154e-08j, 1.2862e+01-9.5336e-08j, 1.1132e+00-0.0000e+00j,
        4.4355e-02+2.5039e-08j, 1.5057e+00+1.7881e-07j, 1.2077e+00-5.9605e-08j,
        8.0814e-01+9.9975e-09j, 3.5228e+01-8.3367e-09j, 1.0397e+00-2.9802e-07j,
        2.5283e+00-1.9950e-08j, 4.5639e+00-2.6551e-07j, 4.6864e+01-7.4867e-07j,
        2.6089e-01+3.1665e-08j, 4.7570e+00-6.4472e-08j, 2.3647e+00-0.0000e+00j,
        1.6970e-01+3.9771e-07j, 5.0105e-01-1.3416e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.302450656890869-4.6701458700226794e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0586-3.1135e-09j, 0.1589-3.0291e-09j, 0.2340+2.2395e-09j,
        0.1710-1.0228e-08j, 5.6388+6.4030e-08j, 0.2297-5.9605e-08j,
        1.0000+9.3178e-08j, 3.3950-1.1921e-07j, 3.6389-2.8452e-08j,
        0.2205+4.4236e-09j, 4.4122+4.2554e-08j, 0.1573-3.3528e-08j,
        1.7528+1.1921e-07j, 2.6778-9.4163e-09j, 8.6465+1.1609e-07j,
        0.2254+7.4506e-09j, 2.8641+3.2200e-08j, 1.0673-0.0000e+00j,
        2.3468-3.6312e-08j, 0.5308+1.7239e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.971317172050476+9.785910748405513e-09j)
SINR torch.Size([20]) = tensor([-10.5259,   1.4207,   0.0685,  -3.1281,  -2.1002,  -2.1998, -13.7796,
         -0.5204,  -8.3776,  -0.1567,   4.4634,  -3.4433,   0.4612,   2.1986,
          6.8087,  -9.8720,   2.3682,  -1.1683, -15.3520,  -6.4308],
       device='cuda:0')
SINR mean = -2.963275671005249
E[H^H] = 1e-07
E_MSE (Error Power) = 5.63264799118042
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0814, 0.5811, 0.5039, 0.3273, 0.3814, 0.3760, 0.0402, 0.4701, 0.1269,
        0.4910, 0.7365, 0.3116, 0.5265, 0.6239, 0.8275, 0.0934, 0.6330, 0.4331,
        0.0283, 0.1853], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([702, 306, 352, 464, 428, 431, 791, 372, 638, 360, 212, 475, 339, 281,
        151, 683, 275, 395, 830, 576], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
--------SNR = 9-----------
Real SNR = tensor([ 6.6832,  7.1384,  6.4523,  6.3490,  5.2745, 10.6398,  9.8074,  7.8274,
        10.5297,  7.6345,  9.3079,  7.5872,  9.1481,  6.5204,  6.4010, -1.9265,
        10.9463,  4.9302, 11.3110, 10.1497], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 7.8558-6.0936e-08j,  1.0073+1.9019e-08j,  7.2226+2.9024e-08j,
         2.3176+1.4300e-07j,  0.7066-6.1210e-09j,  2.0456-2.7449e-08j,
         8.0292+1.5934e-08j,  3.5236+1.7324e-08j,  4.1037-1.7368e-07j,
         0.7730-5.9605e-08j,  7.7568+2.1816e-08j,  1.8765-1.8342e-08j,
         2.3221+2.4854e-07j,  1.4341-1.4901e-08j,  0.4903-1.1420e-09j,
         3.9067+5.6437e-08j, 16.5260+3.7655e-07j,  1.2085+1.2318e-07j,
         3.4002+3.1100e-07j,  3.7024+1.4901e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.010437488555908+5.743263997715076e-08j)
torch.linalg.det(H.mH@H) = tensor([3.1362-3.3722e-08j, 0.1970-2.9802e-08j, 5.0085+2.3951e-08j,
        0.7141-5.7983e-08j, 0.3175-1.4901e-08j, 3.7230+1.3517e-07j,
        4.2232+2.7870e-08j, 1.4840+1.7632e-08j, 6.9100-3.6696e-07j,
        1.0627+5.9605e-08j, 1.2989-6.2770e-08j, 1.3538-3.9710e-09j,
        1.1420+6.8810e-08j, 0.2835+1.4901e-08j, 0.1196-5.5973e-08j,
        0.0573+2.7940e-09j, 6.3161+1.9038e-08j, 0.3990-4.6480e-08j,
        0.9993-2.2988e-07j, 7.1975+6.2536e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.297166585922241-2.3506437685227866e-08j)
SINR torch.Size([20]) = tensor([ 3.8945, -2.3844,  5.4526, -0.0399, -4.9574,  1.8783,  1.4218,  0.9438,
         1.4044, -3.2987,  2.6093,  2.4845, -3.0977,  1.2393, -3.8808, -1.6385,
         1.7209, -0.6088, -2.3373, -6.3611], device='cuda:0')
SINR mean = -0.2777603566646576
E[H^H] = 1e-07
E_MSE (Error Power) = 1.659550666809082
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7103, 0.3661, 0.7783, 0.4977, 0.2420, 0.6065, 0.5811, 0.5541, 0.5801,
        0.3187, 0.6458, 0.6392, 0.3289, 0.5709, 0.2904, 0.4068, 0.5978, 0.4650,
        0.3686, 0.1878], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([228, 438, 184, 356, 527, 291, 306, 322, 307, 470, 267, 271, 463, 312,
        490, 412, 296, 376, 436, 574], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic/nonoisenosample/
