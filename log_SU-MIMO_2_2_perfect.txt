Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6331, 0.7854, 0.6502, 0.7924, 0.5607, 0.5562, 1.0437, 0.4510, 0.6230,
        0.6187, 0.5298, 0.5912, 0.5910, 0.6297, 0.6507, 0.9634, 0.4686, 0.9956,
        0.5815, 0.6080], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -7.7104,  -9.0752,  -4.3875,  -1.9864,  -7.8627,  -4.3029,  -4.9321,
         -3.8478,  -2.6569,  -5.0613,  -6.4389,  -6.6077,  -4.2494, -11.8850,
         -6.5503,  -8.9603,  -6.2811,  -5.0616,  -9.2709,  -7.1019],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([143.5570+3.5667e-06j, 125.0056-2.1111e-06j, 327.9578-1.7696e-05j,
        606.4849-0.0000e+00j, 123.2970-2.3303e-06j, 197.7858-1.1705e-05j,
        790.8820-3.0518e-05j, 336.4966-0.0000e+00j,  28.8731+2.1301e-07j,
         38.0357+5.1616e-07j,  89.9252+9.9517e-07j, 266.0419-2.8277e-06j,
        334.3371+4.6887e-07j, 177.8796+1.4496e-05j,   9.8350-3.9220e-05j,
        213.4960+2.3439e-05j,   1.1084+2.8901e-08j, 305.0840+1.3983e-06j,
        224.3840+7.5524e-08j, 391.1555+3.2960e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(236.5811004638672-2.895672423619544e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.4323+6.4269e-09j,  2.8451+6.7275e-10j,  6.2631+1.4373e-07j,
         5.0040+7.3467e-07j,  0.3005-3.4839e-09j,  0.1711+6.9745e-08j,
        12.6369-1.2907e-07j,  7.0893+1.2354e-07j, 10.2526-4.4223e-07j,
         0.2701-7.4129e-08j,  0.3698-3.0358e-08j,  0.2526-1.4699e-09j,
         7.4805+1.0284e-07j,  0.2618+1.1469e-09j,  0.4511-4.8704e-08j,
         0.1116+4.1658e-08j,  0.7657-1.7510e-08j,  1.1888-1.4119e-08j,
         0.1961-5.6777e-10j,  0.3408+8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.8341898918151855+2.7609639019487986e-08j)
SINR torch.Size([20]) = tensor([-12.6975,  -6.7566,  -4.2283,  -7.9972, -13.5144, -20.1682,  -3.3615,
         -5.1660,  -4.2442, -16.0014, -14.5195, -15.8221,  -4.3331, -12.3277,
        -13.5624, -19.6199, -10.8633,  -9.7711, -13.3724, -15.2805],
       device='cuda:0')
SINR mean = -11.180368423461914
E[H^H] = 1e-07
E_MSE (Error Power) = 22.643970489501953
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0510, 0.1743, 0.2742, 0.1369, 0.0426, 0.0095, 0.3156, 0.2333, 0.2734,
        0.0245, 0.0341, 0.0255, 0.2694, 0.0553, 0.0422, 0.0108, 0.0758, 0.0954,
        0.0440, 0.0288], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([762, 587, 502, 627, 784, 938, 472, 534, 503, 845, 809, 841, 506, 752,
        785, 926, 712, 680, 780, 828], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = -4-----------
Real SNR = tensor([-4.2288, -3.8316, -4.2642, -3.9850, -4.0980, -3.6302, -4.5393, -1.6421,
         0.3812, -6.9629, -5.6604, -6.9777, -6.1668, -1.8581, -6.0375, -4.3017,
        -5.4433, -5.6977,  0.3637, -1.2071], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 34.1406+3.8147e-06j, 545.0563+4.0643e-06j, 258.7905-0.0000e+00j,
        656.9900+7.7647e-06j,  36.8553-9.5367e-06j, 208.5622-6.3669e-06j,
        373.3764-2.9804e-06j, 441.5192-1.3045e-06j,  40.4381+3.8147e-06j,
         83.3807-3.9169e-06j,  26.3410-2.0756e-07j,   8.0265+2.6226e-06j,
        448.6401-3.8579e-06j,  49.3577-9.5367e-06j, 111.6541+5.4960e-06j,
         29.4600+1.0674e-06j, 163.0874-7.3009e-06j, 327.6942+4.5349e-06j,
        266.3953-1.7574e-05j,  29.6219-3.1122e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(206.96939086914062-1.4857004089208203e-06j)
torch.linalg.det(H.mH@H) = tensor([0.9536+3.9751e-08j, 4.0910+6.5684e-08j, 3.3475+6.2710e-08j,
        5.6895-8.5344e-08j, 0.0413-3.5288e-09j, 1.0568-6.8540e-09j,
        2.3307+2.7611e-08j, 5.8352-1.4415e-07j, 7.5512+3.8722e-07j,
        0.5614-1.7960e-08j, 4.1325+4.5325e-08j, 1.1661+9.7381e-10j,
        3.1285+3.0416e-08j, 8.7915-1.6372e-07j, 1.7652+2.0696e-08j,
        0.4402-1.2216e-08j, 0.2018+6.2431e-08j, 0.8409+4.9379e-09j,
        1.6378-1.4340e-07j, 4.4754-1.8323e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9019064903259277+7.612952046542887e-09j)
SINR torch.Size([20]) = tensor([-11.4762,  -4.5685,  -4.8998,  -4.1134, -23.0707,  -8.7490,  -7.5210,
         -6.8069,  -4.6988, -11.0349,  -5.5699,  -7.9270,  -5.2772,  -2.9460,
         -7.0557, -13.6554, -17.2670,  -9.1677, -10.2111,  -6.4854],
       device='cuda:0')
SINR mean = -8.625067710876465
E[H^H] = 1e-07
E_MSE (Error Power) = 18.017107009887695
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0665, 0.2589, 0.2445, 0.2795, 0.0049, 0.1177, 0.1504, 0.1726, 0.2531,
        0.0730, 0.2171, 0.1388, 0.2288, 0.3366, 0.1646, 0.0413, 0.0184, 0.1080,
        0.0870, 0.1834], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([729, 514, 525, 498, 995, 650, 612, 589, 518, 717, 548, 624, 538, 458,
        597, 787, 875, 662, 693, 578], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = -3-----------
Real SNR = tensor([-3.8673, -4.7088,  0.0344,  1.2249, -3.3879, -3.1917, -6.7758, -3.0094,
        -2.8189, -7.7637, -2.4183, -3.9417, -3.9494, -2.4259, -8.6614, -7.3443,
        -3.6184, -2.3839, -8.2871, -5.7507], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 11.7696+5.4836e-06j,  88.2513-9.8116e-07j,  83.1440-5.5647e-07j,
         30.3012+7.2173e-06j, 504.9744-4.4137e-06j,  66.0752+1.8389e-05j,
         11.0128+5.9605e-08j, 103.3339+3.1225e-05j,  56.0148+4.6622e-07j,
        577.2885-1.4767e-06j, 126.6788-4.0944e-07j, 223.9371+4.5953e-06j,
          8.4639-5.1571e-06j,  93.0451+1.3244e-06j,   5.3694-1.1921e-06j,
         92.2750-1.0179e-06j, 115.0687+3.4332e-05j, 260.6792-4.7494e-06j,
        221.6497-5.6045e-06j,  84.6177+1.5619e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(138.19752502441406+3.954788098781137e-06j)
torch.linalg.det(H.mH@H) = tensor([1.1979-1.8368e-08j, 0.4084+1.9970e-08j, 2.7643+4.4946e-08j,
        4.1546-4.4763e-07j, 3.7507-4.9719e-08j, 3.3424-1.0920e-07j,
        0.4107-7.8674e-09j, 3.7320-1.4890e-08j, 0.4275-2.0862e-07j,
        0.2565-1.4901e-08j, 2.4397+4.4337e-08j, 3.3767+5.5613e-09j,
        0.9018-3.2745e-08j, 2.5707-1.3700e-07j, 0.4877-7.8236e-09j,
        0.4691+2.3926e-08j, 2.3025+2.9552e-08j, 1.3380-1.4901e-07j,
        0.3411-1.4901e-08j, 0.8378+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7755168676376343-5.07290565110452e-08j)
SINR torch.Size([20]) = tensor([ -7.1040, -10.4587,  -6.8438,  -7.1514,  -3.8467,  -4.2552,  -9.9732,
         -4.6250, -14.5023, -11.4742,  -6.4253,  -4.6641,  -9.5251,  -6.1599,
         -8.6537, -11.0673,  -6.3038,  -9.6677, -11.6355, -10.1070],
       device='cuda:0')
SINR mean = -8.222210884094238
E[H^H] = 1e-07
E_MSE (Error Power) = 7.750716686248779
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1630, 0.0825, 0.1714, 0.1616, 0.2920, 0.2729, 0.0914, 0.2564, 0.0342,
        0.0665, 0.1855, 0.2547, 0.1004, 0.1949, 0.1200, 0.0725, 0.1898, 0.0974,
        0.0642, 0.0889], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([598, 700, 590, 600, 489, 503, 686, 516, 809, 729, 576, 517, 673, 567,
        647, 718, 572, 677, 734, 690], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = -2-----------
Real SNR = tensor([-4.1908,  1.1753, -1.3514, -5.6248, -3.0059, -2.9067, -6.8795, -0.6988,
        -3.2508, -5.8374, -3.6623, -8.5991, -5.2542, -2.4004, -4.8408, -2.9658,
        -1.6476, -4.0863, -0.6764, -0.5331], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([211.7863-2.8979e-06j, 348.4846+1.6463e-05j,  31.8875-3.8322e-07j,
          2.1674-4.6112e-07j,  10.8612+1.2906e-07j,   8.3937-5.3644e-07j,
         25.4792+1.6654e-07j, 112.1574+2.6731e-07j,  50.5081+1.0249e-06j,
        145.5424-1.1513e-06j,   6.4545+1.8222e-06j,  92.7379+1.5259e-05j,
        112.3437+8.1791e-07j, 116.7617-0.0000e+00j,  17.9486-3.5741e-07j,
         12.5165-3.1288e-08j,  46.1541+7.7743e-08j, 345.7810+3.0219e-06j,
         91.4072-7.5720e-07j,  19.4714-7.1526e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(90.44222259521484+1.5879166994636762e-06j)
torch.linalg.det(H.mH@H) = tensor([1.9578e-01-1.5360e-08j, 1.6206e+01-7.6593e-08j, 1.5036e+00+4.7988e-08j,
        1.9811e+00-2.9816e-08j, 3.7075e-01+2.1917e-08j, 2.0980e+00+7.2646e-10j,
        3.8328e-01-2.2352e-08j, 1.9568e+01-1.4177e-07j, 2.6223e-01-3.4832e-08j,
        9.5699e-02+4.6566e-10j, 2.0239e+00-3.0246e-08j, 1.9282e-01+4.8047e-09j,
        8.5197e-01+2.4972e-09j, 4.0686e+00-3.5962e-09j, 2.0201e+00+6.2048e-10j,
        1.6274e+00+2.2177e-08j, 1.8960e+00-9.3333e-09j, 4.7211e-03+4.2334e-09j,
        6.0797e-01+1.7407e-07j, 3.5872e+00+1.5807e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9772768020629883+3.6837701777869825e-09j)
SINR torch.Size([20]) = tensor([-14.1061,   0.3157,  -8.1004,  -5.2332, -12.3228,  -4.0196, -11.9602,
         -0.1512, -12.4381, -15.9793,  -5.2767,  -9.4034,  -7.2293,  -3.6254,
         -3.7427,  -5.7811,  -5.4470, -29.7308, -11.1417,  -4.6757],
       device='cuda:0')
SINR mean = -8.502456665039062
E[H^H] = 1e-07
E_MSE (Error Power) = 54.292415618896484
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0374, 0.5182, 0.1341, 0.2306, 0.0553, 0.2838, 0.0599, 0.4913, 0.0540,
        0.0246, 0.2288, 0.1029, 0.1591, 0.3026, 0.2970, 0.2090, 0.2220, 0.0011,
        0.0714, 0.2541], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 799,  344,  630,  536,  752,  495,  743,  360,  755,  845,  538,  670,
         602,  481,  485,  555,  544, 1000,  720,  517], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = -1-----------
Real SNR = tensor([-3.3416, -7.2598, -5.7448,  2.1382,  1.0448, -4.1056, -1.2856, -6.6126,
         0.2915, -6.6861, -3.6951, -8.3575, -0.3815,  0.1202, -9.9636, -0.4643,
        -2.4552, -5.6327, -1.9155, -1.7600], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 29.1773+6.9147e-07j,   9.5491+4.7684e-07j,  41.3953-1.9163e-07j,
         69.8227+2.9235e-07j,  16.2973+4.7684e-07j,  15.1785-4.7684e-06j,
         18.2414-2.8610e-06j,  26.3150-2.8610e-06j,  25.6936+1.4889e-06j,
          6.8718-1.2906e-07j,  99.7078-1.1215e-07j, 136.7176+2.6778e-06j,
         25.4526+4.0610e-06j,  33.5536+5.5246e-07j,   6.4893-7.1526e-07j,
          5.2308-2.3365e-05j,  34.4543-1.2193e-07j,   6.2126-2.9735e-07j,
         83.4929-5.5607e-07j,  95.1496-1.8130e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(39.250152587890625-1.3537110135075636e-06j)
torch.linalg.det(H.mH@H) = tensor([7.7452e-01-1.3057e-10j, 4.5511e-01-1.3508e-08j, 6.6806e-01-4.5846e-09j,
        3.7041e-01-1.4074e-07j, 8.1483e+00+5.9118e-09j, 2.4424e-01+9.1188e-09j,
        5.8306e+00+3.8408e-08j, 3.2502e-01+3.7902e-09j, 5.3610e+00-3.4432e-08j,
        7.1019e-03-6.6979e-09j, 1.6354e+00-3.4998e-08j, 1.0272e-01+1.6198e-09j,
        1.9333e+00+5.2387e-08j, 7.1333e+00-8.4830e-08j, 8.5321e-02+1.8626e-09j,
        2.6450e+00-2.8992e-08j, 2.6270e+00+8.0274e-09j, 2.0320e+00+4.0529e-08j,
        1.6726e+00+8.9407e-08j, 1.3908e+00+1.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1720921993255615-4.15746370663328e-09j)
SINR torch.Size([20]) = tensor([ -6.1117,  -7.7697,  -6.1016, -14.6300,   0.2637,  -9.5356,  -1.3467,
         -9.0252,  -0.7761, -24.9002,  -4.4925, -11.0956,  -5.2723,  -1.5791,
        -12.9606,  -5.0745,  -2.6343,  -3.2954,  -7.2931,  -4.3951],
       device='cuda:0')
SINR mean = -6.901282787322998
E[H^H] = 1e-07
E_MSE (Error Power) = 20.834135055541992
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1967, 0.1432, 0.1970, 0.0333, 0.5152, 0.1001, 0.4231, 0.1112, 0.4554,
        0.0032, 0.2622, 0.0721, 0.2290, 0.4101, 0.0481, 0.2371, 0.3528, 0.3189,
        0.1572, 0.2666], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 566,  619,  565,  812,  345,  673,  401,  658,  381, 1000,  511,  719,
         538,  410,  769,  531,  447,  470,  604,  508], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 0-----------
Real SNR = tensor([-2.2072, -0.5870, -1.7106, -1.7630, -6.5989, -3.0787, -3.7197,  3.8667,
        -2.6440, -1.2530, -1.9308,  2.8135, -1.0539,  1.0784, -3.8398, -2.4212,
        -4.6717, -5.1298, -3.0706,  0.4659], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  8.5382+2.3751e-08j,  47.1501-3.6893e-06j,  52.2056+8.6326e-08j,
          2.4986+1.7881e-07j,  23.9451-7.6650e-07j,  93.3136+3.4148e-06j,
         25.4169-8.5116e-07j,  50.4558-4.5489e-06j,   1.8885-4.5833e-09j,
          3.2487+6.7254e-07j,   6.3530-1.7171e-07j,  36.8433+8.9716e-07j,
         34.0251-7.2438e-07j, 116.2000+3.1386e-06j, 126.7799-6.5626e-07j,
         10.4254-2.3881e-06j, 106.8352-2.0813e-06j,  56.7364-1.0183e-06j,
         24.1283-5.9605e-07j,   1.5460+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(41.42668914794922-4.5348556909630133e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.2451+3.5413e-09j,  4.4864+1.1780e-08j,  4.3310-9.8954e-09j,
         2.6815-9.0754e-08j,  0.0362+1.6780e-09j,  0.2413-5.3023e-09j,
         2.3094+7.4071e-08j, 10.0039+9.4371e-07j,  0.5794+7.4506e-09j,
         2.5903+1.3549e-09j,  0.3374+2.9802e-08j,  9.9575+7.8748e-08j,
         0.2493-2.2352e-08j,  8.4127-1.6554e-07j,  0.5634+2.9802e-08j,
         1.1424+9.1092e-09j,  0.0158+1.5134e-09j,  1.0386-2.0221e-08j,
         1.4144+1.4901e-08j,  4.1736-5.9605e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7404847145080566+1.4867596931367189e-08j)
SINR torch.Size([20]) = tensor([ -8.8230,  -0.4098,  -0.1747,  -3.1091, -13.8449,  -9.0205,  -4.8861,
         -1.3335,  -7.2923,  -2.2004, -10.7441,   1.5879, -12.9372,   0.2927,
         -7.0113,  -5.9971, -20.5918,  -3.7546,  -4.6597,  -1.8788],
       device='cuda:0')
SINR mean = -5.839411735534668
E[H^H] = 1e-07
E_MSE (Error Power) = 9.931780815124512
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1159, 0.4764, 0.4899, 0.3283, 0.0396, 0.1113, 0.2451, 0.4238, 0.1572,
        0.3760, 0.0777, 0.5904, 0.0484, 0.5168, 0.1660, 0.2009, 0.0087, 0.2964,
        0.2548, 0.3935], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([652, 369, 360, 463, 792, 658, 525, 401, 604, 431, 709, 301, 769, 344,
        595, 562, 946, 486, 517, 420], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 1-----------
Real SNR = tensor([-5.0970, -3.3964,  0.7724,  0.9551, -1.0807, -1.5888, -2.4568,  3.2914,
         2.2862, -4.1652,  0.0635, -0.3949,  2.8757,  0.1748,  2.7617, -3.8582,
         2.4815,  3.6038,  0.4784, -1.3361], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.0082e+02+3.7125e-06j, 7.8928e+00+1.1907e-05j, 1.1738e+01+5.9166e-07j,
        3.3824e-02-5.8595e-08j, 1.0589e+01-5.2175e-07j, 7.6996e+01-5.7357e-07j,
        2.2258e+00-1.7881e-07j, 3.7787e+01-6.7320e-07j, 2.5953e+01-6.3051e-08j,
        6.1037e-01+1.2150e-07j, 7.4218e+00+1.6689e-06j, 2.4168e+01-0.0000e+00j,
        2.6375e+01+1.0553e-07j, 3.2063e+01+9.5367e-07j, 9.3450e+01+7.4203e-07j,
        8.4038e+00-3.3768e-07j, 6.4284e+01+1.9281e-06j, 7.5042e+01-9.8900e-07j,
        4.7839e+00+2.3254e-07j, 1.1786e+01+5.1163e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(31.121057510375977+9.539533039060188e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.3899-1.1346e-08j,  0.4079-2.9802e-08j,  0.5448+8.8271e-09j,
         2.0976-2.3413e-08j,  0.2009-3.7253e-08j,  0.2423-2.9802e-08j,
         0.0440+7.0781e-08j,  1.2825+1.0121e-08j,  5.1214+2.3842e-07j,
         0.2994+9.6072e-09j,  1.0592+5.9605e-08j,  2.1279+1.4512e-08j,
         4.5504+6.5417e-08j,  0.3088-4.0978e-08j, 10.1944+3.5782e-08j,
         0.3382+4.5353e-08j,  6.4826+2.0670e-08j,  0.0541-3.7253e-09j,
         1.9339-8.2407e-08j,  0.2599-8.3348e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.89699387550354+1.1851021497477632e-08j)
SINR torch.Size([20]) = tensor([ -5.2745,  -7.3277,  -6.8924,  -2.1158,  -9.7866, -10.5492, -17.9050,
         -5.9299,  -0.3395,  -7.0939,  -5.6004,  -1.1372,  -0.7202,  -9.6227,
          2.5173,  -7.8107,   0.5376, -19.2814,  -2.5432, -11.4462],
       device='cuda:0')
SINR mean = -6.416077613830566
E[H^H] = 1e-07
E_MSE (Error Power) = 10.546041488647461
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2289, 0.1561, 0.1698, 0.3806, 0.0951, 0.0810, 0.0159, 0.2034, 0.4805,
        0.1634, 0.2159, 0.4349, 0.4586, 0.0983, 0.6410, 0.1420, 0.5309, 0.0117,
        0.3576, 0.0669], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([538, 605, 591, 428, 681, 703, 889, 560, 366, 598, 549, 394, 379, 676,
        270, 621, 336, 919, 443, 728], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 2-----------
Real SNR = tensor([ 1.6937, -8.3082,  0.7862,  0.4074, -0.7525, -1.6470, -3.2101, -0.9159,
         2.0389, -4.0875, -5.6773,  0.5950,  4.7250,  3.5073,  0.6104, -0.5713,
        -0.9446, -2.6792, -7.0550,  1.2913], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.7348+4.7684e-07j,  4.5564-4.7953e-07j, 25.5156-2.9165e-07j,
         3.1562-6.4396e-08j,  4.5314+4.0686e-07j,  8.1087-9.5367e-07j,
        38.7269+9.2074e-07j,  0.3101-2.7118e-08j, 17.6047-2.4717e-07j,
        30.3344+1.9450e-06j,  0.1459+2.5250e-07j, 51.3772-8.3502e-07j,
        11.5630-0.0000e+00j, 12.8733+8.8579e-08j, 10.4661-7.1526e-07j,
         0.7880-2.9802e-08j, 10.9320+3.4225e-08j,  1.4189-4.6213e-08j,
        37.9785+6.4518e-07j, 50.9746-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(16.254840850830078+5.4003262306423494e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1482-2.7211e-08j, 0.0904+1.4755e-10j, 0.4892-3.8417e-09j,
        1.2506+6.8905e-08j, 0.0389-2.0872e-08j, 0.7622+1.6042e-08j,
        1.2623-1.2796e-08j, 0.2790-4.4703e-08j, 1.7723+1.1388e-08j,
        0.1730+1.4901e-08j, 0.0302-2.3283e-10j, 2.1967-8.8625e-09j,
        6.0921+5.4617e-08j, 8.7186-8.5268e-08j, 2.3907+2.3842e-07j,
        1.2788+2.5107e-08j, 0.6459-1.4901e-08j, 1.8593+3.3704e-08j,
        0.0372-1.2453e-11j, 1.0019-1.4901e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5258740186691284+4.775944528745413e-09j)
SINR torch.Size([20]) = tensor([-11.3624,  -8.0084,  -5.6439,  -3.0033, -15.7636,  -2.9755,  -1.6895,
         -9.8940,  -2.4128,  -7.7456, -14.9471,  -0.3417,   0.8171,   2.2907,
         -1.5960,  -1.3140,  -4.5624,  -0.5439,  -9.4007,  -5.5777],
       device='cuda:0')
SINR mean = -5.1837334632873535
E[H^H] = 1e-07
E_MSE (Error Power) = 6.166240215301514
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0681, 0.1366, 0.2142, 0.3337, 0.0258, 0.3351, 0.4040, 0.0929, 0.3646,
        0.1439, 0.0310, 0.4803, 0.5469, 0.6289, 0.4091, 0.4249, 0.2591, 0.4687,
        0.1030, 0.2168], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([726, 627, 550, 460, 840, 459, 413, 684, 439, 619, 820, 366, 326, 278,
        410, 400, 514, 373, 669, 548], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 3-----------
Real SNR = tensor([ 6.0360,  2.1416, -0.1039,  1.7055,  6.6223, -0.9592, -0.0968, -1.8552,
         1.0052,  1.4916,  2.3660,  1.8459,  3.6405,  3.2873,  1.2603,  2.8593,
         3.5395, -4.1982,  3.5181,  1.2877], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([8.8552e+00+8.3894e-07j, 1.1051e+01+6.9047e-07j, 2.5158e+00-3.8000e-08j,
        3.1055e+01-3.0377e-07j, 7.2085e+00+1.8665e-07j, 3.3196e+01+6.3731e-07j,
        9.0932e+00-1.4305e-06j, 8.0811e+00-2.4752e-07j, 3.3142e+00+1.9670e-06j,
        3.1161e+00+8.3584e-07j, 2.9038e+01+3.3772e-07j, 1.9002e-01-1.4901e-08j,
        7.9464e+00+2.7899e-07j, 2.7455e+01-5.5220e-07j, 2.9824e+00-2.3842e-07j,
        6.1262e+01-3.2503e-07j, 1.3159e+00+2.2831e-08j, 1.1945e+01-4.7684e-07j,
        2.2718e+02-3.7417e-06j, 2.9893e-01+6.5193e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(24.35474967956543-7.833217807728943e-08j)
torch.linalg.det(H.mH@H) = tensor([4.9371+3.3113e-08j, 1.7378+9.2126e-09j, 0.0970+1.3890e-08j,
        0.4707+1.2053e-08j, 6.1484+4.3948e-07j, 0.5471+5.3216e-08j,
        0.5450-4.4703e-08j, 0.3805+1.8658e-09j, 0.5273+6.6927e-08j,
        0.6193+5.3114e-09j, 1.6334-9.5518e-08j, 2.4436+5.2387e-08j,
        2.8149+4.0074e-08j, 0.4417+2.3410e-08j, 0.5670-5.2735e-09j,
        4.6679+6.4877e-09j, 0.0652-7.7783e-08j, 0.0155-6.1118e-09j,
        3.9376+4.7684e-07j, 1.1639+1.9947e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6880457401275635+5.124110202814336e-08j)
SINR torch.Size([20]) = tensor([  1.0974,  -1.0844, -10.1764,  -4.7295,   1.1753,  -4.0227,  -5.1342,
         -5.4448,  -4.3540,  -3.3611,  -2.1499,   0.6395,   0.6053,  -6.8230,
         -3.4199,   2.2156, -15.0749, -21.1669,   0.4376,  -0.8576],
       device='cuda:0')
SINR mean = -4.08142614364624
E[H^H] = 1e-07
E_MSE (Error Power) = 9.829872131347656
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5628, 0.4379, 0.0876, 0.2518, 0.5672, 0.2837, 0.2347, 0.2221, 0.2684,
        0.3156, 0.3787, 0.5367, 0.5348, 0.1721, 0.3127, 0.6248, 0.0301, 0.0076,
        0.5252, 0.4508], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([317, 392, 692, 519, 314, 495, 533, 544, 506, 472, 430, 332, 334, 589,
        474, 280, 823, 958, 339, 384], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 4-----------
Real SNR = tensor([ 4.1920,  4.9029,  5.5319,  4.6012,  3.1171,  0.1491, -0.7210,  2.3482,
         0.9034,  1.4838,  2.3323,  4.3059,  5.4860,  0.0125,  4.7416,  0.2017,
         3.5729,  2.1664,  1.6815,  1.8601], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.6484+5.6278e-09j,  3.0973+5.3880e-08j,  4.1766+1.4901e-07j,
        32.6536+1.3192e-07j,  2.7240+3.5763e-07j,  1.2989+2.0289e-08j,
         5.0511-6.6084e-08j, 13.0981-3.1727e-07j,  2.4639+1.1291e-07j,
         5.2620+4.7707e-08j,  0.1405+2.3073e-08j,  4.5045-4.9564e-07j,
         2.3684+7.9921e-09j,  0.3674+1.6099e-07j,  2.9171-0.0000e+00j,
         2.7907-1.4455e-06j,  0.7510+2.5140e-09j,  5.1372-9.5315e-07j,
        13.3299+4.5848e-07j, 15.8562+1.4322e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.981834411621094-8.012204233409648e-08j)
torch.linalg.det(H.mH@H) = tensor([2.4767+1.0384e-08j, 5.4923+4.3563e-08j, 8.3076-1.8356e-07j,
        6.0060-5.9256e-08j, 0.7600-5.9605e-08j, 0.2213-1.1176e-08j,
        0.0936-7.0531e-08j, 0.9632-2.9802e-08j, 0.2864-2.9802e-08j,
        0.0788-1.8237e-09j, 1.2466-2.2188e-08j, 3.8115+8.7613e-08j,
        1.5436-8.3839e-07j, 0.2477+1.1176e-08j, 2.6022+6.1023e-08j,
        0.0771-7.3932e-09j, 3.1442+5.7496e-08j, 3.5066-3.6157e-08j,
        0.9963-0.0000e+00j, 0.6358+2.1673e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.124887704849243-5.283794735078118e-08j)
SINR torch.Size([20]) = tensor([ -0.0745,   4.4663,   4.4842,   4.0766,  -4.5701,  -6.8332, -11.8701,
         -2.6339,  -6.1917, -10.7256,  -1.2134,   2.8120,  -3.3158,  -5.8123,
          1.5723, -10.4814,   1.9632,   0.6049,  -0.9547,  -1.5200],
       device='cuda:0')
SINR mean = -2.3108677864074707
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0480847358703613
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4957, 0.7366, 0.7374, 0.7188, 0.2588, 0.1717, 0.0610, 0.3529, 0.1938,
        0.0780, 0.4306, 0.6564, 0.3179, 0.2078, 0.5895, 0.0822, 0.6111, 0.5348,
        0.4453, 0.4134], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([357, 211, 211, 223, 514, 589, 740, 447, 568, 708, 397, 261, 470, 556,
        301, 701, 288, 334, 388, 407], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 5-----------
Real SNR = tensor([-2.5000e+00,  4.1393e+00,  1.7705e-02,  2.0839e+00, -2.6171e-01,
         5.5693e+00, -2.4705e+00,  1.7287e+00,  3.1761e+00,  1.9330e+00,
         8.9069e-01, -1.6992e-03,  2.6260e+00, -7.1642e+00,  2.6113e+00,
         4.9983e+00, -1.2708e+00, -3.8688e-01, -2.2856e+00,  1.4382e+00],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.2875-8.1053e-08j,  3.6991+3.4614e-09j, 13.6156+4.7684e-07j,
         0.2997+5.9605e-08j, 17.5069+1.5874e-08j, 26.2773-7.0637e-08j,
         4.3146-3.1653e-08j,  4.2243-6.8665e-08j, 36.1212+4.2957e-07j,
         4.3467+5.8376e-08j,  2.7608+4.3213e-07j,  2.3496+1.3520e-07j,
         9.2929+1.4185e-07j,  1.5164+9.6379e-09j, 20.2235+1.5419e-07j,
         5.1700-5.3736e-07j,  1.8734-1.9225e-08j, 15.6865-2.5232e-07j,
         4.7811-3.4866e-07j,  1.5392+7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.79432201385498+2.573070467803973e-08j)
torch.linalg.det(H.mH@H) = tensor([9.1446e-02-9.3132e-10j, 1.5396e+00-2.9386e-07j, 8.7891e-01-2.7798e-09j,
        1.9012e-02-1.8755e-08j, 1.1356e-01-4.3640e-09j, 1.6094e-01+3.9905e-08j,
        9.2010e-03-4.5725e-09j, 9.1743e-02+7.7993e-09j, 2.1709e-01-1.8219e-09j,
        5.2516e-01-2.9802e-08j, 1.3976e-01+1.4901e-08j, 6.9210e-01-1.1272e-08j,
        2.8531e+00+4.7455e-08j, 2.6449e-03-2.3283e-10j, 8.5163e-01-0.0000e+00j,
        8.5841e-01-1.5555e-07j, 3.0954e-02-9.3132e-10j, 2.3451e-01+5.5879e-09j,
        8.2415e-02+7.2202e-10j, 1.5923e-01+2.2352e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.4775713086128235-1.930737880684319e-08j)
SINR torch.Size([20]) = tensor([ -7.6711,  -1.7765,   0.2608, -14.2649,  -4.4465,  -9.1204, -18.5644,
         -9.5511,  -6.7465,  -2.0281,  -9.3210,   0.3113,   3.0466, -16.6949,
         -2.2858,  -3.3244, -13.3554,  -5.5480,  -4.8645,  -7.8472],
       device='cuda:0')
SINR mean = -6.689605712890625
E[H^H] = 1e-07
E_MSE (Error Power) = 9.8310546875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1460, 0.3991, 0.5150, 0.0361, 0.2643, 0.1091, 0.0137, 0.0998, 0.1746,
        0.3853, 0.1047, 0.5179, 0.6685, 0.0210, 0.3714, 0.3175, 0.0441, 0.2180,
        0.2460, 0.1410], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([616, 416, 345, 803, 510, 661, 903, 674, 587, 425, 667, 344, 254, 861,
        434, 471, 780, 547, 524, 622], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 6-----------
Real SNR = tensor([ 7.9186, -1.3969,  7.7785,  8.0060,  8.6152,  4.2603,  3.6700,  3.0925,
         6.0664,  5.2853,  7.6134,  6.4287,  7.6905,  3.3229,  2.9356,  5.6908,
         7.0185,  2.4721,  6.6544,  5.9981], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 5.3744-8.8031e-08j,  8.6361-5.1593e-09j, 20.4469+1.0974e-07j,
         2.3159-1.4092e-08j,  0.8303+1.0109e-08j,  0.5038+3.4273e-07j,
         0.2299+7.4506e-09j, 20.0161-1.3060e-07j,  0.7879-1.7881e-07j,
         4.6818+2.4669e-07j, 12.3021-9.7626e-08j,  7.0715-2.9802e-07j,
         5.9126+2.3055e-07j,  1.0190-1.1921e-07j,  3.9451+5.9330e-07j,
        11.3380-8.2272e-08j,  4.0564-1.9177e-08j,  5.6245+1.8076e-08j,
         4.4578+6.9599e-08j, 19.9467+1.8014e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.974833965301514+3.876873932995295e-08j)
torch.linalg.det(H.mH@H) = tensor([4.6607-1.5998e-08j, 0.4013-1.1436e-09j, 3.2787-4.7684e-07j,
        3.3397-2.3842e-07j, 1.5748-2.9411e-08j, 1.1470-2.5470e-08j,
        0.7190+2.7342e-08j, 0.4602+1.1921e-07j, 2.1329-2.0369e-08j,
        0.7396-3.9154e-08j, 7.3417+3.3593e-08j, 5.4972-6.9558e-10j,
        2.6064-1.4870e-08j, 0.5585+3.7666e-09j, 0.2084+1.8626e-08j,
        2.8777-5.4920e-08j, 2.0934+1.7198e-07j, 0.9766-5.1632e-09j,
        0.0568-2.5939e-08j, 4.1739-1.6534e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2422287464141846-2.9520377253788865e-08j)
SINR torch.Size([20]) = tensor([  4.2851,  -0.4104,   2.6518,   2.7477,   0.2678,   2.0764,  -1.7028,
         -2.4682,   2.1333,  -1.1328,   5.0726,   5.6058,   2.1704,   0.0536,
         -7.6360,   4.3774,   1.5395,   1.0782, -11.5655,   5.1987],
       device='cuda:0')
SINR mean = 0.7171306610107422
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5890614986419678
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7284, 0.4764, 0.6481, 0.6531, 0.5154, 0.6173, 0.4032, 0.3616, 0.6204,
        0.4352, 0.7628, 0.7843, 0.6224, 0.5031, 0.1470, 0.7326, 0.5877, 0.5618,
        0.0652, 0.7680], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([217, 369, 266, 263, 345, 285, 414, 441, 283, 394, 195, 180, 281, 353,
        615, 214, 302, 318, 732, 191], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 7-----------
Real SNR = tensor([ 8.4971,  5.6513,  3.5255,  6.5682,  8.8691,  1.1456,  6.7524,  1.5111,
        -0.7916,  9.0434,  3.4567,  7.1301,  3.4100,  4.6301,  7.5840,  4.9370,
         4.8258,  8.8509,  0.8413,  7.4862], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 7.1066-1.3893e-07j,  1.9320+1.1391e-08j,  0.8754+1.0519e-08j,
         5.8784+3.3665e-07j, 13.4979-7.0236e-08j,  1.3641-1.5063e-08j,
         4.7045-1.1398e-07j,  1.0247+2.9802e-08j,  0.9813-2.9395e-08j,
        18.6308+7.9551e-07j,  0.7886-3.7253e-08j,  4.5680-1.8332e-08j,
         1.4997-0.0000e+00j,  1.0080-1.1921e-07j, 24.3626-6.3812e-07j,
         6.3588+3.8473e-08j,  0.2768+2.8312e-07j,  5.3343+2.2365e-08j,
         2.6174+2.0242e-08j,  0.3533-3.6843e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.158168315887451+1.819334727315436e-08j)
torch.linalg.det(H.mH@H) = tensor([ 3.5226-5.6490e-09j,  0.5448-3.4986e-08j,  0.0572+1.3547e-10j,
         4.8649-1.2806e-07j,  4.3282-1.4802e-07j,  0.2092+1.6531e-09j,
         4.1795-6.9150e-08j,  0.8735+1.5244e-09j,  0.0742+3.8284e-09j,
        10.4155-1.9959e-08j,  0.1889+1.4901e-08j,  1.7549+1.1511e-08j,
         1.5465-5.5784e-09j,  1.9515+9.3441e-09j,  1.7705-6.9387e-08j,
         1.9951-6.5310e-09j,  0.8606-0.0000e+00j,  1.3956-3.7807e-08j,
         0.0559-1.4310e-09j,  3.0722-2.5536e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.183061361312866-2.5459945263150985e-08j)
SINR torch.Size([20]) = tensor([ 4.8343, -0.5594, -7.0302,  5.2918,  5.9632, -0.2933,  6.1443,  2.3759,
        -3.7003,  8.7056, -6.6950,  2.5924,  4.1997,  4.3021,  3.2148,  4.5070,
         0.9748,  2.5097, -6.9936,  5.0165], device='cuda:0')
SINR mean = 1.7680237293243408
E[H^H] = 1e-07
E_MSE (Error Power) = 1.1382793188095093
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7527, 0.4678, 0.1654, 0.7718, 0.7979, 0.4831, 0.8045, 0.6335, 0.2990,
        0.8813, 0.1763, 0.6449, 0.7245, 0.7292, 0.6770, 0.7384, 0.5559, 0.6406,
        0.1665, 0.7604], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([201, 374, 596, 189, 171, 365, 167, 275, 484, 111, 585, 268, 219, 216,
        249, 210, 321, 271, 595, 196], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 8-----------
Real SNR = tensor([ 5.9489,  3.6889,  4.0319,  7.4575,  6.4590,  5.6676,  7.5250,  3.0056,
         7.9833, 10.5236,  5.9485,  5.2656,  7.6241,  8.2304,  6.0573,  2.9935,
         8.1693,  8.9619,  1.8103,  9.8800], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.7419+3.2402e-09j,  3.7271-1.3737e-07j, 11.3847-4.2724e-07j,
         5.4018+1.7737e-07j,  5.2915+4.5828e-08j, 13.0741-4.2231e-07j,
         4.7647+2.3842e-07j,  0.0615+2.5776e-08j,  7.5682+1.3467e-08j,
         0.9968-2.4997e-07j,  9.3474-1.2262e-07j,  1.5887-1.1921e-07j,
         7.7748+3.1989e-07j,  5.4308+1.6264e-08j,  6.8131+1.2445e-07j,
         6.1273+2.0566e-07j,  0.9257-1.4901e-08j, 13.5716-2.3270e-08j,
         5.1110-7.1985e-09j,  0.4627+1.6092e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.508275508880615-9.640117148990157e-09j)
torch.linalg.det(H.mH@H) = tensor([1.9259e+00+4.8847e-08j, 9.8875e-03+4.0047e-08j, 1.6687e-03+5.7480e-10j,
        4.7614e-01+7.4506e-08j, 2.1643e-01+4.7479e-08j, 1.0870e+00+3.6801e-08j,
        1.3176e+00-1.4901e-07j, 9.4917e-02-2.7940e-08j, 6.3345e+00-5.0192e-08j,
        5.5469e+00-3.2605e-08j, 1.3569e+00-1.7162e-07j, 4.6953e-02-4.0047e-08j,
        1.8652e+00-3.8929e-08j, 3.2072e+00-3.4725e-08j, 1.9290e+00+5.4220e-09j,
        2.9653e-02+2.1762e-08j, 9.8932e-01-6.2708e-08j, 3.0266e+00+2.2444e-08j,
        1.4074e-01+2.9802e-08j, 4.4721e-02-2.8500e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4823671579360962-1.4147111038198545e-08j)
SINR torch.Size([20]) = tensor([  5.0578, -15.4172, -22.6719,  -1.3452,  -3.1581,   2.9828,   1.3874,
         -6.8638,   8.2167,   6.9579,   2.7086,  -8.8857,   3.8195,   5.5049,
          5.9332, -10.1121,   1.5197,   4.8703,  -2.8729, -12.1764],
       device='cuda:0')
SINR mean = -1.7272255420684814
E[H^H] = 1e-07
E_MSE (Error Power) = 12.75780200958252
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7622, 0.0279, 0.0054, 0.4232, 0.3258, 0.6653, 0.5792, 0.1707, 0.8690,
        0.8323, 0.6511, 0.1145, 0.7067, 0.7803, 0.7968, 0.0888, 0.5866, 0.7543,
        0.3404, 0.0571], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([195, 831, 988, 401, 465, 256, 307, 590, 120, 147, 264, 654, 230, 183,
        172, 690, 303, 200, 455, 748], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
--------SNR = 9-----------
Real SNR = tensor([11.6939,  4.5838,  8.1095,  8.0258,  8.4308, 10.0421,  5.8117,  3.9187,
         8.6686,  8.5988,  5.7444,  8.2598,  4.0774, 10.8196,  6.9048,  9.1715,
         6.8188,  4.9374,  8.9987,  6.0155], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([10.6413-4.2917e-07j,  1.8124-8.2613e-09j, 10.0422-2.5626e-08j,
         8.0908-1.0418e-07j,  1.9395-7.7486e-07j,  5.9765+2.3842e-07j,
         0.5604-1.8331e-08j,  0.8062+2.5607e-08j,  6.2337+2.6063e-07j,
         3.5148-1.4650e-08j,  2.1877+4.1723e-07j,  6.9507+3.7563e-08j,
         1.2515-1.5600e-08j, 10.9537-0.0000e+00j,  4.4593+8.6382e-08j,
         3.3880+2.0286e-08j,  3.9164+1.3495e-08j,  7.7932+1.3181e-07j,
         7.5630+3.0650e-07j,  1.2027-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.96420431137085+7.362064291527304e-09j)
torch.linalg.det(H.mH@H) = tensor([ 3.8733+5.6708e-08j,  0.3117-0.0000e+00j,  1.0798-7.8633e-09j,
         0.1961+2.9802e-08j,  0.4056+2.9802e-08j,  5.2306+7.4871e-08j,
         1.0926+3.0982e-08j,  0.3128-8.8356e-09j,  3.0409+1.4858e-08j,
         0.5756+6.4309e-09j,  0.7577+5.0178e-09j,  5.5931+5.9835e-09j,
         0.2969-7.4091e-09j, 12.6977+2.9043e-07j,  0.4332+4.4703e-08j,
         1.9503+5.9605e-08j,  1.1692+3.8077e-08j,  0.1982-6.5193e-09j,
         2.7101-1.9604e-08j,  0.1721-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.104877233505249+3.185185093457221e-08j)
SINR torch.Size([20]) = tensor([ 6.0870, -0.2000,  5.0778, -4.0402, -1.7980,  8.4081,  4.4172,  0.4523,
         6.7319,  2.2715,  2.9032,  8.7440,  1.3668,  9.9863, -0.0227,  5.1666,
         5.1420, -4.5898,  6.4463, -4.6484], device='cuda:0')
SINR mean = 2.89509654045105
E[H^H] = 1e-07
E_MSE (Error Power) = 0.783943235874176
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.8024, 0.4885, 0.7630, 0.2829, 0.3979, 0.8739, 0.7344, 0.5260, 0.8249,
        0.6279, 0.6612, 0.8822, 0.5780, 0.9088, 0.4987, 0.7667, 0.7657, 0.2579,
        0.8152, 0.2553], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([168, 361, 194, 496, 417, 116, 213, 339, 153, 278, 258, 110, 308,  89,
        355, 192, 193, 515, 159, 517], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nonoisenosample_pefect_estimate/
