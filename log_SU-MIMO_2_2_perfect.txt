Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6331, 0.7854, 0.6502, 0.7924, 0.5607, 0.5562, 1.0437, 0.4510, 0.6230,
        0.6187, 0.5298, 0.5912, 0.5910, 0.6297, 0.6507, 0.9634, 0.4686, 0.9956,
        0.5815, 0.6080], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -8.1798,  -7.7011,  -7.3189,  -5.5508, -14.4680,  -9.1163,  -9.1976,
         -3.3596,  -6.4183,  -7.0191,  -6.9416,  -3.3982,  -5.4242,  -9.1093,
         -7.2589,  -3.4559,  -6.1625,  -7.3985,  -9.1783,  -6.9090],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 172.3635+4.8004e-06j,  125.4632+7.6294e-06j,  690.0325+9.9435e-07j,
         235.0301+2.5842e-07j,  356.9937-7.4636e-06j,  287.7244+6.1035e-05j,
          80.3386-6.3928e-07j, 2726.3948-3.7903e-05j,  127.9474+7.4506e-07j,
        1347.4805-1.2584e-05j,  920.9402+2.4468e-06j,  146.2019-2.8610e-06j,
        1762.4933+3.0532e-06j,   93.7387+8.1423e-07j,   97.3147+6.9653e-06j,
          76.5514+5.3181e-06j,   89.2352+2.8024e-07j,  134.8042+7.1098e-07j,
        1094.2911+2.1819e-05j,   56.6349-2.2850e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(531.0987548828125+2.656726110217278e-06j)
torch.linalg.det(H.mH@H) = tensor([0.3550-0.0000e+00j, 0.0993-3.7253e-09j, 0.2620+1.4090e-10j,
        2.0015+5.9605e-08j, 0.0197-9.3132e-10j, 0.0748+1.4092e-08j,
        0.0900+3.4839e-09j, 2.8941+1.1146e-07j, 0.4463-1.4901e-08j,
        0.0898-8.0094e-08j, 0.0576+3.3391e-08j, 5.1992-1.3629e-08j,
        2.3148+7.4267e-08j, 0.0516+9.3132e-09j, 0.5753-6.7068e-09j,
        7.5372+8.9714e-08j, 0.9765+5.9605e-08j, 4.4108-8.3251e-09j,
        0.1234+1.9249e-09j, 2.3583+1.2687e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.496867299079895+1.64974576222221e-08j)
SINR torch.Size([20]) = tensor([-13.1736, -21.4453, -12.8517,  -9.4666, -18.6960, -17.9341, -18.0267,
         -8.5000, -15.5354, -21.1088, -23.2077,  -5.4834,  -7.1961, -21.4721,
         -9.8972,  -4.1070, -11.2357,  -5.5784, -14.7816,  -7.2464],
       device='cuda:0')
SINR mean = -13.347189903259277
E[H^H] = 1e-07
E_MSE (Error Power) = 44.08720397949219
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0459, 0.0071, 0.0493, 0.1016, 0.0133, 0.0158, 0.0155, 0.1238, 0.0272,
        0.0077, 0.0048, 0.2205, 0.1602, 0.0071, 0.0929, 0.2798, 0.0700, 0.2168,
        0.0322, 0.1586], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([775, 963, 766, 671, 906, 890, 892, 642, 834, 957, 998, 545, 601, 964,
        684, 498, 723, 548, 816, 603], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = -4-----------
Real SNR = tensor([ -4.1248,  -6.2189,  -1.7836, -13.7345,  -2.0875,  -3.9077,  -2.5164,
         -5.0369,  -3.6757,  -5.5249,  -5.6193,  -3.2079,  -4.7977,  -4.7727,
         -5.9036,  -6.6550,  -9.4872,  -3.6574,  -7.7467,  -4.2929],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([8.1083e+02-4.0054e-05j, 1.3271e+02-3.8147e-06j, 3.8869e-01+2.4024e-06j,
        3.2248e+02-1.0264e-06j, 1.5153e+02-2.7543e-06j, 3.6097e+02+1.7593e-06j,
        1.8694e+02+7.9708e-07j, 8.3236e+00+5.3779e-08j, 7.7716e+01+2.3804e-06j,
        1.2726e+01-8.1656e-07j, 3.0262e+02+7.4265e-06j, 2.7529e+02-8.8122e-06j,
        4.5192e+02-5.7380e-06j, 1.3780e+03-5.0972e-06j, 5.0105e+01+5.7220e-06j,
        1.4906e+02+1.3199e-05j, 1.2026e+02+7.5258e-07j, 4.5315e+01+4.5557e-07j,
        3.3670e+02-8.2566e-06j, 3.0174e+01-5.9605e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(260.2045593261719-2.1008702333347173e-06j)
torch.linalg.det(H.mH@H) = tensor([4.8852e-01+1.3411e-07j, 2.4452e+00+2.9729e-08j, 6.8170e+00-3.8228e-07j,
        1.6145e-02+1.6298e-09j, 4.5132e+00+2.4870e-07j, 1.9980e+00+3.7242e-08j,
        6.7207e+00-5.5249e-08j, 7.7960e-01+1.2112e-07j, 1.7577e+00+1.7192e-08j,
        2.3104e+00+3.3349e-08j, 3.4621e-02-1.1176e-08j, 1.7022e-04-2.6892e-08j,
        2.1051e+00-1.8606e-08j, 9.4328e-01-1.1921e-07j, 1.5478e+00-8.4887e-08j,
        2.4814e-01+7.6293e-08j, 3.3057e-02+4.2841e-08j, 5.6678e+00-8.9879e-09j,
        6.7993e-01+9.3101e-10j, 3.8113e+00-9.4058e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.145878553390503-2.910866880867502e-09j)
SINR torch.Size([20]) = tensor([-14.8742,  -6.4736,  -4.6061, -19.7349,  -5.9358,  -6.9196,  -4.5580,
        -12.8768,  -7.6612,  -6.6691, -26.6046, -47.8921,  -6.6351, -10.0346,
         -7.9256, -17.8390, -21.2104,  -4.6212,  -9.3405,  -5.4264],
       device='cuda:0')
SINR mean = -12.391950607299805
E[H^H] = 1e-07
E_MSE (Error Power) = 2982.919677734375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([3.1526e-02, 1.8383e-01, 2.5720e-01, 1.0518e-02, 2.0314e-01, 1.6892e-01,
        2.5932e-01, 4.9033e-02, 1.4628e-01, 1.7717e-01, 2.1807e-03, 1.6247e-05,
        1.7832e-01, 9.0252e-02, 1.3884e-01, 1.6181e-02, 7.5107e-03, 2.5653e-01,
        1.0426e-01, 2.2279e-01], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 818,  578,  515,  928,  560,  592,  513,  767,  616,  584, 1000, 1000,
         583,  688,  624,  887,  959,  516,  668,  543], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = -3-----------
Real SNR = tensor([ -0.2004,  -1.4733,  -5.3535,  -4.3599,  -3.4173, -11.5767,  -5.4901,
         -4.5467,  -2.9720,  -5.6613,  -0.8507,  -5.4966,  -4.6454,  -0.8501,
         -2.7740,  -3.5897,   1.5923,  -3.3539,  -2.7111,  -3.5214],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 50.4283+1.1075e-06j, 340.0904-2.4040e-06j,  30.1758-2.4989e-06j,
         11.3606+3.9530e-08j,  72.2311-3.7368e-07j,  22.7577-3.8147e-06j,
         76.8083+5.9775e-07j,   8.5930+7.8066e-07j, 294.8033+6.0409e-07j,
          9.8903+1.7285e-06j,  72.4650+1.5056e-06j, 137.3716+1.3665e-06j,
        150.4112-2.0473e-06j, 167.1143-3.1586e-06j, 219.2228+6.8665e-05j,
        106.6969+8.2531e-07j,  71.5279+8.3313e-07j, 107.2218+1.6596e-06j,
         29.7936-4.7684e-07j,  17.8795+2.1025e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(99.8421630859375+3.3520675515319454e-06j)
torch.linalg.det(H.mH@H) = tensor([7.3971e-01+1.0791e-08j, 3.1408e+00-1.1336e-07j, 1.1409e-01-9.5217e-09j,
        1.5797e+00+1.8306e-08j, 4.2585e-01+5.8668e-08j, 1.9669e-02+5.5879e-09j,
        6.4141e-01-4.9478e-08j, 1.0292e+00-8.9407e-08j, 5.4860e+00-4.8231e-08j,
        3.3356e-01-4.4327e-10j, 1.5692e+00-5.3644e-07j, 9.3133e-01-8.9407e-08j,
        1.0202e+00-8.9407e-08j, 4.9795e+00-1.4997e-07j, 6.6959e-01-9.5779e-09j,
        3.4191e-03-2.8196e-07j, 8.5688e+00-7.8839e-08j, 5.0347e+00-1.1168e-07j,
        3.8211e+00+8.5097e-08j, 2.2203e+00-2.4681e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1164023876190186-7.51978106450224e-08j)
SINR torch.Size([20]) = tensor([-12.4569,  -6.0346, -17.0068,  -7.0637, -13.1004, -20.8206, -12.2384,
         -8.5985,  -2.7443, -10.3538, -10.7337,  -9.1845,  -9.4925,  -5.2484,
         -9.0944, -35.9894,  -5.3028,  -3.7082,  -4.5852,  -6.8615],
       device='cuda:0')
SINR mean = -10.530936241149902
E[H^H] = 1e-07
E_MSE (Error Power) = 203.7351837158203
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([5.3743e-02, 1.9949e-01, 1.9532e-02, 1.6431e-01, 4.6687e-02, 8.2102e-03,
        5.6359e-02, 1.2133e-01, 3.4708e-01, 8.4397e-02, 7.7879e-02, 1.0767e-01,
        1.0104e-01, 2.2997e-01, 1.0967e-01, 2.5174e-04, 2.2776e-01, 2.9863e-01,
        2.5812e-01, 1.7081e-01], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 756,  563,  869,  597,  773,  951,  750,  645,  450,  697,  708,  663,
         672,  537,  660, 1000,  539,  484,  514,  590], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = -2-----------
Real SNR = tensor([-3.8065, -5.2110, -4.8211, -2.4491, -2.1373, -4.7905,  0.0814, -7.5121,
        -8.1522, -7.3468, -8.2883, -3.9072, -6.4168, -6.6734, -7.1351, -2.1220,
        -4.9230, -9.6206, -5.4875,  0.1257], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.9111e+01+1.3234e-08j, 6.1435e+01-3.5742e-07j, 1.0113e+02+3.0753e-06j,
        2.3704e+02-4.1819e-06j, 2.9770e+01+7.4304e-07j, 7.2000e+01-0.0000e+00j,
        4.3845e+01+8.0478e-07j, 6.6726e-02-4.2647e-08j, 1.1298e+02+1.7825e-05j,
        5.9027e+01+4.7721e-07j, 8.4895e+01+2.1244e-06j, 3.5183e+02+1.4577e-06j,
        6.7898e+00+1.5795e-06j, 1.9925e+01+6.1989e-06j, 1.1566e+01+1.1921e-06j,
        1.7509e+02-0.0000e+00j, 3.9347e+01-1.9073e-06j, 7.2378e+00-5.3330e-08j,
        2.4453e+02+7.5812e-07j, 1.1242e+02+2.3223e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(90.50208282470703+1.6014372477002325e-06j)
torch.linalg.det(H.mH@H) = tensor([1.8856-2.9911e-08j, 2.0245+1.0768e-08j, 0.0843-6.9891e-08j,
        1.6897+2.4128e-09j, 1.4664-2.0620e-08j, 0.2801+8.6147e-09j,
        3.0054-3.1713e-07j, 0.2939+9.6988e-09j, 0.1908-1.1781e-09j,
        0.0817+6.2981e-09j, 0.0497-3.3528e-08j, 0.6567+1.0860e-08j,
        0.1794+3.6682e-09j, 0.6550-1.8357e-08j, 0.0516+9.3132e-09j,
        3.7552+3.5763e-07j, 0.8226+4.4795e-08j, 0.4432+1.8626e-09j,
        0.7679-3.2446e-09j, 5.2322-6.3640e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1807914972305298-1.7151677855764547e-09j)
SINR torch.Size([20]) = tensor([ -4.8258,  -7.2132, -18.8718,  -6.2582,  -5.9423, -10.9897,  -7.7891,
        -10.4348, -10.9575, -13.3234, -18.9959,  -7.4284, -11.3729,  -7.3647,
        -20.7785,  -5.2996,  -7.5165,  -9.6101,  -6.1579,  -2.9362],
       device='cuda:0')
SINR mean = -9.703322410583496
E[H^H] = 1e-07
E_MSE (Error Power) = 18.55085563659668
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2476, 0.1596, 0.0128, 0.1914, 0.2029, 0.0737, 0.1426, 0.0830, 0.0743,
        0.0445, 0.0124, 0.1531, 0.0679, 0.1550, 0.0083, 0.2279, 0.1505, 0.0986,
        0.1950, 0.3371], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([523, 602, 910, 571, 560, 716, 620, 700, 715, 779, 913, 609, 726, 607,
        950, 539, 611, 676, 567, 457], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = -1-----------
Real SNR = tensor([ 0.8943, -2.2261, -2.4660, -1.9365, -4.7578, -5.7829,  1.4601, -1.3028,
        -0.4868, -4.5138,  0.7656, -0.9907, -2.8503, -1.7056, -2.1529, -7.3648,
        -1.0056,  0.9123, -3.5831,  0.9168], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  2.0175+3.8334e-07j,  14.4327-1.5620e-07j,  27.1478-2.6371e-07j,
        354.2376+7.6575e-06j, 150.8906-7.6294e-06j,   4.4425+1.4399e-06j,
         42.6993+3.2501e-06j,  13.0479+4.7684e-06j,   7.9864-2.3842e-06j,
          0.5140-5.5881e-08j,  69.4947+2.6031e-06j,  54.7011-1.4603e-06j,
        119.8699-2.1285e-06j,  43.2563-1.9073e-06j, 135.3250+7.6294e-06j,
         80.7962+7.9180e-07j,  96.2370+3.1432e-07j, 105.2839-5.5790e-07j,
         46.9339+2.8664e-07j,  13.3422+2.3842e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(69.13282775878906+6.409790671568771e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.6636-5.8137e-08j,  0.2000+2.5521e-08j,  1.6189+7.8931e-09j,
         0.9865-2.8795e-09j,  0.4075-3.4401e-08j,  0.2304+1.0369e-09j,
         0.3665+1.2779e-07j,  2.8048+1.1921e-07j,  3.5284-2.7593e-07j,
         0.5323-5.3823e-10j,  0.7728+4.4245e-08j,  0.6572+6.8726e-08j,
         1.0561+1.5292e-08j,  1.9798-2.2288e-08j,  0.1409-1.8254e-07j,
         0.1284-5.0031e-09j,  3.1842-6.8203e-09j,  0.3772+6.7530e-08j,
         0.4218+2.9802e-08j, 10.6867+8.5681e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.537192463874817+2.0951063106622314e-10j)
SINR torch.Size([20]) = tensor([-1.0638e+01, -1.1269e+01, -3.4058e+00, -7.8347e+00, -9.3146e+00,
        -9.4733e+00, -1.5854e+01, -5.5264e+00, -2.8117e+00, -6.5326e+00,
        -1.0227e+01, -9.7478e+00, -5.6894e+00, -3.3972e+00, -1.4482e+01,
        -1.1517e+01, -2.4398e+00, -1.2859e+01, -1.0971e+01, -1.2311e-02],
       device='cuda:0')
SINR mean = -8.200085639953613
E[H^H] = 1e-07
E_MSE (Error Power) = 9.204553604125977
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0795, 0.0695, 0.3134, 0.1414, 0.1048, 0.1014, 0.0253, 0.2188, 0.3436,
        0.1818, 0.0867, 0.0958, 0.2125, 0.3138, 0.0344, 0.0659, 0.3631, 0.0492,
        0.0740, 0.4993], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([706, 723, 474, 621, 667, 672, 842, 546, 453, 580, 694, 680, 552, 473,
        808, 730, 440, 767, 715, 355], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 0-----------
Real SNR = tensor([ 2.3675,  1.0303,  1.1734,  1.2797,  1.4326, -4.9613, -2.1910, -1.5646,
        -3.3704, -2.1299, -1.1229, -1.0761, -4.0309,  1.9371, -0.3750, -1.3768,
        -3.9032, -1.0905, -1.0679,  2.4397], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 40.9626+1.3546e-06j,  74.5371-4.8377e-07j,   0.9751+1.7223e-08j,
          7.6645-2.1944e-06j,   6.6098+1.8111e-07j,  11.7871-4.3384e-07j,
          1.3744+7.9847e-08j,   7.7630+7.8043e-07j, 219.2304+1.0955e-06j,
          8.8403-3.6287e-07j,  22.2388+2.0255e-07j,  78.8613-0.0000e+00j,
          5.7982-7.6847e-08j, 138.2133-7.6329e-08j,   8.0630-2.3842e-07j,
         31.5431-4.7807e-07j,  75.7555+1.3491e-06j, 131.4112-3.7161e-07j,
         54.7305+3.6913e-07j, 123.3453-1.1944e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(52.485225677490234+2.969149548448513e-08j)
torch.linalg.det(H.mH@H) = tensor([1.4246e+01+1.9058e-07j, 3.9748e+00-1.1921e-07j, 3.4947e+00-9.1631e-08j,
        8.9512e-01+1.3336e-08j, 2.2885e-01-8.7225e-08j, 5.2737e-01-1.4901e-08j,
        3.7666e+00+4.5468e-08j, 3.3500e+00+2.3880e-09j, 1.1706e-01+1.0431e-07j,
        1.6364e+00-1.7881e-07j, 2.9686e+00+3.5427e-08j, 1.4989e+00-2.9802e-08j,
        2.4180e-01-0.0000e+00j, 3.8507e+00-1.6253e-08j, 1.7577e+00-4.5603e-08j,
        1.1432e+00-0.0000e+00j, 5.6265e-03-7.6195e-09j, 3.2370e-02+1.7051e-08j,
        1.8156e+00-0.0000e+00j, 4.3079e+00-1.3729e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.492961883544922-1.5989281010320155e-08j)
SINR torch.Size([20]) = tensor([  1.6732,  -2.6510,  -1.1615,  -9.2731, -14.5513,  -6.9933,  -2.6417,
         -1.7514, -13.2447,  -4.4625,  -2.0584,  -4.1329,  -9.8022,  -1.7663,
         -4.0546,  -5.7235, -24.7781, -18.3043,  -3.8702,  -1.9279],
       device='cuda:0')
SINR mean = -6.573787689208984
E[H^H] = 1e-07
E_MSE (Error Power) = 21.438051223754883
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5951, 0.3520, 0.4335, 0.1057, 0.0339, 0.1666, 0.3525, 0.4005, 0.0452,
        0.2636, 0.3837, 0.2786, 0.0947, 0.3997, 0.2822, 0.2112, 0.0033, 0.0146,
        0.2909, 0.3908], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 298,  447,  395,  666,  810,  595,  447,  416,  777,  510,  426,  499,
         681,  416,  496,  553, 1000,  898,  490,  422], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 1-----------
Real SNR = tensor([-3.1893,  2.0322, -0.0225,  2.2655,  0.1028, -1.8395, -3.6196, -2.7118,
         2.1236,  2.9999, -1.4762, -1.9603,  0.9597,  2.3879,  4.1767, -4.2387,
        -0.6053,  2.0604, -1.8399, -5.2283], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  6.4629+6.3441e-07j, 111.0989+1.8202e-06j,  37.0831+2.4600e-07j,
          0.1638-2.9802e-08j,   3.9166-2.3842e-07j,  48.4792-2.3506e-07j,
          3.4998-8.8392e-07j,   5.3191-4.7684e-07j,  10.2616+2.7857e-06j,
         52.5311-9.1581e-07j,  11.2772+5.0106e-07j,  47.2172+6.5038e-09j,
         31.9063+5.4934e-07j,  49.8674-9.3030e-08j, 104.6734+4.8129e-06j,
         19.0413+2.1469e-07j, 135.1308+1.2079e-06j,   1.4303-2.0130e-08j,
         41.2389-3.8147e-06j,   0.2928+4.6392e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(36.044586181640625+3.0378106430362095e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.6495-6.6360e-09j,  1.3073+6.6050e-08j,  2.2995+6.2210e-09j,
         5.4987-8.5710e-08j,  1.2794+2.9810e-08j,  1.7210-1.4644e-09j,
         1.0051+4.3685e-08j,  0.4055-1.3039e-08j,  1.8447-3.9610e-09j,
        13.4153-1.3130e-07j,  1.6333-5.0255e-08j,  0.4489-1.6144e-08j,
         0.5396-7.9295e-08j, 12.7701-4.7539e-08j,  2.6589-1.3235e-07j,
         1.2467-2.6967e-08j,  0.4583-2.1898e-08j,  0.1358+4.1114e-08j,
         0.2710-1.4901e-08j,  0.2772-6.9248e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4932801723480225-2.2575322944362597e-08j)
SINR torch.Size([20]) = tensor([ -3.8588,  -5.7552,  -0.4787,   0.4139,  -3.5739,  -1.5440,  -4.5599,
         -8.9871,  -3.6990,   2.7682,  -3.2276,  -5.1260,  -7.9133,   2.1220,
         -2.9391,  -1.9313,  -7.3117, -12.9965,  -8.0255,  -6.5539],
       device='cuda:0')
SINR mean = -4.158865928649902
E[H^H] = 1e-07
E_MSE (Error Power) = 3.5685391426086426
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2914, 0.2100, 0.4725, 0.5238, 0.3051, 0.4120, 0.2592, 0.1121, 0.2991,
        0.6542, 0.3223, 0.2350, 0.1392, 0.6198, 0.3370, 0.3906, 0.1566, 0.0478,
        0.1361, 0.1811], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([489, 554, 371, 340, 479, 408, 514, 657, 484, 262, 467, 533, 624, 283,
        457, 422, 605, 770, 627, 580], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 2-----------
Real SNR = tensor([-1.9073,  3.6869, -0.5353, -2.0635, -1.5568,  0.7890,  0.8621, -3.7795,
         0.8705, -1.8253,  1.4076,  3.1435,  3.3256,  3.2536,  3.3263,  2.5851,
         1.9365,  0.7144,  1.2356, -0.2141], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 17.4037+5.4919e-08j,  19.2572-2.2311e-07j,   1.5519-1.5470e-09j,
          5.8085-4.6837e-08j,  39.1613-7.2404e-08j,  36.2386+5.9538e-07j,
         23.7723-9.5367e-07j,   4.0350+6.2063e-08j,   2.1526-4.1723e-07j,
         17.9127-1.5777e-06j,   0.9073+8.6427e-07j,  21.4369-5.2209e-06j,
         11.3685-4.7684e-07j,  78.4372-7.1761e-07j,  26.2218+2.4799e-07j,
          6.1131+3.0994e-06j,  96.9504+1.4943e-06j, 127.5775-1.7049e-06j,
          9.1386+7.1526e-07j,  32.4544-2.4415e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(28.894983291625977-2.2616450223722495e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1196-1.8626e-09j, 7.1822-4.2430e-08j, 0.0707-3.7719e-08j,
        0.4712-3.0826e-09j, 0.9626-1.3233e-08j, 0.7133+3.1665e-08j,
        3.5941+1.0512e-08j, 0.4079-8.5400e-10j, 0.6519+5.9605e-08j,
        1.3169-2.8159e-08j, 1.9048+5.9605e-08j, 2.2577-1.2591e-08j,
        1.2374-5.9605e-08j, 0.2557-1.1921e-07j, 7.1595+2.2596e-07j,
        2.6765+2.9733e-08j, 0.9831-7.4506e-09j, 1.6443+1.8626e-08j,
        0.7172+1.0013e-07j, 0.5366+4.0119e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7431617975234985+1.0682529527628049e-08j)
SINR torch.Size([20]) = tensor([-11.1110,   2.1891, -13.5397,  -3.7888,  -2.3683,  -6.5298,   0.5153,
         -4.6149,  -4.4251,  -1.2287,  -3.6980,  -2.8013,  -4.8073, -12.5166,
          2.5301,  -0.8962,  -5.8018,  -2.3970,  -5.5331,  -3.6172],
       device='cuda:0')
SINR mean = -4.222009658813477
E[H^H] = 1e-07
E_MSE (Error Power) = 4.186585903167725
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0719, 0.6234, 0.0424, 0.2948, 0.3670, 0.1819, 0.5296, 0.2568, 0.2652,
        0.4297, 0.2991, 0.3441, 0.2484, 0.0530, 0.6417, 0.4486, 0.2082, 0.3654,
        0.2186, 0.3030], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([719, 281, 784, 487, 437, 580, 337, 515, 509, 397, 484, 452, 522, 758,
        270, 386, 556, 438, 547, 481], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 3-----------
Real SNR = tensor([ 1.6862,  1.7274,  1.6664,  4.2053,  0.2409,  6.0374, -4.0683,  1.1261,
         1.9126,  2.1094,  2.0953, -3.7262, -0.2539,  0.7187, -4.9500,  2.8226,
         1.2635,  2.1289,  0.0498,  0.6975], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.8540-4.1350e-08j,  0.3239-1.2253e-08j,  3.1307-6.5489e-08j,
         0.0766+4.6194e-07j,  3.8913-1.0359e-07j, 13.5267+7.5977e-08j,
         3.2631-1.5530e-08j,  5.1252-1.1178e-07j, 24.5491-1.4067e-07j,
        32.6731-5.6845e-07j, 16.3848-3.9534e-08j,  6.3545+1.3220e-07j,
         7.2479-4.4784e-07j, 35.1349+6.9651e-07j,  7.1379-2.2620e-08j,
        24.2697+7.3958e-07j,  1.1172-3.4914e-09j, 61.3000-1.1366e-06j,
         6.0583-1.3796e-07j,  1.1994-8.9407e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(12.980926513671875-8.174939836180783e-08j)
torch.linalg.det(H.mH@H) = tensor([1.3252e+00+3.1392e-08j, 7.4073e-01-3.3472e-08j, 2.3645e+00+5.6942e-09j,
        1.8859e+00+3.5763e-07j, 5.3478e-01-3.5134e-08j, 1.0692e+00+2.8240e-08j,
        5.2495e-01+2.9802e-08j, 4.9047e-01-6.8804e-08j, 1.6222e+00+3.1402e-08j,
        2.5211e+00+3.7297e-09j, 2.7540e+00-1.2289e-08j, 2.2928e-01-1.8626e-08j,
        1.1440e+00-8.9827e-09j, 1.3687e+00-5.9605e-08j, 1.0298e-03+4.5839e-10j,
        1.9949e+00+1.7998e-09j, 6.4380e-01-1.1921e-07j, 3.9838e-01+3.7187e-09j,
        4.5685e-01-2.9802e-08j, 1.6184e+00-5.4373e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1844223737716675+2.678330446315158e-09j)
SINR torch.Size([20]) = tensor([ -0.6582,  -5.4792,   0.7186,  -2.9861,  -3.4043,  -4.5348,  -3.9774,
         -5.5203,  -0.5431,   1.4154,   0.4640,  -5.8874,  -0.4826,  -1.6436,
        -29.5323,   0.5786,  -5.0409,  -4.3387,  -4.4540,  -0.7432],
       device='cuda:0')
SINR mean = -3.8024799823760986
E[H^H] = 1e-07
E_MSE (Error Power) = 45.65938186645508
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4622, 0.2207, 0.5413, 0.3346, 0.3135, 0.2603, 0.2858, 0.2191, 0.4688,
        0.5808, 0.5267, 0.2050, 0.4722, 0.4065, 0.0011, 0.5333, 0.2385, 0.2691,
        0.2639, 0.4573], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 377,  545,  330,  459,  474,  513,  493,  546,  373,  306,  338,  558,
         371,  412, 1000,  335,  530,  506,  510,  380], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 4-----------
Real SNR = tensor([ 4.1713, -0.0664,  1.8850,  2.5109,  6.2202,  2.6754,  3.9267,  6.1039,
         5.4456,  1.2699,  3.3807,  7.8970,  0.4558,  0.8998,  8.4981, -2.5878,
         1.8521, -1.8036,  2.1934,  1.9711], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.3577-1.4901e-07j, 10.3858+4.7684e-07j,  9.4178-5.3212e-07j,
        15.5506+4.0642e-07j, 15.5337-3.4995e-07j,  3.2384+2.0908e-07j,
         3.2972-4.1844e-08j, 14.1748+2.5713e-08j, 29.7240-1.2423e-06j,
         9.3522-7.0865e-08j, 18.6435+9.3537e-08j,  1.6713-5.5210e-08j,
         1.3062+1.2224e-08j,  8.9374+2.5901e-09j, 30.0497-4.4413e-06j,
         0.1443-1.3039e-08j, 14.5005+3.9467e-07j,  0.3170-1.4901e-08j,
         9.5298+1.5819e-07j,  1.5967+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(9.936439514160156-2.5358224320370937e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.3286-1.0431e-07j,  0.0584-4.2841e-08j,  1.4809-8.1858e-09j,
         0.8412-2.9802e-08j, 10.2344-1.0748e-07j,  1.5345-4.8203e-09j,
         2.5389-3.5763e-07j,  4.2899-6.4055e-08j,  4.3544+5.8149e-08j,
         0.0194-2.5921e-09j,  1.3479-9.9169e-09j,  8.6643+1.4651e-07j,
         0.6784+1.9287e-08j,  0.1954+3.7253e-08j,  4.2160-2.3842e-07j,
         0.6668+7.9128e-09j,  3.0014-5.8061e-08j,  1.8508-1.1028e-08j,
         0.5718+1.2185e-08j,  0.6790+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.377612829208374-3.193161646208864e-08j)
SINR torch.Size([20]) = tensor([ -8.0268, -12.8218,  -0.3915,  -2.1263,   5.4292,   0.5035,  -1.0174,
          0.9603,   3.2383, -15.1270,  -0.7581,   3.6268,  -1.1114,  -8.1887,
         -0.8554,  -1.2873,   2.5071,   1.8212,  -1.2899,  -4.2321],
       device='cuda:0')
SINR mean = -1.957362413406372
E[H^H] = 1e-07
E_MSE (Error Power) = 3.885092258453369
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1361, 0.0496, 0.4775, 0.3800, 0.7773, 0.5290, 0.4417, 0.5551, 0.6782,
        0.0298, 0.4565, 0.6974, 0.4364, 0.1318, 0.4509, 0.4264, 0.6404, 0.6033,
        0.4263, 0.2740], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([627, 766, 368, 429, 185, 337, 390, 322, 248, 824, 381, 236, 393, 632,
        384, 399, 271, 293, 399, 502], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 5-----------
Real SNR = tensor([ 4.2668,  2.3394,  6.9458,  0.2636,  5.2230,  5.0359,  1.1320,  4.7127,
         0.4566,  0.7049,  2.2206,  5.7587,  3.1864,  2.2756,  2.5467,  0.0496,
         2.6829, -0.9728,  6.5082,  4.1347], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.0148e+00-1.2841e-07j, 9.5263e+00+5.3755e-07j, 2.8475e+00+3.2709e-08j,
        1.0576e+00-5.1953e-09j, 7.0180e-03-9.0804e-08j, 3.8157e+00+1.8274e-07j,
        3.4064e+01+7.7800e-08j, 3.9145e+00-4.4799e-08j, 8.1984e-01+4.7718e-08j,
        2.3223e+00-7.1526e-07j, 8.0107e-01-4.9705e-09j, 2.8613e+01+2.5347e-07j,
        2.8421e+00+2.0749e-08j, 1.8233e+01-1.3681e-07j, 6.2955e-01-0.0000e+00j,
        1.1992e+01-8.0578e-08j, 2.5041e-01+7.4506e-09j, 1.1142e+00+6.5565e-07j,
        6.4782e+00+4.8624e-08j, 4.1948e+01-9.5103e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.914558410644531-1.4669069514638977e-08j)
torch.linalg.det(H.mH@H) = tensor([1.4310+7.2062e-08j, 0.6093+8.9407e-08j, 1.4060+5.2154e-08j,
        0.3408+7.5701e-09j, 0.6635+2.0759e-08j, 2.1597-4.2681e-08j,
        1.1987+5.9605e-08j, 2.5096-8.2150e-09j, 0.3731-1.4901e-08j,
        0.4999-1.2671e-08j, 0.0369+1.4435e-07j, 3.5400+3.4238e-08j,
        0.5377-1.2435e-08j, 0.2733-1.4901e-08j, 0.0096+3.2383e-08j,
        0.8394+7.5387e-09j, 0.4533+1.0117e-08j, 0.3677-8.9407e-08j,
        1.6614-4.1148e-09j, 2.7198-6.0531e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0815386772155762+1.624048984183446e-08j)
SINR torch.Size([20]) = tensor([  0.8964,  -3.3551,  -1.6662,  -2.6596,  -2.1687,   1.9014,  -0.0574,
          1.2117,  -2.0302,  -0.5475, -15.2923,   3.2417,  -2.5726,  -5.8101,
        -18.7913,  -0.0323,  -2.9240,  -3.9382,   0.5200,   3.6372],
       device='cuda:0')
SINR mean = -2.521862745285034
E[H^H] = 1e-07
E_MSE (Error Power) = 6.194639682769775
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5514, 0.3159, 0.4052, 0.3515, 0.3777, 0.6077, 0.4967, 0.5693, 0.3852,
        0.4685, 0.0287, 0.6784, 0.3561, 0.2079, 0.0130, 0.4981, 0.3378, 0.2877,
        0.5299, 0.6979], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([324, 472, 413, 448, 430, 290, 356, 313, 425, 373, 828, 248, 444, 556,
        908, 356, 457, 492, 337, 236], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 6-----------
Real SNR = tensor([ 6.5574,  3.5969,  6.2272, -1.4687,  4.8260,  7.3792,  4.2350,  2.6046,
         7.3380,  5.3395,  8.3952,  3.9422,  5.3416,  7.8693,  5.8750,  0.6865,
         5.6919,  2.8342,  5.4627,  4.2739], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([5.4129e+00-1.0058e-07j, 9.2765e+00+1.0972e-07j, 2.0788e+01-1.9073e-06j,
        1.8215e-04-9.3278e-09j, 3.3293e-01+3.8370e-07j, 1.8167e+00-5.7169e-07j,
        5.5820e-01+1.0431e-07j, 3.0803e+00+1.2219e-08j, 1.6335e+00+5.4421e-08j,
        1.0697e+00-0.0000e+00j, 7.0753e+00-3.1647e-07j, 5.7310e+00-1.1921e-07j,
        1.9654e+01-3.4567e-07j, 1.6727e+01+7.4389e-07j, 6.1474e+00-1.3574e-07j,
        6.6605e-01-3.8720e-07j, 1.4011e+00+3.0725e-09j, 8.3157e+00-2.9166e-07j,
        4.5759e-02+6.3962e-09j, 2.8575e+00-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.62947416305542-1.383583736469518e-07j)
torch.linalg.det(H.mH@H) = tensor([0.7528-9.2257e-09j, 4.1188+2.9706e-08j, 0.0979+8.9407e-08j,
        0.0228-1.6135e-09j, 1.5402+1.9806e-08j, 4.2075-2.9252e-08j,
        0.4540+4.4703e-08j, 0.7167-6.1608e-09j, 0.7237+7.6785e-08j,
        1.5234+5.9605e-08j, 0.8053-8.9407e-08j, 0.6332+1.4901e-08j,
        0.4373+1.6391e-07j, 8.4596-6.5772e-08j, 0.7439-3.7665e-08j,
        1.0695-0.0000e+00j, 2.2862-3.0059e-08j, 0.1517-1.3335e-09j,
        2.6418-2.8470e-08j, 2.4450+5.2143e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6915651559829712+1.260045667805798e-08j)
SINR torch.Size([20]) = tensor([ -1.5814,   5.3054,  -9.6340, -11.3034,   3.4457,   4.5462,  -3.8269,
         -0.6386,  -2.5837,   2.0324,  -4.5407,  -1.4570,  -4.0679,   6.9619,
          0.3256,   0.1218,   3.6328,  -4.3971,   4.7376,   4.3387],
       device='cuda:0')
SINR mean = -0.4291315972805023
E[H^H] = 1e-07
E_MSE (Error Power) = 1.985915184020996
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4100, 0.7723, 0.0981, 0.0690, 0.6886, 0.7402, 0.2929, 0.4633, 0.3555,
        0.6149, 0.2601, 0.4169, 0.2816, 0.8324, 0.5187, 0.5070, 0.6977, 0.2665,
        0.7485, 0.7309], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([410, 188, 676, 724, 241, 209, 488, 377, 445, 286, 513, 405, 497, 147,
        343, 350, 236, 508, 204, 215], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 7-----------
Real SNR = tensor([ 8.6657,  3.9170,  5.6482,  5.6945,  4.9065, 10.1124,  6.5437,  6.6150,
         6.2777,  5.7944,  1.8190,  9.1894, 10.1570,  0.3780,  9.4008,  6.5181,
         1.0884,  8.3342,  9.4770,  9.1412], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([14.2798-1.4629e-08j,  0.3709+6.2741e-09j, 22.8175+3.3165e-07j,
         4.9856+5.3540e-08j,  0.8769-9.4985e-10j, 18.1494-1.0464e-07j,
         0.8613+1.5355e-08j,  1.4182-5.7582e-08j,  5.0610+1.0362e-07j,
         0.4605-1.1373e-08j,  7.5943-7.5892e-08j,  2.6529-3.7703e-09j,
         0.7095+5.8115e-07j,  1.5965+4.4703e-08j, 20.5272-2.7157e-07j,
         5.1169+1.1921e-07j,  1.0707-1.4901e-08j,  1.0863-2.1487e-08j,
         9.1887+7.7077e-08j,  2.1916-2.4962e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.050792217254639+3.654091429439177e-08j)
torch.linalg.det(H.mH@H) = tensor([0.8073-1.9425e-08j, 0.6862-7.7830e-10j, 1.2396+2.0793e-08j,
        0.8914-7.1857e-09j, 1.6070-5.4630e-09j, 8.3371+2.3374e-07j,
        0.5967+3.6958e-09j, 1.1484-2.2804e-09j, 0.8354-9.9961e-08j,
        1.5588+1.8871e-08j, 0.3633+4.2757e-10j, 3.7868-5.5547e-08j,
        1.2907-1.9326e-08j, 0.2840-5.3056e-09j, 6.2357-4.1316e-08j,
        6.8493-3.1984e-08j, 0.0373-1.4755e-08j, 1.5700-0.0000e+00j,
        2.3127-7.2147e-08j, 8.2979-9.0961e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.436781644821167-9.445638049498939e-09j)
SINR torch.Size([20]) = tensor([-1.2114,  2.3921,  2.9385, -0.3384,  4.4096,  6.8071, -1.4135,  0.8908,
         0.3026,  4.2083, -0.7395,  3.9888, -0.4857,  0.6931,  6.2231,  7.3011,
        -7.8539,  2.2523,  1.7989,  6.7199], device='cuda:0')
SINR mean = 1.9441887140274048
E[H^H] = 1e-07
E_MSE (Error Power) = 0.8561121821403503
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4307, 0.6343, 0.6630, 0.4805, 0.7341, 0.8274, 0.4193, 0.5511, 0.5174,
        0.7249, 0.4575, 0.7147, 0.4721, 0.5398, 0.8074, 0.8431, 0.1408, 0.6268,
        0.6021, 0.8245], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([397, 274, 257, 366, 213, 151, 404, 324, 344, 219, 380, 225, 371, 331,
        165, 140, 622, 279, 294, 153], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 8-----------
Real SNR = tensor([ 9.3447,  0.3223, 10.5107,  8.1093,  0.6196,  9.3125, 11.4435,  8.4886,
         8.9555,  3.0086,  5.6666,  6.7484,  4.9238, 10.7893,  8.5474,  6.6773,
         9.8892,  8.1104,  9.2387,  7.1526], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.2152e+00-2.7940e-08j, 1.1036e+01+3.7284e-07j, 1.1709e+00-9.7913e-09j,
        2.3976e+01-5.8597e-07j, 6.7140e+00-3.1431e-07j, 2.2717e+01-1.6319e-07j,
        2.1999e+00-3.4771e-09j, 1.2586e+01+1.2421e-08j, 3.1253e-01+2.9802e-08j,
        2.0639e+00+6.7405e-09j, 4.7911e+00+6.9360e-08j, 6.2808e+00-3.1636e-07j,
        2.0050e+00-5.6902e-08j, 5.9169e+00-6.1816e-09j, 5.4485e+00+2.3842e-07j,
        5.9284e+00-7.4033e-08j, 7.3629e+00-9.5367e-07j, 3.4478e-02-2.2908e-08j,
        3.6276e+01+7.2391e-07j, 4.5159e-01+6.0128e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.924378395080566-5.376203304763294e-08j)
torch.linalg.det(H.mH@H) = tensor([2.7537+5.5685e-08j, 0.1809+2.7702e-09j, 3.9890+3.0841e-08j,
        0.5315+5.0171e-08j, 0.1642-1.1176e-08j, 9.9784-4.4818e-09j,
        2.4442-5.5497e-08j, 4.6069+7.6988e-08j, 3.4013+1.1921e-07j,
        0.1252+1.7854e-09j, 0.8345-9.0632e-09j, 1.4768-7.4506e-08j,
        0.0851-1.5600e-08j, 0.1135+1.4021e-07j, 5.6890-1.9984e-08j,
        0.4084+6.5319e-09j, 4.9482+5.9605e-08j, 0.4379+7.4668e-09j,
        4.8203-8.8921e-09j, 4.2655-7.1502e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.562725782394409+1.724558273963339e-08j)
SINR torch.Size([20]) = tensor([  5.3530,   0.0559,   5.8976,  -0.8489,  -0.9041,   9.3759,   2.6789,
          6.0969,   5.2899,  -2.5516,   2.8268,   2.8599,  -5.9751, -10.1972,
          6.9865,  -0.4232,   6.0292,  -0.8255,   8.1077,   7.7393],
       device='cuda:0')
SINR mean = 2.378596067428589
E[H^H] = 1e-07
E_MSE (Error Power) = 1.1611920595169067
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7743, 0.5032, 0.7954, 0.4513, 0.4481, 0.8965, 0.6495, 0.8028, 0.7717,
        0.3572, 0.6572, 0.6589, 0.2017, 0.0872, 0.8332, 0.4757, 0.8003, 0.4526,
        0.8661, 0.8559], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([187, 352, 173, 384, 386,  99, 265, 168, 189, 444, 261, 260, 561, 693,
        147, 369, 170, 383, 122, 130], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
--------SNR = 9-----------
Real SNR = tensor([ 7.1043,  7.0100, 11.0110,  4.7859,  8.9317,  9.0950,  7.7135,  5.7035,
        10.9832, 11.8808, -2.4663,  7.7382, 10.4533,  8.9516,  8.0649,  6.1327,
         5.2222,  4.6211, 10.3972,  8.6471], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.7900-1.4967e-08j,  3.2780-5.0495e-08j,  3.3200+3.0653e-07j,
         2.2057-3.1701e-09j,  0.5646-6.8677e-08j,  8.4995-2.5075e-07j,
         1.4820+9.2387e-07j,  0.8880+1.5593e-08j,  5.1179-1.0035e-08j,
         9.3223-7.0867e-07j,  0.1742+5.0953e-09j,  1.4880+1.4773e-07j,
        16.5327+6.3225e-07j, 14.6294-2.3866e-07j, 10.7283-4.7461e-08j,
         3.9325-1.0870e-07j,  0.3077+4.3130e-08j,  1.4569+1.1489e-07j,
         4.9851+2.2154e-08j,  1.2173-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.596001625061035+3.548336735548219e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0701e+00+6.0737e-10j, 1.5305e-01-3.1958e-09j, 8.6325e-01-2.8732e-08j,
        9.0913e-02-2.0489e-08j, 1.4257e+00+7.9553e-08j, 2.4915e+00+1.9101e-08j,
        1.2907e+00-4.4703e-08j, 4.1494e-03-3.6720e-09j, 2.6813e+00+4.2319e-08j,
        6.7728e+00-5.0460e-08j, 2.1061e-02+4.8969e-10j, 9.4671e-01-6.6192e-08j,
        5.3031e+00-2.6282e-08j, 2.7868e+00-1.1278e-07j, 2.5343e+00-2.3842e-07j,
        7.6660e-01-3.7790e-10j, 1.5235e-01-2.3036e-09j, 6.0362e-01-2.6678e-08j,
        1.3797e+00+8.9577e-09j, 1.1200e+00-1.7737e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6228868961334229-2.4549860810907376e-08j)
SINR torch.Size([20]) = tensor([  4.5603,  -3.4572,   2.3992,  -4.3481,   4.6146,   6.7019,   2.8004,
        -18.6209,   5.9729,   7.8392,  -4.8739,   2.1274,   8.5389,   5.4257,
          6.2129,   3.7840,  -1.8899,   1.5161,   3.8569,   4.5304],
       device='cuda:0')
SINR mean = 1.8845402002334595
E[H^H] = 1e-07
E_MSE (Error Power) = 3.4581284523010254
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7408, 0.3109, 0.6347, 0.2687, 0.7432, 0.8239, 0.6558, 0.0136, 0.7982,
        0.8588, 0.2456, 0.6201, 0.8772, 0.7772, 0.8070, 0.7050, 0.3929, 0.5864,
        0.7085, 0.7395], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([209, 475, 274, 506, 207, 153, 261, 905, 171, 128, 524, 283, 114, 185,
        165, 231, 420, 303, 229, 210], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/dynamic_perfect_estimate/
20 images are saved in outputs/SU-MIMO/t=2_r=2_t=2/nosample_perfect_estimate/
