Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
合計 100 枚の画像をロードしました。20 枚ずつのチャンクで処理します。

--- 処理中: 画像 1 から 20 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 0)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.7532, 0.6074, 0.6583, 0.7701, 0.8240, 0.5942, 0.6361, 0.7516, 0.5557,
        0.6154, 0.4440, 0.5926, 0.5110, 0.4479, 0.4735, 0.6824, 0.6127, 1.1112,
        0.5368, 0.5905], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -5.0830,  -8.0368, -10.7868,  -9.6976,  -3.1170,  -6.5815,  -5.7792,
         -6.5199,  -4.9271,  -7.3144,  -3.2417,  -6.2238,  -4.4832,  -2.6371,
        -10.9990,  -7.7502,  -4.5699,  -4.1332,  -2.3597,  -2.5263],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.9616e+01+4.9326e-06j, 2.5533e+02+6.9972e-06j, 4.0306e+01+5.4150e-07j,
        4.2875e+02+3.1446e-06j, 6.0269e+02+9.9547e-06j, 4.3388e+02+1.6602e-05j,
        7.4426e+02+5.1292e-06j, 5.1240e+02+5.6471e-06j, 1.6766e+03+1.8476e-05j,
        8.5867e+01-7.6294e-06j, 6.6246e+01+7.6203e-06j, 3.9216e+01-3.0923e-06j,
        1.0824e+00+2.5570e-05j, 6.0038e+02+3.9092e-06j, 1.6227e+02-6.7553e-05j,
        4.2100e+01+6.6757e-06j, 3.1034e+02+1.3184e-05j, 2.0787e+01+2.8610e-06j,
        8.5563e+02-9.1553e-05j, 2.1440e+02+1.6609e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(357.108642578125-1.0986244660671218e-06j)
torch.linalg.det(H.mH@H) = tensor([ 4.6158+1.1889e-08j,  0.0635-6.3890e-09j,  0.0127+1.1091e-09j,
         0.0288+2.8156e-10j,  6.7963-2.3340e-09j,  1.2088+5.4613e-08j,
         0.3640+7.8543e-08j,  1.0311-1.3500e-08j,  1.6589+3.4246e-08j,
         2.8166-2.3842e-07j,  0.9064-2.9802e-08j,  1.8752-4.2550e-08j,
         1.2462+7.2327e-08j, 11.9300+1.5886e-07j,  0.4480+1.0863e-08j,
         0.2812-0.0000e+00j,  3.8361+7.2497e-09j,  5.7309+2.7478e-07j,
         2.7833+2.6906e-08j,  3.0041-2.1739e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.53190279006958+9.064364370203748e-09j)
SINR torch.Size([20]) = tensor([ -8.6694,  -2.7333,  -4.7382,  -0.1912,  -1.6813,  -1.8805,  -2.2766,
         -0.3567,  -0.7743,  -3.7522,  -6.3498,  -5.5936, -24.5006,  -0.5776,
         -4.5567,  -9.3661,  -3.8759,  -8.4159,   0.0880,  -4.2941],
       device='cuda:0')
SINR mean = -4.724795341491699
E[H^H] = 1e-07
E_MSE (Error Power) = 17.498035430908203
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1196, 0.3477, 0.2514, 0.4890, 0.4044, 0.3934, 0.3719, 0.4795, 0.4555,
        0.2965, 0.1881, 0.2162, 0.0035, 0.4668, 0.2594, 0.1037, 0.2906, 0.1259,
        0.5051, 0.2712], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 647,  450,  520,  361,  413,  420,  434,  367,  381,  486,  574,  549,
        1000,  374,  513,  668,  490,  640,  351,  504], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -4-----------
Real SNR = tensor([-1.7257, -7.5621, -3.2151, -9.8260, -7.3110, -5.9083, -5.5032, -7.4651,
        -5.4033, -4.8359, -7.7917, -3.8875, -4.3147, -5.2532, -1.5774, -8.1645,
        -2.9432, -4.2344, -3.5323, -5.4608], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 390.2339+4.7901e-07j,  165.2236+3.1595e-06j,   65.7262+3.8131e-06j,
          11.0054+2.1896e-06j,  175.7928+1.4403e-06j,  574.2599-1.9207e-05j,
          82.8697-0.0000e+00j,   39.9379+1.9073e-06j,  138.9313-1.5259e-05j,
          55.8747+3.6337e-07j,  105.0686-6.3876e-06j,  212.1159+7.6294e-06j,
          85.8149-0.0000e+00j,  153.1881+9.5367e-06j,   51.8008-4.7632e-07j,
         353.3090-0.0000e+00j,   11.3493-1.6689e-06j,   64.9240+2.7243e-07j,
        1215.8683-2.9297e-05j,   23.2025-8.0275e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(198.82484436035156-2.1153668967599515e-06j)
torch.linalg.det(H.mH@H) = tensor([6.0666e+00+1.4631e-09j, 1.1132e+00-1.0110e-08j, 6.9543e+00+3.3137e-08j,
        4.4725e-01+3.9429e-08j, 3.1914e-01-5.5381e-08j, 1.5517e+00-5.8676e-08j,
        9.6043e-02-1.8999e-07j, 1.7635e+00-2.1386e-08j, 6.2353e-01+5.5395e-09j,
        1.9684e-02-1.8626e-09j, 4.7727e-03-1.1874e-08j, 6.8471e+00+3.0946e-08j,
        2.3660e+00+9.6626e-09j, 4.8576e-01+1.4617e-08j, 7.5983e-01-1.7881e-07j,
        1.0985e+00-5.9605e-08j, 2.5827e+00-4.4183e-08j, 1.1937e+00-7.2271e-07j,
        3.3652e+00-2.6811e-08j, 1.6310e+00-1.5453e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9644697904586792-6.310289535349511e-08j)
SINR torch.Size([20]) = tensor([ -2.1843,  -1.7591,  -7.1359, -11.2178,  -2.7097,   0.5127,  -4.5897,
         -4.2126,  -3.2828,  -2.0651,  -3.4867,  -2.0427,  -1.8904,  -2.1583,
         -3.3154,  -1.3997, -11.7472,  -4.7608,  -0.7573,  -5.1196],
       device='cuda:0')
SINR mean = -3.76611328125
E[H^H] = 1e-07
E_MSE (Error Power) = 3.6925370693206787
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3768, 0.4001, 0.1620, 0.0702, 0.3489, 0.5295, 0.2579, 0.2749, 0.3195,
        0.3833, 0.3094, 0.3845, 0.3929, 0.3783, 0.3179, 0.4201, 0.0627, 0.2505,
        0.4565, 0.2353], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([431, 416, 599, 722, 449, 337, 515, 502, 469, 427, 476, 426, 420, 430,
        470, 403, 737, 520, 381, 533], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -3-----------
Real SNR = tensor([-2.2126, -3.9104, -7.5166, -6.5233,  0.5999, -6.2295, -0.0871, -1.6802,
        -8.3887, -7.2252, -4.9924, -7.5032, -3.3500, -2.1037, -2.5005, -4.7444,
         0.0310, -2.0518, -7.2277, -7.2401], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 27.8943-2.8610e-06j,  45.2341-1.8469e-07j,  10.9927-3.4476e-06j,
        286.7897-3.5009e-06j, 374.1912+3.1568e-06j, 215.0866-3.8546e-06j,
         82.1408-3.8147e-06j,  19.6357-0.0000e+00j,  32.2798-7.6294e-06j,
        225.4246-2.7460e-07j, 333.2755-4.5241e-06j, 159.6727+2.5767e-06j,
         31.0872-9.5367e-07j, 255.4129+2.9238e-07j,   2.8228+4.2915e-06j,
        239.6470-8.2617e-07j,  24.8115-9.5976e-07j,  91.8513+1.6723e-06j,
        267.5657-1.1444e-05j,  49.7943+5.2128e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(138.780517578125-1.3536400729208253e-06j)
torch.linalg.det(H.mH@H) = tensor([1.5114+1.1921e-07j, 2.3590-9.3745e-10j, 0.8927+2.8357e-08j,
        0.7248+8.0954e-10j, 7.3861-3.5253e-08j, 0.0439-3.6770e-09j,
        0.3405+1.3411e-07j, 0.2588+5.0750e-09j, 0.2009+7.4506e-09j,
        0.2097-3.6971e-10j, 1.4877+1.7675e-08j, 0.1436+8.1344e-10j,
        2.4912+1.9313e-08j, 0.0077-1.0705e-07j, 5.0979-4.9768e-08j,
        0.5608+2.2893e-08j, 2.4659+5.2705e-08j, 0.4580+1.4210e-08j,
        0.9227+2.2434e-09j, 0.4903+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4026702642440796+1.2135709326344113e-08j)
SINR torch.Size([20]) = tensor([ -7.9888,  -3.4065,  -8.1890,  -1.3021,   0.2361,  -2.0621,  -3.9657,
         -7.0332,  -4.0598,  -1.1349,   0.2168,  -1.7558,  -5.1736,  -0.7512,
        -17.2152,  -1.2734,  -3.9210,  -1.1439,  -2.6927,  -4.9904],
       device='cuda:0')
SINR mean = -3.8803162574768066
E[H^H] = 1e-07
E_MSE (Error Power) = 4.71760892868042
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1371, 0.3134, 0.1317, 0.4256, 0.5136, 0.3835, 0.2864, 0.1653, 0.2820,
        0.4350, 0.5125, 0.4003, 0.2330, 0.4569, 0.0186, 0.4272, 0.2885, 0.4345,
        0.3498, 0.2407], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([626, 474, 632, 400, 346, 427, 493, 596, 496, 394, 347, 416, 534, 381,
        873, 399, 492, 394, 449, 528], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -2-----------
Real SNR = tensor([-2.0262, -2.3732, -3.5188, -3.0215, -3.5736, -0.0151, -3.7226, -6.7990,
        -3.3127, -2.5161, -7.6473, -5.5170,  0.2703, -4.1598, -2.2558, -2.0722,
        -0.4313, -8.5699, -3.1664, -0.8472], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 40.0258+1.0240e-06j,   5.0264+2.9802e-07j,  51.5826+4.3869e-05j,
         46.9920-9.5367e-07j,  22.9614-2.5736e-07j,  33.2996+1.9760e-07j,
          2.8359-5.4512e-08j, 180.5296+1.9932e-06j,  23.4256+5.7700e-07j,
         68.9033+7.6968e-06j,  14.3026-1.6812e-07j, 320.2910+1.7907e-06j,
         21.1749+5.2058e-06j,  93.3077+4.4349e-07j,  24.0843-5.2452e-06j,
         11.5512+1.7881e-07j, 238.2174+3.5755e-06j,  21.8411+7.1258e-07j,
         31.9595-1.5199e-07j, 115.5680-2.5346e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(68.39399719238281+3.023914814548334e-06j)
torch.linalg.det(H.mH@H) = tensor([1.6936-1.9445e-08j, 2.2892-1.9893e-08j, 1.2353-9.7636e-09j,
        0.7042-2.6077e-08j, 4.1152+3.7509e-08j, 0.0683-5.9548e-08j,
        0.6322+7.6483e-09j, 0.3892-6.0284e-10j, 0.0302+3.5390e-08j,
        1.5702+4.1776e-10j, 0.3257-1.9178e-09j, 0.8684+9.1759e-10j,
        3.9438+8.5922e-08j, 0.1054+1.0058e-07j, 2.3319+5.3996e-08j,
        1.2910+3.4734e-07j, 0.3956-1.5358e-09j, 0.0365-3.7253e-09j,
        2.8398+7.0861e-08j, 2.5938-3.0459e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3729727268218994+2.8381000660715472e-08j)
SINR torch.Size([20]) = tensor([ -3.5880,  -6.2699,  -3.9908,  -4.0436,  -7.1003,  -5.3449, -11.5015,
         -0.4433,  -4.5290,  -2.5345,  -4.0347,  -0.3480,  -4.9825,  -1.3940,
         -7.9451,  -6.0325,  -0.7854,  -3.7239,  -0.7143,   1.0906],
       device='cuda:0')
SINR mean = -3.9107704162597656
E[H^H] = 1e-07
E_MSE (Error Power) = 3.223928213119507
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3045, 0.1910, 0.2852, 0.2827, 0.1632, 0.2261, 0.0661, 0.4745, 0.2606,
        0.3581, 0.2831, 0.4800, 0.2410, 0.4204, 0.1383, 0.1996, 0.4549, 0.2979,
        0.4590, 0.5625], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([480, 571, 494, 496, 598, 540, 730, 370, 512, 443, 495, 366, 528, 403,
        625, 563, 382, 485, 379, 317], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = -1-----------
Real SNR = tensor([ 0.5585, -2.9911, -7.0075, -6.0627, -2.2460,  1.2090, -1.1840, -4.5676,
        -3.0903, -3.1404, -1.8225, -2.2418, -5.5733, -4.1186, -2.6907, -2.9998,
        -3.7340,  0.6316, -0.9172, -1.4081], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  7.3767+4.7684e-07j,  10.8501+9.5367e-07j, 132.4845-5.7968e-06j,
         15.5609-1.4305e-06j,  28.3917+1.5179e-07j,  18.9472+7.4238e-07j,
         29.2590-1.9617e-06j,  17.7174+1.4305e-06j,  19.4985+7.2852e-08j,
         25.8140-1.1302e-06j,  92.7383-3.7166e-07j,  69.0125-1.2827e-06j,
          2.1939+2.4957e-07j,  79.0141+4.9929e-06j,   2.5421+3.9339e-06j,
        169.6259-1.0167e-05j,  44.2997-9.8675e-08j,  73.4155-0.0000e+00j,
        103.8153+3.0163e-06j,   6.1263+2.8610e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(47.434165954589844-1.6790259849130962e-07j)
torch.linalg.det(H.mH@H) = tensor([6.8218+2.4319e-07j, 1.3968-3.0772e-09j, 0.3445+1.4901e-08j,
        1.4156-1.3838e-08j, 0.2098-5.4948e-08j, 0.0702-1.0713e-08j,
        2.0468-4.8118e-08j, 0.0222-1.1176e-08j, 0.6466+3.5684e-09j,
        0.0441-7.0781e-08j, 1.5437-5.0330e-08j, 0.9666+2.4591e-08j,
        0.5348-5.6374e-09j, 0.1980+7.4506e-09j, 0.7572-4.8605e-09j,
        1.1157+2.0323e-08j, 0.0725-5.9605e-08j, 4.4665+7.8100e-09j,
        2.9202-5.6119e-08j, 3.4640+1.4069e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4528764486312866+3.6658924784660485e-09j)
SINR torch.Size([20]) = tensor([-11.0884,  -3.6586,  -1.1596,  -3.1135,  -1.9248,  -3.0826,  -5.6395,
         -4.6194,  -2.8996,  -5.1863,   0.5067,   0.4072,  -8.9798,  -2.5849,
        -12.1688,  -0.7814,  -1.3598,   1.1787,   0.6863, -10.7909],
       device='cuda:0')
SINR mean = -3.812955617904663
E[H^H] = 1e-07
E_MSE (Error Power) = 4.311307430267334
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0722, 0.3010, 0.4336, 0.3281, 0.3910, 0.3296, 0.2144, 0.2566, 0.3390,
        0.2325, 0.5291, 0.5234, 0.1123, 0.3554, 0.0572, 0.4551, 0.4224, 0.5674,
        0.5394, 0.0769], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([718, 482, 395, 463, 422, 462, 550, 516, 456, 535, 337, 340, 657, 445,
        748, 382, 402, 314, 331, 710], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 0-----------
Real SNR = tensor([-0.6264,  0.3387, -2.0888,  0.2299, -5.5445, -0.4095, -1.4740, -5.8180,
        -4.1179, -6.4612, -3.2838,  0.3735, -2.3379,  1.9756, -2.1963, -3.2420,
         1.0992,  0.5839, -1.4184, -7.7848], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  2.6093+2.9802e-07j,  87.3767+6.9403e-07j,  26.7592+4.0311e-08j,
          5.1482-0.0000e+00j,   5.6040-2.9142e-06j, 107.2395+2.3636e-07j,
         86.6783-3.8389e-06j, 112.1736-7.6563e-07j,   9.1852+9.3430e-07j,
          6.6991+1.1921e-06j,  58.9487+8.0682e-07j,  17.8829+2.2377e-08j,
          0.6905+2.4362e-06j,   2.6421-1.6391e-06j,   7.7422-1.0265e-07j,
         38.2382+2.9072e-06j,  41.0205+4.6061e-07j,  99.2949+7.6067e-07j,
          1.1103+1.4044e-07j,  24.9151-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(37.09792709350586+8.344591151399072e-08j)
torch.linalg.det(H.mH@H) = tensor([3.2103-3.1541e-08j, 1.0104-6.2478e-09j, 1.1633+2.8717e-08j,
        6.9470+1.9794e-08j, 0.2506-2.2352e-08j, 1.0997-9.7323e-08j,
        1.3854+1.5274e-09j, 0.0944-1.2820e-09j, 0.6542+3.1263e-09j,
        0.0618-1.8626e-09j, 1.3827-1.5679e-09j, 3.3727-3.2193e-08j,
        1.5313+8.7954e-09j, 3.5395-1.1023e-07j, 0.7021+1.3372e-08j,
        0.2687-4.7883e-10j, 3.3048-8.0621e-09j, 2.2363-5.4636e-09j,
        1.9448-4.2257e-09j, 0.1589-1.7128e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7159379720687866-1.2460522391677387e-08j)
SINR torch.Size([20]) = tensor([ -7.6129,   0.1832,  -1.5714,  -6.7943,  -8.1940,   0.8615,   0.7866,
         -0.3704,  -2.9725,  -6.2526,  -1.1642,  -3.6346, -16.2304, -10.6325,
         -1.9764,  -3.7260,  -3.7441,   2.2054,  -9.9537,  -3.7147],
       device='cuda:0')
SINR mean = -4.225399971008301
E[H^H] = 1e-07
E_MSE (Error Power) = 5.342347145080566
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1477, 0.5105, 0.4105, 0.1730, 0.1316, 0.5494, 0.5452, 0.4787, 0.3353,
        0.1916, 0.4334, 0.3022, 0.0233, 0.0796, 0.3882, 0.2978, 0.2969, 0.6243,
        0.0918, 0.2983], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([614, 348, 409, 588, 633, 325, 327, 367, 458, 570, 395, 482, 851, 705,
        423, 485, 485, 280, 686, 484], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 1-----------
Real SNR = tensor([-0.7829,  1.2926, -2.6188, -2.7102, -5.9454,  0.3798, -0.3759, -7.5666,
         2.2182, -1.9474,  2.9863, -2.2437,  0.2903, -1.1965, -4.8219, -6.2364,
        -0.1952,  2.1776, -3.5996,  0.9513], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 62.9279-5.1932e-07j,   7.1677+2.1194e-06j, 141.7809+5.4303e-08j,
          2.1066-7.1526e-07j,  57.6388-2.1614e-06j,  11.1221-1.9865e-07j,
         26.0182+7.2410e-07j,  21.7711+4.1239e-07j,   7.2747+5.9662e-09j,
          2.6608-0.0000e+00j,  56.1766-2.8023e-06j,  18.9646+6.6610e-08j,
          5.8739+2.3842e-07j,  41.6166-0.0000e+00j,   3.0077-4.7991e-07j,
         19.3468+3.8147e-06j,  25.1547-6.6973e-07j,  15.8067-1.3390e-07j,
         37.9215-5.7785e-07j,  10.7415-4.7684e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(28.75396156311035-6.496488680340917e-08j)
torch.linalg.det(H.mH@H) = tensor([0.4841-6.6201e-09j, 0.2041+1.2874e-09j, 1.1777-0.0000e+00j,
        0.1370-9.5461e-09j, 0.6929-9.3137e-08j, 0.0319-1.5341e-08j,
        2.7080+6.6049e-08j, 0.1153-2.6776e-09j, 3.8286+2.9516e-07j,
        0.3584+1.4901e-08j, 4.1121-5.4094e-08j, 1.0863+8.5241e-09j,
        1.3414-2.3842e-07j, 0.1199+3.3528e-08j, 0.7498+4.2605e-08j,
        0.0154+1.6298e-09j, 0.2428-5.9605e-08j, 1.0817-1.8198e-08j,
        0.2495-4.9618e-11j, 3.8768+3.9218e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1306743621826172+2.6069033043363277e-10j)
SINR torch.Size([20]) = tensor([-0.0989, -5.0660, -0.4730, -7.0214,  1.2140, -3.7042, -2.1144, -2.1839,
        -5.8620, -7.6971, -0.4996, -2.3367, -6.4913, -1.1350, -8.5686, -2.2018,
        -3.3840, -2.4409, -0.9126, -4.6987], device='cuda:0')
SINR mean = -3.283803939819336
E[H^H] = 1e-07
E_MSE (Error Power) = 2.867166757583618
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4943, 0.2375, 0.4728, 0.1657, 0.5694, 0.2988, 0.3806, 0.3769, 0.2059,
        0.1453, 0.4713, 0.3686, 0.1832, 0.4350, 0.1221, 0.3759, 0.3145, 0.3631,
        0.4477, 0.2531], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([358, 531, 371, 596, 313, 484, 428, 431, 558, 617, 372, 436, 578, 394,
        644, 431, 473, 440, 386, 518], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 2-----------
Real SNR = tensor([ 0.2378,  0.0075,  0.4217,  3.7836,  0.8544,  1.2919, -2.1525, -1.0481,
        -0.1101,  2.1088, -2.4110,  2.7331,  2.7942,  1.5156,  1.7610, -0.8686,
         1.2073, -3.6646, -1.4607,  0.8776], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.9741+1.1921e-07j, 34.7182+3.4346e-07j, 10.2215+5.3203e-08j,
         7.9344-1.2507e-07j, 48.1612-2.3246e-07j, 26.5670+4.7684e-06j,
         9.8630+2.6453e-07j, 10.4459+3.6888e-07j,  6.4505-2.6581e-08j,
         6.5075-3.5763e-07j, 12.9692-2.5314e-07j,  8.9489+2.0313e-08j,
        38.9719+3.3501e-07j, 11.1877-1.7686e-07j,  4.2903-7.2300e-07j,
         3.0355-2.0862e-07j, 22.4821-4.9186e-07j,  5.9172-6.5189e-08j,
        15.1171+3.9625e-08j, 15.2551+1.4305e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(15.200922012329102+2.541360402119608e-07j)
torch.linalg.det(H.mH@H) = tensor([ 1.4608-1.1921e-07j,  0.4447+9.6448e-09j,  0.9018+7.5856e-09j,
        11.7148-8.9515e-09j,  1.0711-3.4484e-09j,  0.0126-1.4560e-07j,
         1.5358+1.5420e-08j,  0.6016+1.6532e-08j,  0.1539-1.1176e-08j,
         0.2361+8.6436e-09j,  0.0415-1.8626e-09j,  0.3310-2.2164e-08j,
         4.8749+2.0377e-08j,  3.1170-6.5266e-08j,  1.3841-1.3193e-08j,
         2.1090-1.7743e-08j,  0.8031-6.5816e-08j,  0.5903+2.4276e-09j,
         0.3481+5.2852e-09j,  2.8225-2.2529e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7277355194091797-2.0552366919446285e-08j)
SINR torch.Size([20]) = tensor([ -6.6832,   0.2349,  -1.1924,  -2.7838,  -0.3511,  -4.4758,  -2.8464,
         -3.6606,  -3.1895,  -3.8170,  -2.4888,  -5.5927,   0.0241,  -1.2590,
        -10.1818,  -5.3279,   2.5068,  -5.5411,  -6.1464,  -3.4993],
       device='cuda:0')
SINR mean = -3.313554525375366
E[H^H] = 1e-07
E_MSE (Error Power) = 2.7798492908477783
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1767, 0.5135, 0.4318, 0.3450, 0.4798, 0.2630, 0.3418, 0.3009, 0.3242,
        0.2934, 0.3605, 0.2162, 0.5014, 0.4280, 0.0875, 0.2267, 0.6404, 0.2183,
        0.1954, 0.3088], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([585, 346, 396, 452, 367, 511, 454, 482, 466, 488, 442, 549, 354, 398,
        692, 540, 271, 547, 567, 477], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 3-----------
Real SNR = tensor([-2.7610,  3.7341, -4.6804, -7.6592, -5.0733,  1.3011,  3.6895,  6.4545,
         4.8184, -0.4112,  2.9218, -1.7959,  3.3585, -3.4674,  5.8192,  3.4663,
         2.0401,  5.4830,  5.0991,  4.0925], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  5.9008+2.2868e-07j,  12.8010+7.6851e-08j,   9.7348+9.5367e-07j,
         69.2264+2.8941e-06j,  24.6346-6.8559e-07j,  24.5107-2.0963e-06j,
          8.1935-1.9956e-08j,   0.9078-4.9477e-08j,  61.6136+2.3632e-06j,
         15.0918+7.8776e-07j,   2.1616-1.7881e-07j,   0.5818+5.0449e-08j,
         10.1857+9.5367e-07j,  16.4963+3.9798e-07j,  39.4421-3.8147e-06j,
          9.4748+5.8650e-07j,  34.8775-4.5902e-08j,  30.8478+4.7684e-06j,
          4.0596-8.9914e-08j, 108.4974+2.3850e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(24.461986541748047+4.73280778123808e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.5133+1.4834e-08j,  1.4979+1.4481e-08j,  0.0346-3.2401e-10j,
         0.0209-4.6566e-09j,  0.4769+1.4901e-08j,  0.5724-0.0000e+00j,
         1.4075-3.5174e-09j, 14.3557+1.6833e-08j,  2.5379-0.0000e+00j,
         1.1066-4.7040e-09j,  3.2847+1.0357e-07j,  0.1096+4.0285e-08j,
         1.2377+1.9851e-08j,  0.0521-1.8626e-09j,  6.0708-3.4003e-09j,
         1.5922-7.3208e-08j,  4.7021+1.9432e-08j, 11.9542+2.7516e-07j,
         2.6808-1.7297e-08j,  0.2523-5.9980e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7230069637298584+1.752009026745327e-08j)
SINR torch.Size([20]) = tensor([ -2.5412,  -0.2773,  -2.4947,   0.0367,  -0.2037,  -0.6891,   0.4941,
        -10.6875,   1.8997,   0.4199,  -6.1739,  -8.4646,  -1.1172,  -3.6800,
         -1.1213,  -3.0295,   3.7386,   0.1902,  -3.4374,   1.7393],
       device='cuda:0')
SINR mean = -1.7699403762817383
E[H^H] = 1e-07
E_MSE (Error Power) = 2.3001949787139893
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3578, 0.4840, 0.3602, 0.5021, 0.4883, 0.4604, 0.5284, 0.0786, 0.6076,
        0.5242, 0.1944, 0.1247, 0.4360, 0.3000, 0.4358, 0.3324, 0.7028, 0.5109,
        0.3119, 0.5988], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([443, 364, 442, 353, 361, 378, 337, 707, 290, 340, 568, 641, 393, 483,
        393, 460, 233, 348, 475, 296], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 4-----------
Real SNR = tensor([ 3.5486,  5.9301, -3.1466, -0.4284, -4.0512,  5.3381, -0.3075,  4.0158,
         2.1213,  3.9775,  3.6649,  5.4915, -1.1375,  1.0153,  1.3382,  1.5550,
        -0.5565,  0.9822,  4.5334,  0.8903], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.7777-7.1526e-07j, 10.7786+1.5435e-07j,  1.0989+1.1234e-08j,
        11.9270-4.7684e-07j,  9.1216+4.8009e-08j,  6.7027-7.2281e-08j,
         0.1466-1.6614e-08j,  5.6492-5.0067e-09j,  2.0023+6.6757e-06j,
        10.5194+4.7684e-07j,  5.6631+4.9711e-08j, 18.4895+3.3379e-06j,
         1.5654+1.8770e-07j,  1.6273+5.9605e-08j,  1.5775+1.9342e-08j,
         2.9448-8.6888e-07j, 14.4468+2.0567e-07j,  1.4518-0.0000e+00j,
         0.6267+8.0466e-07j,  2.5214+7.8486e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.631926536560059+4.977156891072809e-07j)
torch.linalg.det(H.mH@H) = tensor([1.3168-2.0630e-09j, 0.5565-3.4211e-07j, 0.0270+4.6566e-10j,
        0.1524+3.7253e-09j, 0.4548-5.3723e-09j, 2.6995+4.1208e-08j,
        0.3156+3.9762e-09j, 0.7644+2.5641e-09j, 0.3817+1.4901e-08j,
        0.3201-4.0978e-08j, 1.6970+1.1921e-07j, 0.6004-2.5177e-07j,
        0.1880-7.4506e-09j, 0.0200+2.9076e-08j, 0.5081-1.0890e-08j,
        1.4071-2.1316e-08j, 0.3640-2.5447e-11j, 1.6271-2.9802e-07j,
        1.1305+9.3865e-08j, 0.0995+5.3481e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.7315310835838318-3.087643207777546e-08j)
SINR torch.Size([20]) = tensor([ -1.4628,   0.3576,  -4.6907,  -0.6236,  -1.9651,   0.7941, -13.1102,
         -3.4091, -10.0839,  -1.7881,  -1.6711,   0.0418,  -4.4627,  -5.3891,
         -8.0180,  -7.2604,   0.2587,  -6.8258, -14.7683,  -7.0079],
       device='cuda:0')
SINR mean = -4.554235458374023
E[H^H] = 1e-07
E_MSE (Error Power) = 5.9554901123046875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4166, 0.5206, 0.2535, 0.4642, 0.3888, 0.5456, 0.0466, 0.3132, 0.0893,
        0.3985, 0.4050, 0.5024, 0.2636, 0.2243, 0.1363, 0.1582, 0.5149, 0.1720,
        0.0323, 0.1661], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([405, 342, 518, 376, 423, 327, 773, 474, 690, 417, 413, 353, 510, 542,
        627, 603, 345, 589, 815, 595], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 5-----------
Real SNR = tensor([ 0.3849,  4.2788, -1.2595,  3.8018,  2.4894,  6.7945,  2.9495,  3.3454,
         1.8813,  4.5121,  4.2991,  5.0415,  4.5660,  3.7050,  4.2889,  2.0141,
         3.2020,  1.9153,  4.5465,  6.1046], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.4381e+00+7.7748e-08j, 2.1277e+00+4.5235e-08j, 8.8643e+00+2.6965e-07j,
        8.8807e+01-5.3860e-07j, 3.4487e+00-3.1149e-07j, 6.6643e-02+2.5761e-07j,
        1.3636e+00-1.4901e-07j, 3.1891e+01+7.6695e-08j, 1.0907e+00+4.6194e-07j,
        1.0716e+01-5.0835e-07j, 1.3490e+00-1.1921e-07j, 1.6284e+00+3.7607e-07j,
        1.4449e+00+1.0714e-07j, 2.5522e+01-2.8493e-07j, 3.6871e-01-1.5224e-08j,
        3.6267e+00+2.7489e-08j, 7.3986e+00+5.1715e-08j, 4.5196e+01+1.1624e-06j,
        8.8006e-03+4.4568e-08j, 2.0112e+00+2.9802e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(11.9183931350708+6.647422878813813e-08j)
torch.linalg.det(H.mH@H) = tensor([0.0431+4.9940e-10j, 0.5188-1.2427e-08j, 0.0648+3.1223e-10j,
        8.1094+1.1585e-07j, 5.9585-3.8615e-09j, 1.2466+3.1792e-07j,
        1.8544-2.8421e-08j, 2.1227+1.6524e-08j, 0.6680+1.7834e-08j,
        1.7591+2.9802e-08j, 1.3741+1.1129e-07j, 0.1424+3.3239e-08j,
        3.8485+2.4750e-08j, 1.5918+6.7694e-09j, 4.2306+7.9145e-09j,
        0.2083+1.3039e-08j, 0.5231-1.9548e-08j, 1.6630+5.9756e-08j,
        0.4850-1.5251e-08j, 6.2853+1.6660e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.1348705291748047+4.2129546073965685e-08j)
SINR torch.Size([20]) = tensor([ -4.3292,  -3.5486,  -0.4857,   4.5412,  -3.5781, -22.7610,  -2.8787,
          0.9227,  -8.2059,  -0.3490,  -5.4352,  -3.5691,  -4.7753,   0.9882,
        -11.9589,  -1.2772,   3.3494,   2.6506, -26.6360,  -7.6668],
       device='cuda:0')
SINR mean = -4.750129222869873
E[H^H] = 1e-07
E_MSE (Error Power) = 37.221309661865234
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2696, 0.3064, 0.4721, 0.7399, 0.3049, 0.0053, 0.3401, 0.5529, 0.1313,
        0.4799, 0.2224, 0.3054, 0.2498, 0.5566, 0.0599, 0.4270, 0.6838, 0.6480,
        0.0022, 0.1461], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 506,  479,  371,  209,  480,  989,  455,  323,  633,  366,  543,  479,
         521,  321,  742,  399,  244,  266, 1000,  616], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 6-----------
Real SNR = tensor([10.1997,  6.4155,  4.3938,  3.7082,  0.9178,  3.2164,  3.3370,  3.7333,
         6.8480,  5.9357,  4.4242,  1.1354,  3.5291,  5.3455,  5.7278,  4.1330,
         0.9862,  3.2799,  6.9374,  5.5395], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([48.5091-1.1032e-07j,  5.0811-1.2540e-08j, 18.2328-7.5644e-08j,
         7.0632+1.4305e-06j,  1.6501-4.0855e-08j,  4.1771-4.7228e-08j,
         4.9583-6.9519e-08j, 44.3282+3.4585e-08j,  3.5235-7.1133e-08j,
         5.7775+2.3842e-07j,  8.4680+2.9290e-08j,  4.3976-2.2597e-08j,
         0.0497-1.6012e-08j,  1.4342+5.5664e-08j,  1.8745+1.5894e-07j,
         0.3327+8.9407e-08j,  2.7236-1.5821e-08j,  4.8349+3.6230e-07j,
         6.3829-2.3529e-08j,  6.9344-9.5367e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(9.036680221557617+4.701226430370298e-08j)
torch.linalg.det(H.mH@H) = tensor([2.6994e+01+3.7238e-07j, 1.7661e+00+7.8806e-08j, 2.2665e+00-2.1196e-08j,
        1.1521e+00-6.5193e-08j, 4.0123e-01+8.2439e-10j, 6.4957e-01-8.9407e-08j,
        2.7816e-01-7.4506e-09j, 1.5497e+00+2.1963e-08j, 4.8512e+00-1.6932e-07j,
        4.0537e+00-9.5550e-09j, 9.5487e-01+3.5339e-08j, 7.6327e-01-1.0789e-08j,
        8.0097e-03+3.0073e-10j, 1.6099e+00-7.8580e-09j, 3.6829e+00-1.4345e-08j,
        7.8270e-01-3.6319e-08j, 3.2743e-01+6.8020e-11j, 1.9357e+00-1.6765e-08j,
        1.6982e-01+4.3704e-08j, 2.7170e+00+3.9548e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.845672607421875+7.236603760674143e-09j)
SINR torch.Size([20]) = tensor([  4.4781,  -0.5587,   0.1876,  -3.2455,  -4.2470,   0.8301,   0.3575,
          1.5578,  -0.1541,  -3.5680,   0.9497,   1.4020, -12.0844,  -4.1673,
         -9.7801, -10.3732,  -1.9637,  -0.1762,   0.9518,  -5.5923],
       device='cuda:0')
SINR mean = -2.259787082672119
E[H^H] = 1e-07
E_MSE (Error Power) = 3.5643310546875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7371, 0.4679, 0.5108, 0.3214, 0.2733, 0.5476, 0.5206, 0.5887, 0.4911,
        0.3054, 0.5545, 0.5800, 0.0583, 0.2770, 0.0952, 0.0841, 0.3888, 0.4899,
        0.5546, 0.2162], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([211, 374, 348, 468, 503, 326, 342, 302, 360, 479, 322, 307, 746, 500,
        681, 698, 423, 360, 322, 549], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 7-----------
Real SNR = tensor([ 8.3764,  4.9110,  3.8276,  5.4212,  6.7869,  8.9013,  1.9965,  5.8489,
        -0.7843,  6.6264,  8.5752,  6.6147,  7.6349,  7.6991, 10.2502,  2.5459,
         5.1807, 10.6004,  3.8345,  3.1291], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([15.5571+3.8219e-07j, 11.5985-1.3607e-08j,  4.7354-1.2387e-07j,
         2.6482-2.3842e-07j,  9.2301-0.0000e+00j, 12.3589+4.5976e-07j,
         5.1803-2.3842e-07j,  3.9861+1.1921e-07j,  1.2045-6.1859e-08j,
         3.5982+9.6037e-08j, 25.1254+2.6117e-08j,  6.4210-5.7039e-08j,
         9.9838+4.7684e-07j, 12.3485-1.8504e-07j,  4.3441+3.0884e-09j,
         3.2971+3.3131e-08j,  2.8746+4.4614e-11j, 14.2808-8.8017e-08j,
         1.0521-1.0431e-07j,  1.3683+4.0394e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.55965518951416+2.449381497626746e-08j)
torch.linalg.det(H.mH@H) = tensor([8.1200e+00-7.7909e-08j, 5.0971e-02+1.6198e-08j, 9.3788e-01-4.4703e-08j,
        5.1277e+00+1.7082e-08j, 3.9318e+00-7.3634e-08j, 2.3364e+00+7.4527e-09j,
        3.6099e-01+1.6299e-09j, 3.9045e+00+4.4102e-08j, 7.7244e-03-4.4238e-09j,
        3.1212e+00-3.7900e-08j, 8.6007e+00-9.4374e-08j, 2.1379e+00+8.5477e-09j,
        5.0513e+00-4.6999e-08j, 5.8084e-01+5.9296e-09j, 1.0227e+01+8.6717e-08j,
        6.3305e-01+6.4194e-09j, 7.8412e-01-3.6624e-08j, 7.1632e+00-1.0951e-09j,
        1.7700e-01+9.6858e-08j, 1.9254e-01-3.7253e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.1723480224609375-6.522626883054272e-09j)
SINR torch.Size([20]) = tensor([-1.8205,  1.2847,  1.9083, -8.3541,  1.3569,  2.1794,  0.7410, -2.2168,
        -1.6083, -0.5674,  3.4940, -5.9046,  2.0613,  3.1232,  0.4968, -2.2817,
        -2.4543,  2.0738, -7.3317, -3.5654], device='cuda:0')
SINR mean = -0.8692717552185059
E[H^H] = 1e-07
E_MSE (Error Power) = 1.8332408666610718
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3967, 0.5734, 0.6081, 0.1275, 0.5775, 0.6229, 0.5425, 0.3751, 0.4085,
        0.4674, 0.6909, 0.2043, 0.6165, 0.6724, 0.5286, 0.3716, 0.3624, 0.6172,
        0.1560, 0.3056], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([418, 311, 290, 638, 308, 281, 329, 432, 411, 374, 240, 559, 285, 251,
        337, 434, 440, 285, 605, 479], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 8-----------
Real SNR = tensor([ 8.4843, 10.3918, 10.3834,  9.2753,  5.9776,  4.5547,  7.9097,  8.6714,
         1.7405,  6.6766,  8.6439,  7.2351, -0.9843,  3.4972, 11.4620,  8.1812,
         9.2441,  5.4561,  7.4307,  8.5142], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 3.8113+1.3009e-07j, 22.9829-4.7253e-07j, 23.4558+1.2854e-07j,
        52.1207-1.5639e-06j,  3.3850-9.9226e-08j,  0.8935-1.8637e-08j,
         0.4852+3.6528e-08j,  1.8295-1.3945e-08j,  1.1304+1.9132e-08j,
         4.6566-4.7684e-07j,  3.7830-3.8772e-07j,  3.2605+4.1260e-08j,
         0.1971-2.9802e-08j,  0.2373+2.0047e-09j, 17.5441+2.8524e-07j,
        17.0065+1.3523e-07j, 91.4140+8.5058e-07j,  4.9084-1.1921e-07j,
         3.6014+2.9396e-08j,  0.3738+2.9802e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(12.853854179382324-7.470062257652899e-08j)
torch.linalg.det(H.mH@H) = tensor([8.7747e+00+4.4787e-08j, 1.1669e+01+2.2972e-08j, 5.8878e+00-3.9862e-08j,
        5.2964e+00+1.4746e-08j, 1.9707e+00-1.7133e-07j, 4.4177e-03-9.7638e-09j,
        1.9579e+00-6.0028e-08j, 4.8998e-01+5.4839e-09j, 9.0454e-02-3.2546e-09j,
        1.0876e+00+3.6663e-08j, 5.3128e+00-7.2380e-08j, 1.1982e-02-1.2107e-08j,
        1.6196e-02-0.0000e+00j, 2.7691e-01-8.0258e-09j, 4.1564e+00+1.1899e-07j,
        1.9165e+00-5.5237e-09j, 5.5854e+00+8.7037e-08j, 4.4846e-02+1.4790e-08j,
        1.0166e+00+1.3179e-08j, 2.4748e+00+4.0592e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.9020583629608154+8.480284807710348e-10j)
SINR torch.Size([20]) = tensor([-4.0883,  5.6691,  4.9987,  4.9409,  0.8374, -2.4435, -9.8939,  1.0429,
        -1.1518, -0.2087, -1.1139, -0.1346, -6.5747, -5.9883, -0.4496,  4.5294,
         5.3688,  1.2285,  0.8360, -5.7632], device='cuda:0')
SINR mean = -0.4179464876651764
E[H^H] = 1e-07
E_MSE (Error Power) = 2.215284824371338
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2806, 0.7867, 0.7597, 0.7573, 0.5481, 0.3629, 0.0929, 0.5597, 0.4341,
        0.4880, 0.4362, 0.4923, 0.1804, 0.2012, 0.4741, 0.7394, 0.7749, 0.5703,
        0.5480, 0.2097], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([497, 179, 197, 198, 326, 440, 684, 319, 395, 362, 393, 359, 581, 562,
        370, 210, 187, 313, 326, 554], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)
--------SNR = 9-----------
Real SNR = tensor([ 3.8915,  9.1122, 11.8516,  7.6645, 13.5713,  9.2498,  5.0097, 10.6574,
         8.6468, 11.3196,  9.5189,  7.7061,  5.8270,  7.9014,  5.3807, 10.5393,
         3.4761,  9.6496,  9.6986,  8.7139], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.8865+1.5393e-08j,  1.2337+1.7881e-07j,  3.9552+3.6255e-08j,
        40.9392+5.5518e-07j,  6.5108-4.7684e-07j,  0.7837-8.9407e-08j,
         0.4702+1.7489e-08j, 10.8478-7.8298e-10j,  7.6282-1.9566e-07j,
        21.8922+2.8889e-07j,  6.5297-1.1373e-08j,  9.7767-8.7041e-08j,
         0.1694+1.2997e-08j,  1.6256+5.0212e-08j,  0.8066-1.5086e-08j,
        11.4008+2.1077e-07j,  0.1252+2.2352e-08j,  3.9424-3.5763e-07j,
         0.3502+3.0940e-08j,  0.5749+1.4020e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.572452545166016+1.6283427939356443e-08j)
torch.linalg.det(H.mH@H) = tensor([0.5919+2.2273e-08j, 3.3058-4.5801e-08j, 3.5564-1.6199e-07j,
        6.9914-6.2121e-08j, 3.1377-1.8990e-07j, 3.5247+1.5910e-07j,
        0.2226-5.8183e-09j, 2.9625-2.7496e-08j, 2.7072-5.7582e-08j,
        2.0345+9.2100e-08j, 3.2519-7.1789e-08j, 1.0383+1.3395e-08j,
        0.3516-2.7693e-09j, 2.1285-1.3054e-07j, 0.3157+2.0163e-08j,
        7.8769+5.1872e-08j, 0.3393+7.1086e-09j, 3.9265-9.2525e-08j,
        2.8577+6.2924e-08j, 0.6732-8.0181e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.589717149734497-2.497893092368031e-08j)
SINR torch.Size([20]) = tensor([  2.1587,  -3.1369,   2.3462,   4.7317,   1.8078,  -8.3647,  -3.1217,
          6.5136,   1.6628,   6.1999,   3.4648,   5.3394,  -6.6518,  -3.9988,
         -0.8838,   1.5446, -12.0165,  -3.3903,  -9.8600,  -7.4073],
       device='cuda:0')
SINR mean = -1.153112769126892
E[H^H] = 1e-07
E_MSE (Error Power) = 3.2929139137268066
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6218, 0.3269, 0.6319, 0.7483, 0.6026, 0.1272, 0.3277, 0.8175, 0.5946,
        0.8065, 0.6895, 0.7737, 0.1778, 0.2848, 0.4493, 0.5880, 0.0591, 0.3142,
        0.0936, 0.1537], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([282, 464, 276, 204, 293, 638, 464, 158, 298, 165, 241, 187, 584, 494,
        385, 302, 744, 473, 683, 608], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 0)

--- 処理中: 画像 21 から 40 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 20)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5159, 0.4950, 0.6478, 0.5684, 0.4895, 0.5508, 0.6202, 0.6527, 0.5857,
        0.6284, 0.7064, 0.7388, 0.7715, 0.6258, 0.9953, 0.6690, 0.7055, 0.8390,
        0.6214, 0.6514], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -2.7965,  -3.9332, -11.4277,  -1.8905,  -5.4767,  -4.0971,  -3.4047,
         -9.3285,  -6.0444,  -5.1537,  -3.4711,  -3.9703,  -9.4780,  -5.5063,
         -5.0305,  -3.1670,  -1.6709,  -6.5508,  -4.6404,  -5.0603],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  18.8399+3.9339e-06j,  515.5413+1.1607e-05j,   58.4534+6.6663e-07j,
         214.4082-5.0506e-06j,  191.0973+1.8409e-07j,  199.6923-2.6710e-06j,
          42.8506-0.0000e+00j,   14.2992-4.7684e-07j,  111.6483+3.8147e-06j,
         457.5687+3.1110e-06j,  361.9169-1.5259e-05j,  232.7299+3.8147e-05j,
         104.5181-1.5259e-05j,  160.8613-2.4284e-06j,  353.2886-1.0942e-05j,
         358.5468-1.6500e-05j,  353.2841+5.4490e-06j,   69.7772+1.2335e-06j,
          50.9058-1.0147e-07j, 1208.6377+7.6034e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(253.9432830810547-2.6670296193742615e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.9851-4.8783e-08j,  2.4112-7.7184e-08j,  0.1229-0.0000e+00j,
         8.9217-2.1269e-07j,  0.9064-1.1474e-08j,  2.3860-3.3302e-08j,
         1.6024-3.3620e-08j,  0.2929-1.9863e-09j,  0.1361+8.5682e-08j,
         0.2239+6.7055e-08j,  1.1633+9.9092e-08j,  1.9753+2.0862e-07j,
         0.3603-7.4506e-09j,  3.0057-5.1213e-08j,  0.5943+3.4182e-08j,
        10.3122+3.1142e-07j,  5.7456-1.5999e-07j,  2.3322+1.0593e-08j,
         4.2666-5.1714e-08j,  2.8651+6.4448e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.5304677486419678+9.58407309070708e-09j)
SINR torch.Size([20]) = tensor([-11.2377,  -0.1814,  -3.9230,  -2.9617,  -1.7247,  -3.7882,  -4.4005,
         -7.7870,  -3.7889,  -1.5843,  -0.9676,  -3.7174,  -4.7647,  -3.3000,
         -2.0633,  -0.9363,  -0.7524,  -1.5172,  -5.3526,  -0.3495],
       device='cuda:0')
SINR mean = -3.254920244216919
E[H^H] = 1e-07
E_MSE (Error Power) = 2.7810637950897217
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0699, 0.4896, 0.2884, 0.3358, 0.4020, 0.2948, 0.2663, 0.1427, 0.2948,
        0.4098, 0.4445, 0.2982, 0.2503, 0.3187, 0.3834, 0.4463, 0.4568, 0.4135,
        0.2257, 0.4799], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([723, 361, 492, 458, 415, 487, 508, 620, 487, 410, 388, 484, 521, 470,
        427, 387, 381, 407, 540, 367], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -4-----------
Real SNR = tensor([-5.3776, -1.2998, -4.5208, -3.9219, -5.1477, -7.4366, -2.6322, -6.5533,
        -6.0209, -1.1361, -6.5297, -7.9518, -3.2836, -3.7405, -4.5304, -8.4486,
        -2.3887, -7.2033, -1.7810, -4.7151], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([496.0774+3.5839e-06j, 218.7840-2.4243e-06j,  20.5877-1.9710e-07j,
        258.8181+7.6294e-06j, 490.9513+8.9517e-07j, 219.9577-2.2888e-05j,
        105.6162-2.7551e-07j, 463.2173+8.5061e-06j, 522.4814+2.9732e-06j,
         26.1670-1.6321e-07j, 142.7060+2.1728e-06j,  80.6320-3.1568e-06j,
        152.4075+2.1053e-06j, 149.7525-8.3985e-06j,  27.0235+2.6955e-07j,
        626.1818+1.3287e-05j, 111.1912+3.4585e-06j,  11.5779-5.2689e-08j,
         22.8257+1.4778e-06j,  83.2924+6.4022e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(211.5124053955078+4.7212711251631845e-07j)
torch.linalg.det(H.mH@H) = tensor([0.4906+1.8626e-08j, 1.1476+5.9605e-07j, 0.0632-4.4504e-09j,
        2.2415-5.9472e-11j, 0.5907+7.8818e-10j, 0.0590-1.3039e-07j,
        3.3918-3.3292e-08j, 1.7107-2.9802e-08j, 0.3140-4.4703e-08j,
        3.1494+5.5316e-08j, 0.5386+1.1176e-08j, 0.1199-2.6077e-08j,
        0.2847-4.5192e-09j, 3.3107+4.4857e-08j, 1.0912+4.0942e-08j,
        0.1497-7.4506e-08j, 0.5929-2.9817e-08j, 1.2868+4.8722e-09j,
        1.3818-3.9982e-08j, 0.5458+1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.1230170726776123+1.8496562503855785e-08j)
SINR torch.Size([20]) = tensor([-1.9333, -0.3969, -4.4483, -1.9054, -0.7392, -3.3004, -3.0469, -1.8329,
        -1.2010, -5.3507, -2.0160, -3.9621, -3.5621, -0.8420, -4.2085, -1.1833,
        -3.5053, -4.8487, -7.0828, -3.8320], device='cuda:0')
SINR mean = -2.959899663925171
E[H^H] = 1e-07
E_MSE (Error Power) = 2.3928322792053223
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3905, 0.4772, 0.2642, 0.3920, 0.4576, 0.3187, 0.3315, 0.3960, 0.4313,
        0.2258, 0.3860, 0.2865, 0.3057, 0.4517, 0.2751, 0.4323, 0.3085, 0.2467,
        0.1637, 0.2927], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([422, 368, 510, 421, 380, 470, 461, 418, 396, 540, 425, 493, 479, 384,
        501, 396, 477, 523, 597, 488], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -3-----------
Real SNR = tensor([ -4.0742,  -7.0390,  -4.6318,  -0.7708,  -6.5628,  -6.5367,  -4.9177,
         -6.6492,   0.0481,  -3.6409,  -6.8722,  -0.4708,  -2.7170,  -8.6519,
         -3.3809,  -1.8056,  -3.1008, -11.6280,  -3.4981,  -6.2749],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 13.5702-5.4286e-06j,  52.7124-1.0680e-06j,  12.3457+2.4308e-07j,
         98.4025+2.1226e-06j,  89.2265+3.1762e-06j, 186.6965+4.5776e-05j,
        162.2488-4.5920e-06j,  45.6235-1.2574e-06j,  65.6194+3.5996e-07j,
         23.5379-2.5034e-05j,   3.1783+7.0781e-08j, 420.4859+1.0828e-05j,
        112.6856+7.6294e-06j, 123.7818-1.9319e-06j,  72.4031+5.7220e-06j,
         21.9790+1.6850e-08j, 153.4010+7.7018e-06j, 307.1050+4.8152e-06j,
        347.3794-1.4608e-05j, 103.1316+5.3338e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(120.77571105957031+1.7537903431730228e-06j)
torch.linalg.det(H.mH@H) = tensor([0.7949-7.0126e-09j, 0.1953-0.0000e+00j, 0.4371+1.2267e-08j,
        1.4810-6.1324e-08j, 1.0621+1.4829e-08j, 0.0397+5.6724e-09j,
        0.0486+1.1554e-07j, 0.2211-1.7472e-08j, 3.0602-1.2780e-07j,
        2.4311-1.0739e-08j, 0.5775-7.7006e-09j, 4.5003+4.8040e-08j,
        1.8095+1.2027e-08j, 0.3279+4.7174e-10j, 1.3645-2.9960e-08j,
        6.5421+1.1061e-07j, 3.5183+2.7067e-09j, 0.0103+3.7253e-09j,
        2.8128+2.5323e-08j, 1.0306-2.5536e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6132525205612183+4.332164849074616e-09j)
SINR torch.Size([20]) = tensor([ -8.7511,  -4.1912,  -3.9848,  -6.4381,  -1.7252,  -2.3249,  -1.8641,
         -3.4896,  -1.0212,  -9.4058, -14.6883,   0.5633,  -1.5352,  -2.9474,
         -2.7140,  -5.0993,  -2.7184,  -0.9109,  -0.0223,  -3.1214],
       device='cuda:0')
SINR mean = -3.819486379623413
E[H^H] = 1e-07
E_MSE (Error Power) = 4.114169597625732
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1176, 0.2759, 0.2855, 0.1851, 0.4020, 0.3693, 0.3943, 0.3093, 0.4415,
        0.1029, 0.0329, 0.5324, 0.4125, 0.3366, 0.3487, 0.2361, 0.3484, 0.4478,
        0.4987, 0.3277], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([650, 501, 494, 577, 415, 436, 420, 477, 390, 670, 813, 335, 408, 458,
        449, 532, 450, 386, 355, 464], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -2-----------
Real SNR = tensor([-0.6306, -2.3881, -7.5556, -0.7402, -1.6455, -2.6093, -3.0566, -4.5192,
        -4.8769,  0.1226, -2.0824, -5.5254, -7.3934, -5.0979, -2.1967, -3.7405,
        -2.0722, -4.8866, -2.9101, -6.0600], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 15.8102-4.7684e-07j,  13.8690-1.2479e-07j,  11.2934+1.0735e-08j,
          2.1203+1.1499e-07j,  33.5997-8.8426e-07j, 502.6040-8.6643e-06j,
        551.5290-3.8202e-06j,  56.3285-9.0219e-06j,   8.0817-4.8548e-07j,
        119.9570-7.6888e-07j,  59.3042+1.1024e-06j,   5.0956-9.8348e-07j,
         54.7002+9.7091e-07j,  36.5585-5.7377e-07j, 126.1147-5.7800e-06j,
        165.9859+1.5259e-05j,   7.4611-7.0119e-08j, 429.2201+6.1209e-06j,
          3.2476-1.9887e-06j,  11.0607-4.2915e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(110.6970443725586-7.177748670983419e-07j)
torch.linalg.det(H.mH@H) = tensor([1.5657+1.0249e-07j, 0.7853+8.6485e-09j, 0.2986-1.8626e-09j,
        5.8073-0.0000e+00j, 1.6935-2.4097e-08j, 0.1380+9.6488e-09j,
        0.2238-2.5020e-08j, 1.0564-3.9059e-09j, 0.3734+1.1005e-08j,
        0.4611-1.1060e-07j, 0.6111-2.7554e-07j, 1.0027-2.6531e-09j,
        0.2295-4.4703e-08j, 0.1209-2.7056e-08j, 0.0801-1.3784e-07j,
        0.2740+8.1956e-08j, 2.6848-7.3760e-08j, 2.1578+5.0249e-10j,
        0.2819-1.0654e-09j, 0.6835-3.4311e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.0264662504196167-2.586398650805677e-08j)
SINR torch.Size([20]) = tensor([ -3.0977,  -5.2964,  -3.4749,  -8.5622,  -4.0972,   0.9745,  -0.2034,
         -2.8386,  -5.9229,  -0.4387,  -2.7339,  -8.1021,  -1.6239,  -4.7027,
         -2.0183,  -2.5647,  -3.9946,  -0.8070, -10.2693,  -6.7845],
       device='cuda:0')
SINR mean = -3.827915906906128
E[H^H] = 1e-07
E_MSE (Error Power) = 3.330456495285034
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3289, 0.2280, 0.3100, 0.1222, 0.2802, 0.5559, 0.4883, 0.3422, 0.2036,
        0.4748, 0.3476, 0.1341, 0.4076, 0.2530, 0.3859, 0.3565, 0.2850, 0.4537,
        0.0859, 0.1733], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([463, 539, 476, 644, 498, 321, 361, 454, 560, 370, 450, 630, 411, 518,
        425, 444, 494, 382, 695, 588], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = -1-----------
Real SNR = tensor([-1.3924, -1.1144, -1.2759,  0.2780, -1.0552, -0.4120, -3.6871, -0.8490,
        -5.3215, -1.7588, -6.6325, -5.6568, -1.0729, -2.7770,  0.4926, -2.8717,
        -4.9565, -4.4093, -2.3441, -2.6217], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([120.3045-1.5312e-07j,   3.3164-7.4506e-08j, 236.1349-3.8210e-06j,
         37.8120+5.6856e-07j,  27.6900-1.9073e-06j, 254.2751+2.2760e-05j,
        105.0578-6.3259e-07j,  18.9305-2.6822e-07j,  67.1006+1.1370e-06j,
         77.6270-7.6294e-06j,   8.0573+1.1921e-06j,  60.3708+1.1437e-06j,
         15.5403+3.3218e-07j,   8.1639+2.0078e-07j,  19.2359+8.6087e-08j,
         89.3163-0.0000e+00j,  19.4868+3.2201e-07j, 121.4413-3.1447e-07j,
         26.9346+1.3538e-07j,  43.1979+1.4078e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(67.99970245361328+7.242481387947919e-07j)
torch.linalg.det(H.mH@H) = tensor([2.2228-2.9802e-08j, 3.2895+4.2235e-08j, 3.0055+3.5960e-08j,
        2.3616+3.4100e-08j, 2.0790-1.1921e-07j, 3.6516+5.1000e-08j,
        0.4124-1.8426e-08j, 0.5220+7.0930e-10j, 0.1222+7.4506e-09j,
        1.7495+7.9996e-09j, 0.5953-0.0000e+00j, 0.0378-2.2797e-10j,
        1.5209-7.4808e-08j, 1.8942-1.6627e-08j, 6.2312-6.4018e-08j,
        0.1132-6.7055e-08j, 0.0492-3.3528e-08j, 0.9561-7.4506e-08j,
        2.0992-4.3129e-08j, 1.0258-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6969579458236694-1.883914002576148e-08j)
SINR torch.Size([20]) = tensor([-1.1858, -6.4367,  0.6013,  0.6921, -4.7858, -1.3207, -0.0478, -5.0645,
        -0.8287, -0.7889, -8.8945, -2.3674, -4.5401, -8.3562, -3.3663, -1.8144,
        -6.0984, -1.3143, -5.1033, -0.4711], device='cuda:0')
SINR mean = -3.0745723247528076
E[H^H] = 1e-07
E_MSE (Error Power) = 2.6624221801757812
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4322, 0.1851, 0.5346, 0.5398, 0.2494, 0.4246, 0.4972, 0.2376, 0.4524,
        0.4547, 0.1143, 0.3670, 0.2601, 0.1274, 0.3154, 0.3970, 0.1971, 0.4249,
        0.2359, 0.4729], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([396, 577, 334, 331, 521, 400, 356, 531, 383, 382, 654, 437, 513, 638,
        472, 418, 565, 400, 532, 371], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 0-----------
Real SNR = tensor([ 1.6714, -7.6894, -3.4632, -0.7401,  2.4248, -3.1200, -3.0197,  0.5591,
         0.5529,  2.2568, -7.4317,  1.9755,  1.4471, -0.9766, -1.3170, -6.0995,
        -1.4687, -1.1111,  0.0823, -3.4853], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([180.6307+7.1407e-07j,  30.5985-2.0734e-07j, 115.4065-2.2807e-06j,
          1.2810+3.0306e-08j, 545.0882+7.9056e-06j,  29.5760-7.9512e-07j,
        165.4295+5.4656e-07j,  14.6637-2.1453e-07j,  24.7029-3.5763e-07j,
        108.5590-6.1486e-07j,  18.3828+9.5367e-07j,  10.8609+1.9073e-06j,
         29.2908-4.0624e-06j, 238.0413+1.4561e-06j, 331.6989-1.1363e-06j,
         13.2932-2.9566e-07j,  39.4048+5.5823e-07j,  14.9038+1.2709e-07j,
        114.5172-2.4327e-06j, 117.1050+1.1639e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(107.17174530029297+1.4828545147338446e-07j)
torch.linalg.det(H.mH@H) = tensor([8.0140e+00-2.5259e-08j, 1.4823e-04+1.4532e-09j, 2.4699e-01+7.4719e-09j,
        1.4424e+00+1.1921e-07j, 1.2849e+01-6.4015e-07j, 7.7688e-01-1.6106e-08j,
        3.2105e-01-6.9737e-09j, 6.7426e-02+2.0690e-08j, 3.9552e+00-1.6613e-08j,
        8.0561e-01+2.8410e-07j, 1.6030e-01-3.7253e-09j, 3.3299e+00+1.1977e-07j,
        2.3818e+00+1.1921e-07j, 8.7576e-01+4.9360e-08j, 5.8209e+00+1.4726e-07j,
        1.0698e-01-4.5869e-09j, 1.4458e+00+5.9832e-08j, 1.3618e+00-2.4824e-08j,
        2.0598e+00-5.0008e-08j, 1.0596e+00+7.6463e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3540523052215576+7.387683353954344e-09j)
SINR torch.Size([20]) = tensor([ 2.2758, -1.8271, -0.6608, -7.9260,  1.8750, -2.3346, -0.2975, -1.1634,
        -0.4868,  0.1521, -2.4982, -1.7620, -2.4187, -1.7860,  1.7373, -1.7150,
        -0.3705, -0.1413, -0.4799, -1.5676], device='cuda:0')
SINR mean = -1.069754958152771
E[H^H] = 1e-07
E_MSE (Error Power) = 1.5957573652267456
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6281, 0.3963, 0.4620, 0.1388, 0.6063, 0.3688, 0.4829, 0.4334, 0.4720,
        0.5088, 0.3600, 0.3999, 0.3643, 0.3986, 0.5987, 0.4025, 0.4787, 0.4919,
        0.4724, 0.4107], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([278, 418, 377, 624, 291, 436, 365, 395, 371, 349, 442, 416, 439, 417,
        296, 414, 367, 359, 371, 409], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 1-----------
Real SNR = tensor([ 1.1035,  2.6537,  1.0791,  2.0620, -1.1233,  3.7737, -1.8021, -0.8948,
         0.6434, -2.0088, -0.9217,  1.4833, -0.3136, -0.0348,  3.2678,  3.7136,
         0.5136, -4.9467, -0.9467, -3.7189], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 8.6112+4.7684e-07j,  3.5250+3.5763e-07j, 13.4413-1.7105e-07j,
         6.9277+6.0722e-08j,  3.9862-2.4848e-08j,  6.0317+1.2238e-07j,
        17.9887-2.0029e-06j,  5.2030-5.9605e-08j, 17.8862+1.4167e-06j,
        18.3992-8.1401e-08j, 16.9079-3.5169e-07j, 76.1223+1.5104e-06j,
        28.6970+7.1348e-09j,  5.5944-7.1589e-08j, 41.8879+4.8832e-07j,
        93.1786+4.8491e-06j, 36.7833+3.1935e-06j,  5.5166-0.0000e+00j,
        16.4678-1.4901e-07j, 18.8711-7.8023e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(22.101360321044922+4.3951732209279726e-07j)
torch.linalg.det(H.mH@H) = tensor([1.1544+8.3437e-08j, 1.5718+3.5569e-08j, 0.5536+5.8529e-09j,
        3.5439-6.3616e-08j, 0.0210-4.1504e-09j, 0.9606-1.9272e-09j,
        0.6427-1.0965e-08j, 0.4975+2.9802e-08j, 3.2911+9.7967e-09j,
        2.7317+2.2807e-08j, 2.9483-5.9808e-08j, 3.2521+1.9534e-08j,
        2.0768-0.0000e+00j, 0.5807-5.1564e-08j, 0.0577-2.0256e-08j,
        3.2290-1.0957e-07j, 0.0957-6.9860e-08j, 0.3361+6.4998e-09j,
        0.1150-6.2016e-08j, 0.5538+1.1062e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4106777906417847-1.2016099226741517e-08j)
SINR torch.Size([20]) = tensor([-5.7333, -8.9649, -4.9364, -6.9061, -3.7382, -6.5770, -2.9969, -2.9320,
        -3.8963, -3.7999, -2.6556, -0.6910,  1.0340, -3.1103, -3.5526,  1.6705,
        -2.0599, -4.9117, -4.8895,  0.6608], device='cuda:0')
SINR mean = -3.449310302734375
E[H^H] = 1e-07
E_MSE (Error Power) = 2.8581650257110596
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2108, 0.1126, 0.2429, 0.1694, 0.2972, 0.1803, 0.3340, 0.3374, 0.2896,
        0.2942, 0.3517, 0.4603, 0.5592, 0.3282, 0.3062, 0.5950, 0.3836, 0.2440,
        0.2449, 0.5380], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([553, 656, 526, 592, 485, 581, 459, 457, 491, 487, 447, 378, 319, 463,
        479, 298, 426, 526, 525, 332], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 2-----------
Real SNR = tensor([ 2.1614,  0.9990, -3.5343, -2.8689,  0.2851, -0.3214,  1.1124, -0.8267,
         1.5605,  2.3604, -0.9738,  5.4001, -2.3602, -1.4333,  3.2873,  1.7370,
         2.2510, -2.2967, -7.8896,  4.1742], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([107.3683+1.1187e-06j,  64.9016-4.9770e-07j,   1.9673+8.0270e-08j,
         17.9826-8.1611e-08j,  42.3766+1.2936e-06j,  58.3898+6.5406e-07j,
          0.1331+2.0021e-06j,  59.6229-1.0902e-07j,   9.1909+2.7741e-07j,
         35.1544+4.7416e-07j,  64.3902+5.7220e-06j,  43.0526-3.3666e-06j,
          2.7301+9.3689e-07j,  21.0434-2.4573e-07j,  11.6390+1.4856e-07j,
          4.7112-5.2943e-08j,  22.4684+3.7121e-07j,   2.5486-4.3961e-08j,
          6.8386+1.5304e-07j,   8.1852+7.4625e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(29.2347354888916+4.790349521499593e-07j)
torch.linalg.det(H.mH@H) = tensor([2.8702e+00+4.0834e-08j, 1.1614e+00+7.0991e-10j, 2.6364e-01-7.4738e-09j,
        1.5837e-03-2.5175e-09j, 1.4945e+00-9.6438e-09j, 5.4363e-01-7.4506e-08j,
        5.1721e-01-3.7253e-09j, 1.4389e+00+2.7459e-08j, 1.7245e+00-1.2631e-07j,
        2.6273e+00+7.3671e-09j, 1.9452e+00+2.6077e-08j, 1.3971e+00-2.4440e-07j,
        2.9574e-01-6.7471e-08j, 1.2287e+00-3.2171e-08j, 1.0340e+00+3.8879e-08j,
        3.7346e+00-1.5403e-07j, 1.1182e+00-3.8517e-08j, 2.8434e-01-2.9471e-09j,
        2.5488e-02-1.1642e-09j, 2.4855e+00-5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3095893859863281-3.4157718431515605e-08j)
SINR torch.Size([20]) = tensor([ 2.0749e-01,  1.8469e+00, -6.8559e+00, -1.0997e+00, -1.7688e+00,
         6.3281e-01, -1.9261e+01,  8.7867e-01, -2.2984e+00,  1.2078e-01,
        -1.6471e+00, -9.2614e-01, -7.4273e+00, -1.4231e-02,  1.4066e+00,
        -6.6227e+00, -1.1486e+00, -2.4655e+00, -2.7917e+00, -5.2320e+00],
       device='cuda:0')
SINR mean = -2.7233080863952637
E[H^H] = 1e-07
E_MSE (Error Power) = 6.131381511688232
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5119, 0.6047, 0.1710, 0.4370, 0.3996, 0.5364, 0.0117, 0.5504, 0.3707,
        0.5070, 0.4063, 0.4469, 0.1531, 0.4992, 0.5803, 0.1787, 0.4343, 0.3618,
        0.3446, 0.2306], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([347, 292, 590, 393, 416, 333, 918, 324, 435, 350, 412, 387, 609, 355,
        307, 583, 394, 441, 452, 536], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 3-----------
Real SNR = tensor([-2.7373e-01,  4.3951e+00,  2.9377e+00,  4.2502e+00,  2.3968e+00,
         2.4769e+00, -1.2749e+00,  2.2725e+00,  8.4509e-01,  4.1259e+00,
         3.9443e+00,  6.4077e-01,  2.2094e+00, -1.0281e-03, -5.8806e-01,
         4.5332e+00, -1.4466e+00,  2.2298e+00, -2.1639e-01,  2.3334e+00],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.1517e+00-2.4383e-07j, 2.2296e+01-1.5805e-06j, 1.2149e+02+3.8349e-07j,
        1.1502e+01-3.3964e-07j, 3.1640e+01+1.6326e-07j, 2.3664e+00-8.7107e-09j,
        1.4983e+01-2.2742e-07j, 2.5521e+01+3.8926e-07j, 3.1261e+01-1.7548e-07j,
        3.2783e+01+3.8547e-07j, 6.6972e+00-0.0000e+00j, 7.4504e+00+4.6739e-08j,
        3.3509e+01-3.8444e-07j, 2.9874e+00+2.3842e-07j, 5.3608e+01+7.5645e-07j,
        1.0782e+01-2.0350e-07j, 5.1874e-02-8.6038e-08j, 5.2782e+00+7.1526e-07j,
        1.4885e+01-5.1203e-07j, 1.6731e+01+3.4610e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(22.448421478271484-1.6859170060001816e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3318-2.4203e-09j, 11.6080-1.7586e-07j,  0.8173-9.3132e-09j,
         1.3756-5.9605e-08j,  0.0550-3.5476e-08j,  1.8031+1.2212e-08j,
         0.2497-2.9802e-08j,  3.5205+2.6822e-07j,  0.6057+3.2334e-08j,
         2.3496+2.6225e-08j,  1.9672+1.8756e-08j,  0.9922-1.1988e-08j,
         5.5109-4.6057e-08j,  0.5190+1.5033e-08j,  0.6942+7.7095e-09j,
         0.4327-3.7057e-08j,  0.6589+2.9802e-08j,  3.4835+6.1263e-08j,
         0.4536-1.8539e-08j,  0.2096+1.2614e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8818962574005127+2.902811102600822e-09j)
SINR torch.Size([20]) = tensor([ -3.6807,  -1.0548,   0.7793,  -2.5748,   0.4999,  -6.9626,  -3.4593,
         -0.4658,  -0.0846,  -0.8286,  -3.1228,  -1.2955,   1.6076,  -3.8486,
          1.7372,  -2.8251, -22.3971,  -4.0551,   0.5002,  -1.1034],
       device='cuda:0')
SINR mean = -2.6317298412323
E[H^H] = 1e-07
E_MSE (Error Power) = 10.077868461608887
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3000, 0.4396, 0.5447, 0.3560, 0.5287, 0.1675, 0.3108, 0.4732, 0.4951,
        0.4524, 0.3276, 0.4260, 0.5915, 0.2919, 0.5987, 0.3429, 0.0057, 0.2822,
        0.5288, 0.4368], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([483, 391, 328, 445, 337, 594, 475, 371, 357, 383, 464, 400, 300, 489,
        296, 453, 982, 496, 337, 393], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 4-----------
Real SNR = tensor([ 0.2130, -0.8962,  5.1735,  4.9920,  6.3882,  5.1914,  5.1524,  4.1592,
         6.2685,  2.5024,  2.5685,  4.7636,  1.9417,  1.3174,  0.4428,  4.1278,
         2.4319,  1.0023,  2.6499,  4.1751], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([18.6541+6.5826e-08j, 66.1710-4.6373e-08j,  3.3861+2.9822e-08j,
         7.8776+1.8785e-07j, 33.8899-7.1976e-07j, 36.9978-1.2371e-07j,
         2.5693+1.1413e-08j,  0.0764-1.6681e-08j,  8.9832-4.4038e-08j,
        26.8964-1.6795e-07j, 14.4092-1.8485e-07j,  7.5527+3.8603e-08j,
        37.9404-1.3324e-07j,  1.7893-8.9407e-07j, 27.6648+6.7790e-08j,
         3.8591-4.7684e-07j,  0.0738+6.3330e-08j, 11.3246+1.2305e-07j,
         8.9539+2.8992e-08j, 15.0959-2.8697e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(16.708271026611328-1.2389078563046496e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1696+1.0584e-08j, 0.0606+8.1496e-09j, 1.6594-5.9872e-08j,
        0.8264+1.0174e-07j, 7.3646+1.3930e-07j, 0.2129+1.2666e-07j,
        3.5591-8.7525e-09j, 4.9720+2.2084e-08j, 3.4574-3.5763e-07j,
        0.1747+3.7724e-09j, 2.7524+4.7024e-09j, 4.3909+2.0570e-08j,
        3.4110+1.0869e-08j, 1.6585+5.4894e-09j, 0.4016-4.0047e-08j,
        4.7449+4.4153e-08j, 0.7966-0.0000e+00j, 0.3554+3.0966e-09j,
        0.5192+2.9802e-08j, 5.7423-6.5539e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3614678382873535-4.299209946379001e-11j)
SINR torch.Size([20]) = tensor([  0.8692,  -0.2715,  -6.4818,  -0.0702,   3.5945,  -0.0697,  -2.9182,
        -14.1131,  -0.8431,  -1.9672,   3.1545,   2.4249,  -0.8917, -11.3174,
         -0.3835,  -8.4601, -15.9390,   2.5560,  -1.3851,   0.8166],
       device='cuda:0')
SINR mean = -2.5848019123077393
E[H^H] = 1e-07
E_MSE (Error Power) = 5.482987880706787
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5499, 0.4844, 0.1835, 0.4960, 0.6959, 0.4960, 0.3381, 0.0373, 0.4516,
        0.3887, 0.6740, 0.6361, 0.4488, 0.0688, 0.4779, 0.1248, 0.0248, 0.6430,
        0.4209, 0.5469], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([325, 364, 578, 357, 237, 357, 457, 799, 384, 423, 250, 273, 385, 725,
        368, 641, 844, 269, 403, 326], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 5-----------
Real SNR = tensor([ 2.6279,  0.9330,  7.8248,  1.0069,  4.4694,  2.6491,  6.1017, -0.8760,
         3.9379,  2.3902,  5.3505,  2.2359,  7.7460,  5.1009, -0.3598,  0.1259,
         5.4123,  2.0900,  3.6161,  4.2738], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.3080e+00-2.9802e-08j, 1.3866e+01-2.8372e-07j, 3.9087e+00+1.6150e-07j,
        5.7957e+00-2.3842e-07j, 3.2842e+00-7.2734e-07j, 3.2334e+00-1.4016e-07j,
        3.6474e-02-6.1650e-08j, 6.3488e-01-8.7564e-08j, 4.0546e-01+9.9938e-08j,
        1.1527e+00-1.8317e-07j, 1.1977e+00-0.0000e+00j, 7.6657e+00-7.3355e-07j,
        5.7826e+01-6.6286e-07j, 1.3915e+01-5.5365e-07j, 2.2206e+01-4.7322e-07j,
        1.0286e+01+8.3164e-08j, 1.4048e+01+2.2727e-07j, 1.5085e+01-0.0000e+00j,
        1.4120e+01+4.9626e-07j, 1.4365e+01+1.1559e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(10.217086791992188-1.4956830796108989e-07j)
torch.linalg.det(H.mH@H) = tensor([3.7337e-03-5.5996e-08j, 2.0856e-01-6.9842e-09j, 1.0604e+00-3.2750e-07j,
        1.3905e-01+1.6096e-09j, 2.0184e+00-9.1974e-09j, 1.6583e-02-3.9271e-09j,
        3.4379e+00-1.6313e-08j, 2.0609e-01-0.0000e+00j, 1.9257e-01-1.6764e-08j,
        2.1142e+00-4.6504e-08j, 1.4122e+00-2.9802e-08j, 4.8325e-01-6.7593e-09j,
        2.5899e+01+1.7632e-07j, 3.9002e+00-9.5847e-08j, 2.8271e-01-9.3132e-10j,
        3.9918e-01+2.3934e-09j, 1.0302e+00-1.2757e-08j, 1.9628e+00+2.7109e-08j,
        1.6698e+00+3.5855e-08j, 1.7485e+00+3.0815e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4092938899993896-1.7758766901465606e-08j)
SINR torch.Size([20]) = tensor([ -4.8885,  -1.3766,  -1.1980,  -2.5996,  -1.4621,  -0.4608, -25.2256,
         -5.9084,  -9.2685,  -5.3301,  -7.7358,   0.3987,   4.9640,   1.4736,
          1.8526,   0.7223,   2.0723,  -2.9638,   0.8106,   2.4304],
       device='cuda:0')
SINR mean = -2.6846706867218018
E[H^H] = 1e-07
E_MSE (Error Power) = 21.758155822753906
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2450, 0.4214, 0.4315, 0.3547, 0.4166, 0.4735, 0.0030, 0.2042, 0.1058,
        0.2267, 0.1441, 0.5229, 0.7582, 0.5840, 0.6051, 0.5415, 0.6171, 0.3357,
        0.5465, 0.6364], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 525,  402,  396,  445,  405,  370, 1000,  559,  665,  540,  618,  341,
         198,  304,  292,  330,  285,  458,  327,  273], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 6-----------
Real SNR = tensor([ 8.7825,  4.9114,  4.0641,  5.4976,  3.8912, -1.3939,  7.4551,  5.4728,
         3.4083,  9.3522,  4.9705,  2.2854,  2.3976,  8.2657,  1.0854,  5.7563,
         2.9424,  2.0729,  8.0099,  1.6790], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.2677e+00-1.2352e-07j, 3.6772e+00+2.3842e-07j, 9.3687e+00-4.1067e-08j,
        2.1157e+01-1.1681e-07j, 5.7361e+00-1.1921e-07j, 8.0525e+00-1.5035e-07j,
        1.3734e-01+1.9209e-07j, 5.6691e+01-3.9580e-08j, 5.3209e+00-7.9627e-08j,
        2.0392e+00-8.1422e-08j, 2.6324e+01-1.4832e-07j, 5.9309e+00-9.5367e-07j,
        1.7740e+00-2.9802e-08j, 1.0937e+00-5.9490e-09j, 1.3535e+00+1.1921e-07j,
        1.2557e+01+9.6554e-08j, 3.1629e+01-4.8679e-07j, 2.3892e+00-0.0000e+00j,
        2.5533e+01+1.2405e-07j, 1.5671e-02-2.0372e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(11.202380180358887-9.047612792301152e-08j)
torch.linalg.det(H.mH@H) = tensor([0.3807+6.3433e-08j, 3.1686+7.3799e-09j, 1.0329-0.0000e+00j,
        2.3220+1.2782e-07j, 0.0778+1.8626e-08j, 0.0078-8.1491e-09j,
        0.4015-5.5468e-08j, 0.4650-2.2763e-09j, 0.5256+2.9802e-08j,
        6.7245+1.1769e-07j, 0.5639-5.2154e-08j, 1.1682+1.0034e-09j,
        0.0085-5.5879e-09j, 5.3804-1.0058e-07j, 0.4776+1.8579e-09j,
        1.9638+8.4791e-08j, 0.6159-1.1176e-08j, 1.6531-7.4349e-09j,
        3.5288-2.8435e-07j, 0.7916-3.0477e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.562909483909607-3.8904288679475485e-09j)
SINR torch.Size([20]) = tensor([ -2.7906,   1.1806,   1.5772,   3.4905,  -2.2577,  -1.3478, -14.1872,
          2.1782,   3.5388,  -1.4021,   0.6104,  -0.4190,  -3.5456,  -6.7535,
         -6.7423,   1.1394,   0.6934,  -3.9063,   5.7255, -20.9880],
       device='cuda:0')
SINR mean = -2.210301160812378
E[H^H] = 1e-07
E_MSE (Error Power) = 9.46676254272461
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3447, 0.5675, 0.5898, 0.6908, 0.3729, 0.4230, 0.0367, 0.6228, 0.6931,
        0.4200, 0.5351, 0.4759, 0.3065, 0.1744, 0.1747, 0.5652, 0.5398, 0.2892,
        0.7889, 0.0079], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([452, 314, 301, 240, 433, 401, 801, 281, 239, 403, 333, 369, 478, 587,
        586, 316, 331, 491, 177, 954], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 7-----------
Real SNR = tensor([4.8597, 1.7992, 3.2931, 2.0615, 5.7779, 5.9244, 6.2216, 5.4740, 7.6983,
        5.4294, 4.0829, 5.0883, 9.3351, 7.2123, 4.9348, 7.2480, 5.2933, 4.6562,
        4.1031, 7.6698], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 7.4336-3.1869e-08j,  0.1642-2.0582e-09j,  0.7603-2.0078e-07j,
         1.4058+9.7712e-09j,  1.3161-0.0000e+00j,  8.9153-1.5569e-08j,
         1.9873-0.0000e+00j,  3.5962-2.9802e-07j,  8.3129+6.6724e-08j,
        17.4543-3.8310e-07j,  0.4433-1.5087e-07j, 32.1181+6.9680e-07j,
        18.6585-3.2388e-07j, 13.6620-4.7684e-07j,  0.4941+6.2720e-09j,
        11.3154+5.1068e-08j, 11.2750+1.6413e-07j,  3.1767-4.1612e-08j,
         0.5138+9.8769e-09j, 20.6606-1.1519e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.1831693649292-4.605585601780149e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0198-9.2120e-09j, 0.0289+8.8016e-09j, 0.2610+8.1832e-09j,
        0.1989+1.4901e-08j, 0.4078+7.9909e-08j, 0.4087+2.8733e-09j,
        2.4905+7.4027e-08j, 2.0960+1.1643e-08j, 3.1313-3.3270e-08j,
        0.1623-1.1363e-08j, 0.1906-1.8522e-08j, 1.0664-5.9605e-08j,
        7.9118+2.6551e-08j, 1.4613-1.7881e-07j, 0.6548-2.8632e-09j,
        1.4877+6.2058e-09j, 1.8617-2.9457e-08j, 0.2979+4.7497e-08j,
        0.1960+1.4841e-08j, 5.5830+8.6141e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5458307266235352-1.9529764472281386e-09j)
SINR torch.Size([20]) = tensor([ 1.8831, -4.1224, -7.6306, -1.4085, -4.8672,  1.7707, -1.8264,  0.6119,
         4.0688,  2.8653, -8.3340,  3.9774,  0.6220,  1.3754, -1.8651,  4.3472,
         1.5717, -0.7414, -9.4757,  6.1009], device='cuda:0')
SINR mean = -0.5538396239280701
E[H^H] = 1e-07
E_MSE (Error Power) = 2.414102792739868
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6067, 0.2790, 0.1472, 0.4196, 0.2459, 0.6005, 0.3964, 0.5352, 0.7185,
        0.6592, 0.1280, 0.7142, 0.5357, 0.5785, 0.3943, 0.7312, 0.5895, 0.4574,
        0.1014, 0.8029], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([291, 498, 615, 404, 524, 295, 418, 333, 223, 259, 637, 226, 333, 308,
        420, 215, 301, 380, 672, 168], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 8-----------
Real SNR = tensor([ 9.6824,  8.7098,  2.6721,  5.9274,  8.7376,  9.4834, 14.7621,  5.6123,
         8.2002,  8.1453,  6.8872,  7.2521,  0.2803,  7.5553,  6.0287,  7.0210,
         8.2225,  3.8807,  6.9792, 10.6138], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([36.8058-5.1309e-07j,  1.4342+3.0075e-08j,  5.5610+2.3842e-07j,
         0.2600-7.5509e-09j,  1.7465+1.9895e-08j,  5.4244-1.5283e-07j,
        43.5926+7.4987e-07j,  4.2735+1.3163e-07j, 11.2305+1.9615e-07j,
         5.4400-1.0516e-07j,  1.3160-5.9605e-08j,  1.8868+3.1467e-08j,
         3.7571-1.4116e-07j,  5.1745-8.3447e-07j,  0.2716-3.9488e-07j,
         1.2574-2.1204e-08j,  3.9468+7.0751e-07j,  3.0317-9.6839e-08j,
         2.7704+7.9786e-09j,  0.7117-4.8831e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.994622707366943-1.3131199239069247e-08j)
torch.linalg.det(H.mH@H) = tensor([8.6211e+00-8.3043e-08j, 5.1580e+00+5.8169e-08j, 4.0375e-01+9.5076e-10j,
        1.6441e+00-1.0712e-08j, 2.8717e-01-1.1483e-08j, 3.6430e-01+6.9429e-08j,
        2.7237e+01-3.3907e-08j, 1.6596e+00+2.3209e-08j, 1.8574e+00-3.5763e-07j,
        2.2523e-01+4.7277e-10j, 3.8560e+00+5.7550e-08j, 1.6432e+00-2.7421e-09j,
        9.0764e-02-9.1880e-10j, 5.4468e+00+2.3842e-07j, 3.0376e-01-1.3738e-08j,
        1.1187e+00-2.8520e-09j, 2.7781e+00-2.8865e-08j, 2.5569e-02-9.4064e-08j,
        6.9066e-01+2.8948e-09j, 4.6232e+00-1.0267e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.4017131328582764-1.4576378326580652e-08j)
SINR torch.Size([20]) = tensor([ 2.7168, -3.4603,  1.2811, -4.9592, -7.2224, -3.3224,  7.2360,  3.3410,
         0.2126,  2.4478, -2.8345, -1.2688, -0.1018,  0.5615, -8.4708,  1.5036,
        -3.1110, -0.7163,  3.1185, -9.6256], device='cuda:0')
SINR mean = -1.133704423904419
E[H^H] = 1e-07
E_MSE (Error Power) = 2.514892816543579
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6515, 0.3107, 0.5732, 0.2420, 0.1594, 0.3176, 0.8411, 0.6834, 0.5122,
        0.6373, 0.3424, 0.4275, 0.4941, 0.5323, 0.1245, 0.5857, 0.3282, 0.4589,
        0.6722, 0.0983], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([264, 476, 311, 527, 602, 471, 141, 245, 347, 273, 454, 399, 358, 335,
        641, 303, 463, 379, 251, 676], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)
--------SNR = 9-----------
Real SNR = tensor([ 8.0896,  5.5289,  6.7917,  7.2631,  8.2427,  1.5430,  6.7236, 11.1805,
         6.4650,  8.3144,  4.0163,  8.1226, 10.3765,  7.2507,  6.6951,  5.4323,
         5.9464,  9.2485,  5.8894,  8.0457], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.4854-1.4901e-08j,  0.7681+2.2781e-08j,  0.8443-2.0760e-07j,
         5.5168+1.5794e-08j,  1.6430+4.1723e-07j,  0.4256-0.0000e+00j,
         1.3641+2.8068e-08j,  3.5133-8.4782e-08j,  9.5589-1.1840e-07j,
         3.5865-1.5243e-07j,  0.9903-0.0000e+00j,  0.6600+5.2893e-09j,
        13.7908+1.1144e-07j,  0.1025+3.7560e-09j,  0.0262+2.4793e-11j,
         4.7743+1.7848e-07j,  0.6959-1.3361e-07j, 13.7338-2.3842e-07j,
         1.8022-5.4223e-10j,  0.4907-4.4703e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.238645315170288-1.062583532274175e-08j)
torch.linalg.det(H.mH@H) = tensor([2.2202+3.1794e-08j, 0.4139+4.6216e-09j, 1.7768-1.1913e-09j,
        3.3032-3.7278e-08j, 0.3580+2.6822e-07j, 0.2039+2.8168e-09j,
        0.4453-0.0000e+00j, 0.8343-1.4300e-07j, 0.3337-1.0431e-07j,
        2.5153-1.9479e-08j, 0.5641-1.0081e-08j, 2.1885+2.4347e-08j,
        4.1528-3.6960e-08j, 0.0086-2.0955e-09j, 0.7578+2.1906e-08j,
        0.5287-1.4901e-08j, 0.6269-6.2130e-09j, 5.8474-6.2766e-10j,
        0.0437-1.5832e-08j, 2.3464-1.6314e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4734752178192139-2.7285140813404496e-09j)
SINR torch.Size([20]) = tensor([ -8.4765,  -1.0254,  -3.8949,   3.3969,  -4.2111,  -0.8210,  -1.8872,
          2.2920,  -2.5010,   2.7435,  -1.2793,  -3.6534,   4.2187, -15.4730,
        -11.4248,   1.6826,  -6.8301,   2.5376,   1.1239,  -3.6505],
       device='cuda:0')
SINR mean = -2.3566410541534424
E[H^H] = 1e-07
E_MSE (Error Power) = 4.5053324699401855
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1244, 0.4412, 0.2897, 0.6861, 0.2750, 0.4529, 0.3930, 0.6290, 0.3599,
        0.6529, 0.4269, 0.3013, 0.7254, 0.0276, 0.0672, 0.5957, 0.1718, 0.6421,
        0.5643, 0.3014], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([641, 390, 491, 243, 502, 383, 420, 278, 442, 263, 399, 482, 219, 833,
        728, 297, 589, 270, 316, 482], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 20)

--- 処理中: 画像 41 から 60 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 40)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6305, 0.6925, 0.4886, 0.7032, 0.5710, 0.5101, 0.6843, 0.5062, 0.6585,
        1.1102, 0.7262, 0.7535, 0.6937, 0.3628, 1.0899, 0.4007, 0.6435, 0.4448,
        0.6772, 0.7563], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -6.3118,  -5.0734,  -8.3494,  -0.6268,  -4.0662,  -8.2093,  -2.4367,
         -2.4360,  -5.7811,  -8.1996,  -5.2027,  -9.5083,  -4.4817,  -7.7383,
         -6.2243,  -3.2094, -13.8270, -11.0133,  -3.8318,  -5.5301],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 74.1098-4.4404e-06j, 472.6808-6.7280e-06j,  13.9401+4.7684e-07j,
        532.4069+7.8790e-06j,  36.1153-5.7653e-06j, 646.5778-3.0518e-05j,
         90.2344-7.5358e-07j, 315.3253-1.4684e-05j, 351.0718-7.4812e-06j,
        900.9169+7.8626e-06j,  43.1897+2.8610e-06j, 504.7126-8.3576e-07j,
        300.7611+1.3442e-07j, 238.2255+1.3217e-06j,  40.8015-3.7339e-07j,
         47.6530-3.2085e-07j,  39.6749-9.5367e-06j, 737.8495-6.6762e-07j,
         25.5130+2.4955e-07j, 477.5704+1.7372e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(294.4665222167969-2.1973371531203156e-06j)
torch.linalg.det(H.mH@H) = tensor([1.0121-1.2597e-07j, 1.1802+1.0267e-07j, 0.0472+1.0245e-08j,
        9.0183+2.5617e-07j, 2.1360-8.5283e-09j, 0.2224+6.9136e-09j,
        1.1362-3.8743e-07j, 6.2080-2.8936e-07j, 1.4496-1.8265e-08j,
        0.0860+2.9651e-08j, 2.1653-1.1052e-07j, 0.1450+4.3461e-09j,
        1.3367-8.8281e-09j, 0.0845-4.1401e-08j, 0.0568+5.5879e-09j,
        0.6063-8.4359e-09j, 0.1386+5.9350e-10j, 0.0954+9.3132e-10j,
        4.8090+2.8128e-08j, 2.9562-1.2329e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7444881200790405-2.8292101106330847e-08j)
SINR torch.Size([20]) = tensor([-4.9937, -1.1205, -6.4134, -1.6631, -8.0699, -1.8475, -1.4795, -3.8829,
        -0.2483, -0.8380, -5.0780, -0.8391, -2.5231, -1.0751, -3.8435, -8.3369,
        -8.1935, -0.9715, -4.3311, -1.2796], device='cuda:0')
SINR mean = -3.351407766342163
E[H^H] = 1e-07
E_MSE (Error Power) = 2.6903700828552246
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2405, 0.4359, 0.1859, 0.4054, 0.1349, 0.3952, 0.4156, 0.2903, 0.4857,
        0.4519, 0.2370, 0.4518, 0.3587, 0.4384, 0.2921, 0.1279, 0.1316, 0.4443,
        0.2695, 0.4269], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([528, 393, 576, 412, 629, 419, 406, 490, 363, 384, 531, 384, 443, 392,
        489, 637, 633, 388, 506, 399], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -4-----------
Real SNR = tensor([ -3.2215,  -6.0247,  -2.5413,  -3.9658,  -5.6287,  -4.6381,  -2.3568,
         -7.8177,  -6.4098,  -6.1299,  -3.9783,  -5.0747,  -6.5377,  -4.0530,
         -6.3591,  -2.4373,  -5.9191,  -6.5562,  -1.4694, -13.6797],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 235.2533-3.5828e-05j,   28.8379-0.0000e+00j,   93.4151-4.0937e-06j,
         380.4302+7.0465e-06j,    3.6714+2.3842e-07j,    5.8291+1.4305e-06j,
        1065.5861-2.9714e-05j,   16.0949+1.8477e-06j,    3.7201-1.0745e-07j,
         200.8625-4.4370e-06j,   79.4942+1.8315e-06j,   33.0280+7.1696e-07j,
         134.5838-1.4305e-06j,  522.2066+5.8247e-06j,   62.5110-1.1444e-05j,
         353.6720-1.0776e-06j,   14.0924-0.0000e+00j,   17.9352+2.3842e-06j,
         148.6321-1.2952e-06j,   63.7759-7.6294e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(173.1815948486328-3.7868237541260896e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.7426-8.9407e-08j,  1.0890-1.1740e-08j,  8.8165-8.9187e-08j,
         0.2580+4.1540e-10j,  1.2065-7.4506e-08j,  0.8877-4.4546e-09j,
         9.0894+1.5266e-07j,  1.2233-2.3893e-08j,  0.1323-0.0000e+00j,
         1.7807-1.9137e-08j,  0.0761-1.6561e-08j,  1.6992+2.5319e-08j,
         1.3035+5.9605e-08j,  2.9099-6.7277e-08j,  2.3326+1.8874e-08j,
        10.9171-1.6667e-07j,  0.1884-1.1176e-08j,  0.1633-5.9605e-08j,
         3.8909-6.8919e-08j,  0.0949-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4401023387908936-2.2282737432988142e-08j)
SINR torch.Size([20]) = tensor([ -2.1372,  -4.9159,  -5.7198,  -1.0712, -12.9720, -10.2029,   0.0595,
         -8.3221, -11.7451,  -2.7315,  -3.4562,  -3.6966,  -3.5134,  -1.6131,
         -6.1518,  -2.1441,  -8.4878,  -5.9895,  -3.0735,  -5.2134],
       device='cuda:0')
SINR mean = -5.154873847961426
E[H^H] = 1e-07
E_MSE (Error Power) = 4.759953022003174
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3794, 0.2438, 0.2113, 0.4386, 0.0480, 0.0871, 0.5034, 0.1283, 0.0627,
        0.3477, 0.3109, 0.2992, 0.3081, 0.4082, 0.1952, 0.3790, 0.1241, 0.2012,
        0.3301, 0.2314], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([429, 526, 553, 392, 770, 693, 352, 637, 737, 450, 475, 484, 477, 411,
        567, 429, 642, 562, 462, 536], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -3-----------
Real SNR = tensor([  0.5841,  -3.6801,  -1.4599,  -7.3910,  -4.0281,  -0.7094, -11.5575,
         -4.0221, -10.2064, -10.1090,  -4.3974,  -2.1850,  -7.0386,  -0.0241,
         -2.1806,  -1.3135,  -1.8933,  -3.8481,  -7.6178,  -7.0357],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 40.4867+1.0975e-07j,  81.1719-2.3133e-07j, 118.4471-5.0437e-06j,
          9.1219+2.9742e-06j, 651.3185+1.9949e-07j,  93.7200-7.0237e-07j,
         25.1267+2.3773e-05j, 742.6365+1.4153e-06j,  47.5159+3.8147e-06j,
         83.8354+7.6294e-06j, 143.9152+3.0361e-07j,   1.0310-1.3039e-08j,
        232.5500+7.2083e-06j,  71.4483+1.3791e-06j, 431.8111+4.2933e-06j,
         94.4080+5.0860e-06j, 216.1025+4.3785e-06j,  37.9158-2.5492e-07j,
        293.5990-6.1181e-06j, 159.2758-2.8296e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(178.77186584472656+2.368574996580719e-06j)
torch.linalg.det(H.mH@H) = tensor([ 3.2434+1.6351e-08j,  0.3919-5.9605e-08j,  6.7388-1.1243e-07j,
         0.6156+1.3381e-08j,  1.3915-1.1921e-07j,  0.3265-8.0005e-08j,
         0.2149-3.5688e-10j,  0.3637+6.3343e-09j,  0.2098-5.5271e-09j,
         0.3092-4.7898e-10j,  7.3185-9.1624e-08j,  0.2288-2.5987e-08j,
         0.6292+3.2596e-08j, 11.5368-2.6071e-08j,  0.9504-4.8429e-08j,
         1.6480-0.0000e+00j,  2.5548+1.0731e-08j,  0.5510-1.0335e-07j,
         0.2317+5.9605e-08j,  1.7594+6.5299e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0606987476348877-2.6376961059781934e-08j)
SINR torch.Size([20]) = tensor([ -4.2306,  -0.4868,  -2.0407,  -9.6912,   0.6452,  -1.4478,  -7.8074,
         -1.3724,  -5.3264,  -1.4518,  -1.9839, -14.3686,  -1.7046,  -4.7221,
          1.8052,  -3.2331,  -0.2299,  -3.3207,  -0.2337,  -2.3887],
       device='cuda:0')
SINR mean = -3.179499387741089
E[H^H] = 1e-07
E_MSE (Error Power) = 3.7979695796966553
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2741, 0.4720, 0.3846, 0.0970, 0.5371, 0.4174, 0.1421, 0.4216, 0.2268,
        0.4172, 0.3877, 0.0353, 0.4031, 0.2521, 0.6024, 0.3220, 0.4868, 0.3176,
        0.4865, 0.3659], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([502, 371, 426, 678, 332, 405, 621, 402, 540, 405, 424, 805, 414, 519,
        293, 468, 362, 471, 362, 438], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -2-----------
Real SNR = tensor([-5.5365, -5.6819, -2.5994, -6.0409, -2.6386,  0.3902,  0.5668, -3.7459,
        -5.7107, -4.1313, -5.3394, -4.9717, -5.2595,  0.3685, -3.2942, -6.6639,
        -5.3566, -2.5042, -1.3855, -5.8941], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 42.8373+1.2204e-06j,   0.6082-6.0891e-07j, 396.4227-6.4309e-06j,
        149.1406+3.3648e-08j,  34.0082+3.0098e-07j, 184.3755-7.1625e-07j,
        259.9479+1.6212e-05j,  21.4014+1.5253e-07j,   4.1401-2.9206e-05j,
         32.5521+5.3468e-07j,  30.1182-2.8610e-06j, 113.2463-5.5777e-07j,
         11.3273-1.1921e-07j,   4.1784-1.5806e-08j, 138.6833-8.3467e-06j,
         32.1384-9.5367e-07j,  21.3041+3.7774e-07j,  21.2890-2.9229e-07j,
         37.7882-3.9822e-07j,   9.7138-1.6689e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(77.26105499267578-1.6671734783813008e-06j)
torch.linalg.det(H.mH@H) = tensor([5.4364e-03+6.1797e-09j, 2.4866e-01+2.2352e-08j, 5.4714e-01-1.2075e-07j,
        6.2140e-01-1.3234e-08j, 1.9945e+00-1.1921e-07j, 2.9461e-01+1.9372e-07j,
        2.3588e+01-1.3412e-07j, 1.3878e+00-0.0000e+00j, 6.5428e-02-4.8113e-09j,
        8.1503e-01+1.4901e-07j, 1.5216e+00+7.0832e-09j, 9.9437e-01-5.0111e-08j,
        6.0761e-01-2.9802e-08j, 4.6126e+00-1.2238e-07j, 5.5990e-01-6.8540e-08j,
        4.3023e-01+1.8034e-09j, 1.0774e+00-5.9765e-10j, 2.1088e+00-1.7994e-08j,
        4.5555e+00+3.5763e-07j, 9.6015e-02+5.3406e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.3066117763519287+5.482051257388321e-09j)
SINR torch.Size([20]) = tensor([ -2.3841, -17.8218,   0.3892,  -2.4956,  -3.6648,  -3.1515,  -4.2515,
         -2.4679, -15.1783,  -2.6056,  -3.8274,  -2.8767,  -6.7342, -12.6370,
         -0.0909,  -2.8522,  -3.3458,  -5.4126,  -3.3664,  -6.3823],
       device='cuda:0')
SINR mean = -5.057868480682373
E[H^H] = 1e-07
E_MSE (Error Power) = 8.572333335876465
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3661, 0.0162, 0.5224, 0.3602, 0.3007, 0.3261, 0.2731, 0.3616, 0.0295,
        0.3543, 0.2929, 0.3402, 0.1750, 0.0517, 0.4948, 0.3415, 0.3164, 0.2233,
        0.3154, 0.1870], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([438, 887, 341, 442, 483, 465, 503, 441, 825, 446, 488, 455, 586, 761,
        358, 454, 472, 542, 472, 575], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = -1-----------
Real SNR = tensor([-3.6127, -5.5978, -3.0869, -2.2035, -3.4968, -5.1176, -1.0462,  0.0073,
        -4.1931, -2.9256, -2.2810,  0.8732, -1.4877, -6.2247, -2.5517,  2.7906,
        -2.3199, -2.8398,  4.6745,  0.0346], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.6214e+01-1.2171e-06j, 3.0277e+02+2.0017e-06j, 1.0055e+01-1.2388e-07j,
        1.3906e+02-0.0000e+00j, 1.3396e+00-1.2517e-06j, 1.7223e+02+1.4572e-06j,
        4.5627e+00+2.7418e-06j, 1.2176e+02+4.8312e-06j, 5.5476e+00+9.5367e-07j,
        1.5307e+02-6.5377e-06j, 2.3545e-01+1.3411e-07j, 3.8805e+01+1.9611e-05j,
        2.3161e+02+9.9946e-07j, 7.0266e+00-0.0000e+00j, 1.8680e+01-2.8171e-07j,
        3.8638e+01-2.3842e-07j, 1.3111e+02+1.9073e-05j, 2.6622e+01+2.8610e-06j,
        1.4303e+01-1.4305e-06j, 4.0278e+01-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(76.19557189941406+2.1791715880681295e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.0773+1.4544e-08j,  0.0371-1.2456e-08j,  1.5666-7.4821e-09j,
         0.0394+9.0493e-09j,  1.4345+6.7314e-08j,  0.3085+5.6838e-09j,
         0.1682-5.4756e-10j,  3.9719+1.1372e-07j,  2.0030+2.8536e-08j,
         2.3143+9.8846e-09j,  3.7468+4.3630e-10j,  1.2697-9.6535e-08j,
         1.4477+5.9605e-07j,  0.0575-6.6084e-11j,  2.4077-2.7226e-08j,
         0.9814-7.1996e-08j,  1.4787-8.9407e-08j,  1.7038+3.8021e-09j,
        26.5137+3.1276e-08j,  3.7394+7.3482e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.7633652687072754+3.240284485173106e-08j)
SINR torch.Size([20]) = tensor([ -2.1097,   0.5054,  -6.4806,  -0.0442, -14.1377,  -1.8062,  -8.2252,
         -2.0346,  -9.4031,   0.4375, -18.0223,  -5.5667,   0.3914,  -5.0740,
         -5.0687,  -5.5570,  -3.7348,  -5.1043, -13.5585,  -1.7893],
       device='cuda:0')
SINR mean = -5.319133281707764
E[H^H] = 1e-07
E_MSE (Error Power) = 8.442911148071289
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3809, 0.5291, 0.1836, 0.4975, 0.0371, 0.3975, 0.1308, 0.3850, 0.1029,
        0.5252, 0.0155, 0.2172, 0.5225, 0.2372, 0.2374, 0.2176, 0.2973, 0.2359,
        0.0422, 0.3984], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([428, 337, 578, 356, 800, 418, 634, 426, 670, 339, 892, 548, 341, 531,
        531, 547, 485, 532, 785, 417], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 0-----------
Real SNR = tensor([ 2.7618, -1.2751, -0.1161,  1.7283,  2.3778, -4.2070,  1.9437, -0.6481,
         1.6829, -0.4955, -1.8230, -0.1048,  0.4227,  1.1271,  2.0352,  1.7135,
         2.3387, -2.3365, -5.1012,  5.2570], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  3.6673+4.0103e-08j,   7.4778-6.1172e-08j,  18.4252-0.0000e+00j,
        124.8742-6.4165e-06j, 129.0176-1.3035e-07j,   1.5583-1.2359e-08j,
         74.2547+2.3595e-06j,  55.1474-1.0949e-07j,  54.3178+7.6294e-06j,
          4.3846-9.9910e-08j,  36.1461+9.5367e-07j,  50.9831-4.6341e-07j,
         37.2629-2.8581e-07j,  47.2906+5.4354e-06j, 104.0736-1.4534e-06j,
         12.1470-4.8374e-08j, 193.1942+9.9442e-07j,  61.6892+3.8147e-06j,
          0.2356-5.4958e-09j,  79.2723-2.7786e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(54.770965576171875+5.931525492997025e-07j)
torch.linalg.det(H.mH@H) = tensor([ 2.0953+9.9404e-08j,  2.5322-4.7474e-09j,  2.0041-2.0826e-08j,
         3.3381+4.8316e-08j,  8.3351+1.9675e-07j,  0.1069+3.7253e-09j,
         4.2986+1.1813e-08j,  0.9045-1.9156e-08j, 10.0941-2.5970e-07j,
         0.8695+1.0911e-07j,  1.3419-2.3842e-07j,  6.7558+1.7237e-08j,
         5.4527-1.3350e-08j,  0.5416-3.5763e-07j,  5.7091+2.5304e-07j,
         7.9040+2.0302e-07j,  7.1595-3.5044e-08j,  1.2633+1.1921e-07j,
         0.1960-7.4506e-09j,  2.0305+1.4720e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.6466362476348877+7.886337982654368e-08j)
SINR torch.Size([20]) = tensor([ -6.4797,  -2.0514,  -3.9134,   1.0947,   0.1241, -10.6649,   0.7391,
         -2.5541,  -2.0410,  -3.6525,  -2.7326,  -0.6483,  -1.5326,  -0.1393,
          1.5175,  -4.0818,   1.6912,  -2.6011, -11.1910,   1.4656],
       device='cuda:0')
SINR mean = -2.382580518722534
E[H^H] = 1e-07
E_MSE (Error Power) = 2.7590017318725586
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1836, 0.3841, 0.2888, 0.5627, 0.5071, 0.0790, 0.5424, 0.3571, 0.3846,
        0.3013, 0.3477, 0.4627, 0.4127, 0.4920, 0.5865, 0.2809, 0.5961, 0.3546,
        0.0706, 0.5836], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([578, 426, 491, 317, 350, 706, 329, 444, 426, 482, 450, 377, 408, 359,
        303, 497, 297, 445, 721, 305], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 1-----------
Real SNR = tensor([ 0.6874, -1.9229,  2.4800,  0.2734, -3.6236,  1.6787, -3.7854, -1.5253,
        -2.3977, -0.3433, -1.9338,  1.0881,  1.2674, -2.8502, -6.0528,  0.3559,
        -3.5940,  4.2180, -1.9194, -0.2529], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 52.9892-3.9600e-07j,   3.5086+3.0994e-06j,   5.9761-9.6012e-08j,
          2.7740-9.9016e-08j,   2.3385-5.7934e-07j,  40.8610-1.9073e-06j,
          8.1524+2.1458e-06j,  50.1058-1.5193e-06j,   3.4691-5.5548e-09j,
          6.0209-3.1102e-07j,  34.0801-1.5190e-07j,  21.8377+1.9073e-06j,
        130.1744-2.4510e-06j,  63.6263+1.1544e-06j,  38.2585+6.3584e-08j,
         20.3939+4.4138e-07j,  20.3003-2.6501e-07j,  34.2395+1.7017e-07j,
          6.0958-1.1550e-08j,   1.2037+2.5757e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(27.320295333862305+6.073404534845395e-08j)
torch.linalg.det(H.mH@H) = tensor([0.6354+2.9802e-08j, 1.1511+3.2950e-08j, 0.0503+1.1538e-08j,
        4.6427+4.2256e-08j, 0.1530-4.2702e-11j, 6.6525-9.5474e-08j,
        0.2746-2.2352e-08j, 0.9415-3.6536e-09j, 1.7042+2.3897e-09j,
        0.9245+1.0017e-08j, 1.2161-1.1479e-09j, 6.5810-9.2582e-08j,
        4.8968-2.2248e-08j, 0.0175+1.7546e-10j, 0.8200-4.1163e-08j,
        3.3930-1.8254e-08j, 0.3675-8.3443e-09j, 8.9313-1.2639e-07j,
        0.7181+4.6873e-09j, 1.5366-5.6435e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2803890705108643-1.5173922562894404e-08j)
SINR torch.Size([20]) = tensor([ -0.5528,  -8.3123,  -3.9420,  -6.1190,  -7.2753,  -3.1481,  -4.3227,
         -1.0814,  -7.4276,  -3.2461,  -2.2485,  -5.2202,   3.4195,   0.5286,
         -1.3288,  -1.7372,  -0.6915,  -0.4222,  -4.8263, -10.8176],
       device='cuda:0')
SINR mean = -3.4385876655578613
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0842137336730957
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4682, 0.1285, 0.2875, 0.1964, 0.1577, 0.3263, 0.2699, 0.4381, 0.1531,
        0.3214, 0.3734, 0.2311, 0.6873, 0.5304, 0.4241, 0.4013, 0.4603, 0.4757,
        0.2476, 0.0765], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([374, 636, 492, 566, 604, 465, 505, 392, 609, 468, 433, 536, 242, 336,
        401, 415, 378, 369, 523, 711], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 2-----------
Real SNR = tensor([ 2.7461, -0.5287, -1.2729,  1.2488, -3.6053,  3.5104,  2.4622,  1.9980,
         1.4323, -0.7729,  0.8149,  1.0988, -1.0240,  2.8401, -3.8813,  1.0421,
        -3.2582,  2.0794, -4.2814, -2.0409], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([2.4105e+01-6.6643e-07j, 1.4972e-02-3.1432e-08j, 7.8420e-01-1.1031e-08j,
        4.8487e+00+1.3510e-07j, 5.9246e+00-3.5259e-09j, 1.0690e+02+1.2217e-06j,
        6.7631e+00-1.9073e-06j, 3.2512e+01+4.0921e-07j, 4.8504e+00+1.1921e-07j,
        1.1209e+01+1.4305e-06j, 2.9872e+01+3.8151e-06j, 5.1799e+00+1.1921e-07j,
        1.3114e+01-0.0000e+00j, 9.2135e+00+1.5735e-06j, 5.7988e+00-0.0000e+00j,
        1.3006e+01-1.1921e-07j, 5.9432e+00-2.4687e-07j, 1.1421e+01+2.9001e-08j,
        8.8605e+00+1.4305e-06j, 9.2592e+00-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(15.478927612304688+3.588972674606339e-07j)
torch.linalg.det(H.mH@H) = tensor([0.4041+2.1093e-10j, 4.0774+2.5242e-08j, 0.1146+7.4506e-09j,
        3.3574+5.9605e-08j, 0.2823-1.5134e-09j, 5.5122+6.9895e-09j,
        0.0919-1.5815e-07j, 2.2895-4.6544e-08j, 0.7992+2.9802e-08j,
        1.1829-3.6113e-08j, 0.7703+1.4901e-08j, 1.4966+1.7881e-07j,
        0.2015+4.9360e-08j, 3.7944-3.8736e-08j, 0.3026+2.2352e-08j,
        1.2462+1.1921e-07j, 0.3000-4.4703e-08j, 1.7376+1.1921e-07j,
        0.0678+4.6566e-09j, 0.7078-5.4609e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4368137121200562+1.532898785683301e-08j)
SINR torch.Size([20]) = tensor([ -3.0313, -27.6475,  -6.1915,  -5.1694,  -3.0308,   0.6335,  -1.8678,
         -0.2011,  -5.5437,   0.7549,  -0.5273,  -5.8646,  -0.3642,  -3.1517,
         -5.3995,  -5.6626,  -2.0229,  -2.5634,  -1.4942,   0.1207],
       device='cuda:0')
SINR mean = -3.911226987838745
E[H^H] = 1e-07
E_MSE (Error Power) = 33.681148529052734
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3323, 0.0017, 0.1938, 0.2332, 0.3323, 0.5364, 0.3941, 0.4884, 0.2181,
        0.5433, 0.4697, 0.2058, 0.4790, 0.3261, 0.2239, 0.2135, 0.3856, 0.3566,
        0.4148, 0.5069], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 461, 1000,  568,  534,  461,  333,  420,  361,  547,  329,  373,  558,
         367,  465,  542,  551,  425,  444,  407,  350], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 3-----------
Real SNR = tensor([ 7.0331, -3.2888,  4.6848, -0.1414,  1.3891,  2.9877,  2.7182,  5.4163,
         2.8030,  2.4359, -1.0356,  2.0836, -4.9664,  3.8525,  1.9497,  1.7014,
         5.0185,  3.2529,  0.7512, -4.8411], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([11.5307-4.9544e-07j,  6.0667+8.9407e-08j,  4.9802+6.0698e-07j,
        10.7851+1.6363e-06j,  1.0617+6.7102e-07j,  3.8799-1.1921e-07j,
        38.5156+4.4592e-07j, 15.2429+3.7514e-08j, 37.0214-3.7311e-07j,
        12.3565+5.4080e-08j,  2.2401-4.8803e-08j, 40.4771+2.8591e-07j,
        15.7654-3.0684e-08j, 24.3415+2.1815e-07j,  1.1171-7.0202e-07j,
        44.6764+3.7946e-07j, 31.2773+4.1051e-07j,  4.8019-2.4438e-06j,
        12.8057-1.3219e-07j, 14.8982+1.5613e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(16.69207000732422+3.2306427755202094e-08j)
torch.linalg.det(H.mH@H) = tensor([5.1534+1.9828e-08j, 0.2213-2.8693e-09j, 1.4097-8.6392e-08j,
        0.6230+3.4663e-09j, 1.4778+4.4367e-08j, 0.0499-1.1176e-08j,
        4.7940-3.3775e-09j, 2.4866-4.8369e-08j, 3.1349+8.9911e-08j,
        0.3055+1.0120e-07j, 0.4654-7.4506e-09j, 2.3044+1.4967e-08j,
        0.0091-0.0000e+00j, 4.5492-1.3735e-07j, 4.4255+1.7635e-07j,
        0.5813-2.2926e-09j, 5.4637+1.9929e-07j, 0.9617+3.1292e-07j,
        1.4762+2.5447e-08j, 0.1920-7.3491e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0042316913604736+3.405593673733165e-08j)
SINR torch.Size([20]) = tensor([ -8.5410,  -2.1251,  -5.9801,  -2.5263, -11.1347,  -5.5112,  -0.7843,
         -0.6986,   1.8596,  -2.2755,  -4.6065,   1.0510,  -1.5975,   0.2964,
        -12.8681,   0.2181,  -0.8457,  -5.7768,   2.6046,  -2.7639],
       device='cuda:0')
SINR mean = -3.1002819538116455
E[H^H] = 1e-07
E_MSE (Error Power) = 3.388338565826416
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1228, 0.3801, 0.2015, 0.3585, 0.0715, 0.2194, 0.4550, 0.4599, 0.6054,
        0.3719, 0.2572, 0.5602, 0.4091, 0.5171, 0.0491, 0.5126, 0.4515, 0.2091,
        0.6456, 0.3461], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([643, 429, 561, 443, 720, 546, 382, 379, 292, 434, 515, 318, 410, 344,
        767, 347, 384, 555, 268, 451], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 4-----------
Real SNR = tensor([ 1.7661,  2.2483,  3.6368,  1.1483,  1.6310, -1.7504,  6.7724,  0.0372,
         6.8129, -2.4886,  4.2407,  1.3124,  4.1111, -1.0399,  0.8027,  4.8090,
         2.4409,  5.3394,  3.5206,  4.7707], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([18.4765-3.3011e-07j, 14.3327-3.3387e-07j,  8.5880+2.1042e-07j,
         4.5318-8.9407e-08j, 14.8378-5.3537e-07j,  0.3718-1.3872e-07j,
         0.6852-1.4271e-07j,  3.7715-0.0000e+00j, 28.5529-4.3205e-07j,
        10.7033-9.3231e-08j,  6.2459-2.2987e-07j, 23.3085-2.0201e-07j,
        80.4492+3.3143e-08j,  0.4862-3.7253e-09j,  1.0772+1.7343e-08j,
        58.8557-2.8684e-07j, 13.1164-9.8790e-08j,  3.8876+1.7881e-06j,
         0.4648-2.5332e-07j,  4.0137-1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(14.837837219238281-6.20083184799114e-08j)
torch.linalg.det(H.mH@H) = tensor([2.0845+3.2421e-08j, 2.6734-5.6907e-09j, 0.0557+6.7677e-11j,
        0.1232+2.3543e-10j, 1.6209+2.7568e-08j, 0.0161+4.1910e-09j,
        0.0336+1.0788e-08j, 0.1246-3.2310e-09j, 7.4586+5.7649e-08j,
        0.3629-3.6499e-10j, 3.9089-4.5755e-08j, 0.9373+6.0987e-08j,
        0.8206-1.5885e-08j, 0.2505-7.4506e-09j, 0.7259+2.4801e-08j,
        1.9742-1.1921e-07j, 0.8516+2.2352e-08j, 0.5338-7.4506e-08j,
        0.2768+1.4901e-08j, 7.2806-7.0648e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6056874990463257-4.338997161568159e-09j)
SINR torch.Size([20]) = tensor([  2.2860,  -2.3357,  -2.2192,  -3.1352,  -3.8556, -10.6126, -12.7329,
         -1.2998,  -0.2496,  -0.1529,  -4.3369,   1.8275,   2.5816,  -6.1549,
         -1.8940,   2.8698,   1.1931,  -5.5845, -12.1394,  -1.0230],
       device='cuda:0')
SINR mean = -2.8484103679656982
E[H^H] = 1e-07
E_MSE (Error Power) = 4.204564571380615
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6286, 0.3687, 0.3750, 0.3270, 0.2916, 0.0799, 0.0506, 0.4257, 0.4856,
        0.4912, 0.2692, 0.6037, 0.6444, 0.1951, 0.3927, 0.6594, 0.5683, 0.2166,
        0.0576, 0.4414], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([278, 436, 432, 464, 489, 705, 763, 400, 363, 360, 506, 293, 268, 567,
        421, 259, 314, 548, 747, 390], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 5-----------
Real SNR = tensor([ 2.6999,  2.5634,  2.9011,  5.8762, -1.9283,  9.3247,  1.9600,  6.1042,
         3.8402,  3.2145,  5.3679,  4.1620,  6.2272,  3.1956,  2.9377,  5.4990,
         3.6446,  2.1236,  4.3286,  1.2528], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([23.9128-6.9664e-08j,  1.3078+7.3706e-08j,  6.8231+1.2666e-07j,
         8.6107+2.9774e-07j,  0.5257+1.3747e-07j, 90.9014+1.5862e-06j,
         4.7425-1.7335e-07j, 17.1608+1.4070e-07j,  0.6538+2.0946e-07j,
         4.7560+7.3094e-08j, 49.8681+1.0060e-06j,  1.9283+1.1921e-07j,
         8.1680-1.6924e-07j, 53.8566-1.8435e-07j,  5.6200-8.9407e-08j,
        13.8719+7.3514e-07j,  3.8447+3.5763e-07j,  5.2574+2.6226e-06j,
         5.4094-2.3604e-08j,  4.5183+4.9863e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(15.586874961853027+3.412927469526039e-07j)
torch.linalg.det(H.mH@H) = tensor([1.9907+2.0161e-08j, 2.5033+4.3381e-08j, 0.3049-1.4901e-08j,
        4.1043+1.6109e-08j, 0.0805-7.4469e-09j, 7.9512+2.4482e-07j,
        1.1864-7.4506e-09j, 3.8006+1.6255e-07j, 2.5716+1.9225e-08j,
        2.5072+5.3791e-09j, 4.3323-4.2235e-08j, 0.3840-1.0431e-07j,
        2.3696+6.7897e-09j, 0.3799+4.2096e-09j, 1.3844-2.2881e-08j,
        4.0929-2.5215e-08j, 1.1689-5.1317e-08j, 0.0691-1.5832e-08j,
        1.3789+5.9605e-08j, 0.2236+1.1972e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.139212131500244+1.5130863673107342e-08j)
SINR torch.Size([20]) = tensor([ 2.0464, -6.8850, -2.9769,  3.7358, -7.1672,  4.4956, -0.8069,  2.8619,
        -9.2056, -5.8222,  2.7395, -3.3382, -0.6826,  2.0184, -2.1333,  0.8660,
        -5.2055, -2.9493,  0.0871,  0.4619], device='cuda:0')
SINR mean = -1.3930004835128784
E[H^H] = 1e-07
E_MSE (Error Power) = 2.2182095050811768
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6157, 0.1700, 0.3350, 0.7027, 0.1611, 0.7379, 0.4537, 0.6590, 0.1072,
        0.2074, 0.6527, 0.3168, 0.4608, 0.6141, 0.3796, 0.5497, 0.2317, 0.3365,
        0.5050, 0.5266], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([286, 591, 459, 233, 600, 211, 382, 259, 664, 556, 263, 471, 378, 286,
        429, 325, 535, 458, 351, 339], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 6-----------
Real SNR = tensor([ 5.9743,  5.6329,  1.5251,  1.9626,  5.2260,  1.6715,  4.7697,  7.0430,
         6.6729,  2.5301, -1.2801,  5.8596,  1.1023,  4.5751,  3.4610,  7.8132,
         8.1361,  7.1465, -1.4343,  0.8895], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 6.9136-1.7188e-07j,  7.3728-1.4792e-07j,  4.5077-2.8688e-09j,
         3.8499-0.0000e+00j,  1.5155-1.0744e-08j,  0.8364+2.3842e-07j,
         7.7508-2.0341e-08j,  7.5362+3.7036e-07j,  2.9631+4.2094e-08j,
         2.1115-3.5763e-07j,  8.6338+5.9432e-07j, 15.5665-1.1655e-08j,
         0.0916-4.4529e-08j,  1.7702-1.1176e-07j,  4.2466-3.0823e-09j,
        16.4172+9.6950e-08j,  0.2409+1.5312e-07j, 48.0641-7.5210e-07j,
         1.9070+2.3842e-07j,  1.2361-1.3045e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.176565647125244+4.307107115408826e-09j)
torch.linalg.det(H.mH@H) = tensor([3.6437+5.0096e-08j, 9.1704+6.7169e-08j, 0.4640-6.3496e-09j,
        0.4476+7.4506e-08j, 0.2742+1.0462e-08j, 0.1314+5.5879e-09j,
        0.6979-2.9802e-08j, 0.3413+3.7998e-07j, 3.5171-2.3445e-08j,
        0.4558-2.2352e-08j, 0.1638-3.2000e-10j, 1.1999-2.2984e-07j,
        0.5925-1.0789e-08j, 0.7498-3.7253e-09j, 1.3830-1.9931e-09j,
        3.9855+4.7684e-07j, 8.7566+7.2122e-08j, 8.1150-1.4635e-08j,
        0.1291+1.1176e-08j, 1.7763-1.9996e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2997400760650635+4.013411825098956e-08j)
SINR torch.Size([20]) = tensor([  2.9680,  -0.2720,  -3.4953,  -0.6471,  -0.6723,  -2.9733,   2.0158,
         -0.9582,  -2.0694,  -6.9377,  -1.0571,   0.6796, -12.6665,  -7.4729,
          1.9019,   1.6397, -16.9671,   5.7862,  -3.7489,  -2.1056],
       device='cuda:0')
SINR mean = -2.3526153564453125
E[H^H] = 1e-07
E_MSE (Error Power) = 5.129181861877441
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6645, 0.4843, 0.3090, 0.4628, 0.4614, 0.3352, 0.6140, 0.4451, 0.3831,
        0.1683, 0.4394, 0.5390, 0.0513, 0.1518, 0.6078, 0.5933, 0.0197, 0.7912,
        0.2967, 0.3811], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([256, 364, 477, 377, 378, 459, 287, 388, 427, 593, 391, 331, 762, 610,
        290, 299, 868, 176, 486, 428], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 7-----------
Real SNR = tensor([5.7794, 8.2789, 3.2941, 9.7670, 8.7763, 8.4684, 4.7564, 3.3603, 3.5692,
        3.2295, 6.9783, 8.3521, 1.0481, 5.1526, 1.5668, 6.1109, 5.3835, 5.1257,
        0.6405, 9.7576], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([16.9602-2.5530e-07j,  3.8010-2.3934e-08j,  0.7091+1.3372e-08j,
         1.8939+4.7922e-08j,  9.3666+1.6393e-07j, 17.2930+4.8903e-07j,
         0.1914-2.4825e-09j,  0.1353-9.5227e-10j,  2.9998+4.7684e-07j,
         1.4367+3.7946e-08j, 27.0838+1.7196e-07j,  7.2945+2.3842e-07j,
         1.1419+9.2323e-09j,  4.6055-1.6985e-08j,  6.2144+4.9325e-07j,
        25.2816+6.0653e-07j,  2.1104-3.4083e-07j, 14.9250-0.0000e+00j,
         9.4409-7.9572e-09j,  6.0008+6.8752e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.944296360015869+1.3937498977156793e-07j)
torch.linalg.det(H.mH@H) = tensor([1.0970+1.1921e-07j, 6.2036-2.4758e-08j, 0.8697-1.9969e-08j,
        2.5933+1.2304e-08j, 4.5164+9.9554e-08j, 5.1091-4.2750e-08j,
        0.0309-1.0245e-08j, 0.1441+4.7531e-09j, 0.1642-1.1921e-07j,
        1.7854-2.1927e-08j, 4.2053-5.9389e-08j, 4.0050+1.1696e-07j,
        0.1494+1.4014e-09j, 0.2057-8.8093e-09j, 0.6814+2.7453e-09j,
        0.9716+3.1634e-08j, 0.2441+1.5807e-08j, 0.6140-7.4506e-08j,
        0.1417-7.4506e-09j, 3.2135-7.9986e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8472633361816406-3.23154991654917e-09j)
SINR torch.Size([20]) = tensor([ 1.7650,  3.6954, -4.1009, -4.3289,  2.9356,  3.2564, -9.5502, -9.5990,
         0.1582, -2.4122,  3.9044, -1.3942, -0.3389,  0.8891,  1.5207,  2.3374,
        -6.3171, -0.8826,  0.7253,  2.4185], device='cuda:0')
SINR mean = -0.7659006118774414
E[H^H] = 1e-07
E_MSE (Error Power) = 2.1411283016204834
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6002, 0.7008, 0.2800, 0.2696, 0.6628, 0.6791, 0.0998, 0.0988, 0.5091,
        0.3646, 0.7108, 0.4204, 0.4805, 0.5510, 0.5867, 0.6314, 0.1893, 0.4494,
        0.5417, 0.6357], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([295, 234, 498, 506, 257, 247, 674, 675, 349, 439, 228, 403, 366, 324,
        303, 276, 573, 385, 330, 274], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 8-----------
Real SNR = tensor([ 6.2910,  5.5609,  5.3782,  8.4273,  4.1044,  3.9244,  8.0144,  2.8879,
         5.5636,  7.7158,  6.8357,  5.7444,  4.9413, 10.6800,  8.9225,  4.5624,
         9.5506,  7.7560,  8.8973,  4.9823], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 2.7569+2.9614e-08j,  6.0334+2.9181e-08j,  2.3012-1.4062e-08j,
        24.3331+4.8150e-07j, 23.8247-3.9310e-07j,  2.4346-6.9443e-08j,
         8.0516-1.1921e-06j,  0.4147-0.0000e+00j,  1.9234-1.2336e-07j,
         2.5505+3.2954e-07j, 13.5433-1.3423e-07j,  3.7614+1.6166e-08j,
         1.1461+1.1921e-07j,  4.1179-1.7881e-06j,  1.0275-4.2200e-08j,
         5.2328+1.6635e-08j,  0.1235+1.7891e-08j, 10.9923-7.1628e-08j,
        11.3001-1.6933e-07j,  7.9608-8.5329e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.691490173339844-1.4831917383162363e-07j)
torch.linalg.det(H.mH@H) = tensor([7.2877e-01-1.2297e-07j, 8.7384e-01+9.6335e-09j, 1.5406e+00-2.0049e-08j,
        2.5570e+00-2.7064e-08j, 1.0603e+00-1.8368e-08j, 4.8953e-01+1.8626e-09j,
        6.0795e+00+1.0227e-08j, 2.9827e-01-1.3394e-10j, 7.6286e-01+1.1921e-07j,
        2.9796e+00-8.5906e-09j, 4.6377e-01+1.4901e-08j, 9.5520e-02-7.2579e-09j,
        7.2838e-01+5.9605e-08j, 3.2447e+00+2.4484e-08j, 3.6216e+00+8.1927e-08j,
        7.8792e-01-1.4414e-08j, 1.2656e+00-1.5221e-09j, 1.0452e+00+1.5015e-08j,
        3.7101e+00+3.0912e-08j, 1.3669e-03-1.5986e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6167137622833252+7.362443543712516e-09j)
SINR torch.Size([20]) = tensor([ -5.3767,   2.8463,   3.0705,   5.9177,   3.0060,  -0.7456,  -2.5227,
         -4.8016,  -4.7128,   1.2053,   3.1788,   0.5096,  -3.0619,  -2.5589,
         -2.9940,   3.1623, -11.3764,   4.5503,   4.5410,   1.2258],
       device='cuda:0')
SINR mean = -0.24685752391815186
E[H^H] = 1e-07
E_MSE (Error Power) = 1.9707205295562744
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2248, 0.6582, 0.6697, 0.7962, 0.6664, 0.4572, 0.3587, 0.2487, 0.2525,
        0.5689, 0.6752, 0.5293, 0.3307, 0.3568, 0.3342, 0.6744, 0.0679, 0.7403,
        0.7399, 0.5701], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([541, 260, 253, 172, 255, 380, 443, 522, 519, 313, 250, 337, 462, 444,
        459, 250, 726, 209, 209, 313], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)
--------SNR = 9-----------
Real SNR = tensor([12.8758, 10.0784,  7.2323,  8.0319,  6.2514,  4.6132,  9.5019,  9.5912,
         6.3562,  5.2186, 10.1633,  4.9789,  6.6302,  6.0347,  2.6124,  7.6357,
         4.9663,  6.5277, 11.3312,  5.5684], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([17.6673+1.1203e-07j,  3.9369+4.7684e-07j,  9.8228-6.7664e-07j,
         0.7829-3.2448e-08j,  0.8292+2.9802e-08j,  0.1765-2.2352e-08j,
         0.1677+3.8183e-08j,  5.9571+1.4314e-07j,  1.0047-4.5839e-09j,
         0.0838-1.8626e-09j,  8.3287-1.6573e-07j,  3.5380-1.7882e-08j,
         8.0570-6.9488e-08j,  1.8558+5.6045e-09j,  0.8056+5.9605e-08j,
         2.8138-4.7398e-08j,  0.5219+3.1292e-07j,  4.0762-4.9974e-08j,
         2.5934-3.5622e-08j,  0.8024+2.5826e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.691091299057007+3.998778197455977e-09j)
torch.linalg.det(H.mH@H) = tensor([1.7758-1.3059e-07j, 5.6200-1.9157e-08j, 0.8050+4.7335e-08j,
        0.1760+1.3301e-07j, 1.0253+1.4692e-08j, 0.0104-1.6298e-09j,
        0.5948+2.0509e-08j, 0.6728+5.6279e-09j, 0.3114+1.3305e-08j,
        1.0554+8.9407e-08j, 0.5218+6.0782e-10j, 0.8886+9.2094e-09j,
        2.2944+1.7653e-09j, 1.7705+1.2213e-09j, 2.1352-1.4110e-08j,
        1.9184+1.3093e-08j, 0.3786+5.0175e-09j, 0.4711-3.8527e-08j,
        5.5229+3.1667e-07j, 1.3407-6.7350e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.464459776878357+2.3035809704197163e-08j)
SINR torch.Size([20]) = tensor([  3.9213,   0.4099,   3.8267,  -0.5248,  -3.3360,  -9.3332,  -9.6529,
          3.8607,   0.1328, -10.3778,   3.4778,   2.6538,   2.6164,   0.2768,
         -5.3140,   3.6475,  -2.3773,   1.2212,  -4.7312,  -0.1253],
       device='cuda:0')
SINR mean = -0.9863823056221008
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0453832149505615
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.7115, 0.5236, 0.7071, 0.4698, 0.3169, 0.1044, 0.0977, 0.7087, 0.5076,
        0.0840, 0.6901, 0.6482, 0.6462, 0.5159, 0.2273, 0.6984, 0.3665, 0.5698,
        0.2517, 0.4928], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([227, 340, 230, 373, 471, 667, 677, 229, 350, 698, 240, 266, 267, 345,
        539, 235, 438, 313, 519, 359], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 40)

--- 処理中: 画像 61 から 80 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 60)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6583, 0.6377, 0.7080, 0.4698, 0.4843, 0.5120, 0.8771, 0.5660, 0.6880,
        0.6601, 0.6396, 0.6971, 0.6009, 0.7180, 0.5978, 0.4435, 0.5451, 0.5308,
        0.7748, 0.5434], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-7.2098, -8.5143, -7.6190, -8.0906, -9.4266, -4.8233, -4.4056, -7.2184,
        -6.2863, -6.0159, -8.1354, -5.4723, -3.6032, -8.0750, -2.9925, -4.2308,
        -4.6488, -2.8299, -8.7082, -6.9281], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 113.4728+9.5367e-06j,  131.0408-3.8147e-06j,  184.8927+7.6294e-06j,
         237.2244-1.4994e-06j, 1589.5688-3.4448e-05j,  151.9324+1.5343e-06j,
         143.8716+1.2992e-05j,  502.5231-9.0655e-06j,   74.5492+1.1252e-05j,
         179.0249+4.5776e-05j,  483.3657+1.0050e-05j, 2680.1001-5.0360e-05j,
          95.8184-2.4206e-07j,  589.2958-5.2606e-06j,  565.6440+1.4697e-06j,
          18.1758+4.4514e-07j,   35.3276+4.8735e-07j,  174.5822-0.0000e+00j,
         893.3942-9.9726e-06j,   86.9555-3.0606e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(446.5379943847656-8.275016512016009e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.9481+1.2135e-08j,  0.0683+2.7842e-09j,  2.3783-2.5624e-08j,
         0.6968-4.3108e-09j,  0.2770+2.2352e-08j,  6.1753-2.6731e-08j,
         0.9639+1.4231e-08j,  0.2441-2.2352e-08j,  2.4281-1.2735e-08j,
         3.1985-2.0720e-08j,  1.2369+2.5111e-08j,  1.5697+2.6936e-08j,
         8.3557+8.8016e-08j,  1.9146+1.8599e-08j, 13.7060+1.0614e-08j,
         3.0264+1.5847e-09j,  2.1494+1.3374e-08j,  1.9375-6.8468e-08j,
         0.0446+1.9142e-08j,  1.9534+5.3209e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.663634777069092+6.3573466491106956e-09j)
SINR torch.Size([20]) = tensor([-5.7634, -3.5371, -1.2992, -1.9739, -1.2343, -0.7875, -4.9632, -0.9750,
        -5.5803, -4.2928, -2.4698, -0.2296, -1.4926, -1.7609, -0.4787, -7.9536,
        -3.9258, -2.8877, -0.6632, -3.9092], device='cuda:0')
SINR mean = -2.808898448944092
E[H^H] = 1e-07
E_MSE (Error Power) = 2.191408157348633
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2096, 0.3069, 0.4258, 0.3883, 0.4294, 0.4548, 0.2418, 0.4441, 0.2167,
        0.2712, 0.3615, 0.4868, 0.4149, 0.4000, 0.4725, 0.1381, 0.2882, 0.3396,
        0.4619, 0.2890], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([554, 478, 400, 423, 397, 382, 527, 388, 548, 504, 441, 362, 406, 416,
        371, 625, 492, 456, 377, 491], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -4-----------
Real SNR = tensor([ -7.0445,  -1.8202,  -1.9646,  -8.0330,  -7.1047,  -4.3888,  -6.8433,
         -4.0749,  -6.5277, -11.6476,  -6.8148,  -2.9705,  -6.6883,  -4.4276,
         -1.0364,  -4.5916,  -5.5927,  -3.9165,  -1.1849,  -6.7332],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 205.6392-4.1870e-05j,  113.4608+5.7220e-06j,  329.1009+4.5776e-05j,
         213.4008-5.1755e-06j,   76.0351+4.4240e-06j,    7.7971-2.0264e-07j,
          39.9758+3.8147e-06j,  102.3668-5.6903e-06j,  110.8993-1.1702e-05j,
          23.1593+2.2776e-08j,  253.1036-3.5945e-07j,   30.0969-6.3839e-08j,
          73.9361-9.0958e-08j,  516.4058+3.7598e-05j,  160.2462+3.5930e-05j,
          64.6865-3.0098e-06j,  784.1051+5.4778e-06j, 1207.0493+1.8251e-05j,
           9.7765+7.2601e-07j,  248.0595-6.1035e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(228.4650115966797+1.4271502095652977e-06j)
torch.linalg.det(H.mH@H) = tensor([1.1885e+00-2.1163e-08j, 6.0802e+00-1.4459e-09j, 4.7544e+00+1.8617e-07j,
        3.1550e-02-1.8626e-08j, 1.6112e+00+4.3045e-08j, 1.3854e+00-0.0000e+00j,
        3.8405e-01-4.5635e-08j, 6.8398e-01-5.5238e-08j, 2.8547e-01-1.2682e-07j,
        1.2925e-02-1.3916e-09j, 7.7044e-01-7.4506e-08j, 2.8707e-03+4.1635e-08j,
        1.0148e+00-1.0444e-08j, 2.5788e-01-1.2946e-08j, 1.7634e+00-5.2582e-08j,
        2.6428e+00+1.2635e-07j, 1.2680e+00-5.9605e-08j, 3.4874e-01+3.3740e-09j,
        1.2489e+00+2.3842e-07j, 4.2849e-01+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3082040548324585+1.0909796621660917e-08j)
SINR torch.Size([20]) = tensor([-3.1515, -5.1231, -1.2591, -2.5710, -4.1277, -7.4914, -4.0211, -3.3032,
        -4.6294, -3.7020, -1.2415, -1.8344, -2.0878, -1.7496, -5.6941, -3.5247,
        -0.1867, -0.3078, -8.9574, -2.5266], device='cuda:0')
SINR mean = -3.374509811401367
E[H^H] = 1e-07
E_MSE (Error Power) = 2.6051619052886963
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3261, 0.2351, 0.4280, 0.3562, 0.2788, 0.1512, 0.2838, 0.3185, 0.2562,
        0.2989, 0.4290, 0.3959, 0.3821, 0.4006, 0.2123, 0.3076, 0.4893, 0.4823,
        0.1128, 0.3585], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([465, 533, 398, 444, 499, 611, 495, 470, 516, 484, 398, 419, 427, 416,
        552, 478, 361, 365, 656, 443], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -3-----------
Real SNR = tensor([ -2.3860,   0.2844,  -2.4246,   2.2652,  -8.9744,  -3.2309,  -5.3592,
         -2.7606,  -1.3610, -10.2621,  -6.5450,  -5.9003,  -1.7521,  -7.8486,
         -6.2091,  -5.0730,  -5.9409,  -5.4822,  -1.4841,  -2.2261],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 600.0585-2.5103e-06j,   32.0589-2.5034e-06j,    6.1154-1.3270e-06j,
         173.2098-6.1414e-06j,  386.3131+3.4113e-06j,  130.4281+8.6145e-09j,
         185.8311+3.9999e-06j,  340.3255-5.5790e-06j,   51.0345+4.4771e-08j,
          18.3946-9.5367e-07j,   11.7175-1.4305e-06j,   24.2341+4.7684e-07j,
          31.7812-1.9417e-05j,   23.3715-7.5605e-07j,   63.3050-7.9136e-07j,
        2990.0679-2.5811e-05j,   19.2768-1.9471e-07j,  184.1658+2.7727e-06j,
         318.1679+1.8611e-06j,   51.2509+9.8965e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(282.0553894042969-2.2471785996458493e-06j)
torch.linalg.det(H.mH@H) = tensor([7.9796e-01+2.2042e-08j, 9.0355e+00+7.5073e-08j, 8.7330e-03-1.1450e-08j,
        1.2724e+01+2.6344e-08j, 5.9768e-02-4.7803e-09j, 2.6127e+00+8.1364e-08j,
        8.8030e-01-2.2553e-08j, 7.0402e+00+9.4741e-08j, 6.6713e+00+4.9452e-08j,
        9.0350e-02-6.1488e-10j, 5.5164e-01+2.8378e-08j, 9.9147e-01-5.1947e-08j,
        4.5414e+00-1.7774e-07j, 3.9677e-01+3.7253e-09j, 4.2430e-01+1.4498e-07j,
        4.7626e-01+1.1008e-08j, 8.3001e-01+7.2270e-10j, 9.3000e-01+6.5250e-09j,
        8.5764e-01+5.3644e-07j, 7.1527e+00+1.3835e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.8536508083343506+4.750287985189061e-08j)
SINR torch.Size([20]) = tensor([ -0.8767,  -7.0047, -13.9583,  -1.6204,  -1.3579,  -2.3139,  -2.2552,
          0.4933,  -2.5533,  -7.3040,  -5.9210,  -6.3484,  -7.4888,  -5.2904,
         -1.8995,  -0.2484,  -5.6366,  -2.5744,   0.8388,  -6.0465],
       device='cuda:0')
SINR mean = -3.9683189392089844
E[H^H] = 1e-07
E_MSE (Error Power) = 3.8552091121673584
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4497, 0.1662, 0.0386, 0.4078, 0.4225, 0.3699, 0.3730, 0.5284, 0.3571,
        0.1569, 0.2037, 0.1882, 0.1513, 0.2283, 0.3924, 0.4857, 0.2145, 0.3560,
        0.5481, 0.1990], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([385, 595, 795, 411, 402, 435, 433, 337, 444, 605, 559, 574, 610, 538,
        421, 363, 550, 445, 326, 564], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -2-----------
Real SNR = tensor([-1.1115, -0.8443, -2.1877,  0.3027, -1.2592, -6.5246, -2.2087, -0.2554,
        -1.0181,  0.0618,  0.1492,  0.7877, -3.0811, -4.4117, -5.4976, -1.0769,
        -0.8933, -2.6521, -2.5747,  1.3269], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([   7.0043-6.2008e-06j,   35.7987-4.0455e-06j, 1338.4741-9.9535e-06j,
           4.3191-6.8364e-07j,   15.1452+2.5845e-07j,  188.2188-2.9657e-06j,
         550.9799-2.8124e-05j,   37.3013+2.7700e-06j,    9.7635+3.5370e-07j,
           6.7565+2.6798e-07j,  165.9034-1.9909e-06j,  306.0030+3.0518e-05j,
         129.0973-2.1036e-06j,  269.5813+5.8548e-06j,   53.2162+8.5831e-06j,
         148.7169-3.8147e-06j,    9.9163+9.5367e-07j,   10.2642-3.9199e-06j,
          12.2425+5.9089e-07j,  152.9550+1.3192e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(172.5828857421875-6.166192179080099e-07j)
torch.linalg.det(H.mH@H) = tensor([ 3.5624+3.5430e-07j,  3.0878+1.3981e-07j,  2.9779-6.1589e-08j,
         1.2426-1.1041e-07j,  0.6631+2.1819e-08j,  0.0884+5.7427e-09j,
         1.1856+1.3492e-08j,  3.0128+1.0325e-07j,  2.8547+1.5093e-08j,
         4.6563+2.5187e-07j,  7.3647+2.1748e-07j, 14.4304+1.1927e-07j,
         0.4897+5.7838e-08j,  0.7009+2.2173e-08j,  0.5579-2.2352e-08j,
         0.4246+1.0431e-08j,  0.1952-3.1797e-09j,  0.2428-2.8357e-09j,
         0.3316-1.0754e-07j,  8.2756-9.9361e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.817246437072754+4.6264496234016406e-08j)
SINR torch.Size([20]) = tensor([-10.7098,  -5.5334,   0.4247,  -9.3572,  -3.5202,   0.0898,  -1.0897,
         -4.6725,  -8.9828,  -9.0075,  -0.2812,  -1.0532,  -1.7172,  -0.1383,
         -5.4065,  -2.2902,  -6.6790, -11.6460,  -6.5757,  -3.0247],
       device='cuda:0')
SINR mean = -4.558540344238281
E[H^H] = 1e-07
E_MSE (Error Power) = 4.567793369293213
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0783, 0.2186, 0.5244, 0.1039, 0.3078, 0.5052, 0.4376, 0.2543, 0.1122,
        0.1116, 0.4838, 0.4397, 0.4024, 0.4920, 0.2236, 0.3711, 0.1768, 0.0641,
        0.1803, 0.3326], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([708, 547, 340, 668, 478, 351, 392, 517, 657, 658, 364, 391, 414, 359,
        542, 435, 584, 734, 581, 460], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = -1-----------
Real SNR = tensor([ -7.7997,  -1.1643,  -4.7627,  -2.4830,  -5.2570,  -1.8171,  -1.4003,
          1.5410,  -0.2063,   1.2182,  -0.9402, -10.0954,  -1.5213,  -3.0573,
          3.2696,   1.7274,  -1.4561,  -3.2750,  -3.6939,  -0.0869],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 59.4722-1.9073e-06j,   1.7618-3.1292e-07j,   1.2772-1.0266e-07j,
         93.5702+1.0836e-06j,  59.8647+9.5367e-07j,  51.0646+3.7561e-06j,
         74.6689-6.2690e-06j,   4.3047+2.7449e-07j, 147.7768-1.9731e-06j,
         30.7543+9.5401e-08j,   0.9311+7.0092e-07j,  95.4545-6.2944e-07j,
         15.5991-4.3166e-08j,  39.3622-1.0177e-07j, 872.2941-7.5880e-06j,
          2.4217-7.9031e-07j,  28.8960+1.7988e-06j,  29.8149-5.8013e-07j,
         53.6733-1.1102e-07j,  96.8830-4.5924e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(87.99227142333984-8.169050715878257e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.0813+1.1176e-08j,  3.2839+3.0158e-08j,  0.1519-8.7304e-09j,
         0.3116-2.9802e-08j,  0.1997+1.8691e-08j,  2.1899+3.7520e-08j,
         3.5706-1.1921e-07j,  0.5220-2.9802e-07j,  4.1498-3.5763e-07j,
         6.0644+3.3656e-08j,  2.2975-9.7552e-08j,  0.1108-3.9336e-09j,
         2.8047+1.4434e-10j,  0.1317+4.4703e-08j, 19.5763+1.6433e-07j,
         8.5092-8.7265e-08j,  2.3548-0.0000e+00j,  0.1729+3.5585e-09j,
         1.0496+9.0768e-09j,  2.9648-1.1313e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.0248868465423584-3.2513341352569114e-08j)
SINR torch.Size([20]) = tensor([ -2.2321, -11.9073, -12.4804,   0.4219,  -5.0793,  -3.1838,   0.3750,
        -10.0021,  -0.0567,  -3.8910, -12.9017,  -1.6841,  -4.5781,  -2.9622,
         -0.2174, -13.2934,  -3.1503,  -3.6227,  -2.1146,  -1.5730],
       device='cuda:0')
SINR mean = -4.706666946411133
E[H^H] = 1e-07
E_MSE (Error Power) = 6.029942989349365
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3743, 0.0606, 0.0535, 0.5243, 0.2369, 0.3245, 0.5216, 0.0909, 0.4967,
        0.2899, 0.0488, 0.4043, 0.2584, 0.3358, 0.4875, 0.0447, 0.3262, 0.3028,
        0.3806, 0.4104], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([432, 741, 757, 340, 531, 466, 341, 687, 356, 490, 768, 413, 514, 458,
        362, 778, 465, 481, 428, 409], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 0-----------
Real SNR = tensor([-2.8266,  0.3481,  1.1257, -3.8663, -0.3019, -4.2122, -0.6641,  0.8929,
        -0.7748, -0.1280,  1.4907, -1.5012, -0.8527, -2.3084,  0.6045, -6.0012,
        -3.4188,  2.2654, -3.9395,  1.3910], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 52.4481+3.3905e-07j,  35.6901+1.3942e-07j,  12.1478-4.7684e-07j,
          9.9946+9.1119e-06j,  19.8897+8.5831e-06j,  17.6957+4.0676e-07j,
         49.6202+5.7220e-06j,  16.2328-1.4329e-07j,  40.5046-5.7220e-06j,
         21.3242+2.2903e-07j,  33.6279+5.7220e-06j,  47.4174-6.1314e-07j,
          0.9230+5.1294e-07j, 152.4779+1.4973e-06j,   8.0201+7.1526e-07j,
          1.8541-0.0000e+00j,  23.6207-3.8147e-06j,  13.1818+7.7621e-07j,
         15.2705+2.3842e-07j,   4.5582+1.2010e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(28.82496452331543+1.2212207138873055e-06j)
torch.linalg.det(H.mH@H) = tensor([1.1927+1.0871e-08j, 1.2737-6.7828e-08j, 2.4701+9.8580e-08j,
        0.2951+1.7557e-09j, 0.3435+3.3366e-09j, 0.2638-2.4168e-09j,
        5.3637-3.8076e-08j, 4.7367-6.2428e-09j, 1.2201-9.4137e-09j,
        0.1071-2.2352e-08j, 5.6801+3.0534e-08j, 1.7473+9.2609e-09j,
        0.5084+6.9614e-09j, 0.0356-4.6566e-09j, 6.4598+7.8412e-08j,
        0.1218-1.9061e-09j, 0.6376+1.7467e-08j, 5.6794-5.7074e-08j,
        0.3792-7.4506e-09j, 1.7601+1.5190e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.0137851238250732+2.747613914166891e-09j)
SINR torch.Size([20]) = tensor([  0.8377,  -1.8119,  -4.5760,  -6.8163,  -2.9862,  -4.8708,  -0.3521,
         -3.2100,  -4.3224,  -1.4736,  -2.6375,   0.5760, -14.8833,   0.0430,
         -7.6017,  -7.3225,  -4.1096,  -7.2589,  -3.1885,  -7.3124],
       device='cuda:0')
SINR mean = -4.1638407707214355
E[H^H] = 1e-07
E_MSE (Error Power) = 4.308749675750732
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5481, 0.3972, 0.2585, 0.1723, 0.3346, 0.2457, 0.4797, 0.3232, 0.2699,
        0.4160, 0.3527, 0.5331, 0.0315, 0.5025, 0.1480, 0.1563, 0.2796, 0.1582,
        0.3243, 0.1566], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([326, 418, 514, 589, 459, 524, 367, 467, 505, 406, 447, 335, 818, 353,
        614, 605, 498, 603, 466, 605], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 1-----------
Real SNR = tensor([ 1.3076, -0.2399, -2.2290, -0.1505,  1.4683,  3.1770,  1.0558,  0.4077,
        -0.3026, -0.6546,  0.8623, -1.7019, -1.1545, -1.1976,  1.6969,  2.4772,
         1.6769,  2.0668,  2.6542,  1.1743], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  1.8189+7.0482e-06j,  20.8567-1.5093e-07j,  19.6029+6.6050e-07j,
          4.3311-8.3447e-07j,   0.6819+9.8956e-09j,  72.0210-1.5600e-06j,
          9.9525-0.0000e+00j,  13.7495-2.1772e-07j,  41.6028+7.1583e-07j,
          3.0576-4.7684e-06j, 206.5088+2.7746e-06j,   1.7999-1.5076e-07j,
         31.9071-5.6963e-08j,  27.1435+2.9895e-07j,  62.9654-1.1921e-07j,
         27.4831+3.8775e-07j,  23.3294+2.9405e-07j,  86.6491-5.6724e-06j,
        149.0447+3.9880e-06j,  19.2010-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(41.18535232543945+1.3234848950105516e-07j)
torch.linalg.det(H.mH@H) = tensor([2.1216-2.3144e-08j, 0.0876+3.7253e-09j, 1.4387-5.8245e-09j,
        0.2671+3.7253e-08j, 2.2118-3.7741e-08j, 1.2028-0.0000e+00j,
        1.0122+1.9210e-07j, 1.3290-2.3711e-08j, 0.7768-1.4901e-08j,
        2.8869-2.3068e-09j, 0.2119+1.1991e-07j, 1.9662+5.3831e-08j,
        0.8145+3.5579e-09j, 0.3334+2.4381e-09j, 5.4145-8.3149e-08j,
        1.0623-2.9802e-07j, 0.1736+2.2724e-07j, 1.0065-4.1462e-07j,
        5.1120-2.3842e-07j, 1.9939+5.9605e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.5711716413497925-2.210849991968189e-08j)
SINR torch.Size([20]) = tensor([-14.5175,  -4.9478,  -2.6395,  -4.5115,  -9.9733,   0.8885,  -4.1303,
         -3.3302,  -1.0321, -13.6207,   0.5347,  -8.8614,   1.5446,  -2.3620,
         -0.2267,  -0.8119,  -0.7671,  -1.8065,  -1.3933,  -1.6417],
       device='cuda:0')
SINR mean = -3.680278778076172
E[H^H] = 1e-07
E_MSE (Error Power) = 5.355012893676758
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0341, 0.2425, 0.3526, 0.2614, 0.0914, 0.5510, 0.2787, 0.3172, 0.4409,
        0.0416, 0.5307, 0.1150, 0.5880, 0.3673, 0.4870, 0.4534, 0.4560, 0.3975,
        0.4205, 0.4066], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([809, 527, 447, 512, 686, 324, 499, 471, 390, 787, 336, 653, 302, 437,
        362, 383, 381, 418, 403, 412], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 2-----------
Real SNR = tensor([ 0.4391,  0.6173,  0.0334,  1.2537,  1.4049,  1.4520,  1.6067,  2.3604,
        -0.7578,  4.6749, -0.7635, -0.6402, -1.4832,  1.5164,  0.9438,  2.0774,
         3.0243,  1.2144, -0.0478,  1.1733], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([38.9012+1.2314e-06j, 16.3974+2.3240e-07j,  1.7629+2.5053e-08j,
        41.9390+5.3716e-07j,  8.9800-4.8216e-08j,  1.4187-7.6619e-08j,
        10.0249-6.6757e-07j,  1.4447-5.2154e-08j,  8.2278-3.4255e-06j,
         7.2882-2.9739e-07j,  4.7952-2.3442e-08j, 63.4708+3.5407e-07j,
        13.2888+5.4807e-07j, 27.0976-1.5984e-07j, 60.5496+1.4305e-06j,
         3.4134-1.6391e-07j, 10.8251-9.8034e-08j, 17.9568+1.4408e-08j,
        27.7400-4.8283e-10j,  3.6173+1.1667e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(18.45696449279785-3.141696680586392e-08j)
torch.linalg.det(H.mH@H) = tensor([2.7473e+00+6.9179e-08j, 2.2405e+00-3.4095e-08j, 1.1721e+00-0.0000e+00j,
        6.3499e-03-1.9736e-09j, 1.8624e+00-1.7881e-07j, 1.5550e+00+2.9021e-08j,
        4.0607e+00+1.8854e-08j, 2.2211e+00+4.6590e-09j, 8.7687e-01+2.6920e-08j,
        7.7147e+00-2.3842e-07j, 4.2496e-01+5.9605e-08j, 1.4824e+00-2.4724e-08j,
        3.2522e-01-7.4506e-09j, 4.3694e+00-1.2568e-07j, 5.5839e-01-2.9802e-08j,
        2.9862e-01+3.8702e-08j, 7.0750e-01+4.9731e-08j, 1.4538e+00-7.7697e-09j,
        1.6710e+00+1.7334e-08j, 1.2949e+00+5.6374e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8521616458892822-1.6454313467306747e-08j)
SINR torch.Size([20]) = tensor([-2.0370, -0.4902, -7.4519, -1.3390, -3.3984, -9.4246, -4.6275, -9.4024,
        -4.8481, -5.3904, -2.5183,  0.1499, -1.7352,  0.0379, -2.4842, -3.8734,
        -2.6391, -4.5524, -1.3412, -2.3381], device='cuda:0')
SINR mean = -3.4851739406585693
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0398776531219482
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3848, 0.4718, 0.1524, 0.4235, 0.3138, 0.1025, 0.2563, 0.1029, 0.2467,
        0.2242, 0.3590, 0.5086, 0.4014, 0.5022, 0.3608, 0.2907, 0.3526, 0.2596,
        0.4234, 0.3686], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([426, 371, 609, 401, 473, 670, 516, 669, 523, 542, 443, 349, 415, 353,
        441, 490, 447, 513, 401, 436], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 3-----------
Real SNR = tensor([-1.8079,  1.6338,  3.0608,  2.6022,  0.2217,  1.2457,  0.8281,  1.0240,
         0.4277,  0.4216, -1.1124,  1.7672,  5.3446,  2.7076,  2.0285,  1.3180,
         3.1411,  1.7175,  2.4786,  4.9910], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([18.5153+5.5826e-07j, 97.8785+8.3733e-07j, 52.4447+7.0097e-07j,
        23.2681-2.0960e-07j, 29.0658+9.1266e-07j,  0.4148+1.2492e-07j,
        10.9936+4.7684e-07j, 21.4921-2.3128e-07j, 16.1036-8.0749e-08j,
        11.3230+1.0978e-06j,  5.4683-3.9659e-09j,  1.7843+3.4845e-08j,
         9.2379+1.4659e-06j, 16.7007+9.1941e-10j,  3.1139+5.9605e-07j,
         0.9434+4.1723e-07j,  1.0020+3.1015e-08j, 31.9308+1.3557e-07j,
         3.9319+4.8876e-06j, 43.1040+8.3522e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(19.935836791992188+6.293726073636208e-07j)
torch.linalg.det(H.mH@H) = tensor([0.4411+2.5116e-08j, 0.5777+1.1147e-08j, 0.0901-1.6019e-07j,
        1.7416-7.0148e-08j, 1.3480+5.0536e-08j, 0.7484+7.4506e-09j,
        0.9163+7.8213e-10j, 0.3047+4.7665e-09j, 1.2753-1.1921e-07j,
        0.8991+9.1255e-09j, 1.0290-1.5746e-08j, 1.4341-1.6037e-07j,
        3.5977-1.1815e-07j, 0.1315-7.4506e-09j, 0.0419+1.0959e-08j,
        1.0536+1.7881e-07j, 1.6430+7.9476e-08j, 0.9881-0.0000e+00j,
        0.7629-5.9605e-08j, 0.1553-6.5415e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (0.9589827656745911-1.9905655790353194e-08j)
SINR torch.Size([20]) = tensor([  0.0427,  -1.1478,   2.1629,  -2.8890,  -1.6716, -12.6338,  -0.5995,
          0.7936,  -0.5268,  -0.4609,   0.5796,  -7.5885,  -2.8607,   0.1262,
         -7.3673, -10.3444,  -5.0707,  -0.3552,  -7.9250,  -1.1663],
       device='cuda:0')
SINR mean = -2.945125102996826
E[H^H] = 1e-07
E_MSE (Error Power) = 3.3523929119110107
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5025, 0.4343, 0.6220, 0.3396, 0.4049, 0.0517, 0.4655, 0.5456, 0.4697,
        0.4735, 0.5333, 0.1484, 0.3410, 0.5073, 0.1549, 0.0846, 0.2373, 0.4796,
        0.1389, 0.4333], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([353, 394, 282, 456, 413, 761, 375, 327, 373, 370, 334, 614, 455, 350,
        607, 697, 531, 367, 624, 395], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 4-----------
Real SNR = tensor([ 3.3205,  6.9530,  3.0103,  4.7602,  6.5120,  3.1060,  2.4231,  3.3325,
         1.5507,  0.6514,  1.9357,  5.2524,  1.9945, -1.1854,  2.5196,  3.8656,
         0.3620,  6.8872,  5.0036, -2.1434], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 4.1977-9.2787e-07j, 28.1170-6.1009e-08j,  2.0739-1.1428e-07j,
         3.6431-5.5694e-08j, 20.8767-2.1365e-06j,  6.1982-3.0370e-08j,
         0.4824+5.3374e-08j, 10.7270-1.1921e-07j,  1.5499+4.0788e-09j,
         2.5576+4.7684e-07j, 16.6018+4.4846e-08j, 13.8575+7.7707e-08j,
        16.0629-1.0989e-07j,  6.7324-2.5705e-08j,  2.9195-1.1921e-07j,
         2.8947+1.0710e-07j,  6.4709-1.0832e-07j,  2.9939-4.7684e-07j,
        16.9033+7.7685e-08j,  0.2525+6.7055e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.305652618408203-1.6881141107205622e-07j)
torch.linalg.det(H.mH@H) = tensor([ 0.0549+1.1462e-08j,  3.6505+2.9770e-08j,  0.9096-5.9605e-08j,
         0.4817+2.4653e-09j, 11.1888+1.4836e-07j,  0.1234-3.7253e-09j,
         0.2152-9.1591e-08j,  3.3274+3.4789e-08j,  0.8229+9.2947e-09j,
         0.5598+1.0953e-08j,  1.6771+9.1438e-09j,  0.1175-1.5225e-08j,
         0.9269-1.8989e-08j,  0.3677+3.7253e-09j,  1.3326+2.9628e-08j,
         3.6115+4.2590e-08j,  0.8531-2.8031e-09j,  6.9894+4.3510e-08j,
         0.6064-1.1587e-08j,  0.2280+1.5055e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9022184610366821+8.683749719295975e-09j)
SINR torch.Size([20]) = tensor([ -3.0523,   1.2635,  -5.4458,  -4.6853,   2.1760,  -0.6796,  -8.9872,
          0.2611,  -0.7358,  -4.7423,   2.5062,  -2.4756,  -3.6612,  -3.3828,
         -6.8685,  -2.3797,  -4.7141,  -5.7676,   0.1668, -10.3665],
       device='cuda:0')
SINR mean = -3.078535556793213
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0050811767578125
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3312, 0.5722, 0.2220, 0.2537, 0.6227, 0.4610, 0.1121, 0.5150, 0.4577,
        0.2512, 0.6404, 0.3612, 0.3009, 0.3146, 0.1706, 0.3663, 0.2525, 0.2095,
        0.5096, 0.0842], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([461, 311, 544, 518, 281, 378, 657, 345, 380, 520, 271, 441, 482, 473,
        591, 438, 519, 554, 349, 698], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 5-----------
Real SNR = tensor([ 9.3135,  3.6642,  1.2689,  4.4864,  3.3562,  9.7465,  1.3313,  3.7781,
        -2.0968,  8.6193,  4.5893,  3.0194,  1.6661,  2.8157,  2.5024,  4.4248,
         6.5945,  5.3501,  3.0908,  1.8626], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.9190e+00-3.3601e-07j, 6.3806e+01+3.0040e-07j, 1.3981e+01+1.4305e-06j,
        2.1327e-02+3.2410e-07j, 4.3141e+00-6.4817e-08j, 2.2504e+01-1.3963e-08j,
        2.2007e+00+5.9605e-08j, 2.6440e+01-1.2481e-07j, 6.1168e+00-1.2701e-07j,
        2.1900e+01-2.2829e-07j, 4.0682e+01-5.5301e-07j, 5.0300e+00+1.1921e-07j,
        9.8286e-01-2.9061e-07j, 3.5283e+00+1.4339e-07j, 1.1762e+01-1.7751e-07j,
        9.6584e+00+2.5458e-07j, 2.2374e+01+1.4946e-07j, 2.0309e+00-4.6347e-07j,
        1.6899e+00+8.7781e-08j, 2.4382e+00+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(13.268963813781738+3.043700047555831e-08j)
torch.linalg.det(H.mH@H) = tensor([14.0988+1.1904e-07j,  1.5368-1.4605e-08j,  0.5462+2.9802e-08j,
         0.9231+1.9381e-08j,  0.8833+5.9605e-08j,  6.7026-3.8225e-07j,
         0.0188+2.6579e-09j,  0.8443+2.3388e-08j,  0.0415+4.5379e-09j,
         0.9939+1.7120e-07j,  0.1105+1.7881e-07j,  1.0428+7.3999e-09j,
         0.0216-6.3522e-09j,  0.6634-2.7863e-08j,  2.8179+2.9431e-09j,
         1.5314+4.7902e-08j,  0.5015+1.6391e-07j,  2.5201-3.9660e-08j,
         0.0210-9.0571e-08j,  0.1791+4.9341e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7999337911605835+1.371037683384202e-08j)
SINR torch.Size([20]) = tensor([ -2.5775,   1.4919,   1.0734, -22.3839,  -3.9971,   2.4001,  -5.2322,
          0.4339,  -0.8344,   1.1264,   1.9562,  -3.4592,  -6.3532,  -2.5455,
         -0.2580,  -1.6343,   1.6749,  -3.2785,  -4.7940,  -2.0749],
       device='cuda:0')
SINR mean = -2.4632935523986816
E[H^H] = 1e-07
E_MSE (Error Power) = 14.822601318359375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3558, 0.5850, 0.5615, 0.0057, 0.2849, 0.6347, 0.2306, 0.5250, 0.4521,
        0.5645, 0.6107, 0.3108, 0.1880, 0.3575, 0.4852, 0.4070, 0.5952, 0.3198,
        0.2490, 0.3828], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([445, 304, 318, 982, 494, 274, 536, 339, 383, 316, 288, 475, 574, 443,
        363, 411, 298, 469, 522, 427], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 6-----------
Real SNR = tensor([ 5.3379,  6.4775,  9.6477,  2.6312,  6.6213,  5.4643,  6.9355, -0.2878,
         7.2062,  3.7858,  1.5114,  2.0863,  4.8793,  5.7302,  2.4132,  5.5119,
         8.2976,  2.3492,  9.7454,  5.0580], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 9.2807+3.8112e-08j,  5.7260-8.1756e-08j,  0.2961-8.4646e-08j,
         0.9324+2.7434e-07j, 18.6238+1.8262e-09j,  1.1999+1.2834e-08j,
        11.8554+7.1526e-07j,  8.6370+5.4142e-07j,  3.0776-2.7438e-08j,
         8.3583+5.3124e-10j,  5.1719+1.2418e-07j,  0.3645-3.8807e-09j,
         0.8475+9.4190e-09j, 30.2340-2.5370e-08j, 12.7194+1.5406e-07j,
        20.6326+1.8953e-07j,  4.3482-3.9606e-07j,  1.8369-1.6156e-07j,
         5.2485-1.1245e-07j,  6.8284-0.0000e+00j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.810951232910156+5.841787853455571e-08j)
torch.linalg.det(H.mH@H) = tensor([2.6521-5.9605e-08j, 0.9723-9.0530e-10j, 4.9070+1.3708e-07j,
        0.0120-3.1981e-09j, 2.0750-5.4849e-08j, 1.0589-2.2352e-08j,
        4.0876-2.4199e-08j, 0.2881+1.3033e-08j, 8.3794+2.4193e-09j,
        1.4304+1.1921e-07j, 0.2194-1.6168e-09j, 0.9073+2.6777e-09j,
        1.6317-9.3511e-10j, 4.6918-1.8638e-08j, 0.1534-2.5262e-08j,
        0.4754+2.1558e-08j, 1.2232-5.7933e-09j, 0.6316+7.4529e-09j,
        4.4189-1.8949e-07j, 0.4205+7.0541e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.031804084777832-1.6439181127481106e-09j)
SINR torch.Size([20]) = tensor([  2.6644,  -1.1378, -10.2170, -10.4237,   3.9113,  -3.5031,  -3.4275,
         -2.8168,   0.2781,   1.7060,   0.3692,  -6.2189,  -8.5242,   3.3964,
          3.3479,   1.8096,  -5.0489,  -2.5006,   3.3134,  -1.7198],
       device='cuda:0')
SINR mean = -1.7371009588241577
E[H^H] = 1e-07
E_MSE (Error Power) = 3.137082815170288
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6487, 0.4349, 0.0869, 0.0832, 0.7111, 0.3086, 0.3123, 0.3433, 0.5160,
        0.5970, 0.5212, 0.1928, 0.1232, 0.6861, 0.6837, 0.6027, 0.2382, 0.3599,
        0.6820, 0.4023], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([266, 394, 693, 699, 228, 477, 474, 453, 345, 297, 342, 569, 643, 243,
        244, 293, 530, 442, 245, 414], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 7-----------
Real SNR = tensor([ 6.0939,  8.1941,  5.5239,  6.8243,  9.4752,  3.3061,  2.3951,  6.6502,
        -1.6063,  4.3607,  9.4055,  9.6387,  1.9214,  4.2809,  1.1812,  1.1777,
         6.0912,  6.0433,  7.3813,  5.5910], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([7.7309e+00-2.7438e-07j, 2.6960e-01+4.3325e-09j, 1.1923e+00+1.8816e-07j,
        1.3824e+01-4.3098e-07j, 1.0109e+00+5.0264e-07j, 1.4789e-02-3.9581e-09j,
        9.0553e-01+1.6508e-08j, 2.7004e+00-2.3200e-08j, 1.9820e+00-5.4555e-08j,
        2.1549e+00-5.9605e-08j, 1.8127e+01+3.0012e-07j, 8.2524e+01-6.8171e-07j,
        2.9588e+00+2.7478e-07j, 5.6353e+00+2.1765e-07j, 1.1599e+00-5.8377e-08j,
        4.1454e+00-7.8813e-08j, 1.0248e+00-4.0888e-08j, 1.3446e+00+1.8579e-08j,
        3.3833e+00+2.9802e-08j, 1.0790e-01-5.7018e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.609792232513428-7.979217286901985e-09j)
torch.linalg.det(H.mH@H) = tensor([9.4016e-01-1.7075e-08j, 1.4501e+00+4.2270e-08j, 1.8544e+00-7.7042e-08j,
        6.3190e+00-1.9959e-08j, 1.4094e-01+7.8379e-08j, 8.0234e-01+2.3152e-08j,
        2.7350e-01+9.0067e-10j, 2.0466e+00-1.7881e-07j, 1.0345e-01-1.8199e-09j,
        1.8681e+00+2.0763e-09j, 6.3338e+00-7.1526e-07j, 1.4886e+01-2.8450e-08j,
        7.5047e-03+4.1791e-08j, 2.0179e-01+1.1241e-08j, 8.4911e-02+1.7881e-07j,
        3.1772e-01+5.8526e-09j, 4.9407e-01-3.9597e-08j, 1.1223e+00+1.2535e-08j,
        6.0777e+00+1.4559e-08j, 3.6666e-01+3.2165e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2845423221588135-3.1713849324432886e-08j)
SINR torch.Size([20]) = tensor([  0.2507,  -4.6336,  -5.0126,   2.1730,  -7.3789, -19.3874,  -3.7880,
         -1.0680,  -0.5290,  -0.9750,   3.3157,   6.7994,  -2.3378,  -2.4068,
         -2.3010,  -1.8275,  -3.7478,  -5.7377,  -1.1014,  -9.6321],
       device='cuda:0')
SINR mean = -2.9662914276123047
E[H^H] = 1e-07
E_MSE (Error Power) = 6.527773380279541
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5144, 0.2560, 0.2397, 0.6225, 0.1546, 0.0114, 0.2948, 0.4388, 0.4696,
        0.4441, 0.6821, 0.8272, 0.3686, 0.3649, 0.3706, 0.3963, 0.2967, 0.2106,
        0.4369, 0.0982], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([346, 516, 529, 281, 607, 921, 487, 392, 373, 388, 245, 151, 436, 439,
        435, 418, 486, 553, 393, 676], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 8-----------
Real SNR = tensor([7.4662, 4.9912, 4.2645, 8.9202, 4.3747, 9.9648, 8.5036, 5.3557, 8.9833,
        6.6621, 7.3059, 8.8596, 9.4294, 7.3912, 8.4166, 6.1319, 5.6506, 7.7037,
        7.2882, 7.1398], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1168e-01+1.3460e-08j, 6.2510e-01+1.8387e-09j, 4.6272e+00-9.5367e-07j,
        5.9738e+00-9.5367e-07j, 8.4945e+00+3.5763e-07j, 1.8954e+01-3.3858e-07j,
        4.6078e+00-1.8287e-07j, 4.5165e-01-1.1176e-08j, 7.2387e+00+1.0751e-07j,
        9.1815e-01+1.4901e-08j, 3.0662e+00+1.2833e-08j, 1.7758e+01+1.7101e-07j,
        1.9686e-01-4.9061e-08j, 8.9360e-01+8.5471e-08j, 2.1882e-01-6.2017e-08j,
        9.9184e+00-3.0271e-08j, 7.5613e+00-3.3246e-08j, 9.2894e+00+2.9136e-07j,
        1.6285e-02-2.4809e-09j, 4.7302e-01-2.4055e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.069722652435303-9.007879242517447e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0669-5.4039e-08j, 0.8501+4.2882e-09j, 0.7668-1.0645e-08j,
        1.8966+3.5763e-07j, 0.4963-1.4901e-08j, 9.5838+7.8151e-08j,
        1.0862-1.4901e-07j, 0.2999+1.4901e-07j, 4.8912+1.1805e-07j,
        1.7654+2.3679e-08j, 1.1612-1.2941e-08j, 1.8508+1.5646e-07j,
        1.8180+1.4071e-07j, 2.3043+2.5201e-08j, 3.0087+3.0877e-08j,
        0.0195+1.1642e-08j, 1.7718+7.5167e-09j, 0.4040+3.2698e-08j,
        0.9314-5.2044e-09j, 1.2270+1.5950e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.8599865436553955+4.525562857793375e-08j)
SINR torch.Size([20]) = tensor([-10.4255,  -2.0991,  -2.7499,  -1.6049,   2.5871,   0.2033,  -0.6519,
         -2.6173,   2.5924,  -2.7176,   1.1235,   2.7803, -13.8699,  -1.0931,
        -13.0373,  -0.0670,   4.0672,   0.0863, -21.1902,  -5.7554],
       device='cuda:0')
SINR mean = -3.221956253051758
E[H^H] = 1e-07
E_MSE (Error Power) = 12.111433029174805
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0831, 0.3815, 0.3468, 0.4087, 0.6447, 0.5117, 0.4625, 0.3537, 0.6450,
        0.3485, 0.5643, 0.6548, 0.0394, 0.4374, 0.0473, 0.4961, 0.7184, 0.5050,
        0.0075, 0.2099], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([699, 428, 451, 410, 268, 347, 377, 446, 268, 450, 316, 262, 793, 392,
        771, 357, 223, 351, 958, 554], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)
--------SNR = 9-----------
Real SNR = tensor([ 2.9309,  4.3704,  5.7648,  8.2253,  4.3655,  5.7917, 11.1294,  8.9771,
         8.4516,  2.5562, 10.0136,  9.8453,  8.2790,  3.8591,  9.7404,  6.4198,
         8.5514,  8.4645,  6.0625,  7.9185], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 0.9988+1.4901e-08j,  0.4084+3.6343e-09j,  0.0307+1.3970e-09j,
         4.9375+7.4469e-09j,  1.7461+1.3271e-08j,  2.2197+1.1921e-07j,
         0.3207-1.4183e-08j,  1.5936+1.6507e-08j, 11.5501-3.3541e-07j,
         0.0905-1.2812e-09j, 11.4031+1.4303e-07j, 13.9806+7.5721e-08j,
         0.7390-7.8080e-09j,  0.7185-3.6024e-08j,  3.0138-1.5260e-07j,
         0.2331-2.0540e-09j,  6.6033-1.6186e-07j,  2.9715+1.8897e-08j,
        12.5612+5.7203e-07j,  0.2094-8.2082e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(3.816486358642578+1.3700530487881224e-08j)
torch.linalg.det(H.mH@H) = tensor([0.1170-7.4506e-09j, 0.1787+2.7940e-09j, 0.1531-7.4462e-09j,
        2.2427-1.3808e-08j, 0.2702-4.7444e-09j, 1.2563-7.9489e-08j,
        1.9594-6.1219e-09j, 1.5396+3.1654e-08j, 2.7615-1.5945e-08j,
        0.1806-8.4313e-09j, 0.7838+2.3267e-08j, 4.5291+3.7302e-08j,
        0.6362+9.1408e-09j, 0.9328-6.2688e-09j, 3.4626-1.1921e-07j,
        0.3194-1.3015e-08j, 0.7666+3.2267e-08j, 2.1850+3.3609e-08j,
        1.3559+1.3859e-08j, 0.3683-2.2802e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.2999337911605835-1.6302676542068184e-08j)
SINR torch.Size([20]) = tensor([ -3.1268,  -1.0445, -14.4393,   3.1270,   1.2560,   1.5730,  -7.9017,
         -6.9248,   3.0903,  -4.9661,   3.2439,   5.6391,  -4.4232,  -1.6430,
         -4.3009,  -5.1173,   3.5377,   3.8070,   3.6667, -11.8091],
       device='cuda:0')
SINR mean = -1.8378013372421265
E[H^H] = 1e-07
E_MSE (Error Power) = 4.506948947906494
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3274, 0.4402, 0.0347, 0.6726, 0.5718, 0.5896, 0.1395, 0.1688, 0.6707,
        0.2417, 0.6785, 0.7856, 0.2653, 0.4065, 0.2709, 0.2354, 0.6931, 0.7061,
        0.6994, 0.0619], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([464, 391, 807, 251, 312, 301, 624, 592, 252, 527, 248, 180, 509, 412,
        505, 533, 239, 231, 235, 738], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 60)

--- 処理中: 画像 81 から 100 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 80)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6931, 0.5226, 0.7302, 0.7399, 0.7176, 0.6209, 0.5511, 0.6197, 0.7088,
        0.8136, 0.7387, 0.7753, 0.8751, 0.5915, 0.6488, 0.7575, 0.5067, 0.6304,
        0.9574, 0.5433], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([ -7.7436,  -8.9901,  -4.1153,  -4.1695,  -5.3185,  -5.3157,  -8.7500,
         -6.3468,  -6.1040,  -5.7574,  -5.2198,  -8.4290, -10.0482,  -5.9746,
        -10.7762,  -4.6783,  -3.9097,  -1.1497,  -7.9647,  -9.0737],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 131.1476+2.9744e-07j, 3073.3977+5.5573e-05j,    3.1914-5.7649e-06j,
         120.1594+1.8730e-06j,   96.8208-2.1586e-06j,  322.3149-0.0000e+00j,
         211.5593+1.8760e-07j,    4.3243+2.3842e-07j,   59.0892-5.9878e-06j,
         411.0357+5.9524e-06j,  714.1450-6.0090e-06j,  289.2673+7.6294e-06j,
          14.6195-3.5718e-06j,  125.1965-5.9019e-07j,  172.2764-1.5240e-06j,
         871.3127-8.6498e-06j,   38.1250-5.7220e-06j, 1519.5315+3.8568e-05j,
         133.8536+5.3165e-06j,  818.6136+2.8599e-05j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(456.49908447265625+5.212834366830066e-06j)
torch.linalg.det(H.mH@H) = tensor([ 0.3100+1.9541e-08j,  0.1060-3.7253e-09j,  2.4326-2.1189e-07j,
         4.7022+7.3324e-08j,  2.3193-5.9605e-08j,  5.0471-3.1323e-08j,
         0.4202-1.2108e-09j,  1.3461-1.4901e-08j,  0.0732+1.2455e-08j,
         3.8466+1.1921e-07j,  2.1880+7.6186e-09j,  0.9959-1.0025e-07j,
         0.2145-8.9407e-08j,  1.4807+6.9214e-08j,  0.2526-0.0000e+00j,
        11.1940+3.9803e-08j,  0.7200-4.4869e-08j,  0.6340-1.5163e-08j,
         0.0671-5.0291e-08j,  0.8515+3.5259e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9600861072540283-1.3897222927994335e-08j)
SINR torch.Size([20]) = tensor([ -1.6636,  -0.1916, -18.0542,  -2.8760,  -4.1479,  -3.9995,  -2.1475,
        -16.6707,  -5.8355,  -2.6810,  -1.8123,  -2.4095,  -8.7520,  -2.4802,
         -1.5200,  -0.0623,  -7.2614,  -0.3896,  -3.2456,  -0.9373],
       device='cuda:0')
SINR mean = -4.356882572174072
E[H^H] = 1e-07
E_MSE (Error Power) = 7.437010288238525
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4054, 0.4890, 0.0154, 0.3402, 0.2779, 0.2848, 0.3788, 0.0211, 0.2069,
        0.3504, 0.3972, 0.3648, 0.1176, 0.3610, 0.4134, 0.4964, 0.1582, 0.4776,
        0.3214, 0.4463], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([413, 361, 892, 455, 499, 494, 430, 861, 557, 448, 418, 439, 650, 441,
        407, 357, 603, 368, 468, 387], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -4-----------
Real SNR = tensor([-5.0019, -2.1603, -4.4708, -5.8125, -1.6423, -2.0517, -8.4306, -2.9630,
        -2.2607, -6.8274, -6.4836, -6.9158, -5.7292, -2.5491, -4.6447, -4.4260,
        -4.7685, -5.6041, -4.9994, -6.7353], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  46.9416-3.8324e-07j,   92.3316-7.7207e-06j,  115.2983+2.6978e-06j,
          81.9159+1.9073e-06j,  272.4550-1.6056e-06j,   67.3002-2.6580e-06j,
        1314.5665-2.9437e-05j,    1.6952-1.3275e-06j,  155.4650-9.1672e-05j,
         197.6123-6.3914e-06j,   18.4713+6.6757e-06j,  355.6081-4.2745e-06j,
         210.4614+1.8610e-06j,  367.8391+9.6612e-06j,   85.4162+3.3796e-06j,
         127.9985-1.0322e-06j,   89.7124+4.0302e-06j,  106.5979-2.2413e-06j,
         101.7936-2.6454e-06j,   40.7079-1.8900e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(192.50938415527344-6.153311005618889e-06j)
torch.linalg.det(H.mH@H) = tensor([3.6105+8.1532e-09j, 2.0277-1.3963e-08j, 2.8560-4.0175e-08j,
        2.0219-2.3842e-07j, 1.3201-2.3311e-08j, 6.5562+1.1846e-07j,
        0.3473-1.7319e-09j, 0.4051+3.0090e-07j, 6.0407-6.1210e-08j,
        0.2539+3.7253e-08j, 0.1689-2.5057e-09j, 1.7232-0.0000e+00j,
        2.3792+8.9407e-08j, 1.3560+3.5076e-08j, 0.0707-7.0630e-09j,
        3.4902-5.8162e-09j, 0.5856+1.3642e-08j, 1.3199+5.2329e-08j,
        1.5105+3.0670e-09j, 0.4998-5.1857e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.927172303199768+1.2945370109207488e-08j)
SINR torch.Size([20]) = tensor([ -6.1761,  -3.5016,  -2.9306,  -3.6882,  -0.1440,  -4.1653,  -0.7064,
        -18.1942,  -2.5075,  -2.5924,  -6.6936,   0.0238,   0.5949,  -1.0348,
         -1.3978,  -1.9510,  -3.8833,  -2.3229,  -3.4512,  -3.9192],
       device='cuda:0')
SINR mean = -3.432082414627075
E[H^H] = 1e-07
E_MSE (Error Power) = 5.285939693450928
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1943, 0.3087, 0.3374, 0.2996, 0.4917, 0.2771, 0.4594, 0.0149, 0.3595,
        0.3550, 0.1764, 0.5014, 0.5342, 0.4407, 0.4202, 0.3895, 0.2903, 0.3694,
        0.3112, 0.2885], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([568, 477, 457, 483, 359, 500, 379, 895, 442, 445, 585, 354, 334, 390,
        403, 423, 490, 436, 475, 491], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -3-----------
Real SNR = tensor([-1.2959, -3.3370, -3.9800, -8.8058, -8.1991, -5.6457, -4.4610, -7.5764,
        -3.5074, -7.1498, -4.7094, -6.4752, -6.0679, -2.8717, -1.1798, -7.7193,
        -7.1949, -5.8601, -8.2965, -3.4125], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 56.1258+3.1257e-07j,  54.5093+1.9073e-06j,  20.6601+4.0800e-07j,
         23.4360-1.4305e-06j, 321.8772-0.0000e+00j,   2.0858-5.4836e-06j,
          5.6235-0.0000e+00j,  77.9261+1.2120e-05j, 125.2947+8.5224e-07j,
        110.3422+1.9965e-07j, 194.5904+4.8729e-06j, 351.1900+2.1902e-06j,
         88.8984-1.3351e-05j,  35.8408+1.6212e-05j,  66.0145+2.3841e-07j,
         10.4850+7.4506e-08j, 291.5444-4.5994e-06j,  21.0577+6.5526e-07j,
         93.1252+1.5259e-05j, 341.9993+3.5533e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(114.63130187988281+1.6995475107250968e-06j)
torch.linalg.det(H.mH@H) = tensor([2.8699-0.0000e+00j, 1.7036-1.3093e-08j, 2.1843+3.1035e-08j,
        0.1001-0.0000e+00j, 0.5112-6.2347e-09j, 0.3741-0.0000e+00j,
        1.3688-7.2971e-09j, 0.4361+7.4294e-09j, 0.9660+2.9802e-08j,
        0.6483-0.0000e+00j, 3.3247-1.1436e-08j, 0.1454+1.1810e-09j,
        3.0736+2.1083e-08j, 3.9296-1.7640e-07j, 1.9289+1.3492e-07j,
        0.6134-1.8967e-09j, 0.3142+4.8933e-09j, 1.1709+1.0042e-08j,
        1.8302+9.9904e-10j, 0.1785-9.1020e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3835840225219727+7.95957355581578e-10j)
SINR torch.Size([20]) = tensor([ -7.1320,  -3.2978,  -7.9348,  -5.0612,  -0.5638, -15.8658,  -6.5825,
         -3.1783,  -3.5280,  -0.8871,  -3.5359,  -2.2885,  -2.4471,  -7.1485,
         -3.3393,  -6.7090,  -0.5478,  -3.0189,  -1.2824,  -0.3466],
       device='cuda:0')
SINR mean = -4.234766960144043
E[H^H] = 1e-07
E_MSE (Error Power) = 4.41749382019043
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1622, 0.3188, 0.1386, 0.2377, 0.4676, 0.0253, 0.1801, 0.3248, 0.3074,
        0.4491, 0.3070, 0.3712, 0.3627, 0.1616, 0.3167, 0.1758, 0.4685, 0.3329,
        0.4267, 0.4801], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([599, 470, 625, 531, 374, 842, 581, 466, 478, 385, 478, 434, 440, 600,
        471, 585, 373, 460, 399, 366], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -2-----------
Real SNR = tensor([ -1.5131,  -0.9229,  -1.9879,  -4.3528,  -3.6479, -10.8292,  -3.6823,
         -3.7187,  -5.6523,  -2.8190,  -5.4922,  -0.9083,  -5.7178,  -5.9166,
         -4.4030,  -3.9474,  -0.2762,  -1.5647,  -1.9848,  -2.2724],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([318.7306+5.2082e-06j,   8.5641+2.3842e-07j,  41.7166+9.0814e-08j,
         48.5419-1.2641e-06j,   0.5407-3.3831e-08j,  55.6581-7.6031e-07j,
        313.0916-1.0103e-05j,  27.8251-3.1045e-07j,   9.2837-2.8230e-07j,
         23.1449+2.7293e-07j,  71.5543-5.4472e-07j, 256.8978-7.6294e-06j,
        132.2022+6.5082e-07j, 235.6381-1.3497e-05j, 178.1136-4.9829e-06j,
          9.6419+1.5698e-06j, 263.7419+1.7676e-05j,   8.9718-1.4717e-06j,
          8.0050-4.7684e-07j,   3.8594+1.0729e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(100.78616333007812-7.288659276127873e-07j)
torch.linalg.det(H.mH@H) = tensor([0.0872-1.5646e-07j, 2.2042-3.5763e-07j, 0.1389-5.1112e-08j,
        0.1343-1.2362e-09j, 0.9704+1.6303e-08j, 0.0583-2.2704e-09j,
        1.3962-3.8748e-09j, 1.1132+1.9062e-08j, 0.2691-3.9639e-09j,
        0.2317-7.3319e-09j, 0.8282-6.6159e-09j, 5.1984+3.9796e-08j,
        1.9635-5.7740e-09j, 0.1837-2.7580e-08j, 1.8811-5.9605e-08j,
        2.9125-1.3924e-07j, 3.0626-1.0943e-09j, 1.9082+3.1770e-08j,
        7.2167+2.5703e-09j, 2.8182+3.9410e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.7288330793380737-3.374396229105514e-08j)
SINR torch.Size([20]) = tensor([-4.2861e-02, -7.0488e+00, -2.9433e+00, -1.7212e+00, -1.5003e+01,
        -2.6862e+00,  7.7805e-01, -2.2584e+00, -5.5121e+00, -2.8730e+00,
        -3.3377e+00, -2.8522e+00, -2.9568e-01, -1.2879e+00, -1.1709e+00,
        -8.0383e+00, -1.3654e-02, -9.6481e+00, -7.0625e+00, -7.4604e+00],
       device='cuda:0')
SINR mean = -4.02390718460083
E[H^H] = 1e-07
E_MSE (Error Power) = 4.780481338500977
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4975, 0.1648, 0.3368, 0.4022, 0.0306, 0.3501, 0.5447, 0.3729, 0.2194,
        0.3404, 0.3168, 0.3415, 0.4830, 0.4264, 0.4330, 0.1358, 0.4992, 0.0978,
        0.1644, 0.1522], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([356, 596, 457, 415, 821, 448, 328, 433, 546, 455, 471, 454, 365, 399,
        395, 628, 355, 677, 597, 610], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = -1-----------
Real SNR = tensor([-8.8966, -1.1585, -1.4211,  0.9753,  0.3874, -0.7052, -5.3196, -1.4970,
        -6.0178, -8.3789, -4.6415, -2.4009, -3.2854, -3.1620, -1.3375, -1.8757,
         0.1100, -5.3916, -4.9973, -5.8203], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 59.3252-1.2336e-07j, 200.2504+7.6294e-06j,  99.1512+7.6294e-06j,
         19.4065-1.9073e-06j,  36.3488-1.3202e-06j,  98.3011+1.5259e-05j,
         37.7952-3.8147e-06j,  97.5533-3.2071e-06j,   9.8346-1.9073e-06j,
         23.6727+5.2784e-07j,   4.7033-1.1921e-07j,  67.0160-1.5017e-07j,
        187.2024-4.4403e-06j,  66.9529-2.0252e-06j,  19.1948-1.0553e-07j,
         31.1765-1.7625e-07j,  52.3897+2.0954e-07j,  37.7813-1.9073e-06j,
         54.0638-1.1506e-06j,  61.7423-4.7684e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(63.1931037902832+4.2116980125683767e-07j)
torch.linalg.det(H.mH@H) = tensor([1.3626e-01-3.1581e-09j, 3.0391e+00+1.1921e-07j, 1.4824e+00+3.8361e-08j,
        7.3716e+00+1.1921e-07j, 2.1134e+00-2.3842e-07j, 1.2750e+00+4.9641e-08j,
        9.3803e-02+1.5061e-08j, 1.3297e+00-2.6822e-07j, 4.3069e-02+7.4506e-09j,
        5.2549e-03-6.9849e-10j, 2.1503e+00+5.0948e-09j, 2.8027e+00+1.2601e-07j,
        1.0121e+00+8.3812e-08j, 1.5100e+00-1.1921e-07j, 1.1731e+00-2.0984e-08j,
        5.8676e-02+1.0100e-08j, 3.0008e-01-1.3145e-08j, 9.3806e-02+2.5073e-09j,
        1.6316e+00+4.4517e-08j, 9.8581e-02-7.4506e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3860201835632324-2.515767150157444e-09j)
SINR torch.Size([20]) = tensor([-0.3599, -0.6102, -1.5487, -4.7433, -5.7034, -2.3378, -4.2406, -0.6774,
        -5.2605, -1.2846, -6.1131, -2.3556, -2.2671, -2.1498, -1.1316, -3.4022,
        -3.2668, -5.0082, -0.8117, -1.8260], device='cuda:0')
SINR mean = -2.754936695098877
E[H^H] = 1e-07
E_MSE (Error Power) = 2.1030948162078857
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4793, 0.4649, 0.4118, 0.2512, 0.2119, 0.3686, 0.2736, 0.4611, 0.2295,
        0.4266, 0.1966, 0.3676, 0.3724, 0.3787, 0.4352, 0.3136, 0.3203, 0.2399,
        0.4534, 0.3964], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([367, 376, 408, 520, 552, 436, 503, 378, 537, 399, 566, 437, 434, 430,
        394, 473, 469, 529, 383, 418], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 0-----------
Real SNR = tensor([ -5.3373,  -4.9840,  -2.1022,  -5.0422,  -4.3559,  -1.0810,  -0.8162,
          0.4746,  -7.1456,   1.3342,  -3.2962,  -1.7086,  -1.0477,  -2.6180,
         -1.6452,  -1.4971,   0.0187,  -5.1972,   2.2774, -11.1467],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([110.2346+6.5872e-08j,  26.6143-4.9502e-08j, 118.7156-3.4082e-07j,
          0.8629-1.3051e-07j,  10.3757-9.5367e-07j,   5.8914-1.3822e-07j,
         17.2733+2.8478e-07j, 149.0560-1.4620e-06j,   7.5280-5.8887e-07j,
         24.0094+1.5966e-07j,   2.0855+1.7015e-07j,  25.4595+2.4608e-06j,
          3.2411-1.3113e-06j,   0.8155+6.2585e-07j, 134.6515+2.5162e-06j,
         21.4716+7.5563e-08j, 218.7332+1.6768e-05j,   2.5236-1.6326e-06j,
        553.1879+3.6174e-06j,   9.9701-2.7477e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(72.13504028320312+9.930955684467335e-07j)
torch.linalg.det(H.mH@H) = tensor([0.4868+4.6481e-09j, 0.0953+4.0047e-08j, 0.7492-5.7686e-09j,
        0.1929+1.4901e-08j, 0.6265-4.1930e-09j, 0.4912-7.4418e-08j,
        2.7145-3.6572e-08j, 5.6667-4.7684e-07j, 0.0858-1.2705e-09j,
        4.4293-1.4943e-08j, 0.3629+4.2358e-10j, 0.0869-6.3863e-08j,
        0.1599+2.3211e-09j, 0.5219-0.0000e+00j, 0.3825+2.9802e-08j,
        4.4976+5.2569e-08j, 5.2036-2.4066e-08j, 0.1007-1.4010e-09j,
        2.2612+2.9802e-08j, 0.0191+4.8061e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.4567211866378784-2.641684027082647e-08j)
SINR torch.Size([20]) = tensor([  0.6433,   0.2241,   0.4883,  -9.0114,  -2.6344,  -4.7798,  -2.5999,
         -2.1029,  -4.2330,  -0.5396,  -9.5242,  -1.4274,  -6.1893, -17.2825,
         -0.9193,  -1.3940,  -0.5895,  -8.4522,   0.4908,  -3.3583],
       device='cuda:0')
SINR mean = -3.659550189971924
E[H^H] = 1e-07
E_MSE (Error Power) = 5.46234655380249
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5370, 0.5129, 0.5281, 0.1116, 0.3528, 0.2496, 0.3547, 0.3813, 0.2739,
        0.4690, 0.1004, 0.4186, 0.1939, 0.0184, 0.4473, 0.4204, 0.4661, 0.1250,
        0.5282, 0.3158], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([332, 347, 338, 658, 447, 521, 445, 428, 502, 373, 673, 404, 568, 875,
        386, 403, 375, 641, 338, 472], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 1-----------
Real SNR = tensor([-2.1998, -0.1328, -4.8170, -4.8161,  0.8098, -0.9796, -5.1485,  0.5582,
         0.6035,  0.4634, -2.3096, -5.1152, -0.6229, -1.1661, -8.6243, -0.0277,
        -0.3644, -0.2479,  1.0046,  1.3145], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([206.4347-3.7436e-06j,  16.3820-3.8147e-06j,   9.5328-8.1062e-06j,
          0.7126-5.9605e-08j,   4.0996-5.9605e-07j,   8.2698+1.3113e-06j,
         26.8440-8.9352e-08j,  21.1656+1.5106e-07j,  91.4863-5.0053e-07j,
          1.3019-2.2102e-07j,  30.0077-1.8610e-06j,   0.2331+4.5995e-07j,
          3.5031-5.7006e-07j,  12.2864-2.3907e-07j,   1.0964+2.0862e-07j,
         41.0265-1.0693e-07j,   2.8543+2.2840e-07j,  45.3132-4.4287e-07j,
        108.8057+1.8752e-06j,  10.5345+2.3842e-06j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(32.09450912475586-6.866119974802132e-07j)
torch.linalg.det(H.mH@H) = tensor([0.1380-1.3232e-08j, 1.1840+8.9407e-08j, 0.1850-1.4901e-08j,
        0.0968-1.4283e-08j, 8.2089+1.5618e-08j, 0.9268+8.7103e-08j,
        0.0485-0.0000e+00j, 1.9914-1.9618e-08j, 0.9534+2.5255e-07j,
        2.6586+7.5688e-10j, 0.7211+8.9407e-08j, 0.2954+2.1203e-09j,
        0.9782+1.5538e-08j, 1.8576-0.0000e+00j, 0.0318-0.0000e+00j,
        3.4024+2.7292e-08j, 1.0080-0.0000e+00j, 3.1034+1.6631e-08j,
        2.1063+1.7881e-07j, 2.2197+8.9407e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6057676076889038+4.0130483824896146e-08j)
SINR torch.Size([20]) = tensor([  1.1386,  -3.5687,  -5.8203,  -8.8334,  -8.1856,  -5.0628,  -2.0707,
         -2.4403,   2.3104, -14.0186,  -1.7207, -16.4081,  -5.4103,  -2.4242,
         -7.9826,  -0.5455,  -9.5158,   2.4421,  -0.0529,  -3.0839],
       device='cuda:0')
SINR mean = -4.5626678466796875
E[H^H] = 1e-07
E_MSE (Error Power) = 6.0691680908203125
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5652, 0.3054, 0.2075, 0.1157, 0.1318, 0.2376, 0.3830, 0.3631, 0.6299,
        0.0381, 0.4022, 0.0224, 0.2234, 0.3640, 0.1373, 0.4686, 0.1006, 0.6370,
        0.4970, 0.3296], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([316, 479, 556, 652, 632, 531, 427, 440, 277, 797, 415, 855, 542, 439,
        626, 373, 673, 273, 356, 462], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 2-----------
Real SNR = tensor([-4.5796,  1.1623,  2.8368,  0.7499,  1.7668,  4.7372,  0.6111,  1.1390,
         3.0068, -2.4413,  3.4399, -2.4457,  2.5097,  2.0227, -2.2865, -3.0034,
         1.5920,  1.0469, -1.5981,  3.0419], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([  9.7149-7.1310e-07j,   1.8644+9.6107e-08j,  55.8241+4.7684e-07j,
         12.5242-7.2903e-08j,  18.8165+2.0205e-07j,   1.0283+1.8425e-08j,
          3.8905-2.6373e-08j,  23.6261-1.1313e-07j,   5.6286+6.3931e-09j,
         29.1336+7.7219e-10j,   2.1788+5.6982e-08j,  14.2857+2.3842e-07j,
         36.3018+3.0279e-06j,  53.0055-1.8447e-06j,  11.3003+1.4009e-07j,
        113.1734-9.9883e-07j,  48.7882-1.0140e-07j,   1.2839+1.6819e-07j,
         20.1459-3.6428e-07j,   4.4473+1.1921e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(23.348115921020508+1.5836132405411263e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.3143+2.9802e-08j,  0.6129-2.6084e-08j,  5.9738+6.0231e-09j,
         1.8116+2.2827e-07j,  9.5000+5.7112e-08j, 11.4622+9.5991e-08j,
         2.0476-2.1680e-08j,  2.4030+2.8255e-08j,  0.9401+1.7515e-07j,
         0.2408+2.7983e-09j,  9.1556+5.1452e-08j,  0.3150-1.4901e-08j,
         0.6275-2.9574e-08j,  0.4906+4.0721e-09j,  0.6709-3.1247e-09j,
         0.4980-8.3692e-09j,  3.5783-2.7150e-08j,  1.8302+2.3192e-08j,
         1.8526+3.0929e-08j,  3.5274+2.3842e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.892622232437134+4.202906467298817e-08j)
SINR torch.Size([20]) = tensor([ -1.1818,  -7.4306,   0.1003,  -2.8366,   1.9583,  -8.3249,  -3.2099,
         -0.9801,  -5.8762,   1.8012,  -9.7801,  -2.2234,  -3.1016,   1.3142,
         -4.6360,   0.6385,   2.8729, -10.5070,   0.6755,  -5.3754],
       device='cuda:0')
SINR mean = -2.8051388263702393
E[H^H] = 1e-07
E_MSE (Error Power) = 3.0964512825012207
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4324, 0.1530, 0.5058, 0.3423, 0.6109, 0.1282, 0.3232, 0.4438, 0.2054,
        0.6022, 0.0952, 0.3747, 0.3287, 0.5751, 0.2559, 0.5367, 0.6596, 0.0817,
        0.5388, 0.2248], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([396, 609, 351, 454, 288, 637, 467, 389, 558, 294, 681, 432, 463, 310,
        516, 332, 259, 702, 331, 541], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 3-----------
Real SNR = tensor([ 5.6881,  2.1929,  3.2888, -0.1113,  1.3374,  1.2330,  2.7097,  2.6654,
         1.1646,  0.2788,  1.6881,  3.2604, -1.3678,  4.5064,  6.0686,  0.3989,
         4.5782,  2.1746,  2.7625, -2.9183], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([51.6745+1.3280e-06j,  5.1170+4.7684e-07j, 25.9148-5.1749e-07j,
        52.1431-2.2821e-06j, 77.9075-5.7182e-07j,  2.8587-0.0000e+00j,
         5.5434-1.0729e-06j, 26.6497-7.7448e-07j,  4.5753-9.5594e-08j,
        12.7126+3.2742e-08j,  7.9228-2.9802e-08j, 22.0712+6.8949e-06j,
         8.7995+6.8291e-08j, 32.1105-5.0861e-07j, 31.7573-1.5665e-06j,
         3.0756-7.1256e-08j, 39.1688-7.9198e-08j,  6.1524-2.3842e-07j,
         4.7149+4.6278e-08j, 11.3150+4.7111e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(21.60922622680664+7.549538594275873e-08j)
torch.linalg.det(H.mH@H) = tensor([14.9828-1.1750e-09j,  1.1604+7.4506e-08j,  2.0983-1.7881e-07j,
         1.3665-4.5577e-08j,  5.5060+6.6953e-08j,  0.4348-1.5769e-09j,
         2.4186+9.7468e-09j,  1.7054-1.3293e-09j,  0.1184-1.3807e-08j,
         0.3174+1.1138e-08j,  0.7939+7.3161e-09j,  0.4430+5.7954e-08j,
         1.3877-0.0000e+00j,  8.8942-4.0425e-07j,  7.8214-2.1744e-07j,
         1.2568-3.3798e-09j,  8.5535-6.6593e-08j,  2.1103-2.8759e-08j,
        10.1396-7.7902e-09j,  0.0255+5.2970e-10j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3.5767219066619873-3.711737406320026e-08j)
SINR torch.Size([20]) = tensor([ 2.6721, -3.1282, -0.7469,  2.3531,  1.8829, -3.3771, -4.1213,  2.1447,
        -1.9612, -2.4516,  0.0125,  0.0850, -2.7717,  1.5295, -0.6551, -5.9594,
         1.9008, -8.4503, -1.7600, -1.2545], device='cuda:0')
SINR mean = -1.2028489112854004
E[H^H] = 1e-07
E_MSE (Error Power) = 1.7747553586959839
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6491, 0.3273, 0.4571, 0.6322, 0.6067, 0.3148, 0.2791, 0.6210, 0.3890,
        0.3625, 0.5007, 0.5049, 0.3457, 0.5871, 0.4624, 0.2023, 0.6077, 0.1250,
        0.4000, 0.4283], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([265, 464, 380, 276, 291, 473, 498, 282, 423, 440, 354, 351, 451, 302,
        377, 561, 290, 641, 416, 398], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 4-----------
Real SNR = tensor([ 1.2447,  2.6531, -0.6221,  1.9050,  0.6850,  1.1079,  1.1710,  2.6097,
         2.1141,  0.8003,  0.0573, -4.9827,  4.5994, -0.4124,  5.2297,  9.3184,
         5.4197,  1.0426, -0.4185,  5.5768], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.7840-4.1642e-08j, 14.0518+2.2466e-07j, 31.4574+2.6100e-07j,
        11.3335+2.9310e-08j,  0.7298-3.5148e-07j,  1.8012-2.1024e-08j,
         1.3158+2.9802e-08j,  1.2320+7.3559e-09j,  4.6822+9.5367e-07j,
        12.9182+3.8571e-08j, 14.1970+6.4552e-07j,  0.4095+5.9605e-08j,
         3.5645-2.0424e-07j,  1.4769+3.2183e-07j,  7.0620-2.1104e-07j,
        90.8777-2.5883e-07j, 15.5726+3.3824e-07j,  3.8250+7.3011e-08j,
         9.5700+1.3015e-07j,  8.1140-7.8098e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(11.798762321472168+9.731818551017568e-08j)
torch.linalg.det(H.mH@H) = tensor([1.1219-1.2141e-10j, 2.8322-6.7088e-08j, 0.2104-2.9107e-09j,
        0.5446-1.8626e-09j, 0.3066+7.1003e-09j, 0.1871+9.5176e-09j,
        1.2988+6.7104e-09j, 0.6039+4.3374e-08j, 4.9319-4.0318e-08j,
        0.3476+3.5148e-08j, 0.5786+1.8677e-08j, 0.0349-1.2697e-10j,
        1.7033-9.1515e-08j, 0.0774-7.9424e-09j, 7.0130+9.9670e-08j,
        7.7449+1.1921e-07j, 5.7796+2.8452e-08j, 0.0763-1.6266e-09j,
        1.0589+1.2622e-08j, 3.4245-7.0465e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.9938243627548218+4.8251531659104785e-09j)
SINR torch.Size([20]) = tensor([ -5.3844,   0.8708,   0.8454,  -0.4721, -10.1155,  -3.5735,  -4.9801,
         -2.8573,  -0.8770,  -0.3153,   0.5937, -10.1662,  -6.1612,  -5.5980,
         -0.6465,   3.0433,   0.3650,  -3.9087,  -2.0761,   0.2268],
       device='cuda:0')
SINR mean = -2.5593464374542236
E[H^H] = 1e-07
E_MSE (Error Power) = 2.9573047161102295
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2245, 0.5500, 0.5485, 0.4729, 0.0887, 0.3052, 0.2411, 0.3412, 0.4497,
        0.4819, 0.5341, 0.0878, 0.1949, 0.2160, 0.4629, 0.6684, 0.5210, 0.2890,
        0.3827, 0.5131], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([542, 325, 325, 371, 691, 479, 528, 454, 385, 365, 334, 692, 567, 549,
        377, 254, 342, 491, 427, 347], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 5-----------
Real SNR = tensor([ 2.8411,  2.5670,  4.6466, -0.7964,  4.2144,  4.0119, -2.5755,  0.6581,
         3.4995,  9.1233, -3.0480,  2.9473,  1.5159,  5.2936,  1.7112,  5.4924,
         2.2081, -1.6817,  0.6806,  6.9090], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([ 1.9440+3.6161e-09j,  0.2118+3.7253e-09j,  0.1708-2.2352e-08j,
         5.8226-2.5806e-07j,  4.7016+3.0014e-07j,  6.0837-9.1512e-09j,
         3.3398+7.0637e-08j,  4.7371-2.3842e-07j, 10.7854+6.4582e-08j,
        20.6108-4.3842e-07j,  4.2416-5.9592e-08j,  0.0543-3.7253e-09j,
         4.6636-5.2327e-07j,  5.4882-2.3842e-07j, 20.2138-1.6657e-07j,
         3.3360-3.2783e-07j,  3.7447-1.8712e-07j,  0.2039+1.0431e-07j,
         6.3203+4.7436e-08j, 10.3151+1.6413e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(5.849445343017578-8.571742426966011e-08j)
torch.linalg.det(H.mH@H) = tensor([ 0.8937+1.3095e-08j,  1.3464+4.5156e-08j,  0.2358-1.8077e-08j,
         0.2798-6.8241e-09j,  6.3428+1.2953e-07j,  0.2553+4.5517e-08j,
         0.0674-0.0000e+00j,  0.3429+8.8867e-09j,  0.2966+1.6391e-07j,
        29.1852+2.4690e-08j,  0.1587-0.0000e+00j,  0.3598-5.1071e-09j,
         0.0553-7.4506e-09j,  1.0302-4.2654e-09j,  0.5057-2.2352e-08j,
         0.7552+5.9605e-08j,  1.2160-1.0837e-08j,  0.2615+1.4901e-08j,
         0.6453+8.1024e-08j,  0.7171-2.3842e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.2475361824035645+1.3649404273508026e-08j)
SINR torch.Size([20]) = tensor([ -0.6914, -15.8956, -16.0591,  -3.2464,  -2.6554,   0.2756,  -1.7999,
         -1.5371,   0.4276,   1.8290,  -2.1672, -15.0186,  -4.6397,   0.6947,
          2.5390,  -3.1316,  -3.2482, -11.8633,  -0.2851,   1.1630],
       device='cuda:0')
SINR mean = -3.7654824256896973
E[H^H] = 1e-07
E_MSE (Error Power) = 7.146855354309082
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.4603, 0.0251, 0.0242, 0.3214, 0.3517, 0.5159, 0.3978, 0.4124, 0.5246,
        0.6038, 0.3778, 0.0305, 0.2557, 0.5399, 0.6421, 0.3272, 0.3213, 0.0611,
        0.4836, 0.5666], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([378, 843, 847, 468, 447, 345, 417, 408, 340, 293, 430, 822, 516, 331,
        270, 464, 468, 740, 364, 315], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 6-----------
Real SNR = tensor([ 2.3545,  3.9107,  7.4050,  3.9206,  2.6408,  4.3772,  5.9383,  3.7847,
         4.8520,  4.2552, -0.2536,  8.7154,  0.5275,  6.9500, -4.7043,  3.7215,
         5.1903,  7.5425,  3.7723,  4.4545], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([9.0627e+00+1.4034e-08j, 2.2815e+00+1.1921e-07j, 1.9423e+01-1.6769e-07j,
        8.9217e+00-2.3296e-07j, 3.0644e+00+4.7684e-07j, 6.2186e+00+1.4216e-07j,
        3.1664e+00+5.6556e-08j, 6.5861e+00-8.4493e-08j, 8.1016e+00+7.4559e-08j,
        2.9275e+00-2.0936e-07j, 1.1149e+01-2.3256e-07j, 2.9625e+00+1.1396e-08j,
        5.3907e-01-8.2948e-09j, 8.2511e+00+5.8314e-08j, 7.7741e-01+2.2352e-08j,
        6.4722e-03-4.8894e-09j, 7.5309e-01-9.8240e-09j, 3.6937e+00-5.8610e-07j,
        8.7630e-01-5.0664e-07j, 2.6855e+01-9.8050e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(6.28084135055542-1.0239467940209579e-07j)
torch.linalg.det(H.mH@H) = tensor([0.4520+4.4703e-08j, 1.9636-6.4052e-09j, 2.5561-3.7253e-08j,
        1.6917-1.7583e-08j, 0.2432+2.8501e-09j, 0.3277+1.4901e-08j,
        0.1842-6.3537e-10j, 1.1647+1.5338e-08j, 0.9054-2.9802e-08j,
        0.9362+2.5040e-08j, 0.6730+1.2233e-08j, 7.5030+1.8487e-07j,
        0.0648+2.9284e-10j, 0.7839-1.3511e-08j, 0.0322+7.9037e-10j,
        0.3944+9.9114e-09j, 0.3850-9.3132e-10j, 9.8970+4.7684e-07j,
        1.7567-9.5742e-09j, 0.2867-1.4901e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.6100810766220093+3.285833827249007e-08j)
SINR torch.Size([20]) = tensor([  0.9468,  -7.1470,   3.6660,   0.1048,  -0.9477,  -0.1351,  -2.4971,
          1.2289,   1.6784,   0.1441,   2.1357,  -1.0982,  -4.6801,   0.0524,
         -5.1844, -29.0287,  -8.0276,  -0.0514,  -6.7483,  -0.2186],
       device='cuda:0')
SINR mean = -2.7903621196746826
E[H^H] = 1e-07
E_MSE (Error Power) = 43.07890701293945
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5543, 0.1617, 0.6993, 0.5060, 0.4457, 0.4922, 0.3601, 0.5703, 0.5954,
        0.5083, 0.6205, 0.4371, 0.2540, 0.5030, 0.2326, 0.0012, 0.1361, 0.4970,
        0.1745, 0.4874], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 322,  600,  235,  351,  387,  359,  442,  313,  298,  349,  283,  393,
         518,  353,  535, 1000,  627,  356,  587,  362], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 7-----------
Real SNR = tensor([ 4.7475,  1.5513,  2.1388,  6.5842,  4.7444,  9.5770, 11.4301,  3.3792,
         5.4953,  6.9852,  7.7160,  9.5928,  9.0317,  3.7210,  4.7623,  4.6440,
         7.4913,  1.6530,  3.9676,  6.5876], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1209e+01-2.7482e-07j, 1.9530e+00-5.9605e-08j, 5.0209e-02+4.6566e-09j,
        1.2815e+00-3.1548e-08j, 3.4239e+00+3.5763e-07j, 3.1505e+00-1.0674e-07j,
        5.2454e+01+1.0504e-06j, 2.2774e-01+7.4506e-09j, 1.0542e+01-2.7261e-07j,
        2.8699e+01+4.0674e-07j, 8.5307e-01-2.4211e-09j, 2.9715e+00-3.4753e-10j,
        8.1920e+00-0.0000e+00j, 1.2861e+00+5.9605e-08j, 4.3413e+00+7.0614e-08j,
        2.0408e+00-5.9605e-08j, 6.1916e-01+3.0499e-07j, 2.4343e+00+9.9669e-09j,
        1.1137e+00+1.7881e-07j, 1.0009e+01-2.5743e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(7.342625617980957+6.928802065431228e-08j)
torch.linalg.det(H.mH@H) = tensor([ 1.4214+1.3861e-10j,  0.1791-9.3132e-09j,  0.1793+1.6629e-08j,
         1.6601+4.3412e-08j,  0.4136+2.6077e-08j,  1.8510+2.6675e-08j,
        26.4838-2.0496e-07j,  0.3241+1.4901e-08j,  1.1728-1.1921e-07j,
         2.8794+2.7164e-08j,  0.3076-2.1192e-08j,  1.9937-1.4900e-07j,
         6.5064-0.0000e+00j,  0.4263+1.4901e-08j,  0.0498+9.4028e-10j,
         0.1454-1.0431e-07j,  0.3210-5.7994e-08j,  0.1190+9.4544e-09j,
         0.9780-7.5005e-08j,  0.8962+6.0343e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4154014587402344-2.5017143912009487e-08j)
SINR torch.Size([20]) = tensor([  2.7547,  -1.2631, -10.3702,  -2.9501,  -1.7989,  -4.0556,   3.0445,
         -6.0926,   0.4282,   3.3689,  -1.3068,  -5.3492,   3.1345,  -3.1869,
          1.7093,  -1.3885, -11.1543,  -3.8829,  -1.9753,   1.1892],
       device='cuda:0')
SINR mean = -1.9572508335113525
E[H^H] = 1e-07
E_MSE (Error Power) = 2.7344610691070557
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.6535, 0.4278, 0.0841, 0.3364, 0.3979, 0.2821, 0.6684, 0.1974, 0.5246,
        0.6848, 0.4253, 0.2259, 0.6730, 0.3244, 0.5971, 0.4207, 0.0712, 0.2903,
        0.3882, 0.5680], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([263, 398, 698, 458, 417, 496, 254, 565, 340, 244, 400, 540, 251, 466,
        297, 403, 720, 490, 423, 314], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 8-----------
Real SNR = tensor([ 4.6023,  6.5284,  4.1638,  6.4904,  8.2299,  7.9804,  6.5105,  3.7390,
        10.2418,  1.2563,  7.1068,  5.0928,  4.5593,  8.6017, 10.1154,  9.1608,
        10.7341,  4.7616,  7.3106,  5.5303], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.1444e-01+1.4901e-08j, 1.2736e+00+1.8613e-08j, 1.4582e+00+1.1921e-07j,
        2.3327e-02+8.8380e-09j, 3.1756e+01-4.0203e-07j, 1.3719e+01-1.4226e-07j,
        7.6734e-02+3.9107e-07j, 1.8440e-01+8.3502e-09j, 1.3753e+01-3.5678e-07j,
        6.7001e-01+5.9605e-08j, 2.1878e+01-4.3552e-07j, 8.5255e+00-5.0013e-08j,
        2.4774e-01-8.1956e-08j, 2.1765e+00-5.2154e-08j, 5.0367e+00-1.7881e-07j,
        1.0325e+00-1.8078e-07j, 2.7655e+01+9.3225e-07j, 3.1038e-01-3.7253e-08j,
        2.7373e+01+7.7096e-08j, 8.6326e+00+1.1574e-09j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(8.30981731414795-1.4323342512057025e-08j)
torch.linalg.det(H.mH@H) = tensor([0.7181-2.9802e-08j, 2.7505-4.7427e-08j, 0.0194-1.0245e-08j,
        0.2195-1.7208e-09j, 7.0176-2.8273e-09j, 4.7841+6.9897e-08j,
        0.3765-2.9570e-08j, 0.7766+2.2564e-09j, 1.9811+2.0132e-07j,
        0.1918-3.7253e-09j, 6.1788-7.2499e-09j, 0.2536-7.4506e-08j,
        1.6410+2.7881e-08j, 1.0358-7.4506e-08j, 9.3964+1.1921e-07j,
        2.9171+4.1317e-08j, 4.3819+1.4652e-07j, 0.9138+1.5425e-08j,
        2.1273+2.6691e-08j, 0.7779-1.3809e-08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (2.4229416847229004+1.7756585535266822e-08j)
SINR torch.Size([20]) = tensor([ -2.2550,  -3.6394,  -2.1822, -16.6077,   3.0005,   3.9826, -19.0219,
         -5.0591,   2.9185,  -3.7974,   4.9347,   2.2852, -12.9690,  -1.3553,
         -4.6658,  -3.6786,   1.9411,  -3.3758,   6.0109,   3.7864],
       device='cuda:0')
SINR mean = -2.487366199493408
E[H^H] = 1e-07
E_MSE (Error Power) = 9.578713417053223
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3730, 0.3020, 0.3770, 0.0214, 0.6662, 0.7144, 0.0124, 0.2378, 0.6620,
        0.2943, 0.7570, 0.6286, 0.0481, 0.4226, 0.2546, 0.3001, 0.6099, 0.3149,
        0.7996, 0.7051], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([433, 482, 431, 859, 255, 225, 913, 531, 258, 487, 198, 278, 770, 402,
        517, 483, 289, 473, 170, 231], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)
--------SNR = 9-----------
Real SNR = tensor([ 7.2963, 11.0576,  5.4881,  9.2829,  8.2500,  6.7176,  9.0761,  4.0724,
         3.4247,  6.3712,  2.1295,  9.6379,  8.7703,  9.0075,  9.0615, 11.2285,
         7.9156,  8.0167,  6.7208, 12.0943], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.5246e+00+4.0385e-08j, 7.6920e-01+5.6691e-08j, 2.5159e-01-4.9553e-09j,
        6.3330e+00-9.3197e-09j, 3.1165e+00-6.9197e-08j, 9.7963e-01+1.0589e-08j,
        1.4936e+00+1.7442e-07j, 5.0163e-01-5.9605e-08j, 2.8882e-02+2.8500e-08j,
        8.0738e-01+1.0365e-08j, 1.3099e+00+3.2654e-08j, 3.4400e+00+1.4079e-08j,
        1.1644e+01+1.8125e-07j, 9.9364e-01+1.1921e-07j, 4.9599e+00+1.0089e-07j,
        2.1689e+01+2.6060e-08j, 9.2680e-01+2.1499e-08j, 1.0298e+00+3.1057e-07j,
        1.1537e+00-3.3311e-08j, 3.1852e+01+3.5598e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(4.990201473236084+6.533726093493897e-08j)
torch.linalg.det(H.mH@H) = tensor([1.0192e+00+3.7656e-08j, 2.4058e+00-5.3706e-08j, 1.2164e+00+2.7814e-08j,
        1.4275e+00+6.2730e-08j, 2.1270e-01-2.6826e-09j, 4.1045e-01+1.5042e-08j,
        6.9706e-01-4.3747e-09j, 2.6607e-01+2.9802e-08j, 5.5864e-03-3.8656e-09j,
        2.6389e+00-1.7633e-08j, 5.2235e-02+1.9516e-09j, 1.8406e+00-1.2930e-08j,
        3.3329e+00+9.1591e-08j, 5.5727e-01+1.1921e-07j, 3.0348e-01+1.0265e-08j,
        5.8749e+00+4.5319e-08j, 9.4794e-01-7.3840e-09j, 4.2811e-01-8.4438e-08j,
        5.2265e-01-5.2988e-09j, 3.7707e+00+1.8374e-07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (1.3965167999267578+2.1640582659188112e-08j)
SINR torch.Size([20]) = tensor([  1.5945,  -8.0047,  -1.6147,   3.1770,   2.7186,   1.9658,  -2.3598,
         -2.1158, -14.3791,  -2.4946,  -2.3062,   2.3964,   5.0730,  -5.5879,
          2.2208,   5.2109,  -6.1901,  -1.7506,   0.8241,   3.5908],
       device='cuda:0')
SINR mean = -0.9015873074531555
E[H^H] = 1e-07
E_MSE (Error Power) = 3.4335803985595703
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.5908, 0.1367, 0.4081, 0.6751, 0.6516, 0.6113, 0.3674, 0.3806, 0.0352,
        0.3602, 0.3703, 0.6345, 0.7628, 0.2164, 0.6251, 0.7685, 0.1938, 0.4006,
        0.5473, 0.6957], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([300, 627, 411, 250, 264, 288, 437, 428, 806, 442, 435, 274, 195, 548,
        280, 191, 568, 416, 326, 237], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic/nosample/ (starting from index 80)

全 100 枚の画像の処理が完了しました。
Your samples are ready and waiting four you here: 
outputs/ALLSU-MIMO/t=2_r=2_t=2/dynamic 
Enjoy.
