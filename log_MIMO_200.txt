Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([10, 3, 256, 256])
10 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([10, 8, 32, 32])
autoencoder.py , moments = torch.Size([10, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5908, 0.4737, 0.7370, 0.6033, 0.5286, 0.8769, 0.5822, 0.6585, 0.6126,
        0.5291], device='cuda:0')
Variance (Real, all elements): 0.5303353071212769
Variance (Imag, all elements): 0.47340452671051025
--------SNR = -5,  rho_ul = 0.07905694150420949-----------
G_variance = tensor([0.8466, 1.2131, 0.9793, 0.8577, 0.8064, 1.1607, 0.9742, 0.9306, 0.7573,
        0.6706], device='cuda:0')
G_hat_variance = tensor([0.4669, 0.6910, 0.7101, 0.5783, 0.3714, 0.7926, 0.6491, 0.6683, 0.6197,
        0.4363], device='cuda:0')
gamma = tensor([[[0.6126, 0.6126, 0.6126, 0.6126]]], device='cuda:0')
Z_mean = tensor([-0.0326+0.1085j, -0.0432+0.1678j,  0.0135+0.0622j,  0.0443+0.0905j,
        -0.1210+0.0096j, -0.1078+0.0356j, -0.0366-0.0350j,  0.1423+0.0453j,
         0.1404+0.0015j, -0.0714+0.0756j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.7622, 1.1281, 1.1593, 0.9440, 0.6064, 1.2938, 1.0596, 1.0910, 1.0116,
        0.7123], device='cuda:0')
Real_SNR = tensor([-5.7325, -3.1430, -4.7241, -4.7451, -4.8202, -5.4172, -4.9530, -6.9406,
        -5.5314, -5.6349], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.3800, 6.1197, 4.3051, 4.2532, 4.0875, 3.7615, 4.1447, 2.5812, 3.5726,
        3.4958], device='cuda:0')
signal_var = tensor([0.2672, 0.4838, 0.3403, 0.3362, 0.3231, 0.2974, 0.3277, 0.2041, 0.2824,
        0.2764], device='cuda:0')
w_var = tensor([1.0002, 0.9976, 1.0100, 1.0027, 0.9804, 1.0352, 1.0250, 1.0088, 1.0094,
        1.0115], device='cuda:0')
y_var = tensor([1.2606, 1.4759, 1.3512, 1.3420, 1.3137, 1.3360, 1.3421, 1.2126, 1.3044,
        1.2881], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 6.7557,  9.8222,  8.0446,  5.6179],
        [11.1059,  8.5597, 15.8599,  9.6710],
        [12.2387, 11.6985, 10.2011, 11.2353],
        [11.4818,  8.0429,  8.8626,  8.8367],
        [ 6.0682,  5.1941,  7.8452,  5.1305],
        [12.8008, 14.8079, 10.1351, 13.2307],
        [13.3902, 10.7465,  9.0386,  8.2499],
        [ 7.9362,  9.9292, 15.8197,  9.7573],
        [11.5718, 11.1477,  7.6281,  9.8931],
        [ 6.3131,  8.7553,  8.5710,  4.5724]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 7.5834, 11.0256,  9.0302,  6.3062],
        [12.4666,  9.6084, 17.8030, 10.8559],
        [13.7382, 13.1318, 11.4509, 12.6118],
        [12.8885,  9.0283,  9.9484,  9.9193],
        [ 6.8116,  5.8304,  8.8063,  5.7590],
        [14.3691, 16.6221, 11.3768, 14.8516],
        [15.0307, 12.0631, 10.1460,  9.2606],
        [ 8.9085, 11.1457, 17.7579, 10.9527],
        [12.9895, 12.5135,  8.5626, 11.1051],
        [ 7.0866,  9.8279,  9.6211,  5.1326]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([38.5630, 57.6353, 57.8610, 47.4686, 30.9085, 65.0033, 52.8260, 55.3984,
        51.3154, 35.9762], device='cuda:0')
SINR = tensor([-15.8617, -17.6069, -17.6239, -16.7641, -14.9008, -18.1294, -17.2285,
        -17.4350, -17.1025, -15.5601], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0253, 0.0171, 0.0170, 0.0206, 0.0313, 0.0152, 0.0186, 0.0177, 0.0191,
        0.0270], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -4,  rho_ul = 0.0995267926383743-----------
G_variance = tensor([1.3530, 0.6626, 1.0739, 0.8526, 0.6824, 0.8793, 0.9521, 0.9090, 0.8006,
        0.9494], device='cuda:0')
G_hat_variance = tensor([0.7756, 0.5757, 0.7278, 0.6413, 0.4645, 0.5966, 0.6432, 0.6586, 0.6835,
        0.6445], device='cuda:0')
gamma = tensor([[[0.6656, 0.6656, 0.6656, 0.6656]]], device='cuda:0')
Z_mean = tensor([ 0.1357+0.1530j, -0.0924+0.0843j, -0.0117-0.0257j,  0.0381+0.1996j,
        -0.0774+0.0056j,  0.1225+0.0637j, -0.0110-0.0720j,  0.0545+0.1772j,
         0.1112+0.0071j,  0.0761-0.0706j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1653, 0.8649, 1.0935, 0.9635, 0.6978, 0.8964, 0.9663, 0.9894, 1.0268,
        0.9683], device='cuda:0')
Real_SNR = tensor([-2.0869, -4.8650, -4.2969, -4.4309, -4.7126, -3.4551, -4.2386, -4.2130,
        -4.3125, -3.7900], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([6.2316, 3.3060, 3.8176, 3.6004, 3.3653, 4.4583, 3.8195, 3.8345, 3.7768,
        4.1751], device='cuda:0')
signal_var = tensor([0.6202, 0.3290, 0.3800, 0.3583, 0.3349, 0.4437, 0.3801, 0.3816, 0.3759,
        0.4155], device='cuda:0')
w_var = tensor([1.0028, 1.0087, 1.0219, 0.9940, 0.9913, 0.9832, 1.0088, 1.0068, 1.0146,
        0.9945], device='cuda:0')
y_var = tensor([1.6414, 1.3403, 1.3900, 1.3394, 1.3411, 1.4267, 1.3794, 1.3999, 1.3907,
        1.4071], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.8833, 16.8021,  8.1904, 11.2424],
        [ 9.4144,  7.9581,  6.8795, 10.1037],
        [16.5322,  9.8292,  4.6808, 11.6345],
        [14.9856,  8.2774,  6.2765,  9.6893],
        [ 5.2429,  9.3914,  6.1397,  6.6812],
        [13.4474,  9.1781,  6.2329,  6.8640],
        [ 6.7284,  9.8367,  8.7288, 12.6054],
        [11.4418, 11.5871, 10.3616,  6.5702],
        [12.7412, 10.0131,  8.5860,  9.2032],
        [11.6384, 13.9191,  8.1240,  4.5129]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[12.3322, 19.0388,  9.2807, 12.7390],
        [10.6677,  9.0175,  7.7953, 11.4487],
        [18.7330, 11.1377,  5.3039, 13.1834],
        [16.9805,  9.3793,  7.1120, 10.9791],
        [ 5.9408, 10.6416,  6.9570,  7.5707],
        [15.2375, 10.3999,  7.0626,  7.7778],
        [ 7.6241, 11.1462,  9.8908, 14.2834],
        [12.9650, 13.1296, 11.7410,  7.4449],
        [14.4374, 11.3461,  9.7289, 10.4284],
        [13.1877, 15.7720,  9.2055,  5.1136]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([51.8591, 37.8124, 46.9708, 43.1758, 30.2177, 39.3167, 41.7127, 43.9815,
        44.6229, 42.0374], device='cuda:0')
SINR = tensor([-17.1482, -15.7763, -16.7183, -16.3524, -14.8026, -15.9458, -16.2027,
        -16.4327, -16.4956, -16.2364], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0189, 0.0258, 0.0208, 0.0226, 0.0320, 0.0248, 0.0234, 0.0222, 0.0219,
        0.0232], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -3,  rho_ul = 0.12529680840681806-----------
G_variance = tensor([0.6664, 1.4106, 0.7548, 1.2896, 1.1780, 1.3581, 1.2117, 0.8490, 0.8087,
        1.2696], device='cuda:0')
G_hat_variance = tensor([0.6541, 0.9201, 0.5629, 0.8505, 0.8612, 0.9413, 0.8261, 0.6536, 0.7830,
        0.7900], device='cuda:0')
gamma = tensor([[[0.7148, 0.7148, 0.7148, 0.7148]]], device='cuda:0')
Z_mean = tensor([-0.0508+0.0765j, -0.0642+0.0620j,  0.1832+0.1856j, -0.0129+0.2442j,
        -0.1372-0.2168j, -0.0534-0.0754j, -0.2049-0.0513j, -0.1263+0.0084j,
        -0.0943+0.0838j, -0.0958+0.0818j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9152, 1.2873, 0.7876, 1.1899, 1.2049, 1.3170, 1.1558, 0.9144, 1.0955,
        1.1053], device='cuda:0')
Real_SNR = tensor([-4.6037, -0.0494, -3.2695, -2.6975, -2.2254, -2.0857, -1.9074, -3.2308,
        -2.6716, -1.5794], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([2.7307, 7.8588, 3.8239, 4.2987, 4.7679, 4.9579, 5.0638, 3.7987, 4.3574,
        5.4353], device='cuda:0')
signal_var = tensor([0.3421, 0.9847, 0.4791, 0.5386, 0.5974, 0.6212, 0.6345, 0.4760, 0.5460,
        0.6810], device='cuda:0')
w_var = tensor([0.9876, 0.9960, 1.0172, 1.0024, 0.9972, 1.0042, 0.9844, 1.0015, 1.0100,
        0.9797], device='cuda:0')
y_var = tensor([1.3196, 1.9715, 1.4909, 1.5621, 1.5968, 1.6081, 1.6309, 1.4444, 1.5584,
        1.6816], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 6.3849,  4.2711,  9.9758, 15.3968],
        [14.2472, 15.4312, 10.6930, 10.1512],
        [ 7.9277,  8.9416,  7.7243,  8.8420],
        [ 6.7244, 11.1533, 13.0938, 17.8271],
        [12.4176, 10.5048, 14.7392, 11.9632],
        [10.1560, 15.8166, 14.9641, 10.7676],
        [11.5504, 11.3096, 12.3039, 11.6963],
        [ 8.2222, 11.6684, 10.5745,  5.8355],
        [16.2039,  7.4226, 12.3346,  7.3998],
        [ 9.2760, 15.2238,  8.0932, 11.1468]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 7.2976,  4.8817, 11.4019, 17.5979],
        [16.2839, 17.6372, 12.2216, 11.6024],
        [ 9.0609, 10.2198,  8.8286, 10.1060],
        [ 7.6857, 12.7478, 14.9656, 20.3755],
        [14.1927, 12.0065, 16.8462, 13.6734],
        [11.6078, 18.0777, 17.1032, 12.3069],
        [13.2015, 12.9263, 14.0628, 13.3683],
        [ 9.3976, 13.3365, 12.0861,  6.6697],
        [18.5203,  8.4837, 14.0979,  8.4576],
        [10.6021, 17.4001,  9.2501, 12.7403]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([34.4004, 48.2394, 31.9245, 46.5932, 47.3822, 49.3676, 44.7423, 34.6601,
        41.4013, 41.7631], device='cuda:0')
SINR = tensor([-15.3656, -16.8340, -15.0412, -16.6832, -16.7561, -16.9344, -16.5072,
        -15.3983, -16.1701, -16.2079], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0282, 0.0203, 0.0304, 0.0210, 0.0207, 0.0199, 0.0219, 0.0280, 0.0236,
        0.0234], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -2,  rho_ul = 0.1577393361200483-----------
G_variance = tensor([1.2067, 0.8840, 0.8090, 0.6719, 1.1238, 0.9972, 0.8808, 0.9776, 0.9402,
        0.7458], device='cuda:0')
G_hat_variance = tensor([0.6692, 0.8086, 0.6019, 0.6814, 0.8132, 0.7501, 0.5955, 0.8254, 0.6315,
        0.6130], device='cuda:0')
gamma = tensor([[[0.7593, 0.7593, 0.7593, 0.7593]]], device='cuda:0')
Z_mean = tensor([ 0.1416+0.0055j, -0.0685+0.0145j, -0.0424-0.0040j,  0.2239-0.1510j,
        -0.0011+0.0101j,  0.0393-0.1063j, -0.1214-0.0239j,  0.1164-0.0131j,
        -0.2627-0.0456j, -0.0817+0.0280j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8814, 1.0649, 0.7927, 0.8973, 1.0710, 0.9879, 0.7842, 1.0870, 0.8317,
        0.8074], device='cuda:0')
Real_SNR = tensor([-1.2548, -1.8316, -2.4064, -3.2239, -1.7524, -1.9932, -2.8421, -1.1667,
        -1.2425, -3.0693], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.7226, 4.2970, 3.6263, 3.0370, 4.2715, 4.0296, 3.3351, 4.9550, 4.7358,
        3.1345], device='cuda:0')
signal_var = tensor([0.7449, 0.6778, 0.5720, 0.4790, 0.6738, 0.6356, 0.5261, 0.7816, 0.7470,
        0.4944], device='cuda:0')
w_var = tensor([0.9945, 1.0334, 0.9955, 1.0064, 1.0087, 1.0058, 1.0122, 1.0225, 0.9944,
        1.0024], device='cuda:0')
y_var = tensor([1.7243, 1.7007, 1.5725, 1.4822, 1.6763, 1.6216, 1.5272, 1.8107, 1.7030,
        1.4915], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 4.0998,  6.8133, 12.3451, 11.9184],
        [ 9.2836,  7.8336, 11.4154, 13.1953],
        [ 5.7848,  6.1761, 12.5769,  6.4520],
        [10.9006, 10.5983,  9.7115,  6.7034],
        [11.8483, 14.2388,  8.1463,  7.5406],
        [ 8.3687, 15.2212,  4.0383, 11.4146],
        [ 8.2652,  6.0306, 12.2022,  4.6997],
        [10.8447, 11.3830, 11.3600,  9.3542],
        [10.8237,  7.7024, 10.7847,  5.9678],
        [ 5.8217, 10.1629,  5.5902, 10.2105]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 4.7224,  7.8479, 14.2199, 13.7284],
        [10.6935,  9.0232, 13.1490, 15.1992],
        [ 6.6633,  7.1141, 14.4869,  7.4318],
        [12.5560, 12.2078, 11.1864,  7.7214],
        [13.6476, 16.4011,  9.3834,  8.6857],
        [ 9.6396, 17.5327,  4.6516, 13.1481],
        [ 9.5204,  6.9464, 14.0552,  5.4134],
        [12.4915, 13.1117, 13.0852, 10.7747],
        [12.4674,  8.8721, 12.4225,  6.8740],
        [ 6.7058, 11.7063,  6.4391, 11.7612]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([29.2694, 34.7205, 25.7858, 31.5470, 34.7588, 32.4864, 25.9586, 35.7306,
        29.3542, 26.4476], device='cuda:0')
SINR = tensor([-14.6641, -15.4059, -14.1138, -14.9896, -15.4106, -15.1170, -14.1428,
        -15.5304, -14.6767, -14.2239], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0330, 0.0280, 0.0373, 0.0307, 0.0280, 0.0299, 0.0371, 0.0272, 0.0329,
        0.0364], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = -1,  rho_ul = 0.19858205868107037-----------
G_variance = tensor([1.0089, 0.9916, 0.7865, 1.0580, 1.0024, 0.8136, 0.8966, 0.8833, 0.6918,
        1.0872], device='cuda:0')
G_hat_variance = tensor([0.8643, 0.9360, 0.6123, 0.8468, 0.9038, 0.7187, 0.6843, 0.6795, 0.6944,
        0.7311], device='cuda:0')
gamma = tensor([[[0.7989, 0.7989, 0.7989, 0.7989]]], device='cuda:0')
Z_mean = tensor([ 0.2379+0.0892j, -0.1892-0.0254j,  0.0964+0.0880j, -0.0227-0.1536j,
         0.2130+0.1368j, -0.0801-0.0615j,  0.0189-0.1218j,  0.1407+0.0776j,
        -0.1646-0.1854j,  0.1060+0.1976j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0820, 1.1717, 0.7664, 1.0601, 1.1313, 0.8996, 0.8567, 0.8506, 0.8692,
        0.9152], device='cuda:0')
Real_SNR = tensor([-1.1642, -0.0478, -1.7488,  0.4263, -1.1417, -0.9714, -0.5025, -0.5941,
        -1.9845,  0.0717], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.7999, 4.9417, 3.3262, 5.4210, 3.8830, 4.0861, 4.6432, 4.4048, 3.1594,
        4.9594], device='cuda:0')
signal_var = tensor([0.7546, 0.9813, 0.6605, 1.0765, 0.7711, 0.8114, 0.9221, 0.8747, 0.6274,
        0.9848], device='cuda:0')
w_var = tensor([0.9866, 0.9922, 0.9880, 0.9759, 1.0029, 1.0148, 1.0352, 1.0029, 0.9908,
        0.9687], device='cuda:0')
y_var = tensor([1.7484, 1.9649, 1.6547, 2.0396, 1.7651, 1.8026, 1.9348, 1.9113, 1.6186,
        1.9634], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[13.0427,  9.9398, 11.1491, 10.6471],
        [12.0315, 14.1141, 10.6062, 10.4008],
        [ 9.2902,  3.7613,  8.7870,  8.7329],
        [16.8624, 10.5158,  7.9348,  6.9942],
        [11.9658, 13.2793, 14.3174,  7.1221],
        [ 5.6324,  7.8822,  5.9906, 15.9883],
        [13.1579,  9.2642,  7.1713,  4.4236],
        [ 7.2703,  6.4409,  9.8576, 10.6366],
        [ 9.8588,  8.5870, 10.6840,  7.2275],
        [10.6854,  9.3409, 11.1493,  6.5300]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[15.1265, 11.5279, 12.9304, 12.3482],
        [13.9537, 16.3691, 12.3007, 12.0625],
        [10.7745,  4.3622, 10.1909, 10.1282],
        [19.5566, 12.1960,  9.2025,  8.1117],
        [13.8776, 15.4009, 16.6049,  8.2600],
        [ 6.5323,  9.1416,  6.9478, 18.5428],
        [15.2602, 10.7444,  8.3171,  5.1304],
        [ 8.4319,  7.4699, 11.4325, 12.3360],
        [11.4340,  9.9590, 12.3910,  8.3823],
        [12.3926, 10.8333, 12.9306,  7.5733]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([32.5970, 34.3251, 22.2548, 30.7980, 33.9844, 25.8379, 24.7631, 24.9001,
        26.4667, 27.4481], device='cuda:0')
SINR = tensor([-15.1318, -15.3561, -13.4742, -14.8852, -15.3128, -14.1226, -13.9380,
        -13.9620, -14.2270, -14.3851], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0298, 0.0283, 0.0430, 0.0314, 0.0286, 0.0373, 0.0388, 0.0386, 0.0364,
        0.0352], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 0,  rho_ul = 0.25-----------
G_variance = tensor([1.3291, 0.9503, 0.8561, 0.7080, 1.1186, 1.1288, 0.7482, 1.2351, 0.8753,
        0.8630], device='cuda:0')
G_hat_variance = tensor([0.9299, 0.7378, 0.6763, 0.6796, 0.9484, 1.0425, 0.7701, 1.0909, 0.8722,
        0.7157], device='cuda:0')
gamma = tensor([[[0.8333, 0.8333, 0.8333, 0.8333]]], device='cuda:0')
Z_mean = tensor([ 0.0653-0.0484j,  0.0207-0.1090j,  0.1025+0.1205j, -0.2373+0.0224j,
         0.0890+0.0248j,  0.0320+0.1124j, -0.0086+0.1354j, -0.1157+0.1716j,
        -0.1862+0.0159j, -0.1665-0.1174j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1159, 0.8854, 0.8116, 0.8155, 1.1381, 1.2510, 0.9242, 1.3091, 1.0466,
        0.8589], device='cuda:0')
Real_SNR = tensor([ 0.4533,  1.0778, -1.5221, -0.6320,  0.3843, -0.4791, -0.9018,  0.6969,
         0.4895,  0.5364], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.5872, 5.0404, 2.8450, 3.4019, 4.3783, 3.6110, 3.1762, 4.7524, 4.4781,
        4.5301], device='cuda:0')
signal_var = tensor([1.1468, 1.2601, 0.7113, 0.8505, 1.0946, 0.9028, 0.7940, 1.1881, 1.1195,
        1.1325], device='cuda:0')
w_var = tensor([1.0331, 0.9832, 1.0098, 0.9837, 1.0019, 1.0080, 0.9773, 1.0120, 1.0002,
        1.0009], device='cuda:0')
y_var = tensor([2.1624, 2.2959, 1.7288, 1.8556, 2.0796, 1.9086, 1.7841, 2.2242, 2.1336,
        2.1066], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[10.4859,  6.8797, 12.3740, 14.0460],
        [ 4.8649, 10.1540,  7.8400, 12.1631],
        [ 8.2591,  8.0087,  8.3933,  7.9915],
        [ 8.6013,  5.0773,  9.6672, 10.7318],
        [ 8.3827,  8.0260, 12.8964, 15.4220],
        [11.6428, 13.0526, 14.9235,  9.7169],
        [ 7.1403, 10.3376, 10.0862,  9.2149],
        [ 5.0466, 12.8340, 17.6370, 17.2495],
        [11.3223, 15.7997,  5.9403,  9.1530],
        [12.0138,  9.1989,  6.0256,  7.9186]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[12.2336,  8.0263, 14.4364, 16.3870],
        [ 5.6757, 11.8463,  9.1467, 14.1902],
        [ 9.6356,  9.3434,  9.7921,  9.3234],
        [10.0349,  5.9236, 11.2784, 12.5205],
        [ 9.7799,  9.3637, 15.0458, 17.9923],
        [13.5833, 15.2281, 17.4108, 11.3363],
        [ 8.3304, 12.0605, 11.7672, 10.7507],
        [ 5.8877, 14.9730, 20.5766, 20.1245],
        [13.2093, 18.4330,  6.9304, 10.6785],
        [14.0161, 10.7321,  7.0299,  9.2383]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([27.9795, 22.3794, 20.8652, 21.7760, 28.5811, 31.5261, 23.5021, 33.7187,
        26.9760, 22.4656], device='cuda:0')
SINR = tensor([-14.4684, -13.4985, -13.1942, -13.3798, -14.5608, -14.9867, -13.7111,
        -15.2787, -14.3098, -13.5152], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0345, 0.0428, 0.0457, 0.0439, 0.0338, 0.0307, 0.0408, 0.0288, 0.0357,
        0.0426], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 1,  rho_ul = 0.3147313529485418-----------
G_variance = tensor([1.0042, 1.0017, 0.9357, 1.2285, 1.1520, 1.2903, 1.1333, 0.9588, 0.9463,
        0.7454], device='cuda:0')
G_hat_variance = tensor([0.8037, 0.8716, 0.8212, 1.0542, 1.0318, 1.1500, 0.9314, 0.8371, 0.9487,
        0.7160], device='cuda:0')
gamma = tensor([[[0.8629, 0.8629, 0.8629, 0.8629]]], device='cuda:0')
Z_mean = tensor([ 0.0268-0.0819j, -0.0558-0.0135j,  0.0193-0.0961j, -0.0606+0.0609j,
         0.0802+0.0816j, -0.0055+0.0968j, -0.1686+0.1011j, -0.2013-0.0467j,
        -0.0066+0.1459j, -0.0198-0.1370j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9313, 1.0101, 0.9517, 1.2217, 1.1958, 1.3327, 1.0794, 0.9701, 1.0994,
        0.8298], device='cuda:0')
Real_SNR = tensor([0.7437, 1.3791, 0.1010, 1.7274, 1.8468, 1.0954, 1.8813, 1.3740, 2.0982,
        0.3061], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.7507, 4.3581, 3.3031, 4.6808, 4.7851, 3.9903, 4.9198, 4.4106, 5.2658,
        3.3728], device='cuda:0')
signal_var = tensor([1.1805, 1.3716, 1.0396, 1.4732, 1.5060, 1.2559, 1.5484, 1.3881, 1.6573,
        1.0615], device='cuda:0')
w_var = tensor([0.9947, 0.9985, 1.0157, 0.9897, 0.9844, 0.9759, 1.0041, 1.0117, 1.0223,
        0.9893], device='cuda:0')
y_var = tensor([2.1954, 2.3983, 2.0386, 2.4949, 2.4891, 2.2126, 2.5373, 2.4083, 2.6394,
        2.0600], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 6.1651, 11.9889,  7.5411, 10.9238],
        [10.8654,  8.0945,  8.1716, 12.3950],
        [ 5.3381, 10.6127,  7.8299, 13.7208],
        [12.2841, 14.7129,  9.8988, 11.0439],
        [14.9383, 15.6534,  6.0382, 10.5281],
        [12.8276, 12.5840, 10.8759, 16.0659],
        [12.5969,  8.6514, 10.5190, 11.8731],
        [11.0903, 10.0944,  4.6287, 13.7295],
        [15.0616,  6.6453, 11.0058, 11.0185],
        [ 7.2096,  7.6997,  7.9745, 10.2442]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 7.2291, 14.0580,  8.8425, 12.8091],
        [12.7406,  9.4914,  9.5818, 14.5341],
        [ 6.2593, 12.4443,  9.1812, 16.0887],
        [14.4042, 17.2521, 11.6072, 12.9499],
        [17.5164, 18.3549,  7.0803, 12.3451],
        [15.0414, 14.7558, 12.7529, 18.8386],
        [14.7709, 10.1445, 12.3344, 13.9221],
        [13.0043, 11.8366,  5.4276, 16.0990],
        [17.6609,  7.7921, 12.9052, 12.9202],
        [ 8.4539,  9.0286,  9.3508, 12.0121]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([20.5985, 22.2340, 21.0949, 26.9666, 26.5269, 29.4493, 24.5482, 22.2433,
        24.5992, 18.6349], device='cuda:0')
SINR = tensor([-13.1384, -13.4702, -13.2418, -14.3083, -14.2369, -14.6907, -13.9002,
        -13.4720, -13.9092, -12.7033], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0463, 0.0430, 0.0453, 0.0358, 0.0363, 0.0328, 0.0391, 0.0430, 0.0391,
        0.0509], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 2,  rho_ul = 0.3962232981152784-----------
G_variance = tensor([1.2483, 1.1099, 1.3822, 1.0471, 0.8620, 1.0213, 1.3653, 1.0863, 1.1186,
        0.7727], device='cuda:0')
G_hat_variance = tensor([0.9273, 0.9593, 1.0689, 0.8876, 0.7548, 0.9316, 1.3065, 0.9258, 0.9889,
        0.7282], device='cuda:0')
gamma = tensor([[[0.8879, 0.8879, 0.8879, 0.8879]]], device='cuda:0')
Z_mean = tensor([ 0.0164+0.0426j, -0.1035-0.0482j,  0.1203-0.1794j,  0.2934-0.2498j,
        -0.0617-0.0228j,  0.0165-0.1273j,  0.0487+0.0099j, -0.2170+0.1773j,
        -0.0038-0.0696j,  0.0123-0.0258j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0443, 1.0803, 1.2038, 0.9996, 0.8501, 1.0491, 1.4714, 1.0427, 1.1137,
        0.8201], device='cuda:0')
Real_SNR = tensor([1.6210, 3.3466, 2.9970, 2.7844, 1.3021, 0.8580, 3.4494, 2.7380, 2.2887,
        0.7533], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.5828, 5.4549, 5.1379, 4.7618, 3.4000, 3.2154, 5.4240, 4.8479, 4.2275,
        2.9640], device='cuda:0')
signal_var = tensor([1.4196, 2.1614, 2.0357, 1.8867, 1.3472, 1.2740, 2.1491, 1.9209, 1.6750,
        1.1744], device='cuda:0')
w_var = tensor([0.9774, 1.0002, 1.0210, 0.9937, 0.9982, 1.0456, 0.9712, 1.0226, 0.9889,
        0.9874], device='cuda:0')
y_var = tensor([2.4012, 3.1494, 3.0456, 2.8689, 2.3840, 2.3475, 3.0875, 2.9591, 2.6686,
        2.1797], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 7.3038, 12.2660,  8.2905, 12.9515],
        [11.2710, 12.8854,  6.6204, 11.8776],
        [ 7.0040, 18.4742,  9.9637, 13.3704],
        [12.4031, 12.3544, 11.6207,  8.5452],
        [ 5.8517,  9.5821, 11.0023,  6.8901],
        [11.4591,  9.7803, 12.4300,  7.9064],
        [15.9328, 10.7094, 12.7332, 18.1083],
        [10.8045,  7.8627, 13.9313, 11.2063],
        [ 8.0110, 11.5665, 13.2726, 10.7793],
        [ 6.2133, 12.3817,  7.7269,  5.6951]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 8.6008, 14.4443,  9.7628, 15.2516],
        [13.2726, 15.1738,  7.7961, 13.9870],
        [ 8.2478, 21.7551, 11.7332, 15.7449],
        [14.6058, 14.5485, 13.6844, 10.0627],
        [ 6.8909, 11.2837, 12.9562,  8.1137],
        [13.4942, 11.5171, 14.6374,  9.3105],
        [18.7623, 12.6113, 14.9944, 21.3241],
        [12.7232,  9.2590, 16.4054, 13.1964],
        [ 9.4337, 13.6206, 15.6297, 12.6936],
        [ 7.3167, 14.5806,  9.0991,  6.7064]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([20.2561, 21.1707, 24.2270, 22.2968, 16.5408, 20.6353, 28.5308, 21.7416,
        21.6546, 15.8910], device='cuda:0')
SINR = tensor([-13.0656, -13.2573, -13.8430, -13.4824, -12.1856, -13.1461, -14.5531,
        -13.3729, -13.3555, -12.0115], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0470, 0.0451, 0.0396, 0.0429, 0.0570, 0.0462, 0.0339, 0.0440, 0.0441,
        0.0592], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 3,  rho_ul = 0.4988155787422199-----------
G_variance = tensor([0.9011, 0.9166, 1.4423, 1.2402, 0.7799, 0.9398, 1.0143, 0.7933, 0.8844,
        1.1493], device='cuda:0')
G_hat_variance = tensor([0.8096, 0.7934, 1.2793, 1.0424, 0.7495, 1.0235, 0.9636, 0.7321, 0.7922,
        1.0982], device='cuda:0')
gamma = tensor([[[0.9089, 0.9089, 0.9089, 0.9089]]], device='cuda:0')
Z_mean = tensor([-0.0592+0.1082j,  0.0122-0.1572j,  0.1022+0.0577j,  0.2448-0.0695j,
        -0.1932+0.2402j,  0.0174-0.0331j, -0.0184-0.1820j, -0.1829-0.0423j,
         0.0584+0.0405j,  0.0340+0.0075j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.8907, 0.8729, 1.4076, 1.1469, 0.8246, 1.1261, 1.0602, 0.8054, 0.8717,
        1.2083], device='cuda:0')
Real_SNR = tensor([2.5853, 2.4150, 4.8902, 4.3830, 1.9839, 3.0708, 2.8786, 2.5019, 2.1699,
        3.8778], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.6416, 3.5789, 6.1299, 5.5547, 3.1957, 3.9938, 3.8878, 3.6031, 3.3945,
        4.9178], device='cuda:0')
signal_var = tensor([1.8165, 1.7852, 3.0577, 2.7708, 1.5941, 1.9922, 1.9393, 1.7973, 1.6932,
        2.4531], device='cuda:0')
w_var = tensor([1.0016, 1.0237, 0.9917, 1.0099, 1.0095, 0.9823, 0.9995, 1.0102, 1.0274,
        1.0044], device='cuda:0')
y_var = tensor([2.8332, 2.8399, 4.0125, 3.7917, 2.6130, 2.9943, 2.9674, 2.7974, 2.7160,
        3.4781], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 6.7568,  7.7960, 12.2255,  8.5695],
        [ 6.8568,  7.8096, 13.0129,  7.3579],
        [ 8.8583, 13.2339, 12.7605, 20.5941],
        [12.0837,  9.7290, 15.2769, 10.2294],
        [ 8.6175,  9.3030,  6.6557, 11.3850],
        [12.9941, 10.3232,  7.7739, 12.8829],
        [ 7.3090, 12.7426, 16.2665,  6.3660],
        [ 9.6635,  7.5817,  7.0035,  8.5726],
        [ 8.9840,  8.8651,  7.4904,  8.8569],
        [ 8.1963, 13.2045, 16.5241,  9.2485]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 7.9851,  9.2131, 14.4478, 10.1273],
        [ 8.1032,  9.2293, 15.3784,  8.6954],
        [10.4685, 15.6395, 15.0801, 24.3377],
        [14.2802, 11.4976, 18.0539, 12.0888],
        [10.1840, 10.9940,  7.8656, 13.4546],
        [15.3561, 12.1997,  9.1870, 15.2247],
        [ 8.6376, 15.0589, 19.2234,  7.5232],
        [11.4201,  8.9599,  8.2766, 10.1309],
        [10.6171, 10.4766,  8.8520, 10.4669],
        [ 9.6863, 15.6048, 19.5278, 10.9296]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([15.5100, 15.3737, 24.3291, 20.7627, 15.7792, 19.2950, 18.7290, 14.4014,
        15.0048, 20.6989], device='cuda:0')
SINR = tensor([-11.9061, -11.8678, -13.8613, -13.1728, -11.9808, -12.8545, -12.7252,
        -11.5841, -11.7623, -13.1595], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0606, 0.0611, 0.0395, 0.0460, 0.0596, 0.0493, 0.0507, 0.0649, 0.0625,
        0.0461], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 4,  rho_ul = 0.627971607877395-----------
G_variance = tensor([1.1540, 0.8142, 1.2095, 1.0613, 1.2093, 0.9525, 1.0290, 1.2879, 1.1046,
        1.0409], device='cuda:0')
G_hat_variance = tensor([1.0540, 0.7387, 1.0743, 0.9254, 1.0365, 0.9227, 0.7953, 1.2159, 0.9271,
        0.9811], device='cuda:0')
gamma = tensor([[[0.9263, 0.9263, 0.9263, 0.9263]]], device='cuda:0')
Z_mean = tensor([-0.1955+0.2116j, -0.0548-0.0357j, -0.0137+0.2194j,  0.0637-0.0042j,
         0.0923+0.1231j, -0.0684-0.0063j, -0.1004-0.1016j,  0.0340+0.1879j,
         0.0510+0.0602j,  0.0100-0.0210j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.1379, 0.7975, 1.1598, 0.9990, 1.1190, 0.9962, 0.8587, 1.3127, 1.0009,
        1.0592], device='cuda:0')
Real_SNR = tensor([4.5357, 3.5536, 5.3688, 5.0192, 4.4701, 3.3143, 5.2018, 4.3794, 4.9644,
        5.1244], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.4964, 3.5368, 5.5659, 4.9810, 4.5724, 3.4401, 5.3193, 4.3792, 5.0136,
        5.1364], device='cuda:0')
signal_var = tensor([2.8236, 2.2210, 3.4952, 3.1279, 2.8713, 2.1603, 3.3404, 2.7500, 3.1484,
        3.2255], device='cuda:0')
w_var = tensor([0.9937, 0.9799, 1.0153, 0.9848, 1.0258, 1.0071, 1.0083, 1.0032, 1.0038,
        0.9912], device='cuda:0')
y_var = tensor([3.8343, 3.1759, 4.5075, 4.1099, 3.8573, 3.1881, 4.3516, 3.8035, 4.2098,
        4.2034], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[12.1686,  8.1097,  7.1481, 20.2706],
        [ 3.8059,  7.1953,  7.3891, 12.8839],
        [17.7345, 13.3867,  7.5221,  8.5229],
        [ 9.8109, 10.2231,  8.4180, 10.6736],
        [ 6.3966, 12.8251, 13.2274, 12.1381],
        [ 5.3809,  9.6972, 12.9494, 11.0121],
        [10.0878, 13.2264,  5.6268,  5.3632],
        [11.7861, 16.8933, 12.3000, 11.6762],
        [ 9.5849,  6.5805, 15.3956,  7.7218],
        [10.4433, 16.8805,  6.9239,  7.0825]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[14.4228,  9.6120,  8.4723, 24.0258],
        [ 4.5110,  8.5282,  8.7580, 15.2707],
        [21.0198, 15.8666,  8.9156, 10.1017],
        [11.6284, 12.1169,  9.9774, 12.6508],
        [ 7.5816, 15.2009, 15.6778, 14.3866],
        [ 6.3777, 11.4936, 15.3483, 13.0521],
        [11.9566, 15.6766,  6.6692,  6.3567],
        [13.9695, 20.0228, 14.5786, 13.8393],
        [11.3605,  7.7995, 18.2477,  9.1523],
        [12.3779, 20.0076,  8.2065,  8.3945]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([18.5313, 12.1508, 18.3251, 15.2011, 17.3231, 15.1677, 13.3280, 20.4579,
        15.2622, 16.0577], device='cuda:0')
SINR = tensor([-12.6791, -10.8460, -12.6305, -11.8188, -12.3863, -11.8092, -11.2476,
        -13.1086, -11.8362, -12.0568], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0512, 0.0760, 0.0517, 0.0617, 0.0546, 0.0619, 0.0698, 0.0466, 0.0615,
        0.0586], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 5,  rho_ul = 0.7905694150420949-----------
G_variance = tensor([1.0053, 1.0048, 1.1521, 0.9830, 1.1371, 0.8283, 1.0032, 0.8317, 1.0280,
        1.0003], device='cuda:0')
G_hat_variance = tensor([0.9885, 0.9067, 1.0725, 0.9507, 1.0301, 0.7792, 0.8935, 0.7654, 0.9223,
        0.9309], device='cuda:0')
gamma = tensor([[[0.9405, 0.9405, 0.9405, 0.9405]]], device='cuda:0')
Z_mean = tensor([ 0.1198+0.1192j,  0.0160+0.0389j, -0.0949-0.0155j,  0.0439-0.1265j,
        -0.0734+0.0887j,  0.0204+0.0453j, -0.0115-0.0946j, -0.1176+0.1485j,
        -0.0614+0.0791j, -0.0250-0.0351j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0510, 0.9640, 1.1404, 1.0108, 1.0952, 0.8285, 0.9500, 0.8138, 0.9807,
        0.9897], device='cuda:0')
Real_SNR = tensor([4.9949, 5.4066, 5.3588, 4.2340, 5.0696, 4.5574, 5.2928, 3.2745, 5.8696,
        6.0288], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.0009, 4.4274, 4.4119, 3.2883, 4.0226, 3.6414, 4.3214, 2.6649, 4.8431,
        5.0551], device='cuda:0')
signal_var = tensor([3.1630, 3.5001, 3.4879, 2.5996, 3.1802, 2.8788, 3.4163, 2.1068, 3.8288,
        3.9964], device='cuda:0')
w_var = tensor([1.0014, 1.0079, 1.0155, 0.9806, 0.9897, 1.0080, 1.0099, 0.9912, 0.9911,
        0.9972], device='cuda:0')
y_var = tensor([4.1862, 4.4736, 4.4618, 3.5890, 4.1289, 3.9091, 4.4375, 3.1268, 4.8666,
        5.0173], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[12.2841,  6.9045, 11.6448, 11.2976],
        [11.9014,  7.4078,  6.5817, 11.7772],
        [ 8.7349, 13.4271, 13.7118,  8.9702],
        [ 7.2583,  9.5941, 11.8603, 11.4246],
        [ 9.2454, 11.9899, 13.1864,  8.8218],
        [ 7.1546, 10.8751,  7.0782,  7.3005],
        [11.0500,  8.6866,  9.1584,  8.5185],
        [ 1.9087, 10.6480, 11.3901,  9.2262],
        [11.9712,  8.7504,  5.2342, 12.6923],
        [10.9005,  8.9743,  9.2535,  9.5456]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[14.5948,  8.2033, 13.8353, 13.4227],
        [14.1401,  8.8012,  7.8198, 13.9926],
        [10.3779, 15.9528, 16.2910, 10.6575],
        [ 8.6236, 11.3988, 14.0913, 13.5736],
        [10.9844, 14.2453, 15.6668, 10.4812],
        [ 8.5004, 12.9207,  8.4096,  8.6738],
        [13.1286, 10.3206, 10.8811, 10.1208],
        [ 2.2678, 12.6510, 13.5326, 10.9617],
        [14.2230, 10.3963,  6.2188, 15.0798],
        [12.9509, 10.6624, 10.9941, 11.3411]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([14.5125, 12.9752, 15.4470, 13.8258, 14.8957, 11.1635, 12.8875, 11.4268,
        13.3128, 13.3217], device='cuda:0')
SINR = tensor([-11.6174, -11.1311, -11.8884, -11.4069, -11.7306, -10.4780, -11.1017,
        -10.5793, -11.2427, -11.2456], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0645, 0.0716, 0.0608, 0.0675, 0.0629, 0.0822, 0.0720, 0.0805, 0.0699,
        0.0698], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 6,  rho_ul = 0.9952679263837431-----------
G_variance = tensor([0.9566, 1.3344, 0.9051, 1.0218, 0.8565, 0.9423, 0.8543, 1.0725, 0.9263,
        1.1896], device='cuda:0')
G_hat_variance = tensor([0.8857, 1.2360, 0.8962, 0.9500, 0.8210, 0.8832, 0.8243, 1.1009, 0.9464,
        1.0513], device='cuda:0')
gamma = tensor([[[0.9522, 0.9522, 0.9522, 0.9522]]], device='cuda:0')
Z_mean = tensor([-0.0277+0.0808j, -0.0694+0.1675j, -0.2123+0.2100j, -0.1130-0.0450j,
         0.0820+0.1995j,  0.0039+0.0648j,  0.0628+0.0150j,  0.0106+0.1550j,
        -0.1159-0.0483j, -0.0076+0.1150j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9302, 1.2980, 0.9413, 0.9977, 0.8622, 0.9275, 0.8657, 1.1562, 0.9939,
        1.1041], device='cuda:0')
Real_SNR = tensor([6.2181, 8.0955, 4.4540, 5.8596, 5.3139, 6.9584, 4.9548, 6.9098, 7.1910,
        6.7336], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.2701, 6.3636, 2.8002, 3.9366, 3.5184, 4.8310, 3.1305, 4.9049, 5.2207,
        4.8221], device='cuda:0')
signal_var = tensor([4.2499, 6.3335, 2.7870, 3.9180, 3.5018, 4.8082, 3.1157, 4.8816, 5.1959,
        4.7993], device='cuda:0')
w_var = tensor([1.0152, 0.9820, 0.9994, 1.0165, 1.0301, 0.9686, 0.9956, 0.9945, 0.9921,
        1.0182], device='cuda:0')
y_var = tensor([5.2331, 7.3609, 3.7960, 4.9297, 4.5931, 5.7785, 4.1690, 5.9068, 6.1800,
        5.8336], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[ 8.2177,  9.0108, 12.5853,  6.7567],
        [13.6170, 15.0732, 11.8746, 11.3736],
        [ 9.1474,  9.3286, 17.4814,  4.3190],
        [ 8.4677, 12.2738, 10.3427,  8.4193],
        [ 7.2753, 10.9566,  6.7314, 10.5236],
        [ 5.8780, 10.5128,  8.2110, 11.7404],
        [ 8.2237,  4.8251,  8.4438, 12.4374],
        [10.7317,  8.6776,  9.6267, 17.0214],
        [10.9204, 11.1285,  6.6094, 10.7343],
        [ 9.1493,  6.5046, 11.7087, 16.2286]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[ 9.7827, 10.7267, 14.9820,  8.0434],
        [16.2101, 17.9437, 14.1360, 13.5395],
        [10.8893, 11.1050, 20.8105,  5.1414],
        [10.0802, 14.6112, 12.3123, 10.0227],
        [ 8.6607, 13.0431,  8.0132, 12.5277],
        [ 6.9973, 12.5147,  9.7747, 13.9761],
        [ 9.7898,  5.7439, 10.0518, 14.8059],
        [12.7754, 10.3301, 11.4599, 20.2628],
        [13.0000, 13.2478,  7.8681, 12.7785],
        [10.8916,  7.7432, 13.9385, 19.3190]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([11.1802, 15.8784, 12.3131, 12.0769, 10.8489, 11.1104, 10.3730, 14.0805,
        12.0430, 13.3265], device='cuda:0')
SINR = tensor([-10.4845, -12.0081, -10.9037, -10.8196, -10.3539, -10.4573, -10.1590,
        -11.4862, -10.8073, -11.2472], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0821, 0.0592, 0.0751, 0.0765, 0.0844, 0.0826, 0.0879, 0.0663, 0.0767,
        0.0698], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 7,  rho_ul = 1.2529680840681805-----------
G_variance = tensor([1.0231, 0.9924, 0.8232, 0.7526, 1.4810, 1.1960, 1.1907, 0.9712, 1.1692,
        0.9228], device='cuda:0')
G_hat_variance = tensor([1.0221, 0.9515, 0.8566, 0.8024, 1.3927, 1.1843, 1.1788, 0.9329, 1.1508,
        0.8784], device='cuda:0')
gamma = tensor([[[0.9616, 0.9616, 0.9616, 0.9616]]], device='cuda:0')
Z_mean = tensor([-0.0483+0.0187j, -0.0481-0.1796j,  0.0644-0.0010j, -0.0465-0.0182j,
        -0.1722+0.0287j, -0.1636-0.1302j,  0.1547+0.0325j,  0.0539-0.0405j,
         0.1081-0.0127j,  0.2315-0.0181j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0629, 0.9895, 0.8908, 0.8344, 1.4483, 1.2315, 1.2259, 0.9701, 1.1967,
        0.9134], device='cuda:0')
Real_SNR = tensor([6.9344, 8.2008, 5.9968, 5.8631, 8.4853, 8.0153, 7.7745, 8.0221, 7.6748,
        7.7505], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([4.0158, 5.1633, 3.2752, 3.0359, 5.5412, 5.0999, 4.8000, 5.1848, 4.6422,
        4.7264], device='cuda:0')
signal_var = tensor([5.0317, 6.4695, 4.1038, 3.8039, 6.9430, 6.3900, 6.0143, 6.4963, 5.8165,
        5.9221], device='cuda:0')
w_var = tensor([1.0192, 0.9790, 1.0316, 0.9861, 0.9840, 1.0092, 1.0040, 1.0244, 0.9935,
        0.9941], device='cuda:0')
y_var = tensor([6.0899, 7.4731, 5.0562, 4.8445, 7.9974, 7.4710, 7.0578, 7.5393, 6.7801,
        6.9182], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[13.5619,  9.2839, 11.5010,  7.2135],
        [10.3626, 10.2743, 11.0066,  8.3307],
        [ 5.7628,  6.4837, 11.7024, 10.9580],
        [ 8.1471,  6.9002,  6.7761, 10.8193],
        [15.3674, 13.5356, 19.2382,  9.5608],
        [11.6523, 14.1901,  8.8205, 15.1153],
        [12.8347,  8.9568, 12.7893, 14.2283],
        [ 6.4866, 14.9926,  8.6168,  7.9197],
        [ 8.9601, 21.6865,  8.4909,  8.0087],
        [ 8.8920, 12.2225,  8.0193,  8.6455]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[16.1702, 11.0694, 13.7129,  8.6009],
        [12.3556, 12.2503, 13.1235,  9.9329],
        [ 6.8712,  7.7307, 13.9531, 13.0655],
        [ 9.7139,  8.2273,  8.0793, 12.9001],
        [18.3229, 16.1388, 22.9382, 11.3996],
        [13.8934, 16.9193, 10.5169, 18.0224],
        [15.3031, 10.6794, 15.2490, 16.9648],
        [ 7.7341, 17.8761, 10.2740,  9.4428],
        [10.6834, 25.8574, 10.1239,  9.5490],
        [10.6022, 14.5732,  9.5616, 10.3083]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([11.2860, 10.8553,  9.4792,  8.8643, 15.6694, 13.5177, 13.2545, 10.3234,
        12.8029, 10.2593], device='cuda:0')
SINR = tensor([-10.5254, -10.3564,  -9.7677,  -9.4765, -11.9505, -11.3090, -11.2236,
        -10.1382, -11.0731, -10.1112], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0814, 0.0844, 0.0954, 0.1014, 0.0600, 0.0689, 0.0702, 0.0883, 0.0724,
        0.0888], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 8,  rho_ul = 1.5773933612004833-----------
G_variance = tensor([1.5107, 0.8386, 0.9521, 1.1417, 1.2564, 1.1505, 0.7367, 1.0817, 1.4033,
        1.0625], device='cuda:0')
G_hat_variance = tensor([1.3750, 0.8193, 1.0030, 1.1015, 1.2167, 1.1263, 0.7706, 0.9974, 1.2791,
        0.9594], device='cuda:0')
gamma = tensor([[[0.9693, 0.9693, 0.9693, 0.9693]]], device='cuda:0')
Z_mean = tensor([ 0.1102+0.0976j, -0.0254+0.0181j,  0.1359-0.0462j,  0.2322+0.0288j,
        -0.0006+0.0919j, -0.0785+0.0191j, -0.0249+0.1439j,  0.0568-0.1799j,
        -0.1512+0.1009j, -0.0288+0.0575j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.4186, 0.8452, 1.0348, 1.1364, 1.2553, 1.1620, 0.7950, 1.0290, 1.3196,
        0.9898], device='cuda:0')
Real_SNR = tensor([9.7940, 7.6772, 9.3669, 8.2762, 8.5549, 8.7322, 6.1013, 9.9026, 9.9949,
        8.5037], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([5.9911, 3.7404, 5.5822, 4.2408, 4.5469, 4.9500, 2.5938, 6.1087, 6.2988,
        4.6020], device='cuda:0')
signal_var = tensor([9.4504, 5.9001, 8.8053, 6.6894, 7.1722, 7.8080, 4.0915, 9.6358, 9.9357,
        7.2591], device='cuda:0')
w_var = tensor([0.9909, 1.0073, 1.0187, 0.9949, 1.0004, 1.0455, 1.0040, 0.9854, 0.9947,
        1.0245], device='cuda:0')
y_var = tensor([10.6034,  6.9717,  9.8702,  7.6274,  8.1890,  8.8104,  5.1257, 10.7387,
        10.8329,  8.2052], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[13.2549, 21.0718, 12.0552,  9.8089],
        [ 6.7368, 10.3770,  9.0463,  6.8432],
        [14.4874, 13.2459,  5.8880,  7.5581],
        [12.8027,  8.5339, 19.9985,  5.1758],
        [13.0298, 15.3377, 11.5164,  9.4114],
        [17.4099,  8.9424, 11.5373,  7.6882],
        [ 4.9517,  8.9691,  5.2415, 12.6965],
        [10.9751, 10.4346, 10.0973, 10.0487],
        [12.1382, 17.8020, 11.1859, 11.6614],
        [ 9.4315, 10.3789,  9.6334,  9.3232]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[15.8244, 25.1566, 14.3922, 11.7104],
        [ 8.0428, 12.3887, 10.8000,  8.1698],
        [17.2959, 15.8136,  7.0294,  9.0232],
        [15.2846, 10.1882, 23.8753,  6.1791],
        [15.5557, 18.3110, 13.7489, 11.2359],
        [20.7849, 10.6759, 13.7738,  9.1787],
        [ 5.9117, 10.7079,  6.2575, 15.1578],
        [13.1027, 12.4575, 12.0547, 11.9967],
        [14.4912, 21.2530, 13.3544, 13.9221],
        [11.2598, 12.3909, 11.5009, 11.1305]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([13.5632,  7.9663,  9.9398, 11.2267, 11.8988, 11.0015,  7.6900, 10.0307,
        12.7417,  9.3575], device='cuda:0')
SINR = tensor([-11.3236,  -9.0126,  -9.9738, -10.5025, -10.7550, -10.4145,  -8.8593,
        -10.0133, -11.0523,  -9.7116], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0687, 0.1115, 0.0914, 0.0818, 0.0775, 0.0833, 0.1151, 0.0907, 0.0728,
        0.0965], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
--------SNR = 9,  rho_ul = 1.985820586810704-----------
G_variance = tensor([1.0129, 0.7406, 0.8503, 1.0097, 1.1155, 0.8567, 0.9846, 1.0207, 1.0481,
        0.9805], device='cuda:0')
G_hat_variance = tensor([1.0249, 0.7242, 0.8663, 0.9370, 1.0751, 0.7985, 0.9384, 1.0368, 1.0225,
        0.9545], device='cuda:0')
gamma = tensor([[[0.9754, 0.9754, 0.9754, 0.9754]]], device='cuda:0')
Z_mean = tensor([-0.0086+0.1998j, -0.0099-0.0807j,  0.0575-0.0178j, -0.0307+0.0358j,
        -0.0536-0.1049j,  0.0013+0.0476j,  0.2107-0.0023j, -0.0628-0.1755j,
        -0.0020-0.0513j, -0.1236+0.1463j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0507, 0.7424, 0.8881, 0.9606, 1.1022, 0.8186, 0.9620, 1.0629, 1.0482,
        0.9785], device='cuda:0')
Real_SNR = tensor([ 8.9681,  8.1941,  9.3128,  8.3980, 10.4712,  7.6733,  8.9351,  8.2927,
         8.5115,  9.6193], device='cuda:0')
q_var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([0.9990, 1.0001, 0.9970, 0.9988, 0.9991, 0.9993, 0.9980, 0.9899, 0.9769,
        0.9945], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([3.9475, 3.3858, 4.3184, 3.5560, 5.5357, 3.0285, 3.9773, 3.4071, 3.6016,
        4.6705], device='cuda:0')
signal_var = tensor([ 7.8389,  6.7237,  8.5755,  7.0616, 10.9930,  6.0141,  7.8981,  6.7659,
         7.1522,  9.2747], device='cuda:0')
w_var = tensor([0.9941, 1.0191, 1.0046, 1.0212, 0.9863, 1.0276, 1.0093, 1.0024, 1.0076,
        1.0124], device='cuda:0')
y_var = tensor([ 8.8453,  7.7612,  9.5388,  8.0458, 11.9337,  7.0786,  8.8782,  7.7980,
         8.0809, 10.3081], device='cuda:0')
####cond finisihed #####
************
Z_H_Z_k (shape: torch.Size([10, 4])) = tensor([[12.4229, 11.2452,  8.1317, 10.7779],
        [ 6.0309,  7.4755,  8.1801,  7.5307],
        [ 5.0908, 10.3868,  8.7680, 10.5365],
        [ 8.0200, 10.1724,  7.6433, 11.7167],
        [16.0603,  8.5202, 11.5420,  7.4171],
        [ 9.0245,  9.5620,  7.2852,  6.1457],
        [ 8.5301,  6.4213, 15.7732,  8.5702],
        [13.6969, 14.9731,  7.7706,  6.4000],
        [ 5.7930, 10.5068, 15.3671,  9.3184],
        [ 9.8977,  8.9953, 10.9936,  9.7418]], device='cuda:0')
Var (shape: torch.Size([10, 4])) = tensor([[14.8464, 13.4390,  9.7181, 12.8806],
        [ 7.2074,  8.9339,  9.7760,  8.9998],
        [ 6.0840, 12.4132, 10.4785, 12.5921],
        [ 9.5845, 12.1569,  9.1345, 14.0025],
        [19.1935, 10.1824, 13.7938,  8.8641],
        [10.7851, 11.4274,  8.7065,  7.3447],
        [10.1942,  7.6740, 18.8504, 10.2421],
        [16.3690, 17.8942,  9.2866,  7.6485],
        [ 6.9231, 12.5566, 18.3651, 11.1362],
        [11.8286, 10.7502, 13.1383, 11.6423]], device='cuda:0')
***********
mean_perbatch torch.Size([10]) = tensor([9.1401, 6.2720, 7.4667, 8.0613, 9.3466, 6.8732, 8.4354, 9.1966, 8.7983,
        8.5070], device='cuda:0')
SINR = tensor([-9.6095, -7.9741, -8.7313, -9.0641, -9.7065, -8.3716, -9.2610, -9.6362,
        -9.4440, -9.2978], device='cuda:0')
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0986, 0.1375, 0.1181, 0.1104, 0.0966, 0.1270, 0.1060, 0.0981, 0.1021,
        0.1052], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([200, 200, 200, 200, 200, 200, 200, 200, 200, 200], device='cuda:0')
d = torch.Size([10, 4, 32, 32])
recoverd_img = torch.Size([10, 3, 256, 256])
10 images are saved in outputs/MIMOdiffusion/t=200/
10 images are saved in outputs/MIMOdiffusion/nonoisenosample/
